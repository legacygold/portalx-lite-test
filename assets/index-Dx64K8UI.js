const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/basic-CU7X1560.js","assets/index-DS-zVj4K.js","assets/w3m-modal-Bh-jYajQ.js"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=r(s);fetch(s.href,i)}})();var $g,Mt,UI,BI,nc,Vv,LI,MI,jI,Xb,Ww,Vw,Cd={},FI=[],$6=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,Tg=Array.isArray;function Ao(t,e){for(var r in e)t[r]=e[r];return t}function Zb(t){t&&t.parentNode&&t.parentNode.removeChild(t)}function qI(t,e,r){var n,s,i,o={};for(i in e)i=="key"?n=e[i]:i=="ref"?s=e[i]:o[i]=e[i];if(arguments.length>2&&(o.children=arguments.length>3?$g.call(arguments,2):r),typeof t=="function"&&t.defaultProps!=null)for(i in t.defaultProps)o[i]===void 0&&(o[i]=t.defaultProps[i]);return Qf(t,o,n,s,null)}function Qf(t,e,r,n,s){var i={type:t,props:e,key:r,ref:n,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:s??++UI,__i:-1,__u:0};return s==null&&Mt.vnode!=null&&Mt.vnode(i),i}function xh(t){return t.children}function Dl(t,e){this.props=t,this.context=e}function Vl(t,e){if(e==null)return t.__?Vl(t.__,t.__i+1):null;for(var r;e<t.__k.length;e++)if((r=t.__k[e])!=null&&r.__e!=null)return r.__e;return typeof t.type=="function"?Vl(t):null}function zI(t){var e,r;if((t=t.__)!=null&&t.__c!=null){for(t.__e=t.__c.base=null,e=0;e<t.__k.length;e++)if((r=t.__k[e])!=null&&r.__e!=null){t.__e=t.__c.base=r.__e;break}return zI(t)}}function Kv(t){(!t.__d&&(t.__d=!0)&&nc.push(t)&&!xp.__r++||Vv!=Mt.debounceRendering)&&((Vv=Mt.debounceRendering)||LI)(xp)}function xp(){for(var t,e,r,n,s,i,o,a=1;nc.length;)nc.length>a&&nc.sort(MI),t=nc.shift(),a=nc.length,t.__d&&(r=void 0,n=void 0,s=(n=(e=t).__v).__e,i=[],o=[],e.__P&&((r=Ao({},n)).__v=n.__v+1,Mt.vnode&&Mt.vnode(r),Jb(e.__P,r,n,e.__n,e.__P.namespaceURI,32&n.__u?[s]:null,i,s??Vl(n),!!(32&n.__u),o),r.__v=n.__v,r.__.__k[r.__i]=r,VI(i,r,o),n.__e=n.__=null,r.__e!=s&&zI(r)));xp.__r=0}function HI(t,e,r,n,s,i,o,a,c,l,u){var d,h,p,y,g,w,S,A=n&&n.__k||FI,E=e.length;for(c=T6(r,e,A,c,E),d=0;d<E;d++)(p=r.__k[d])!=null&&(h=p.__i==-1?Cd:A[p.__i]||Cd,p.__i=d,w=Jb(t,p,h,s,i,o,a,c,l,u),y=p.__e,p.ref&&h.ref!=p.ref&&(h.ref&&Qb(h.ref,null,p),u.push(p.ref,p.__c||y,p)),g==null&&y!=null&&(g=y),(S=!!(4&p.__u))||h.__k===p.__k?c=WI(p,c,t,S):typeof p.type=="function"&&w!==void 0?c=w:y&&(c=y.nextSibling),p.__u&=-7);return r.__e=g,c}function T6(t,e,r,n,s){var i,o,a,c,l,u=r.length,d=u,h=0;for(t.__k=new Array(s),i=0;i<s;i++)(o=e[i])!=null&&typeof o!="boolean"&&typeof o!="function"?(c=i+h,(o=t.__k[i]=typeof o=="string"||typeof o=="number"||typeof o=="bigint"||o.constructor==String?Qf(null,o,null,null,null):Tg(o)?Qf(xh,{children:o},null,null,null):o.constructor==null&&o.__b>0?Qf(o.type,o.props,o.key,o.ref?o.ref:null,o.__v):o).__=t,o.__b=t.__b+1,a=null,(l=o.__i=N6(o,r,c,d))!=-1&&(d--,(a=r[l])&&(a.__u|=2)),a==null||a.__v==null?(l==-1&&(s>u?h--:s<u&&h++),typeof o.type!="function"&&(o.__u|=4)):l!=c&&(l==c-1?h--:l==c+1?h++:(l>c?h--:h++,o.__u|=4))):t.__k[i]=null;if(d)for(i=0;i<u;i++)(a=r[i])!=null&&(2&a.__u)==0&&(a.__e==n&&(n=Vl(a)),GI(a,a));return n}function WI(t,e,r,n){var s,i;if(typeof t.type=="function"){for(s=t.__k,i=0;s&&i<s.length;i++)s[i]&&(s[i].__=t,e=WI(s[i],e,r,n));return e}t.__e!=e&&(n&&(e&&t.type&&!e.parentNode&&(e=Vl(t)),r.insertBefore(t.__e,e||null)),e=t.__e);do e=e&&e.nextSibling;while(e!=null&&e.nodeType==8);return e}function N6(t,e,r,n){var s,i,o,a=t.key,c=t.type,l=e[r],u=l!=null&&(2&l.__u)==0;if(l===null&&t.key==null||u&&a==l.key&&c==l.type)return r;if(n>(u?1:0)){for(s=r-1,i=r+1;s>=0||i<e.length;)if((l=e[o=s>=0?s--:i++])!=null&&(2&l.__u)==0&&a==l.key&&c==l.type)return o}return-1}function Gv(t,e,r){e[0]=="-"?t.setProperty(e,r??""):t[e]=r==null?"":typeof r!="number"||$6.test(e)?r:r+"px"}function nf(t,e,r,n,s){var i,o;e:if(e=="style")if(typeof r=="string")t.style.cssText=r;else{if(typeof n=="string"&&(t.style.cssText=n=""),n)for(e in n)r&&e in r||Gv(t.style,e,"");if(r)for(e in r)n&&r[e]==n[e]||Gv(t.style,e,r[e])}else if(e[0]=="o"&&e[1]=="n")i=e!=(e=e.replace(jI,"$1")),o=e.toLowerCase(),e=o in t||e=="onFocusOut"||e=="onFocusIn"?o.slice(2):e.slice(2),t.l||(t.l={}),t.l[e+i]=r,r?n?r.u=n.u:(r.u=Xb,t.addEventListener(e,i?Vw:Ww,i)):t.removeEventListener(e,i?Vw:Ww,i);else{if(s=="http://www.w3.org/2000/svg")e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!="width"&&e!="height"&&e!="href"&&e!="list"&&e!="form"&&e!="tabIndex"&&e!="download"&&e!="rowSpan"&&e!="colSpan"&&e!="role"&&e!="popover"&&e in t)try{t[e]=r??"";break e}catch{}typeof r=="function"||(r==null||r===!1&&e[4]!="-"?t.removeAttribute(e):t.setAttribute(e,e=="popover"&&r==1?"":r))}}function Yv(t){return function(e){if(this.l){var r=this.l[e.type+t];if(e.t==null)e.t=Xb++;else if(e.t<r.u)return;return r(Mt.event?Mt.event(e):e)}}}function Jb(t,e,r,n,s,i,o,a,c,l){var u,d,h,p,y,g,w,S,A,E,v,C,O,L,j,D,W,P=e.type;if(e.constructor!=null)return null;128&r.__u&&(c=!!(32&r.__u),i=[a=e.__e=r.__e]),(u=Mt.__b)&&u(e);e:if(typeof P=="function")try{if(S=e.props,A="prototype"in P&&P.prototype.render,E=(u=P.contextType)&&n[u.__c],v=u?E?E.props.value:u.__:n,r.__c?w=(d=e.__c=r.__c).__=d.__E:(A?e.__c=d=new P(S,v):(e.__c=d=new Dl(S,v),d.constructor=P,d.render=k6),E&&E.sub(d),d.props=S,d.state||(d.state={}),d.context=v,d.__n=n,h=d.__d=!0,d.__h=[],d._sb=[]),A&&d.__s==null&&(d.__s=d.state),A&&P.getDerivedStateFromProps!=null&&(d.__s==d.state&&(d.__s=Ao({},d.__s)),Ao(d.__s,P.getDerivedStateFromProps(S,d.__s))),p=d.props,y=d.state,d.__v=e,h)A&&P.getDerivedStateFromProps==null&&d.componentWillMount!=null&&d.componentWillMount(),A&&d.componentDidMount!=null&&d.__h.push(d.componentDidMount);else{if(A&&P.getDerivedStateFromProps==null&&S!==p&&d.componentWillReceiveProps!=null&&d.componentWillReceiveProps(S,v),!d.__e&&d.shouldComponentUpdate!=null&&d.shouldComponentUpdate(S,d.__s,v)===!1||e.__v==r.__v){for(e.__v!=r.__v&&(d.props=S,d.state=d.__s,d.__d=!1),e.__e=r.__e,e.__k=r.__k,e.__k.some(function(R){R&&(R.__=e)}),C=0;C<d._sb.length;C++)d.__h.push(d._sb[C]);d._sb=[],d.__h.length&&o.push(d);break e}d.componentWillUpdate!=null&&d.componentWillUpdate(S,d.__s,v),A&&d.componentDidUpdate!=null&&d.__h.push(function(){d.componentDidUpdate(p,y,g)})}if(d.context=v,d.props=S,d.__P=t,d.__e=!1,O=Mt.__r,L=0,A){for(d.state=d.__s,d.__d=!1,O&&O(e),u=d.render(d.props,d.state,d.context),j=0;j<d._sb.length;j++)d.__h.push(d._sb[j]);d._sb=[]}else do d.__d=!1,O&&O(e),u=d.render(d.props,d.state,d.context),d.state=d.__s;while(d.__d&&++L<25);d.state=d.__s,d.getChildContext!=null&&(n=Ao(Ao({},n),d.getChildContext())),A&&!h&&d.getSnapshotBeforeUpdate!=null&&(g=d.getSnapshotBeforeUpdate(p,y)),D=u,u!=null&&u.type===xh&&u.key==null&&(D=KI(u.props.children)),a=HI(t,Tg(D)?D:[D],e,r,n,s,i,o,a,c,l),d.base=e.__e,e.__u&=-161,d.__h.length&&o.push(d),w&&(d.__E=d.__=null)}catch(R){if(e.__v=null,c||i!=null)if(R.then){for(e.__u|=c?160:128;a&&a.nodeType==8&&a.nextSibling;)a=a.nextSibling;i[i.indexOf(a)]=null,e.__e=a}else{for(W=i.length;W--;)Zb(i[W]);Kw(e)}else e.__e=r.__e,e.__k=r.__k,R.then||Kw(e);Mt.__e(R,e,r)}else i==null&&e.__v==r.__v?(e.__k=r.__k,e.__e=r.__e):a=e.__e=O6(r.__e,e,r,n,s,i,o,c,l);return(u=Mt.diffed)&&u(e),128&e.__u?void 0:a}function Kw(t){t&&t.__c&&(t.__c.__e=!0),t&&t.__k&&t.__k.forEach(Kw)}function VI(t,e,r){for(var n=0;n<r.length;n++)Qb(r[n],r[++n],r[++n]);Mt.__c&&Mt.__c(e,t),t.some(function(s){try{t=s.__h,s.__h=[],t.some(function(i){i.call(s)})}catch(i){Mt.__e(i,s.__v)}})}function KI(t){return typeof t!="object"||t==null||t.__b&&t.__b>0?t:Tg(t)?t.map(KI):Ao({},t)}function O6(t,e,r,n,s,i,o,a,c){var l,u,d,h,p,y,g,w=r.props,S=e.props,A=e.type;if(A=="svg"?s="http://www.w3.org/2000/svg":A=="math"?s="http://www.w3.org/1998/Math/MathML":s||(s="http://www.w3.org/1999/xhtml"),i!=null){for(l=0;l<i.length;l++)if((p=i[l])&&"setAttribute"in p==!!A&&(A?p.localName==A:p.nodeType==3)){t=p,i[l]=null;break}}if(t==null){if(A==null)return document.createTextNode(S);t=document.createElementNS(s,A,S.is&&S),a&&(Mt.__m&&Mt.__m(e,i),a=!1),i=null}if(A==null)w===S||a&&t.data==S||(t.data=S);else{if(i=i&&$g.call(t.childNodes),w=r.props||Cd,!a&&i!=null)for(w={},l=0;l<t.attributes.length;l++)w[(p=t.attributes[l]).name]=p.value;for(l in w)if(p=w[l],l!="children"){if(l=="dangerouslySetInnerHTML")d=p;else if(!(l in S)){if(l=="value"&&"defaultValue"in S||l=="checked"&&"defaultChecked"in S)continue;nf(t,l,null,p,s)}}for(l in S)p=S[l],l=="children"?h=p:l=="dangerouslySetInnerHTML"?u=p:l=="value"?y=p:l=="checked"?g=p:a&&typeof p!="function"||w[l]===p||nf(t,l,p,w[l],s);if(u)a||d&&(u.__html==d.__html||u.__html==t.innerHTML)||(t.innerHTML=u.__html),e.__k=[];else if(d&&(t.innerHTML=""),HI(e.type=="template"?t.content:t,Tg(h)?h:[h],e,r,n,A=="foreignObject"?"http://www.w3.org/1999/xhtml":s,i,o,i?i[0]:r.__k&&Vl(r,0),a,c),i!=null)for(l=i.length;l--;)Zb(i[l]);a||(l="value",A=="progress"&&y==null?t.removeAttribute("value"):y!=null&&(y!==t[l]||A=="progress"&&!y||A=="option"&&y!=w[l])&&nf(t,l,y,w[l],s),l="checked",g!=null&&g!=t[l]&&nf(t,l,g,w[l],s))}return t}function Qb(t,e,r){try{if(typeof t=="function"){var n=typeof t.__u=="function";n&&t.__u(),n&&e==null||(t.__u=t(e))}else t.current=e}catch(s){Mt.__e(s,r)}}function GI(t,e,r){var n,s;if(Mt.unmount&&Mt.unmount(t),(n=t.ref)&&(n.current&&n.current!=t.__e||Qb(n,null,e)),(n=t.__c)!=null){if(n.componentWillUnmount)try{n.componentWillUnmount()}catch(i){Mt.__e(i,e)}n.base=n.__P=null}if(n=t.__k)for(s=0;s<n.length;s++)n[s]&&GI(n[s],e,r||typeof t.type!="function");r||Zb(t.__e),t.__c=t.__=t.__e=void 0}function k6(t,e,r){return this.constructor(t,r)}function Iu(t,e,r){var n,s,i,o;e==document&&(e=document.documentElement),Mt.__&&Mt.__(t,e),s=(n=!1)?null:e.__k,i=[],o=[],Jb(e,t=e.__k=qI(xh,null,[t]),s||Cd,Cd,e.namespaceURI,s?null:e.firstChild?$g.call(e.childNodes):null,i,s?s.__e:e.firstChild,n,o),VI(i,t,o)}$g=FI.slice,Mt={__e:function(t,e,r,n){for(var s,i,o;e=e.__;)if((s=e.__c)&&!s.__)try{if((i=s.constructor)&&i.getDerivedStateFromError!=null&&(s.setState(i.getDerivedStateFromError(t)),o=s.__d),s.componentDidCatch!=null&&(s.componentDidCatch(t,n||{}),o=s.__d),o)return s.__E=s}catch(a){t=a}throw t}},UI=0,BI=function(t){return t!=null&&t.constructor==null},Dl.prototype.setState=function(t,e){var r;r=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=Ao({},this.state),typeof t=="function"&&(t=t(Ao({},r),this.props)),t&&Ao(r,t),t!=null&&this.__v&&(e&&this._sb.push(e),Kv(this))},Dl.prototype.forceUpdate=function(t){this.__v&&(this.__e=!0,t&&this.__h.push(t),Kv(this))},Dl.prototype.render=xh,nc=[],LI=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,MI=function(t,e){return t.__v.__b-e.__v.__b},xp.__r=0,jI=/(PointerCapture)$|Capture$/i,Xb=0,Ww=Yv(!1),Vw=Yv(!0);var $d,pr,Ny,Xv,Gw=0,YI=[],Er=Mt,Zv=Er.__b,Jv=Er.__r,Qv=Er.diffed,eE=Er.__c,tE=Er.unmount,rE=Er.__;function e1(t,e){Er.__h&&Er.__h(pr,t,Gw||e),Gw=0;var r=pr.__H||(pr.__H={__:[],__h:[]});return t>=r.__.length&&r.__.push({}),r.__[t]}function Yw(t){return Gw=1,P6(ZI,t)}function P6(t,e,r){var n=e1($d++,2);if(n.t=t,!n.__c&&(n.__=[ZI(void 0,e),function(a){var c=n.__N?n.__N[0]:n.__[0],l=n.t(c,a);c!==l&&(n.__N=[l,n.__[1]],n.__c.setState({}))}],n.__c=pr,!pr.__f)){var s=function(a,c,l){if(!n.__c.__H)return!0;var u=n.__c.__H.__.filter(function(h){return!!h.__c});if(u.every(function(h){return!h.__N}))return!i||i.call(this,a,c,l);var d=n.__c.props!==a;return u.forEach(function(h){if(h.__N){var p=h.__[0];h.__=h.__N,h.__N=void 0,p!==h.__[0]&&(d=!0)}}),i&&i.call(this,a,c,l)||d};pr.__f=!0;var i=pr.shouldComponentUpdate,o=pr.componentWillUpdate;pr.componentWillUpdate=function(a,c,l){if(this.__e){var u=i;i=void 0,s(a,c,l),i=u}o&&o.call(this,a,c,l)},pr.shouldComponentUpdate=s}return n.__N||n.__}function R6(t,e){var r=e1($d++,3);!Er.__s&&XI(r.__H,e)&&(r.__=t,r.u=e,pr.__H.__h.push(r))}function D6(t,e){var r=e1($d++,7);return XI(r.__H,e)&&(r.__=t(),r.__H=e,r.__h=t),r.__}function U6(){for(var t;t=YI.shift();)if(t.__P&&t.__H)try{t.__H.__h.forEach(ep),t.__H.__h.forEach(Xw),t.__H.__h=[]}catch(e){t.__H.__h=[],Er.__e(e,t.__v)}}Er.__b=function(t){pr=null,Zv&&Zv(t)},Er.__=function(t,e){t&&e.__k&&e.__k.__m&&(t.__m=e.__k.__m),rE&&rE(t,e)},Er.__r=function(t){Jv&&Jv(t),$d=0;var e=(pr=t.__c).__H;e&&(Ny===pr?(e.__h=[],pr.__h=[],e.__.forEach(function(r){r.__N&&(r.__=r.__N),r.u=r.__N=void 0})):(e.__h.forEach(ep),e.__h.forEach(Xw),e.__h=[],$d=0)),Ny=pr},Er.diffed=function(t){Qv&&Qv(t);var e=t.__c;e&&e.__H&&(e.__H.__h.length&&(YI.push(e)!==1&&Xv===Er.requestAnimationFrame||((Xv=Er.requestAnimationFrame)||B6)(U6)),e.__H.__.forEach(function(r){r.u&&(r.__H=r.u),r.u=void 0})),Ny=pr=null},Er.__c=function(t,e){e.some(function(r){try{r.__h.forEach(ep),r.__h=r.__h.filter(function(n){return!n.__||Xw(n)})}catch(n){e.some(function(s){s.__h&&(s.__h=[])}),e=[],Er.__e(n,r.__v)}}),eE&&eE(t,e)},Er.unmount=function(t){tE&&tE(t);var e,r=t.__c;r&&r.__H&&(r.__H.__.forEach(function(n){try{ep(n)}catch(s){e=s}}),r.__H=void 0,e&&Er.__e(e,r.__v))};var nE=typeof requestAnimationFrame=="function";function B6(t){var e,r=function(){clearTimeout(n),nE&&cancelAnimationFrame(e),setTimeout(t)},n=setTimeout(r,35);nE&&(e=requestAnimationFrame(r))}function ep(t){var e=pr,r=t.__c;typeof r=="function"&&(t.__c=void 0,r()),pr=e}function Xw(t){var e=pr;t.__c=t.__(),pr=e}function XI(t,e){return!t||t.length!==e.length||e.some(function(r,n){return r!==t[n]})}function ZI(t,e){return typeof e=="function"?e(t):e}var L6=Symbol.for("preact-signals");function Ng(){if(xa>1)xa--;else{for(var t,e=!1;hd!==void 0;){var r=hd;for(hd=void 0,Zw++;r!==void 0;){var n=r.o;if(r.o=void 0,r.f&=-3,!(8&r.f)&&eC(r))try{r.c()}catch(s){e||(t=s,e=!0)}r=n}}if(Zw=0,xa--,e)throw t}}function M6(t){if(xa>0)return t();xa++;try{return t()}finally{Ng()}}var Pt=void 0;function JI(t){var e=Pt;Pt=void 0;try{return t()}finally{Pt=e}}var hd=void 0,xa=0,Zw=0,Sp=0;function QI(t){if(Pt!==void 0){var e=t.n;if(e===void 0||e.t!==Pt)return e={i:0,S:t,p:Pt.s,n:void 0,t:Pt,e:void 0,x:void 0,r:e},Pt.s!==void 0&&(Pt.s.n=e),Pt.s=e,t.n=e,32&Pt.f&&t.S(e),e;if(e.i===-1)return e.i=0,e.n!==void 0&&(e.n.p=e.p,e.p!==void 0&&(e.p.n=e.n),e.p=Pt.s,e.n=void 0,Pt.s.n=e,Pt.s=e),e}}function ln(t,e){this.v=t,this.i=0,this.n=void 0,this.t=void 0,this.W=e?.watched,this.Z=e?.unwatched,this.name=e?.name}ln.prototype.brand=L6;ln.prototype.h=function(){return!0};ln.prototype.S=function(t){var e=this,r=this.t;r!==t&&t.e===void 0&&(t.x=r,this.t=t,r!==void 0?r.e=t:JI(function(){var n;(n=e.W)==null||n.call(e)}))};ln.prototype.U=function(t){var e=this;if(this.t!==void 0){var r=t.e,n=t.x;r!==void 0&&(r.x=n,t.e=void 0),n!==void 0&&(n.e=r,t.x=void 0),t===this.t&&(this.t=n,n===void 0&&JI(function(){var s;(s=e.Z)==null||s.call(e)}))}};ln.prototype.subscribe=function(t){var e=this;return wi(function(){var r=e.value,n=Pt;Pt=void 0;try{t(r)}finally{Pt=n}},{name:"sub"})};ln.prototype.valueOf=function(){return this.value};ln.prototype.toString=function(){return this.value+""};ln.prototype.toJSON=function(){return this.value};ln.prototype.peek=function(){var t=Pt;Pt=void 0;try{return this.value}finally{Pt=t}};Object.defineProperty(ln.prototype,"value",{get:function(){var t=QI(this);return t!==void 0&&(t.i=this.i),this.v},set:function(t){if(t!==this.v){if(Zw>100)throw new Error("Cycle detected");this.v=t,this.i++,Sp++,xa++;try{for(var e=this.t;e!==void 0;e=e.x)e.t.N()}finally{Ng()}}}});function yr(t,e){return new ln(t,e)}function eC(t){for(var e=t.s;e!==void 0;e=e.n)if(e.S.i!==e.i||!e.S.h()||e.S.i!==e.i)return!0;return!1}function tC(t){for(var e=t.s;e!==void 0;e=e.n){var r=e.S.n;if(r!==void 0&&(e.r=r),e.S.n=e,e.i=-1,e.n===void 0){t.s=e;break}}}function rC(t){for(var e=t.s,r=void 0;e!==void 0;){var n=e.p;e.i===-1?(e.S.U(e),n!==void 0&&(n.n=e.n),e.n!==void 0&&(e.n.p=n)):r=e,e.S.n=e.r,e.r!==void 0&&(e.r=void 0),e=n}t.s=r}function qc(t,e){ln.call(this,void 0),this.x=t,this.s=void 0,this.g=Sp-1,this.f=4,this.W=e?.watched,this.Z=e?.unwatched,this.name=e?.name}qc.prototype=new ln;qc.prototype.h=function(){if(this.f&=-3,1&this.f)return!1;if((36&this.f)==32||(this.f&=-5,this.g===Sp))return!0;if(this.g=Sp,this.f|=1,this.i>0&&!eC(this))return this.f&=-2,!0;var t=Pt;try{tC(this),Pt=this;var e=this.x();(16&this.f||this.v!==e||this.i===0)&&(this.v=e,this.f&=-17,this.i++)}catch(r){this.v=r,this.f|=16,this.i++}return Pt=t,rC(this),this.f&=-2,!0};qc.prototype.S=function(t){if(this.t===void 0){this.f|=36;for(var e=this.s;e!==void 0;e=e.n)e.S.S(e)}ln.prototype.S.call(this,t)};qc.prototype.U=function(t){if(this.t!==void 0&&(ln.prototype.U.call(this,t),this.t===void 0)){this.f&=-33;for(var e=this.s;e!==void 0;e=e.n)e.S.U(e)}};qc.prototype.N=function(){if(!(2&this.f)){this.f|=6;for(var t=this.t;t!==void 0;t=t.x)t.t.N()}};Object.defineProperty(qc.prototype,"value",{get:function(){if(1&this.f)throw new Error("Cycle detected");var t=QI(this);if(this.h(),t!==void 0&&(t.i=this.i),16&this.f)throw this.v;return this.v}});function Kl(t,e){return new qc(t,e)}function nC(t){var e=t.u;if(t.u=void 0,typeof e=="function"){xa++;var r=Pt;Pt=void 0;try{e()}catch(n){throw t.f&=-2,t.f|=8,t1(t),n}finally{Pt=r,Ng()}}}function t1(t){for(var e=t.s;e!==void 0;e=e.n)e.S.U(e);t.x=void 0,t.s=void 0,nC(t)}function j6(t){if(Pt!==this)throw new Error("Out-of-order effect");rC(this),Pt=t,this.f&=-2,8&this.f&&t1(this),Ng()}function du(t,e){this.x=t,this.u=void 0,this.s=void 0,this.o=void 0,this.f=32,this.name=e?.name}du.prototype.c=function(){var t=this.S();try{if(8&this.f||this.x===void 0)return;var e=this.x();typeof e=="function"&&(this.u=e)}finally{t()}};du.prototype.S=function(){if(1&this.f)throw new Error("Cycle detected");this.f|=1,this.f&=-9,nC(this),tC(this),xa++;var t=Pt;return Pt=this,j6.bind(this,t)};du.prototype.N=function(){2&this.f||(this.f|=2,this.o=hd,hd=this)};du.prototype.d=function(){this.f|=8,1&this.f||t1(this)};du.prototype.dispose=function(){this.d()};function wi(t,e){var r=new du(t,e);try{r.c()}catch(s){throw r.d(),s}var n=r.d.bind(r);return n[Symbol.dispose]=n,n}var sC,Oy,iC=[];wi(function(){sC=this.N})();function hu(t,e){Mt[t]=e.bind(null,Mt[t]||function(){})}function Ap(t){Oy&&Oy(),Oy=t&&t.S()}function oC(t){var e=this,r=t.data,n=q6(r);n.value=r;var s=D6(function(){for(var a=e,c=e.__v;c=c.__;)if(c.__c){c.__c.__$f|=4;break}var l=Kl(function(){var p=n.value.value;return p===0?0:p===!0?"":p||""}),u=Kl(function(){return!Array.isArray(l.value)&&!BI(l.value)}),d=wi(function(){if(this.N=aC,u.value){var p=l.value;a.__v&&a.__v.__e&&a.__v.__e.nodeType===3&&(a.__v.__e.data=p)}}),h=e.__$u.d;return e.__$u.d=function(){d(),h.call(this)},[u,l]},[]),i=s[0],o=s[1];return i.value?o.peek():o.value}oC.displayName="ReactiveTextNode";Object.defineProperties(ln.prototype,{constructor:{configurable:!0,value:void 0},type:{configurable:!0,value:oC},props:{configurable:!0,get:function(){return{data:this}}},__b:{configurable:!0,value:1}});hu("__b",function(t,e){if(typeof e.type=="function"&&typeof window<"u"&&window.__PREACT_SIGNALS_DEVTOOLS__&&window.__PREACT_SIGNALS_DEVTOOLS__.exitComponent(),typeof e.type=="string"){var r,n=e.props;for(var s in n)if(s!=="children"){var i=n[s];i instanceof ln&&(r||(e.__np=r={}),r[s]=i,n[s]=i.peek())}}t(e)});hu("__r",function(t,e){if(typeof e.type=="function"&&typeof window<"u"&&window.__PREACT_SIGNALS_DEVTOOLS__&&window.__PREACT_SIGNALS_DEVTOOLS__.enterComponent(e),e.type!==xh){Ap();var r,n=e.__c;n&&(n.__$f&=-2,(r=n.__$u)===void 0&&(n.__$u=r=(function(s){var i;return wi(function(){i=this}),i.c=function(){n.__$f|=1,n.setState({})},i})())),Ap(r)}t(e)});hu("__e",function(t,e,r,n){typeof window<"u"&&window.__PREACT_SIGNALS_DEVTOOLS__&&window.__PREACT_SIGNALS_DEVTOOLS__.exitComponent(),Ap(),t(e,r,n)});hu("diffed",function(t,e){typeof e.type=="function"&&typeof window<"u"&&window.__PREACT_SIGNALS_DEVTOOLS__&&window.__PREACT_SIGNALS_DEVTOOLS__.exitComponent(),Ap();var r;if(typeof e.type=="string"&&(r=e.__e)){var n=e.__np,s=e.props;if(n){var i=r.U;if(i)for(var o in i){var a=i[o];a!==void 0&&!(o in n)&&(a.d(),i[o]=void 0)}else i={},r.U=i;for(var c in n){var l=i[c],u=n[c];l===void 0?(l=F6(r,c,u,s),i[c]=l):l.o(u,s)}}}t(e)});function F6(t,e,r,n){var s=e in t&&t.ownerSVGElement===void 0,i=yr(r);return{o:function(o,a){i.value=o,n=a},d:wi(function(){this.N=aC;var o=i.value.value;n[e]!==o&&(n[e]=o,s?t[e]=o:o?t.setAttribute(e,o):t.removeAttribute(e))})}}hu("unmount",function(t,e){if(typeof e.type=="string"){var r=e.__e;if(r){var n=r.U;if(n){r.U=void 0;for(var s in n){var i=n[s];i&&i.d()}}}}else{var o=e.__c;if(o){var a=o.__$u;a&&(o.__$u=void 0,a.d())}}t(e)});hu("__h",function(t,e,r,n){(n<3||n===9)&&(e.__$f|=2),t(e,r,n)});Dl.prototype.shouldComponentUpdate=function(t,e){var r=this.__$u,n=r&&r.s!==void 0;for(var s in e)return!0;if(this.__f||typeof this.u=="boolean"&&this.u===!0){var i=2&this.__$f;if(!(n||i||4&this.__$f)||1&this.__$f)return!0}else if(!(n||4&this.__$f)||3&this.__$f)return!0;for(var o in t)if(o!=="__source"&&t[o]!==this.props[o])return!0;for(var a in this.props)if(!(a in t))return!0;return!1};function q6(t,e){return Yw(function(){return yr(t,e)})[0]}var z6=function(t){queueMicrotask(function(){queueMicrotask(t)})};function H6(){M6(function(){for(var t;t=iC.shift();)sC.call(t)})}function aC(){iC.push(this)===1&&(Mt.requestAnimationFrame||z6)(H6)}var cC=function(t,e,r,n){var s;e[0]=0;for(var i=1;i<e.length;i++){var o=e[i++],a=e[i]?(e[0]|=o?1:2,r[e[i++]]):e[++i];o===3?n[0]=a:o===4?n[1]=Object.assign(n[1]||{},a):o===5?(n[1]=n[1]||{})[e[++i]]=a:o===6?n[1][e[++i]]+=a+"":o?(s=t.apply(a,cC(t,a,r,["",null])),n.push(s),a[0]?e[0]|=2:(e[i-2]=0,e[i]=s)):n.push(a)}return n},sE=new Map;function W6(t){var e=sE.get(this);return e||(e=new Map,sE.set(this,e)),(e=cC(this,e.get(t)||(e.set(t,e=(function(r){for(var n,s,i=1,o="",a="",c=[0],l=function(h){i===1&&(h||(o=o.replace(/^\s*\n\s*|\s*\n\s*$/g,"")))?c.push(0,h,o):i===3&&(h||o)?(c.push(3,h,o),i=2):i===2&&o==="..."&&h?c.push(4,h,0):i===2&&o&&!h?c.push(5,0,!0,o):i>=5&&((o||!h&&i===5)&&(c.push(i,0,o,s),i=6),h&&(c.push(i,h,0,s),i=6)),o=""},u=0;u<r.length;u++){u&&(i===1&&l(),l(u));for(var d=0;d<r[u].length;d++)n=r[u][d],i===1?n==="<"?(l(),c=[c],i=3):o+=n:i===4?o==="--"&&n===">"?(i=1,o=""):o=n+o[0]:a?n===a?a="":o+=n:n==='"'||n==="'"?a=n:n===">"?(l(),i=1):i&&(n==="="?(i=5,s=o,o=""):n==="/"&&(i<5||r[u][d+1]===">")?(l(),i===3&&(c=c[0]),i=c,(c=c[0]).push(2,0,i),i=0):n===" "||n==="	"||n===`
`||n==="\r"?(l(),i=2):o+=n),i===3&&o==="!--"&&(i=4,c=c[0])}return l(),c})(t)),e),arguments,[])).length>1?e:e[0]}var Vt=W6.bind(qI),gi=(function(t){return t.AUTH_OPTIONS="AUTH_OPTIONS",t.HELP_PAGE="HELP_PAGE",t.PROFILE_PAGE="PROFILE_PAGE",t.HW_ACCOUNTS_FETCHER="HW_ACCOUNTS_FETCHER",t})({}),dc=(function(t){return t.FIXED="FIXED",t.BLOCK="BLOCK",t.HIDDEN="HIDDEN",t})({});const lC={background:"#fcfcfcff","background-secondary":"#f8f8f8ff","foreground-strong":"#000000",foreground:"#161619ff","foreground-secondary":"#2d2d31ff",primary:"#3b82f6","primary-foreground":"#ffffff",transparent:"rgba(0, 0, 0, 0)",lighter:"#fcfcfc",light:"#f8f8f8","light-gray":"oklch(0.800 0.006 286.033)",gray:"oklch(0.600 0.006 286.033)",danger:"oklch(57.7% 0.245 27.325)",border:"rgba(0, 0, 0, 0.15)",shadow:"0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -4px rgba(0, 0, 0, 0.1)","border-radius":"0.5rem","font-family":"sans-serif"},V6={background:"oklch(0.333 0 89.876)","background-secondary":"oklch(0 0 0)","foreground-strong":"#fff",foreground:"oklch(0.985 0 0)","foreground-secondary":"oklch(0.97 0 0)",primary:"#e0e0e0","primary-foreground":"#1e1e1e",transparent:"rgba(0, 0, 0, 0)",lighter:"#fcfcfc",light:"#f8f8f8","light-gray":"oklch(0.800 0.006 286.033)",gray:"oklch(0.600 0.006 286.033)",danger:"oklch(57.7% 0.245 27.325)",border:"rgba(58,58,58,0.15)",shadow:"0 10px 15px -3px rgba(255, 255, 255, 0.1), 0 4px 6px -4px rgba(255, 255, 255, 0.1)","border-radius":"0.5rem","font-family":"sans-serif"};var xs=(function(t){return t.usedWalletsIds="@StellarWalletsKit/usedWalletsIds",t.activeAddress="@StellarWalletsKit/activeAddress",t.selectedModuleId="@StellarWalletsKit/selectedModuleId",t.hardwareWalletPaths="@StellarWalletsKit/hardwareWalletPaths",t.wcSessionPaths="@StellarWalletsKit/wcSessionPaths",t})({}),Sa=(function(t){return t.PUBLIC="Public Global Stellar Network ; September 2015",t.TESTNET="Test SDF Network ; September 2015",t.FUTURENET="Test SDF Future Network ; October 2022",t.SANDBOX="Local Sandbox Stellar Network ; September 2022",t.STANDALONE="Standalone Network ; February 2017",t})({}),Bo=(function(t){return t.HW_WALLET="HW_WALLET",t.HOT_WALLET="HOT_WALLET",t.BRIDGE_WALLET="BRIDGE_WALLET",t.AIR_GAPED_WALLET="AIR_GAPED_WALLET",t})({}),ol=(function(t){return t.STATE_UPDATED="STATE_UPDATE",t.WALLET_SELECTED="WALLET_SELECTED",t.DISCONNECT="DISCONNECT",t})({});const Og=globalThis.localStorage,Ip=yr(dc.FIXED),kg=yr("Connect a Wallet"),uC=yr(!0),K6=yr(!0),G6=yr("Install");yr("https://horizon.stellar.org");const Pi=yr(Sa.PUBLIC),dC=yr(lC),Pg=yr(gi.AUTH_OPTIONS),Oc=yr([gi.AUTH_OPTIONS]),ur=yr(Og?.getItem(xs.activeAddress)||void 0),Io=yr(Og?.getItem(xs.selectedModuleId)||void 0),hC=yr([]),fd=yr([]),Ss=Kl(()=>fd.value.find(t=>t.productId===Io.value)),Y6=Og?.getItem(xs.hardwareWalletPaths),Td=yr(JSON.parse(Y6||"[]"));Kl(()=>{const t=Td.value.find(({publicKey:e})=>e===ur.value);if(t)return`44'/148'/${t.index}'`});const X6=Og?.getItem(xs.wcSessionPaths),yo=yr(JSON.parse(X6||"[]"));function Z6(){Oc.value=[],Td.value=[],yo.value=[],ur.value=void 0,Io.value=void 0}function Rg(){const t=yr(null);let e="active",r=null;const n=new Set,s=new Set,i=new Set;wi(()=>{if(e==="active"&&t.value!==null){const a=t.value;t.value=null;for(const c of n)c(a)}});function o(){n.clear(),s.clear(),i.clear()}return{next(a){e==="active"&&(t.value=a)},error(a){if(e==="active"){e="error",r=a;for(const c of s)c(a);o()}},complete(){if(e==="active"){e="completed";for(const a of i)a();o()}},subscribe(a,c,l){return e==="error"?(c?.(r),()=>{}):e==="completed"?(l?.(),()=>{}):(a&&n.add(a),c&&s.add(c),l&&i.add(l),()=>{a&&n.delete(a),c&&s.delete(c),l&&i.delete(l)})},isCompleted(){return e==="completed"},hasError(){return e==="error"}}}const J6=Rg(),Cp=Rg(),Nd=Rg(),fC=Rg(),Ri=globalThis.localStorage,iE=globalThis.document;wi(()=>{if(iE)for(const[t,e]of Object.entries(dC.value))iE.documentElement.style.setProperty(`--swk-${t}`,e)});wi(()=>{if(Ri&&Ss.value)try{const t=Ri.getItem(xs.usedWalletsIds),e=t?new Set(JSON.parse(t)):new Set;e.has(Ss.value.productId)&&e.delete(Ss.value.productId),Ri.setItem(xs.usedWalletsIds,JSON.stringify([Ss.value.productId,...e]))}catch(t){console.error(t)}});wi(()=>{Ri&&(ur.value?Ri.setItem(xs.activeAddress,ur.value):Ri.removeItem(xs.activeAddress),Io.value?Ri.setItem(xs.selectedModuleId,Io.value):Ri.removeItem(xs.selectedModuleId),typeof Td.value<"u"&&Ri.setItem(xs.hardwareWalletPaths,JSON.stringify(Td.value)),typeof yo.value<"u"&&Ri.setItem(xs.wcSessionPaths,JSON.stringify(yo.value)))});let ky;function r1(t){return[...t.v,(t.i?"!":"")+t.n].join(":")}function pC(t,e=","){return t.map(r1).join(e)}let n1=typeof CSS<"u"&&CSS.escape||(t=>t.replace(/[!"'`*+.,;:\\/<=>?@#$%&^|~()[\]{}]/g,"\\$&").replace(/^\d/,"\\3$& "));function Gl(t){for(var e=9,r=t.length;r--;)e=Math.imul(e^t.charCodeAt(r),1597334677);return"#"+((e^e>>>9)>>>0).toString(36)}function s1(t,e="@media "){return e+Yt(t).map(r=>(typeof r=="string"&&(r={min:r}),r.raw||Object.keys(r).map(n=>`(${n}-width:${r[n]})`).join(" and "))).join(",")}function Yt(t=[]){return Array.isArray(t)?t:t==null?[]:[t]}function oE(t){return t}function Dg(){}let on={d:0,b:134217728,c:268435456,a:671088640,u:805306368,o:939524096};function gC(t){return t.match(/[-=:;]/g)?.length||0}function Jw(t){return Math.min(/(?:^|width[^\d]+)(\d+(?:.\d+)?)(p)?/.test(t)?Math.max(0,29.63*(+RegExp.$1/(RegExp.$2?15:1))**.137-43):0,15)<<22|Math.min(gC(t),15)<<18}let Q6=["rst-c","st-ch","h-chi","y-lin","nk","sited","ecked","pty","ad-on","cus-w","ver","cus","cus-v","tive","sable","tiona","quire"];function i1({n:t,i:e,v:r=[]},n,s,i){t&&(t=r1({n:t,i:e,v:r})),i=[...Yt(i)];for(let a of r){let c=n.theme("screens",a);for(let l of Yt(c&&s1(c)||n.v(a))){var o;i.push(l),s|=c?67108864|Jw(l):a=="dark"?1073741824:l[0]=="@"?Jw(l):(o=l,1<<~(/:([a-z-]+)/.test(o)&&~Q6.indexOf(RegExp.$1.slice(2,7))||-18))}}return{n:t,p:s,r:i,i:e}}let o1=new Map;function Qw(t){if(t.d){let e=[],r=Py(t.r.reduce((n,s)=>s[0]=="@"?(e.push(s),n):s?Py(n,i=>Py(s,o=>{let a=/(:merge\(.+?\))(:[a-z-]+|\\[.+])/.exec(o);if(a){let c=i.indexOf(a[1]);return~c?i.slice(0,c)+a[0]+i.slice(c+a[1].length):Ry(i,o)}return Ry(o,i)})):n,"&"),n=>Ry(n,t.n?"."+n1(t.n):""));return r&&e.push(r.replace(/:merge\((.+?)\)/g,"$1")),e.reduceRight((n,s)=>s+"{"+n+"}",t.d)}}function Py(t,e){return t.replace(/ *((?:\(.+?\)|\[.+?\]|[^,])+) *(,|$)/g,(r,n,s)=>e(n)+s)}function Ry(t,e){return t.replace(/&/g,e)}let aE=new Intl.Collator("en",{numeric:!0});function yC(t,e){for(var r=0,n=t.length;r<n;){let s=n+r>>1;0>=mC(t[s],e)?r=s+1:n=s}return n}function mC(t,e){let r=t.p&on.o;return r==(e.p&on.o)&&(r==on.b||r==on.o)?0:t.p-e.p||t.o-e.o||aE.compare(cE(t.n),cE(e.n))||aE.compare(lE(t.n),lE(e.n))}function cE(t){return(t||"").split(/:/).pop().split("/").pop()||"\0"}function lE(t){return(t||"").replace(/\W/g,e=>String.fromCharCode(127+e.charCodeAt(0)))+"\0"}function Dy(t,e){return Math.round(parseInt(t,16)*e)}function Ea(t,e={}){if(typeof t=="function")return t(e);let{opacityValue:r="1",opacityVariable:n}=e,s=n?`var(${n})`:r;if(t.includes("<alpha-value>"))return t.replace("<alpha-value>",s);if(t[0]=="#"&&(t.length==4||t.length==7)){let i=(t.length-1)/3,o=[17,1,.062272][i-1];return`rgba(${[Dy(t.substr(1,i),o),Dy(t.substr(1+i,i),o),Dy(t.substr(1+2*i,i),o),s]})`}return s=="1"?t:s=="0"?"#0000":t.replace(/^(rgb|hsl)(\([^)]+)\)$/,`$1a$2,${s})`)}function a1(t,e,r,n,s=[]){return(function i(o,{n:a,p:c,r:l=[],i:u},d){let h=[],p="",y=0,g=0;for(let A in o||{}){var w,S;let E=o[A];if(A[0]=="@"){if(!E)continue;if(A[1]=="a"){h.push(...u1(a,c,Od(""+E),d,c,l,u,!0));continue}if(A[1]=="l"){for(let v of Yt(E))h.push(...i(v,{n:a,p:(w=on[A[7]],c&-939524097|w),r:A[7]=="d"?[]:l,i:u},d));continue}if(A[1]=="i"){h.push(...Yt(E).map(v=>({p:-1,o:0,r:[],d:A+" "+v})));continue}if(A[1]=="k"){h.push({p:on.d,o:0,r:[A],d:i(E,{p:on.d},d).map(Qw).join("")});continue}if(A[1]=="f"){h.push(...Yt(E).map(v=>({p:on.d,o:0,r:[A],d:i(v,{p:on.d},d).map(Qw).join("")})));continue}}if(typeof E!="object"||Array.isArray(E))A=="label"&&E?a=E+Gl(JSON.stringify([c,u,o])):(E||E===0)&&(A=A.replace(/[A-Z]/g,v=>"-"+v.toLowerCase()),g+=1,y=Math.max(y,(S=A)[0]=="-"?0:gC(S)+(/^(?:(border-(?!w|c|sty)|[tlbr].{2,4}m?$|c.{7,8}$)|([fl].{5}l|g.{8}$|pl))/.test(S)?+!!RegExp.$1||-!!RegExp.$2:0)+1),p+=(p?";":"")+Yt(E).map(v=>d.s(A,c1(""+v,d.theme)+(u?" !important":""))).join(";"));else if(A[0]=="@"||A.includes("&")){let v=c;A[0]=="@"&&(A=A.replace(/\bscreen\(([^)]+)\)/g,(C,O)=>{let L=d.theme("screens",O);return L?(v|=67108864,s1(L,"")):C}),v|=Jw(A)),h.push(...i(E,{n:a,p:v,r:[...l,A],i:u},d))}else h.push(...i(E,{p:c,r:[...l,A]},d))}return h.unshift({n:a,p:c,o:Math.max(0,15-g)+1.5*Math.min(y||15,15),r:l,d:p}),h.sort(mC)})(t,i1(e,r,n,s),r)}function c1(t,e){return t.replace(/theme\((["'`])?(.+?)\1(?:\s*,\s*(["'`])?(.+?)\3)?\)/g,(r,n,s,i,o="")=>{let a=e(s,o);return typeof a=="function"&&/color|fill|stroke/i.test(s)?Ea(a):""+Yt(a).filter(c=>Object(c)!==c)})}function l1(t,e){let r,n=[];for(let s of t)s.d&&s.n?r?.p==s.p&&""+r.r==""+s.r?(r.c=[r.c,s.c].filter(Boolean).join(" "),r.d=r.d+";"+s.d):n.push(r={...s,n:s.n&&e}):n.push({...s,n:s.n&&e});return n}function $p(t,e,r=on.u,n,s){let i=[];for(let o of t)for(let a of(function(c,l,u,d,h){c={...c,i:c.i||h};let p=(function(y,g){let w=o1.get(y.n);return w?w(y,g):g.r(y.n,y.v[0]=="dark")})(c,l);return p?typeof p=="string"?({r:d,p:u}=i1(c,l,u,d),l1($p(Od(p),l,u,d,c.i),c.n)):Array.isArray(p)?p.map(y=>{var g,w;return{o:0,...y,r:[...Yt(d),...Yt(y.r)],p:(g=u,w=y.p??u,g&-939524097|w)}}):a1(p,c,l,u,d):[{c:r1(c),p:0,o:0,r:[]}]})(o,e,r,n,s))i.splice(yC(i,a),0,a);return i}function u1(t,e,r,n,s,i,o,a){return l1((a?r.flatMap(c=>$p([c],n,s,i,o)):$p(r,n,s,i,o)).map(c=>c.p&on.o&&(c.n||e==on.b)?{...c,p:c.p&-939524097|e,o:0}:c),t)}function ek(t,e,r,n){var s;return s=(i,o)=>{let{n:a,p:c,r:l,i:u}=i1(i,o,e);return r&&u1(a,e,r,o,c,l,u,n)},o1.set(t,s),t}function Uy(t,e,r){if(t[t.length-1]!="("){let n=[],s=!1,i=!1,o="";for(let a of t)if(!(a=="("||/[~@]$/.test(a))){if(a[0]=="!"&&(a=a.slice(1),s=!s),a.endsWith(":")){n[a=="dark:"?"unshift":"push"](a.slice(0,-1));continue}a[0]=="-"&&(a=a.slice(1),i=!i),a.endsWith("-")&&(a=a.slice(0,-1)),a&&a!="&"&&(o+=(o&&"-")+a)}o&&(i&&(o="-"+o),e[0].push({n:o,v:n.filter(tk),i:s}))}}function tk(t,e,r){return r.indexOf(t)==e}let uE=new Map;function Od(t){let e=uE.get(t);if(!e){let r=[],n=[[]],s=0,i=0,o=null,a=0,c=(l,u=0)=>{s!=a&&(r.push(t.slice(s,a+u)),l&&Uy(r,n)),s=a+1};for(;a<t.length;a++){let l=t[a];if(i)t[a-1]!="\\"&&(i+=+(l=="[")||-(l=="]"));else if(l=="[")i+=1;else if(o)t[a-1]!="\\"&&o.test(t.slice(a))&&(o=null,s=a+RegExp.lastMatch.length);else if(l=="/"&&t[a-1]!="\\"&&(t[a+1]=="*"||t[a+1]=="/"))o=t[a+1]=="*"?/^\*\//:/^[\r\n]/;else if(l=="(")c(),r.push(l);else if(l==":")t[a+1]!=":"&&c(!1,1);else if(/[\s,)]/.test(l)){c(!0);let u=r.lastIndexOf("(");if(l==")"){let d=r[u-1];if(/[~@]$/.test(d)){let h=n.shift();r.length=u,Uy([...r,"#"],n);let{v:p}=n[0].pop();for(let y of h)y.v.splice(+(y.v[0]=="dark")-+(p[0]=="dark"),p.length);Uy([...r,ek(d.length>1?d.slice(0,-1)+Gl(JSON.stringify([d,h])):d+"("+pC(h)+")",on.a,h,/@$/.test(d))],n)}u=r.lastIndexOf("(",u-1)}r.length=u+1}else/[~@]/.test(l)&&t[a+1]=="("&&n.unshift([])}c(!0),uE.set(t,e=n[0])}return e}function wC(t,e,r){return e.reduce((n,s,i)=>n+r(s)+t[i+1],t[0])}function d1(t,e){return Array.isArray(t)&&Array.isArray(t.raw)?wC(t,e,r=>By(r).trim()):e.filter(Boolean).reduce((r,n)=>r+By(n),t?By(t):"")}function By(t){let e,r="";if(t&&typeof t=="object")if(Array.isArray(t))(e=d1(t[0],t.slice(1)))&&(r+=" "+e);else for(let n in t)t[n]&&(r+=" "+n);else t!=null&&typeof t!="boolean"&&(r+=" "+t);return r}function Tp(t,e){return Array.isArray(t)?dE(wC(t,e,r=>r!=null&&typeof r!="boolean"?r:"")):typeof t=="string"?dE(t):[t]}let rk=/ *(?:(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}))/g;function dE(t){let e;t=t.replace(/\/\*[^]*?\*\/|\s\s+|\n/gm," ");let r=[{}],n=[r[0]],s=[];for(;e=rk.exec(t);)e[4]&&(r.shift(),s.shift()),e[3]?(s.unshift(e[3]),r.unshift({}),n.push(s.reduce((i,o)=>({[o]:i}),r[0]))):e[4]||(r[0][e[1]]&&(r.unshift({}),n.push(s.reduce((i,o)=>({[o]:i}),r[0]))),r[0][e[1]]=e[2]);return n}function Ug(t,...e){var r;let n=Tp(t,e),s=(n.find(i=>i.label)?.label||"css")+Gl(JSON.stringify(n));return r=(i,o)=>l1(n.flatMap(a=>a1(a,i,o,on.o)),s),o1.set(s,r),s}function me(t,e,r){return[t,e0(e,r)]}function e0(t,e){return typeof t=="function"?t:typeof t=="string"&&/^[\w-]+$/.test(t)?((r,n)=>({[t]:e?e(r,n):t0(r,1)})):r=>t||{[r[1]]:t0(r,2)}}function t0(t,e,r=t.slice(e).find(Boolean)||t.$$||t.input){return t.input[0]=="-"?`calc(${r} * -1)`:r}function ve(t,e,r,n){return[t,nk(e,r,n)]}function nk(t,e,r){let n=typeof e=="string"?(s,i)=>({[e]:r?r(s,i):s._}):e||(({1:s,_:i},o,a)=>({[s||a]:i}));return(s,i)=>{let o=bC(t||s[1]),a=i.theme(o,s.$$)??_a(s.$$,o,i);if(a!=null)return s._=t0(s,0,a),n(s,i,o)}}function Lr(t,e={},r){return[t,sk(e,r)]}function sk(t={},e){return(r,n)=>{let{section:s=bC(r[0]).replace("-","")+"Color"}=t,[i,o]=ik(r.$$);if(!i)return;let a=n.theme(s,i)||_a(i,s,n);if(!a||typeof a=="object")return;let{opacityVariable:c=`--tw-${r[0].replace(/-$/,"")}-opacity`,opacitySection:l=s.replace("Color","Opacity"),property:u=s,selector:d}=t,h=n.theme(l,o||"DEFAULT")||o&&_a(o,l,n),p=e||(({_:g})=>{let w=tp(u,g);return d?{[d]:w}:w});r._={value:Ea(a,{opacityVariable:c||void 0,opacityValue:h||void 0}),color:g=>Ea(a,g),opacityVariable:c||void 0,opacityValue:h||void 0};let y=p(r,n);if(!r.dark){let g=n.d(s,i,a);g&&g!==a&&(r._={value:Ea(g,{opacityVariable:c||void 0,opacityValue:h||"1"}),color:w=>Ea(g,w),opacityVariable:c||void 0,opacityValue:h||void 0},y={"&":y,[n.v("dark")]:p(r,n)})}return y}}function ik(t){return(t.match(/^(\[[^\]]+]|[^/]+?)(?:\/(.+))?$/)||[]).slice(1)}function tp(t,e){let r={};return typeof e=="string"?r[t]=e:(e.opacityVariable&&e.value.includes(e.opacityVariable)&&(r[e.opacityVariable]=e.opacityValue||"1"),r[t]=e.value),r}function _a(t,e,r){if(t[0]=="["&&t.slice(-1)=="]"){if(t=kd(c1(t.slice(1,-1),r.theme)),!e)return t;if(!(/color|fill|stroke/i.test(e)&&!(/^color:/.test(t)||/^(#|((hsl|rgb)a?|hwb|lab|lch|color)\(|[a-z]+$)/.test(t))||/image/i.test(e)&&!(/^image:/.test(t)||/^[a-z-]+\(/.test(t))||/weight/i.test(e)&&!(/^(number|any):/.test(t)||/^\d+$/.test(t))||/position/i.test(e)&&/^(length|size):/.test(t)))return t.replace(/^[a-z-]+:/,"")}}function bC(t){return t.replace(/-./g,e=>e[1].toUpperCase())}function kd(t){return t.includes("url(")?t.replace(/(.*?)(url\(.*?\))(.*?)/g,(e,r="",n,s="")=>kd(r)+n+kd(s)):t.replace(/(^|[^\\])_+/g,(e,r)=>r+" ".repeat(e.length-r.length)).replace(/\\_/g,"_").replace(/(calc|min|max|clamp)\(.+\)/g,e=>e.replace(/(-?\d*\.?\d(?!\b-.+[,)](?![^+\-/*])\D)(?:%|[a-z]+)?|\))([+\-/*])/g,"$1 $2 "))}function sc(t,...e){return pC(Od(d1(t,e))," ")}function vC({presets:t=[],...e}){let r={darkMode:void 0,darkColor:void 0,preflight:e.preflight!==!1&&[],theme:{},variants:Yt(e.variants),rules:Yt(e.rules),ignorelist:Yt(e.ignorelist),hash:void 0,stringify:(n,s)=>n+":"+s,finalize:[]};for(let n of Yt([...t,{darkMode:e.darkMode,darkColor:e.darkColor,preflight:e.preflight!==!1&&Yt(e.preflight),theme:e.theme,hash:e.hash,stringify:e.stringify,finalize:e.finalize}])){let{preflight:s,darkMode:i=r.darkMode,darkColor:o=r.darkColor,theme:a,variants:c,rules:l,ignorelist:u,hash:d=r.hash,stringify:h=r.stringify,finalize:p}=typeof n=="function"?n(r):n;r={preflight:r.preflight!==!1&&s!==!1&&[...r.preflight,...Yt(s)],darkMode:i,darkColor:o,theme:{...r.theme,...a,extend:{...r.theme.extend,...a?.extend}},variants:[...r.variants,...Yt(c)],rules:[...r.rules,...Yt(l)],ignorelist:[...r.ignorelist,...Yt(u)],hash:d,stringify:h,finalize:[...r.finalize,...Yt(p)]}}return r}function hE(t,e,r,n,s,i){for(let o of e){let a=r.get(o);a||r.set(o,a=n(o));let c=a(t,s,i);if(c)return c}}function ok(t){var e;return r0(t[0],typeof(e=t[1])=="function"?e:()=>e)}function ak(t){var e,r;return Array.isArray(t)?r0(t[0],e0(t[1],t[2])):r0(t,e0(e,r))}function r0(t,e){return EC(t,(r,n,s,i)=>{let o=n.exec(r);if(o)return o.$$=r.slice(o[0].length),o.dark=i,e(o,s)})}function EC(t,e){let r=Yt(t).map(ck);return(n,s,i)=>{for(let o of r){let a=e(n,o,s,i);if(a)return a}}}function ck(t){return typeof t=="string"?RegExp("^"+t+(t.includes("$")||t.slice(-1)=="-"?"":"$")):t}function lk(t,e){let r=vC(t),n=(function({theme:c,darkMode:l,darkColor:u=Dg,variants:d,rules:h,hash:p,stringify:y,ignorelist:g,finalize:w}){let S=new Map,A=new Map,E=new Map,v=new Map,C=EC(g,(j,D)=>D.test(j));d.push(["dark",Array.isArray(l)||l=="class"?`${Yt(l)[1]||".dark"} &`:typeof l=="string"&&l!="media"?l:"@media (prefers-color-scheme:dark)"]);let O=typeof p=="function"?j=>p(j,Gl):p?Gl:oE;O!==oE&&w.push(j=>({...j,n:j.n&&O(j.n),d:j.d?.replace(/--(tw(?:-[\w-]+)?)\b/g,(D,W)=>"--"+O(W).replace("#",""))}));let L={theme:(function({extend:j={},...D}){let W={},P={get colors(){return R("colors")},theme:R,negative(){return{}},breakpoints(k){let f={};for(let m in k)typeof k[m]=="string"&&(f["screen-"+m]=k[m]);return f}};return R;function R(k,f,m,_){if(k){if({1:k,2:_}=/^(\S+?)(?:\s*\/\s*([^/]+))?$/.exec(k)||[,k],/[.[]/.test(k)){let H=[];k.replace(/\[([^\]]+)\]|([^.[]+)/g,(z,G,M=G)=>H.push(M)),k=H.shift(),m=f,f=H.join("-")}let x=W[k]||Object.assign(Object.assign(W[k]={},T(D,k)),T(j,k));if(f==null)return x;f||(f="DEFAULT");let N=x[f]??f.split("-").reduce((H,z)=>H?.[z],x)??m;return _?Ea(N,{opacityValue:c1(_,R)}):N}let $={};for(let x of[...Object.keys(D),...Object.keys(j)])$[x]=R(x);return $}function T(k,f){let m=k[f];return typeof m=="function"&&(m=m(P)),m&&/color|fill|stroke/i.test(f)?(function _($,x=[]){let N={};for(let H in $){let z=$[H],G=[...x,H];N[G.join("-")]=z,H=="DEFAULT"&&(G=x,N[x.join("-")]=z),typeof z=="object"&&Object.assign(N,_(z,G))}return N})(m):m}})(c),e:n1,h:O,s(j,D){return y(j,D,L)},d(j,D,W){return u(j,D,L,W)},v(j){return S.has(j)||S.set(j,hE(j,d,A,ok,L)||"&:"+j),S.get(j)},r(j,D){let W=JSON.stringify([j,D]);return E.has(W)||E.set(W,!C(j,L)&&hE(j,h,v,ak,L,D)),E.get(W)},f(j){return w.reduce((D,W)=>W(D,L),j)}};return L})(r),s=new Map,i=[],o=new Set;e.resume(c=>s.set(c,c),(c,l)=>{e.insert(c,i.length,l),i.push(l),o.add(c)});function a(c){let l=n.f(c),u=Qw(l);if(u&&!o.has(u)){o.add(u);let d=yC(i,c);e.insert(u,d,c),i.splice(d,0,c)}return l.n}return Object.defineProperties(function(l){if(!s.size)for(let d of Yt(r.preflight))typeof d=="function"&&(d=d(n)),d&&(typeof d=="string"?u1("",on.b,Od(d),n,on.b,[],!1,!0):a1(d,{},n,on.b)).forEach(a);l=""+l;let u=s.get(l);if(!u){let d=new Set;for(let h of $p(Od(l),n))d.add(h.c).add(a(h));u=[...d].filter(Boolean).join(" "),s.set(l,u).set(u,u)}return u},Object.getOwnPropertyDescriptors({get target(){return e.target},theme:n.theme,config:r,snapshot(){let c=e.snapshot(),l=new Set(o),u=new Map(s),d=[...i];return()=>{c(),o=l,s=u,i=d}},clear(){e.clear(),o=new Set,s=new Map,i=[]},destroy(){this.clear(),e.destroy()}}))}function uk(t){let e=document.querySelector(t);return(!e||e.tagName!="STYLE")&&(e=document.createElement("style"),document.head.prepend(e)),e.dataset.twind="claimed",e}function dk(t){let e=t?.cssRules?t:uk(t).sheet;return{target:e,snapshot(){let r=Array.from(e.cssRules,n=>n.cssText);return()=>{this.clear(),r.forEach(this.insert)}},clear(){for(let r=e.cssRules.length;r--;)e.deleteRule(r)},destroy(){e.ownerNode?.remove()},insert(r,n){try{e.insertRule(r,n)}catch{e.insertRule(":root{}",n)}},resume:Dg}}function hk(t){let e=[];return{target:e,snapshot(){let r=[...e];return()=>{e.splice(0,e.length,...r)}},clear(){e.length=0},destroy(){this.clear()},insert(r,n,s){e.splice(n,0,r)},resume:Dg}}let h1=new Proxy(Dg,{apply(t,e,r){return ky(r[0])},get(t,e){let r=ky[e];return typeof r=="function"?function(){return r.apply(ky,arguments)}:r}}),fk=function(t,...e){(typeof this=="function"?this:h1)(Ug({"@layer base":Tp(t,e)}))},pk=(function t(e){return new Proxy(function(n,...s){return fE(e,"",n,s)},{get(r,n){return n==="bind"?t:n in r?r[n]:function(i,...o){return fE(e,n,i,o)}}})})();function fE(t,e,r,n){return{toString(){let s=Tp(r,n),i=n1(e+Gl(JSON.stringify([e,s])));return(typeof t=="function"?t:h1)(Ug({[`@keyframes ${i}`]:Tp(r,n)})),i}}}let gk=function(t,...e){return(typeof this=="function"?this:h1)(d1(t,e))};var yk=new Map([["align-self","-ms-grid-row-align"],["color-adjust","-webkit-print-color-adjust"],["column-gap","grid-column-gap"],["forced-color-adjust","-ms-high-contrast-adjust"],["gap","grid-gap"],["grid-template-columns","-ms-grid-columns"],["grid-template-rows","-ms-grid-rows"],["justify-self","-ms-grid-column-align"],["margin-inline-end","-webkit-margin-end"],["margin-inline-start","-webkit-margin-start"],["mask-border","-webkit-mask-box-image"],["mask-border-outset","-webkit-mask-box-image-outset"],["mask-border-slice","-webkit-mask-box-image-slice"],["mask-border-source","-webkit-mask-box-image-source"],["mask-border-repeat","-webkit-mask-box-image-repeat"],["mask-border-width","-webkit-mask-box-image-width"],["overflow-wrap","word-wrap"],["padding-inline-end","-webkit-padding-end"],["padding-inline-start","-webkit-padding-start"],["print-color-adjust","color-adjust"],["row-gap","grid-row-gap"],["scroll-margin-bottom","scroll-snap-margin-bottom"],["scroll-margin-left","scroll-snap-margin-left"],["scroll-margin-right","scroll-snap-margin-right"],["scroll-margin-top","scroll-snap-margin-top"],["scroll-margin","scroll-snap-margin"],["text-combine-upright","-ms-text-combine-horizontal"]]);function mk(t){return yk.get(t)}function wk(t){var e=/^(?:(text-(?:decoration$|e|or|si)|back(?:ground-cl|d|f)|box-d|mask(?:$|-[ispro]|-cl)|pr|hyphena|flex-d)|(tab-|column(?!-s)|text-align-l)|(ap)|u|hy)/i.exec(t);return e?e[1]?1:e[2]?2:e[3]?3:5:0}function bk(t,e){var r=/^(?:(pos)|(cli)|(background-i)|(flex(?:$|-b)|(?:max-|min-)?(?:block-s|inl|he|widt))|dis)/i.exec(t);return r?r[1]?/^sti/i.test(e)?1:0:r[2]?/^pat/i.test(e)?1:0:r[3]?/^image-/i.test(e)?1:0:r[4]?e[3]==="-"?2:0:/^(?:inline-)?grid$/i.test(e)?4:0:0}let vk=[["-webkit-",1],["-moz-",2],["-ms-",4]];function Ek(){return({stringify:t})=>({stringify(e,r,n){let s="",i=mk(e);i&&(s+=t(i,r,n)+";");let o=wk(e),a=bk(e,r);for(let c of vk)o&c[1]&&(s+=t(c[0]+e,r,n)+";"),a&c[1]&&(s+=t(e,c[0]+r,n)+";");return s+t(e,r,n)}})}let n0={screens:{sm:"640px",md:"768px",lg:"1024px",xl:"1280px","2xl":"1536px"},columns:{auto:"auto","3xs":"16rem","2xs":"18rem",xs:"20rem",sm:"24rem",md:"28rem",lg:"32rem",xl:"36rem","2xl":"42rem","3xl":"48rem","4xl":"56rem","5xl":"64rem","6xl":"72rem","7xl":"80rem"},spacing:{px:"1px",0:"0px",...us(4,"rem",4,.5,.5),...us(12,"rem",4,5),14:"3.5rem",...us(64,"rem",4,16,4),72:"18rem",80:"20rem",96:"24rem"},durations:{75:"75ms",100:"100ms",150:"150ms",200:"200ms",300:"300ms",500:"500ms",700:"700ms",1e3:"1000ms"},animation:{none:"none",spin:"spin 1s linear infinite",ping:"ping 1s cubic-bezier(0,0,0.2,1) infinite",pulse:"pulse 2s cubic-bezier(0.4,0,0.6,1) infinite",bounce:"bounce 1s infinite"},aspectRatio:{auto:"auto",square:"1/1",video:"16/9"},backdropBlur:Et("blur"),backdropBrightness:Et("brightness"),backdropContrast:Et("contrast"),backdropGrayscale:Et("grayscale"),backdropHueRotate:Et("hueRotate"),backdropInvert:Et("invert"),backdropOpacity:Et("opacity"),backdropSaturate:Et("saturate"),backdropSepia:Et("sepia"),backgroundColor:Et("colors"),backgroundImage:{none:"none"},backgroundOpacity:Et("opacity"),backgroundSize:{auto:"auto",cover:"cover",contain:"contain"},blur:{none:"none",0:"0",sm:"4px",DEFAULT:"8px",md:"12px",lg:"16px",xl:"24px","2xl":"40px","3xl":"64px"},brightness:{...us(200,"",100,0,50),...us(110,"",100,90,5),75:"0.75",125:"1.25"},borderColor:({theme:t})=>({DEFAULT:t("colors.gray.200","currentColor"),...t("colors")}),borderOpacity:Et("opacity"),borderRadius:{none:"0px",sm:"0.125rem",DEFAULT:"0.25rem",md:"0.375rem",lg:"0.5rem",xl:"0.75rem","2xl":"1rem","3xl":"1.5rem","1/2":"50%",full:"9999px"},borderSpacing:Et("spacing"),borderWidth:{DEFAULT:"1px",...Ns(8,"px")},boxShadow:{sm:"0 1px 2px 0 rgba(0,0,0,0.05)",DEFAULT:"0 1px 3px 0 rgba(0,0,0,0.1), 0 1px 2px -1px rgba(0,0,0,0.1)",md:"0 4px 6px -1px rgba(0,0,0,0.1), 0 2px 4px -2px rgba(0,0,0,0.1)",lg:"0 10px 15px -3px rgba(0,0,0,0.1), 0 4px 6px -4px rgba(0,0,0,0.1)",xl:"0 20px 25px -5px rgba(0,0,0,0.1), 0 8px 10px -6px rgba(0,0,0,0.1)","2xl":"0 25px 50px -12px rgba(0,0,0,0.25)",inner:"inset 0 2px 4px 0 rgba(0,0,0,0.05)",none:"0 0 #0000"},boxShadowColor:Et("colors"),caretColor:Et("colors"),accentColor:({theme:t})=>({auto:"auto",...t("colors")}),contrast:{...us(200,"",100,0,50),75:"0.75",125:"1.25"},content:{none:"none"},divideColor:Et("borderColor"),divideOpacity:Et("borderOpacity"),divideWidth:Et("borderWidth"),dropShadow:{sm:"0 1px 1px rgba(0,0,0,0.05)",DEFAULT:["0 1px 2px rgba(0,0,0,0.1)","0 1px 1px rgba(0,0,0,0.06)"],md:["0 4px 3px rgba(0,0,0,0.07)","0 2px 2px rgba(0,0,0,0.06)"],lg:["0 10px 8px rgba(0,0,0,0.04)","0 4px 3px rgba(0,0,0,0.1)"],xl:["0 20px 13px rgba(0,0,0,0.03)","0 8px 5px rgba(0,0,0,0.08)"],"2xl":"0 25px 25px rgba(0,0,0,0.15)",none:"0 0 #0000"},fill:({theme:t})=>({...t("colors"),none:"none"}),grayscale:{DEFAULT:"100%",0:"0"},hueRotate:{0:"0deg",15:"15deg",30:"30deg",60:"60deg",90:"90deg",180:"180deg"},invert:{DEFAULT:"100%",0:"0"},flex:{1:"1 1 0%",auto:"1 1 auto",initial:"0 1 auto",none:"none"},flexBasis:({theme:t})=>({...t("spacing"),...Cu(2,6),...Cu(12,12),auto:"auto",full:"100%"}),flexGrow:{DEFAULT:1,0:0},flexShrink:{DEFAULT:1,0:0},fontFamily:{sans:'ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji"'.split(","),serif:'ui-serif,Georgia,Cambria,"Times New Roman",Times,serif'.split(","),mono:'ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace'.split(",")},fontSize:{xs:["0.75rem","1rem"],sm:["0.875rem","1.25rem"],base:["1rem","1.5rem"],lg:["1.125rem","1.75rem"],xl:["1.25rem","1.75rem"],"2xl":["1.5rem","2rem"],"3xl":["1.875rem","2.25rem"],"4xl":["2.25rem","2.5rem"],"5xl":["3rem","1"],"6xl":["3.75rem","1"],"7xl":["4.5rem","1"],"8xl":["6rem","1"],"9xl":["8rem","1"]},fontWeight:{thin:"100",extralight:"200",light:"300",normal:"400",medium:"500",semibold:"600",bold:"700",extrabold:"800",black:"900"},gap:Et("spacing"),gradientColorStops:Et("colors"),gridAutoColumns:{auto:"auto",min:"min-content",max:"max-content",fr:"minmax(0,1fr)"},gridAutoRows:{auto:"auto",min:"min-content",max:"max-content",fr:"minmax(0,1fr)"},gridColumn:{auto:"auto","span-full":"1 / -1"},gridRow:{auto:"auto","span-full":"1 / -1"},gridTemplateColumns:{none:"none"},gridTemplateRows:{none:"none"},height:({theme:t})=>({...t("spacing"),...Cu(2,6),min:"min-content",max:"max-content",fit:"fit-content",auto:"auto",full:"100%",screen:"100vh"}),inset:({theme:t})=>({...t("spacing"),...Cu(2,4),auto:"auto",full:"100%"}),keyframes:{spin:{from:{transform:"rotate(0deg)"},to:{transform:"rotate(360deg)"}},ping:{"0%":{transform:"scale(1)",opacity:"1"},"75%,100%":{transform:"scale(2)",opacity:"0"}},pulse:{"0%,100%":{opacity:"1"},"50%":{opacity:".5"}},bounce:{"0%, 100%":{transform:"translateY(-25%)",animationTimingFunction:"cubic-bezier(0.8,0,1,1)"},"50%":{transform:"none",animationTimingFunction:"cubic-bezier(0,0,0.2,1)"}}},letterSpacing:{tighter:"-0.05em",tight:"-0.025em",normal:"0em",wide:"0.025em",wider:"0.05em",widest:"0.1em"},lineHeight:{...us(10,"rem",4,3),none:"1",tight:"1.25",snug:"1.375",normal:"1.5",relaxed:"1.625",loose:"2"},margin:({theme:t})=>({auto:"auto",...t("spacing")}),maxHeight:({theme:t})=>({full:"100%",min:"min-content",max:"max-content",fit:"fit-content",screen:"100vh",...t("spacing")}),maxWidth:({theme:t,breakpoints:e})=>({...e(t("screens")),none:"none",0:"0rem",xs:"20rem",sm:"24rem",md:"28rem",lg:"32rem",xl:"36rem","2xl":"42rem","3xl":"48rem","4xl":"56rem","5xl":"64rem","6xl":"72rem","7xl":"80rem",full:"100%",min:"min-content",max:"max-content",fit:"fit-content",prose:"65ch"}),minHeight:{0:"0px",full:"100%",min:"min-content",max:"max-content",fit:"fit-content",screen:"100vh"},minWidth:{0:"0px",full:"100%",min:"min-content",max:"max-content",fit:"fit-content"},opacity:{...us(100,"",100,0,10),5:"0.05",25:"0.25",75:"0.75",95:"0.95"},order:{first:"-9999",last:"9999",none:"0"},padding:Et("spacing"),placeholderColor:Et("colors"),placeholderOpacity:Et("opacity"),outlineColor:Et("colors"),outlineOffset:Ns(8,"px"),outlineWidth:Ns(8,"px"),ringColor:({theme:t})=>({...t("colors"),DEFAULT:"#3b82f6"}),ringOffsetColor:Et("colors"),ringOffsetWidth:Ns(8,"px"),ringOpacity:({theme:t})=>({...t("opacity"),DEFAULT:"0.5"}),ringWidth:{DEFAULT:"3px",...Ns(8,"px")},rotate:{...Ns(2,"deg"),...Ns(12,"deg",3),...Ns(180,"deg",45)},saturate:us(200,"",100,0,50),scale:{...us(150,"",100,0,50),...us(110,"",100,90,5),75:"0.75",125:"1.25"},scrollMargin:Et("spacing"),scrollPadding:Et("spacing"),sepia:{0:"0",DEFAULT:"100%"},skew:{...Ns(2,"deg"),...Ns(12,"deg",3)},space:Et("spacing"),stroke:({theme:t})=>({...t("colors"),none:"none"}),strokeWidth:us(2),textColor:Et("colors"),textDecorationColor:Et("colors"),textDecorationThickness:{"from-font":"from-font",auto:"auto",...Ns(8,"px")},textUnderlineOffset:{auto:"auto",...Ns(8,"px")},textIndent:Et("spacing"),textOpacity:Et("opacity"),transitionDuration:({theme:t})=>({...t("durations"),DEFAULT:"150ms"}),transitionDelay:Et("durations"),transitionProperty:{none:"none",all:"all",DEFAULT:"color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter",colors:"color,background-color,border-color,text-decoration-color,fill,stroke",opacity:"opacity",shadow:"box-shadow",transform:"transform"},transitionTimingFunction:{DEFAULT:"cubic-bezier(0.4,0,0.2,1)",linear:"linear",in:"cubic-bezier(0.4,0,1,1)",out:"cubic-bezier(0,0,0.2,1)","in-out":"cubic-bezier(0.4,0,0.2,1)"},translate:({theme:t})=>({...t("spacing"),...Cu(2,4),full:"100%"}),width:({theme:t})=>({min:"min-content",max:"max-content",fit:"fit-content",screen:"100vw",...t("flexBasis")}),willChange:{scroll:"scroll-position"},zIndex:{...us(50,"",1,0,10),auto:"auto"}};function Cu(t,e){let r={};do for(var n=1;n<t;n++)r[`${n}/${t}`]=Number((n/t*100).toFixed(6))+"%";while(++t<=e);return r}function Ns(t,e,r=0){let n={};for(;r<=t;r=2*r||1)n[r]=r+e;return n}function us(t,e="",r=1,n=0,s=1,i={}){for(;n<=t;n+=s)i[n]=n/r+e;return i}function Et(t){return({theme:e})=>e(t)}let _k={"*,::before,::after":{boxSizing:"border-box",borderWidth:"0",borderStyle:"solid",borderColor:"theme(borderColor.DEFAULT, currentColor)"},"::before,::after":{"--tw-content":"''"},html:{lineHeight:1.5,WebkitTextSizeAdjust:"100%",MozTabSize:"4",tabSize:4,fontFamily:`theme(fontFamily.sans, ${n0.fontFamily.sans})`,fontFeatureSettings:"theme(fontFamily.sans[1].fontFeatureSettings, normal)"},body:{margin:"0",lineHeight:"inherit"},hr:{height:"0",color:"inherit",borderTopWidth:"1px"},"abbr:where([title])":{textDecoration:"underline dotted"},"h1,h2,h3,h4,h5,h6":{fontSize:"inherit",fontWeight:"inherit"},a:{color:"inherit",textDecoration:"inherit"},"b,strong":{fontWeight:"bolder"},"code,kbd,samp,pre":{fontFamily:`theme(fontFamily.mono, ${n0.fontFamily.mono})`,fontFeatureSettings:"theme(fontFamily.mono[1].fontFeatureSettings, normal)",fontSize:"1em"},small:{fontSize:"80%"},"sub,sup":{fontSize:"75%",lineHeight:0,position:"relative",verticalAlign:"baseline"},sub:{bottom:"-0.25em"},sup:{top:"-0.5em"},table:{textIndent:"0",borderColor:"inherit",borderCollapse:"collapse"},"button,input,optgroup,select,textarea":{fontFamily:"inherit",fontSize:"100%",lineHeight:"inherit",color:"inherit",margin:"0",padding:"0"},"button,select":{textTransform:"none"},"button,[type='button'],[type='reset'],[type='submit']":{WebkitAppearance:"button",backgroundColor:"transparent",backgroundImage:"none"},":-moz-focusring":{outline:"auto"},":-moz-ui-invalid":{boxShadow:"none"},progress:{verticalAlign:"baseline"},"::-webkit-inner-spin-button,::-webkit-outer-spin-button":{height:"auto"},"[type='search']":{WebkitAppearance:"textfield",outlineOffset:"-2px"},"::-webkit-search-decoration":{WebkitAppearance:"none"},"::-webkit-file-upload-button":{WebkitAppearance:"button",font:"inherit"},summary:{display:"list-item"},"blockquote,dl,dd,h1,h2,h3,h4,h5,h6,hr,figure,p,pre":{margin:"0"},fieldset:{margin:"0",padding:"0"},legend:{padding:"0"},"ol,ul,menu":{listStyle:"none",margin:"0",padding:"0"},textarea:{resize:"vertical"},"input::placeholder,textarea::placeholder":{opacity:1,color:"theme(colors.gray.400, #9ca3af)"},'button,[role="button"]':{cursor:"pointer"},":disabled":{cursor:"default"},"img,svg,video,canvas,audio,iframe,embed,object":{display:"block",verticalAlign:"middle"},"img,video":{maxWidth:"100%",height:"auto"},"[hidden]":{display:"none"}},xk=[me("\\[([-\\w]+):(.+)]",({1:t,2:e},r)=>({"@layer overrides":{"&":{[t]:_a(`[${e}]`,"",r)}}})),me("(group|peer)([~/][^-[]+)?",({input:t},{h:e})=>[{c:e(t)}]),ve("aspect-","aspectRatio"),me("container",(t,{theme:e})=>{let{screens:r=e("screens"),center:n,padding:s}=e("container"),i={width:"100%",marginRight:n&&"auto",marginLeft:n&&"auto",...o("xs")};for(let a in r){let c=r[a];typeof c=="string"&&(i[s1(c)]={"&":{maxWidth:c,...o(a)}})}return i;function o(a){let c=s&&(typeof s=="string"?s:s[a]||s.DEFAULT);if(c)return{paddingRight:c,paddingLeft:c}}}),ve("content-","content",({_:t})=>({"--tw-content":t,content:"var(--tw-content)"})),me("(?:box-)?decoration-(slice|clone)","boxDecorationBreak"),me("box-(border|content)","boxSizing",({1:t})=>t+"-box"),me("hidden",{display:"none"}),me("table-(auto|fixed)","tableLayout"),me(["(block|flex|table|grid|inline|contents|flow-root|list-item)","(inline-(block|flex|table|grid))","(table-(caption|cell|column|row|(column|row|footer|header)-group))"],"display"),"(float)-(left|right|none)","(clear)-(left|right|none|both)","(overflow(?:-[xy])?)-(auto|hidden|clip|visible|scroll)","(isolation)-(auto)",me("isolate","isolation"),me("object-(contain|cover|fill|none|scale-down)","objectFit"),ve("object-","objectPosition"),me("object-(top|bottom|center|(left|right)(-(top|bottom))?)","objectPosition",sf),me("overscroll(-[xy])?-(auto|contain|none)",({1:t="",2:e})=>({["overscroll-behavior"+t]:e})),me("(static|fixed|absolute|relative|sticky)","position"),ve("-?inset(-[xy])?(?:$|-)","inset",({1:t,_:e})=>({top:t!="-x"&&e,right:t!="-y"&&e,bottom:t!="-x"&&e,left:t!="-y"&&e})),ve("-?(top|bottom|left|right)(?:$|-)","inset"),me("(visible|collapse)","visibility"),me("invisible",{visibility:"hidden"}),ve("-?z-","zIndex"),me("flex-((row|col)(-reverse)?)","flexDirection",pE),me("flex-(wrap|wrap-reverse|nowrap)","flexWrap"),ve("(flex-(?:grow|shrink))(?:$|-)"),ve("(flex)-"),ve("grow(?:$|-)","flexGrow"),ve("shrink(?:$|-)","flexShrink"),ve("basis-","flexBasis"),ve("-?(order)-"),"-?(order)-(\\d+)",ve("grid-cols-","gridTemplateColumns"),me("grid-cols-(\\d+)","gridTemplateColumns",wE),ve("col-","gridColumn"),me("col-(span)-(\\d+)","gridColumn",mE),ve("col-start-","gridColumnStart"),me("col-start-(auto|\\d+)","gridColumnStart"),ve("col-end-","gridColumnEnd"),me("col-end-(auto|\\d+)","gridColumnEnd"),ve("grid-rows-","gridTemplateRows"),me("grid-rows-(\\d+)","gridTemplateRows",wE),ve("row-","gridRow"),me("row-(span)-(\\d+)","gridRow",mE),ve("row-start-","gridRowStart"),me("row-start-(auto|\\d+)","gridRowStart"),ve("row-end-","gridRowEnd"),me("row-end-(auto|\\d+)","gridRowEnd"),me("grid-flow-((row|col)(-dense)?)","gridAutoFlow",t=>sf(pE(t))),me("grid-flow-(dense)","gridAutoFlow"),ve("auto-cols-","gridAutoColumns"),ve("auto-rows-","gridAutoRows"),ve("gap-x(?:$|-)","gap","columnGap"),ve("gap-y(?:$|-)","gap","rowGap"),ve("gap(?:$|-)","gap"),"(justify-(?:items|self))-",me("justify-","justifyContent",gE),me("(content|items|self)-",t=>({["align-"+t[1]]:gE(t)})),me("(place-(content|items|self))-",({1:t,$$:e})=>({[t]:("wun".includes(e[3])?"space-":"")+e})),ve("p([xytrbl])?(?:$|-)","padding",al("padding")),ve("-?m([xytrbl])?(?:$|-)","margin",al("margin")),ve("-?space-(x|y)(?:$|-)","space",({1:t,_:e})=>({"&>:not([hidden])~:not([hidden])":{[`--tw-space-${t}-reverse`]:"0",["margin-"+{y:"top",x:"left"}[t]]:`calc(${e} * calc(1 - var(--tw-space-${t}-reverse)))`,["margin-"+{y:"bottom",x:"right"}[t]]:`calc(${e} * var(--tw-space-${t}-reverse))`}})),me("space-(x|y)-reverse",({1:t})=>({"&>:not([hidden])~:not([hidden])":{[`--tw-space-${t}-reverse`]:"1"}})),ve("w-","width"),ve("min-w-","minWidth"),ve("max-w-","maxWidth"),ve("h-","height"),ve("min-h-","minHeight"),ve("max-h-","maxHeight"),ve("font-","fontWeight"),ve("font-","fontFamily",({_:t})=>typeof(t=Yt(t))[1]=="string"?{fontFamily:Qs(t)}:{fontFamily:Qs(t[0]),...t[1]}),me("antialiased",{WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale"}),me("subpixel-antialiased",{WebkitFontSmoothing:"auto",MozOsxFontSmoothing:"auto"}),me("italic","fontStyle"),me("not-italic",{fontStyle:"normal"}),me("(ordinal|slashed-zero|(normal|lining|oldstyle|proportional|tabular)-nums|(diagonal|stacked)-fractions)",({1:t,2:e="",3:r})=>e=="normal"?{fontVariantNumeric:"normal"}:{["--tw-"+(r?"numeric-fraction":"pt".includes(e[0])?"numeric-spacing":e?"numeric-figure":t)]:t,fontVariantNumeric:"var(--tw-ordinal) var(--tw-slashed-zero) var(--tw-numeric-figure) var(--tw-numeric-spacing) var(--tw-numeric-fraction)",...sa({"--tw-ordinal":"var(--tw-empty,/*!*/ /*!*/)","--tw-slashed-zero":"var(--tw-empty,/*!*/ /*!*/)","--tw-numeric-figure":"var(--tw-empty,/*!*/ /*!*/)","--tw-numeric-spacing":"var(--tw-empty,/*!*/ /*!*/)","--tw-numeric-fraction":"var(--tw-empty,/*!*/ /*!*/)"})}),ve("tracking-","letterSpacing"),ve("leading-","lineHeight"),me("list-(inside|outside)","listStylePosition"),ve("list-","listStyleType"),me("list-","listStyleType"),ve("placeholder-opacity-","placeholderOpacity",({_:t})=>({"&::placeholder":{"--tw-placeholder-opacity":t}})),Lr("placeholder-",{property:"color",selector:"&::placeholder"}),me("text-(left|center|right|justify|start|end)","textAlign"),me("text-(ellipsis|clip)","textOverflow"),ve("text-opacity-","textOpacity","--tw-text-opacity"),Lr("text-",{property:"color"}),ve("text-","fontSize",({_:t})=>typeof t=="string"?{fontSize:t}:{fontSize:t[0],...typeof t[1]=="string"?{lineHeight:t[1]}:t[1]}),ve("indent-","textIndent"),me("(overline|underline|line-through)","textDecorationLine"),me("no-underline",{textDecorationLine:"none"}),ve("underline-offset-","textUnderlineOffset"),Lr("decoration-",{section:"textDecorationColor",opacityVariable:!1,opacitySection:"opacity"}),ve("decoration-","textDecorationThickness"),me("decoration-","textDecorationStyle"),me("(uppercase|lowercase|capitalize)","textTransform"),me("normal-case",{textTransform:"none"}),me("truncate",{overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"}),me("align-","verticalAlign"),me("whitespace-","whiteSpace"),me("break-normal",{wordBreak:"normal",overflowWrap:"normal"}),me("break-words",{overflowWrap:"break-word"}),me("break-all",{wordBreak:"break-all"}),me("break-keep",{wordBreak:"keep-all"}),Lr("caret-",{opacityVariable:!1,opacitySection:"opacity"}),Lr("accent-",{opacityVariable:!1,opacitySection:"opacity"}),me("bg-gradient-to-([trbl]|[tb][rl])","backgroundImage",({1:t})=>`linear-gradient(to ${ic(t," ")},var(--tw-gradient-stops))`),Lr("from-",{section:"gradientColorStops",opacityVariable:!1,opacitySection:"opacity"},({_:t})=>({"--tw-gradient-from":t.value,"--tw-gradient-to":t.color({opacityValue:"0"}),"--tw-gradient-stops":"var(--tw-gradient-from),var(--tw-gradient-to)"})),Lr("via-",{section:"gradientColorStops",opacityVariable:!1,opacitySection:"opacity"},({_:t})=>({"--tw-gradient-to":t.color({opacityValue:"0"}),"--tw-gradient-stops":`var(--tw-gradient-from),${t.value},var(--tw-gradient-to)`})),Lr("to-",{section:"gradientColorStops",property:"--tw-gradient-to",opacityVariable:!1,opacitySection:"opacity"}),me("bg-(fixed|local|scroll)","backgroundAttachment"),me("bg-origin-(border|padding|content)","backgroundOrigin",({1:t})=>t+"-box"),me(["bg-(no-repeat|repeat(-[xy])?)","bg-repeat-(round|space)"],"backgroundRepeat"),me("bg-blend-","backgroundBlendMode"),me("bg-clip-(border|padding|content|text)","backgroundClip",({1:t})=>t+(t=="text"?"":"-box")),ve("bg-opacity-","backgroundOpacity","--tw-bg-opacity"),Lr("bg-",{section:"backgroundColor"}),ve("bg-","backgroundImage"),ve("bg-","backgroundPosition"),me("bg-(top|bottom|center|(left|right)(-(top|bottom))?)","backgroundPosition",sf),ve("bg-","backgroundSize"),ve("rounded(?:$|-)","borderRadius"),ve("rounded-([trbl]|[tb][rl])(?:$|-)","borderRadius",({1:t,_:e})=>{let r={t:["tl","tr"],r:["tr","br"],b:["bl","br"],l:["bl","tl"]}[t]||[t,t];return{[`border-${ic(r[0])}-radius`]:e,[`border-${ic(r[1])}-radius`]:e}}),me("border-(collapse|separate)","borderCollapse"),ve("border-opacity(?:$|-)","borderOpacity","--tw-border-opacity"),me("border-(solid|dashed|dotted|double|none)","borderStyle"),ve("border-spacing(-[xy])?(?:$|-)","borderSpacing",({1:t,_:e})=>({...sa({"--tw-border-spacing-x":"0","--tw-border-spacing-y":"0"}),["--tw-border-spacing"+(t||"-x")]:e,["--tw-border-spacing"+(t||"-y")]:e,"border-spacing":"var(--tw-border-spacing-x) var(--tw-border-spacing-y)"})),Lr("border-([xytrbl])-",{section:"borderColor"},al("border","Color")),Lr("border-"),ve("border-([xytrbl])(?:$|-)","borderWidth",al("border","Width")),ve("border(?:$|-)","borderWidth"),ve("divide-opacity(?:$|-)","divideOpacity",({_:t})=>({"&>:not([hidden])~:not([hidden])":{"--tw-divide-opacity":t}})),me("divide-(solid|dashed|dotted|double|none)",({1:t})=>({"&>:not([hidden])~:not([hidden])":{borderStyle:t}})),me("divide-([xy]-reverse)",({1:t})=>({"&>:not([hidden])~:not([hidden])":{["--tw-divide-"+t]:"1"}})),ve("divide-([xy])(?:$|-)","divideWidth",({1:t,_:e})=>{let r={x:"lr",y:"tb"}[t];return{"&>:not([hidden])~:not([hidden])":{[`--tw-divide-${t}-reverse`]:"0",[`border-${ic(r[0])}Width`]:`calc(${e} * calc(1 - var(--tw-divide-${t}-reverse)))`,[`border-${ic(r[1])}Width`]:`calc(${e} * var(--tw-divide-${t}-reverse))`}}}),Lr("divide-",{property:"borderColor",selector:"&>:not([hidden])~:not([hidden])"}),ve("ring-opacity(?:$|-)","ringOpacity","--tw-ring-opacity"),Lr("ring-offset-",{property:"--tw-ring-offset-color",opacityVariable:!1}),ve("ring-offset(?:$|-)","ringOffsetWidth","--tw-ring-offset-width"),me("ring-inset",{"--tw-ring-inset":"inset"}),Lr("ring-",{property:"--tw-ring-color"}),ve("ring(?:$|-)","ringWidth",({_:t},{theme:e})=>({...sa({"--tw-ring-offset-shadow":"0 0 #0000","--tw-ring-shadow":"0 0 #0000","--tw-shadow":"0 0 #0000","--tw-shadow-colored":"0 0 #0000","&":{"--tw-ring-inset":"var(--tw-empty,/*!*/ /*!*/)","--tw-ring-offset-width":e("ringOffsetWidth","","0px"),"--tw-ring-offset-color":Ea(e("ringOffsetColor","","#fff")),"--tw-ring-color":Ea(e("ringColor","","#93c5fd"),{opacityVariable:"--tw-ring-opacity"}),"--tw-ring-opacity":e("ringOpacity","","0.5")}}),"--tw-ring-offset-shadow":"var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color)","--tw-ring-shadow":`var(--tw-ring-inset) 0 0 0 calc(${t} + var(--tw-ring-offset-width)) var(--tw-ring-color)`,boxShadow:"var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow)"})),Lr("shadow-",{section:"boxShadowColor",opacityVariable:!1,opacitySection:"opacity"},({_:t})=>({"--tw-shadow-color":t.value,"--tw-shadow":"var(--tw-shadow-colored)"})),ve("shadow(?:$|-)","boxShadow",({_:t})=>({...sa({"--tw-ring-offset-shadow":"0 0 #0000","--tw-ring-shadow":"0 0 #0000","--tw-shadow":"0 0 #0000","--tw-shadow-colored":"0 0 #0000"}),"--tw-shadow":Qs(t),"--tw-shadow-colored":Qs(t).replace(/([^,]\s+)(?:#[a-f\d]+|(?:(?:hsl|rgb)a?|hwb|lab|lch|color|var)\(.+?\)|[a-z]+)(,|$)/g,"$1var(--tw-shadow-color)$2"),boxShadow:"var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow)"})),ve("(opacity)-"),me("mix-blend-","mixBlendMode"),...yE(),...yE("backdrop-"),ve("transition(?:$|-)","transitionProperty",(t,{theme:e})=>({transitionProperty:Qs(t),transitionTimingFunction:t._=="none"?void 0:Qs(e("transitionTimingFunction","")),transitionDuration:t._=="none"?void 0:Qs(e("transitionDuration",""))})),ve("duration(?:$|-)","transitionDuration","transitionDuration",Qs),ve("ease(?:$|-)","transitionTimingFunction","transitionTimingFunction",Qs),ve("delay(?:$|-)","transitionDelay","transitionDelay",Qs),ve("animate(?:$|-)","animation",(t,{theme:e,h:r,e:n})=>{let s=Qs(t),i=s.split(" "),o=e("keyframes",i[0]);return o?{["@keyframes "+(i[0]=n(r(i[0])))]:o,animation:i.join(" ")}:{animation:s}}),"(transform)-(none)",me("transform",s0),me("transform-(cpu|gpu)",({1:t})=>({"--tw-transform":_C(t=="gpu")})),ve("scale(-[xy])?-","scale",({1:t,_:e})=>({["--tw-scale"+(t||"-x")]:e,["--tw-scale"+(t||"-y")]:e,...s0()})),ve("-?(rotate)-","rotate",Ly),ve("-?(translate-[xy])-","translate",Ly),ve("-?(skew-[xy])-","skew",Ly),me("origin-(center|((top|bottom)(-(left|right))?)|left|right)","transformOrigin",sf),"(appearance)-",ve("(columns)-"),"(columns)-(\\d+)","(break-(?:before|after|inside))-",ve("(cursor)-"),"(cursor)-",me("snap-(none)","scroll-snap-type"),me("snap-(x|y|both)",({1:t})=>({...sa({"--tw-scroll-snap-strictness":"proximity"}),"scroll-snap-type":t+" var(--tw-scroll-snap-strictness)"})),me("snap-(mandatory|proximity)","--tw-scroll-snap-strictness"),me("snap-(?:(start|end|center)|align-(none))","scroll-snap-align"),me("snap-(normal|always)","scroll-snap-stop"),me("scroll-(auto|smooth)","scroll-behavior"),ve("scroll-p([xytrbl])?(?:$|-)","padding",al("scroll-padding")),ve("-?scroll-m([xytrbl])?(?:$|-)","scroll-margin",al("scroll-margin")),me("touch-(auto|none|manipulation)","touch-action"),me("touch-(pinch-zoom|pan-(?:(x|left|right)|(y|up|down)))",({1:t,2:e,3:r})=>({...sa({"--tw-pan-x":"var(--tw-empty,/*!*/ /*!*/)","--tw-pan-y":"var(--tw-empty,/*!*/ /*!*/)","--tw-pinch-zoom":"var(--tw-empty,/*!*/ /*!*/)","--tw-touch-action":"var(--tw-pan-x) var(--tw-pan-y) var(--tw-pinch-zoom)"}),[`--tw-${e?"pan-x":r?"pan-y":t}`]:t,"touch-action":"var(--tw-touch-action)"})),me("outline-none",{outline:"2px solid transparent","outline-offset":"2px"}),me("outline",{outlineStyle:"solid"}),me("outline-(dashed|dotted|double)","outlineStyle"),ve("-?(outline-offset)-"),Lr("outline-",{opacityVariable:!1,opacitySection:"opacity"}),ve("outline-","outlineWidth"),"(pointer-events)-",ve("(will-change)-"),"(will-change)-",["resize(?:-(none|x|y))?","resize",({1:t})=>({x:"horizontal",y:"vertical"})[t]||t||"both"],me("select-(none|text|all|auto)","userSelect"),Lr("fill-",{section:"fill",opacityVariable:!1,opacitySection:"opacity"}),Lr("stroke-",{section:"stroke",opacityVariable:!1,opacitySection:"opacity"}),ve("stroke-","strokeWidth"),me("sr-only",{position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",whiteSpace:"nowrap",clip:"rect(0,0,0,0)",borderWidth:"0"}),me("not-sr-only",{position:"static",width:"auto",height:"auto",padding:"0",margin:"0",overflow:"visible",whiteSpace:"normal",clip:"auto"})];function sf(t){return(typeof t=="string"?t:t[1]).replace(/-/g," ").trim()}function pE(t){return(typeof t=="string"?t:t[1]).replace("col","column")}function ic(t,e="-"){let r=[];for(let n of t)r.push({t:"top",r:"right",b:"bottom",l:"left"}[n]);return r.join(e)}function Qs(t){return t&&""+(t._||t)}function gE({$$:t}){return({r:"flex-","":"flex-",w:"space-",u:"space-",n:"space-"}[t[3]||""]||"")+t}function al(t,e=""){return({1:r,_:n})=>{let s={x:"lr",y:"tb"}[r]||r+r;return s?{...tp(t+"-"+ic(s[0])+e,n),...tp(t+"-"+ic(s[1])+e,n)}:tp(t+e,n)}}function yE(t=""){let e=["blur","brightness","contrast","grayscale","hue-rotate","invert",t&&"opacity","saturate","sepia",!t&&"drop-shadow"].filter(Boolean),r={};for(let n of e)r[`--tw-${t}${n}`]="var(--tw-empty,/*!*/ /*!*/)";return r={...sa(r),[`${t}filter`]:e.map(n=>`var(--tw-${t}${n})`).join(" ")},[`(${t}filter)-(none)`,me(`${t}filter`,r),...e.map(n=>ve(`${n[0]=="h"?"-?":""}(${t}${n})(?:$|-)`,n,({1:s,_:i})=>({[`--tw-${s}`]:Yt(i).map(o=>`${n}(${o})`).join(" "),...r})))]}function Ly({1:t,_:e}){return{["--tw-"+t]:e,...s0()}}function s0(){return{...sa({"--tw-translate-x":"0","--tw-translate-y":"0","--tw-rotate":"0","--tw-skew-x":"0","--tw-skew-y":"0","--tw-scale-x":"1","--tw-scale-y":"1","--tw-transform":_C()}),transform:"var(--tw-transform)"}}function _C(t){return[t?"translate3d(var(--tw-translate-x),var(--tw-translate-y),0)":"translateX(var(--tw-translate-x)) translateY(var(--tw-translate-y))","rotate(var(--tw-rotate))","skewX(var(--tw-skew-x))","skewY(var(--tw-skew-y))","scaleX(var(--tw-scale-x))","scaleY(var(--tw-scale-y))"].join(" ")}function mE({1:t,2:e}){return`${t} ${e} / ${t} ${e}`}function wE({1:t}){return`repeat(${t},minmax(0,1fr))`}function sa(t){return{"@layer defaults":{"*,::before,::after":t,"::backdrop":t}}}let Sk=[["sticky","@supports ((position: -webkit-sticky) or (position:sticky))"],["motion-reduce","@media (prefers-reduced-motion:reduce)"],["motion-safe","@media (prefers-reduced-motion:no-preference)"],["print","@media print"],["(portrait|landscape)",({1:t})=>`@media (orientation:${t})`],["contrast-(more|less)",({1:t})=>`@media (prefers-contrast:${t})`],["(first-(letter|line)|placeholder|backdrop|before|after)",({1:t})=>`&::${t}`],["(marker|selection)",({1:t})=>`& *::${t},&::${t}`],["file","&::file-selector-button"],["(first|last|only)",({1:t})=>`&:${t}-child`],["even","&:nth-child(2n)"],["odd","&:nth-child(odd)"],["open","&[open]"],["(aria|data)-",({1:t,$$:e},r)=>e&&`&[${t}-${r.theme(t,e)||_a(e,"",r)||`${e}="true"`}]`],["((group|peer)(~[^-[]+)?)(-\\[(.+)]|[-[].+?)(\\/.+)?",({2:t,3:e="",4:r,5:n="",6:s=e},{e:i,h:o,v:a})=>{let c=kd(n)||(r[0]=="["?r:a(r.slice(1)));return`${(c.includes("&")?c:"&"+c).replace(/&/g,`:merge(.${i(o(t+s))})`)}${t[0]=="p"?"~":" "}&`}],["(ltr|rtl)",({1:t})=>`[dir="${t}"] &`],["supports-",({$$:t},e)=>{if(t&&(t=e.theme("supports",t)||_a(t,"",e)),t)return t.includes(":")||(t+=":var(--tw)"),/^\w*\s*\(/.test(t)||(t=`(${t})`),`@supports ${t.replace(/\b(and|or|not)\b/g," $1 ").trim()}`}],["max-",({$$:t},e)=>{if(t&&(t=e.theme("screens",t)||_a(t,"",e)),typeof t=="string")return`@media not all and (min-width:${t})`}],["min-",({$$:t},e)=>(t&&(t=_a(t,"",e)),t&&`@media (min-width:${t})`)],[/^\[(.+)]$/,({1:t})=>/[&@]/.test(t)&&kd(t).replace(/[}]+$/,"").split("{")]];function Ak({colors:t,disablePreflight:e}={}){return{preflight:e?void 0:_k,theme:{...n0,colors:{inherit:"inherit",current:"currentColor",transparent:"transparent",black:"#000",white:"#fff",...t}},variants:Sk,rules:xk,finalize(r){return r.n&&r.d&&r.r.some(n=>/^&::(before|after)$/.test(n))&&!/(^|;)content:/.test(r.d)?{...r,d:"content:var(--tw-content);"+r.d}:r}}}const Ik=vC({preflight:!1,hash:!0,darkMode:"class",theme:{extend:{colors:{background:"var(--swk-background)","background-secondary":"var(--swk-background-secondary)","foreground-strong":"var(--swk-foreground-strong)",foreground:"var(--swk-foreground)","foreground-secondary":"var(--swk-foreground-secondary)",primary:"var(--swk-primary)","primary-foreground":"var(--swk-primary-foreground)",transparent:"var(--swk-transparent)",lighter:"var(--swk-lighter)",light:"var(--swk-light)","light-gray":"var(--swk-light-gray)",gray:"var(--swk-gray)",danger:"var(--swk-danger)",border:"var(--swk-border)"},boxShadow:{default:"0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -4px rgba(0, 0, 0, 0.1)"},borderRadius:{default:"var(--swk-border-radius)"},fontFamily:{default:"var(--swk-font-family)"}}},presets:[Ek(),Ak({disablePreflight:!0})]}),Bg=lk(Ik,typeof document>"u"?hk():dk("style[data-library]")),Fe=t=>Bg(`!(${t})`);gk.bind(Bg);fk.bind(Bg);pk.bind(Bg);const xC=Ug`
  .stellar-wallets-kit *,
  .stellar-wallets-kit ::after,
  .stellar-wallets-kit ::before,
  .stellar-wallets-kit ::backdrop,
  .stellar-wallets-kit ::file-selector-button {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
    border: 0 solid;
  }
  .stellar-wallets-kit :host {
    line-height: 1.5;
    -webkit-text-size-adjust: 100%;
    tab-size: 4;
    font-family:
      ui-sans-serif, system-ui, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol",
      "Noto Color Emoji";
    font-feature-settings: normal;
    font-variation-settings: normal;
    -webkit-tap-highlight-color: transparent;
  }
  .stellar-wallets-kit hr {
    height: 0;
    color: inherit;
    border-top-width: 1px;
  }
  .stellar-wallets-kit abbr:where([title]) {
    -webkit-text-decoration: underline dotted;
    text-decoration: underline dotted;
  }
  .stellar-wallets-kit h1,
  .stellar-wallets-kit h2,
  .stellar-wallets-kit h3,
  .stellar-wallets-kit h4,
  .stellar-wallets-kit h5,
  .stellar-wallets-kit h6 {
    font-size: inherit;
    font-weight: inherit;
  }
  .stellar-wallets-kit a {
    color: inherit;
    -webkit-text-decoration: inherit;
    text-decoration: inherit;
  }
  .stellar-wallets-kit b,
  .stellar-wallets-kit strong {
    font-weight: bolder;
  }
  .stellar-wallets-kit code,
  .stellar-wallets-kit kbd,
  .stellar-wallets-kit samp,
  .stellar-wallets-kit pre {
    font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
    font-feature-settings: normal;
    font-variation-settings: normal;
    font-size: 1em;
  }
  .stellar-wallets-kit small {
    font-size: 80%;
  }
  .stellar-wallets-kit sub,
  .stellar-wallets-kit sup {
    font-size: 75%;
    line-height: 0;
    position: relative;
    vertical-align: baseline;
  }
  .stellar-wallets-kit sub {
    bottom: -0.25em;
  }
  .stellar-wallets-kit sup {
    top: -0.5em;
  }
  .stellar-wallets-kit table {
    text-indent: 0;
    border-color: inherit;
    border-collapse: collapse;
  }
  .stellar-wallets-kit :-moz-focusring {
    outline: auto;
  }
  .stellar-wallets-kit progress {
    vertical-align: baseline;
  }
  .stellar-wallets-kit summary {
    display: list-item;
  }
  .stellar-wallets-kit ol,
  .stellar-wallets-kit ul,
  .stellar-wallets-kit menu {
    list-style: none;
  }
  .stellar-wallets-kit img,
  .stellar-wallets-kit svg,
  .stellar-wallets-kit video,
  .stellar-wallets-kit canvas,
  .stellar-wallets-kit audio,
  .stellar-wallets-kit iframe,
  .stellar-wallets-kit embed,
  .stellar-wallets-kit object {
    display: block;
    vertical-align: middle;
  }
  .stellar-wallets-kit img,
  .stellar-wallets-kit video {
    max-width: 100%;
    height: auto;
  }
  .stellar-wallets-kit button,
  .stellar-wallets-kit input,
  .stellar-wallets-kit select,
  .stellar-wallets-kit optgroup,
  .stellar-wallets-kit textarea,
  .stellar-wallets-kit ::file-selector-button {
    font: inherit;
    font-feature-settings: inherit;
    font-variation-settings: inherit;
    letter-spacing: inherit;
    color: inherit;
    border-radius: 0;
    background-color: transparent;
    opacity: 1;
  }
  .stellar-wallets-kit :where(select:is([multiple], [size])) optgroup {
    font-weight: bolder;
  }
  .stellar-wallets-kit :where(select:is([multiple], [size])) optgroup option {
    padding-inline-start: 20px;
  }
  .stellar-wallets-kit ::file-selector-button {
    margin-inline-end: 4px;
  }
  .stellar-wallets-kit ::placeholder {
    opacity: 1;
  }
  .stellar-wallets-kit textarea {
    resize: vertical;
  }
  .stellar-wallets-kit ::-webkit-search-decoration {
    -webkit-appearance: none;
  }
  .stellar-wallets-kit ::-webkit-date-and-time-value {
    min-height: 1lh;
    text-align: inherit;
  }
  .stellar-wallets-kit ::-webkit-datetime-edit {
    display: inline-flex;
  }
  .stellar-wallets-kit ::-webkit-datetime-edit-fields-wrapper {
    padding: 0;
  }
  .stellar-wallets-kit ::-webkit-datetime-edit,
  .stellar-wallets-kit ::-webkit-datetime-edit-year-field,
  .stellar-wallets-kit ::-webkit-datetime-edit-month-field,
  .stellar-wallets-kit ::-webkit-datetime-edit-day-field,
  .stellar-wallets-kit ::-webkit-datetime-edit-hour-field,
  .stellar-wallets-kit ::-webkit-datetime-edit-minute-field,
  .stellar-wallets-kit ::-webkit-datetime-edit-second-field,
  .stellar-wallets-kit ::-webkit-datetime-edit-millisecond-field,
  .stellar-wallets-kit ::-webkit-datetime-edit-meridiem-field {
    padding-block: 0;
  }
  .stellar-wallets-kit ::-webkit-calendar-picker-indicator {
    line-height: 1;
  }
  .stellar-wallets-kit :-moz-ui-invalid {
    box-shadow: none;
  }
  .stellar-wallets-kit button,
  .stellar-wallets-kit input:where([type="button"], [type="reset"], [type="submit"]),
  .stellar-wallets-kit ::file-selector-button {
    appearance: button;
  }
  .stellar-wallets-kit ::-webkit-inner-spin-button,
  .stellar-wallets-kit ::-webkit-outer-spin-button {
    height: auto;
  }
  .stellar-wallets-kit [hidden]:where(:not([hidden="until-found"])) {
    display: none !important;
  }
`;var kr=(function(t){return t.xs="xs",t.sm="sm",t.md="md",t.lg="lg",t.xl="xl",t})({}),fi=(function(t){return t.primary="primary",t.secondary="secondary",t.ghost="ghost",t.free="free",t})({}),In=(function(t){return t.regular="regular",t.icon="icon",t})({});const Ck="flex items-center justify-center font-semibold easy-in-out transition leading-none";function kc({size:t=kr.md,mode:e=fi.primary,shape:r=In.regular,classes:n,styles:s,children:i,onClick:o}){const a=sc({"border-none bg-primary text-primary-foreground shadow-default hover:opacity-70 focus:opacity-90":e===fi.primary,"border-none bg-background text-foreground shadow-default hover:opacity-70 focus:opacity-90":e===fi.secondary,"bg-transparent text-foreground border-transparent border-1 hover:border-light-gray":e===fi.ghost}),c=sc({"rounded-default":r===In.regular,"rounded-full":r===In.icon}),l=sc({"text-xs":t===kr.xs,"text-sm":t!==kr.xs}),u=sc({"px-2 py-1":r===In.regular&&(t===kr.xs||t===kr.sm),"px-2.5 py-1.5":r===In.regular&&t===kr.md,"px-3 py-2":r===In.regular&&t===kr.lg,"px-3.5 py-2.5":r===In.regular&&t===kr.xl,"p-1":r===In.icon&&t===kr.xs,"p-1.5":r===In.icon&&t===kr.sm,"p-2":r===In.icon&&t===kr.md,"p-2.5":r===In.icon&&t===kr.lg,"p-3":r===In.icon&&t===kr.xl}),d=e===fi.free?"":Fe(sc("cursor-pointer",Ck,a,c,l,u));return Vt`
    <button onClick="${()=>o()}" type="button" style="${s}" class="${d} ${n}">
      ${i}
    </button>
  `}function bE(){Oc.value=[]}function Np(t){Pg.value=t,Oc.value=[...Oc.value,t]}function $k(){const t=Oc.value;t.pop(),Oc.value=t.slice(),Pg.value=t[t.length-1]}function Tk({children:t,isActive:e,duration:r=300}){const[n,s]=Yw(e),[i,o]=Yw(e);if(R6(()=>{if(e)o(!0),globalThis.requestAnimationFrame(()=>s(!0));else{s(!1);const c=globalThis.setTimeout(()=>o(!1),r);return()=>globalThis.clearTimeout(c)}},[e,r]),!i)return null;const a={position:n?"relative":"absolute",inset:0,transition:`opacity ${r}ms ease, transform ${r}ms ease, position ${r}ms ease`,opacity:n?1:0};return Vt`<div style=${a}>${t}</div>`}function Nk({currentRoute:t,pages:e,duration:r=300}){const n=Object.entries(e).map(([s,i])=>Vt`
      <${Tk} id=${s} key=${s} isActive=${t===s} duration=${r}>
        <${i} />
      <//>
    `);return Vt`<div style=${{overflow:"scroll",position:"relative",width:"100%",height:"100%"}}>${n}</div>`}function Ok(){Np(gi.HELP_PAGE)}function kk(){$k()}const Pk=Kl(()=>Pg.value!==gi.AUTH_OPTIONS?Oc.value.length<2?Vt``:Vt`
      <${kc} onClick=${()=>kk()}
                 size="${kr.md}"
                 mode="${fi.ghost}"
                 shape="${In.icon}">
        
        <svg class="${Fe("w-4 h-4")}" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M7.82843 10.9999H20V12.9999H7.82843L13.1924 18.3638L11.7782 19.778L4 11.9999L11.7782 4.22168L13.1924 5.63589L7.82843 10.9999Z"></path></svg>
      <//>
    `:Vt`
      <${kc} onClick=${()=>Ok()}
                 size="${kr.md}"
                 mode="${fi.ghost}"
                 shape="${In.icon}">
        <svg class="${Fe("w-4 h-4")}" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22ZM12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20ZM11 15H13V17H11V15ZM13 13.3551V14H11V12.5C11 11.9477 11.4477 11.5 12 11.5C12.8284 11.5 13.5 10.8284 13.5 10C13.5 9.17157 12.8284 8.5 12 8.5C11.2723 8.5 10.6656 9.01823 10.5288 9.70577L8.56731 9.31346C8.88637 7.70919 10.302 6.5 12 6.5C13.933 6.5 15.5 8.067 15.5 10C15.5 11.5855 14.4457 12.9248 13 13.3551Z"></path></svg>
      <//>
    `);function Rk(){return Vt`
    <header class="${Fe("flex items-center px-3 py-2")}">
      <div class="${Fe("w-3/12 flex justify-start")}">
        ${Pk.value}
      </div>

      <div class="${Fe("w-6/12 text-center")}">
        <h1 class="${Fe("text-foreground-strong font-semibold")}">
          ${kg.value}
        </h1>
      </div>

      <div class="${Fe("w-3/12 flex justify-end")}">
        <${kc} onClick=${()=>Nd.next()}
                   size="${kr.md}"
                   mode="${fi.ghost}"
                   shape="${In.icon}">

          <svg class="${Fe("w-4 h-4")}" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M11.9997 10.5865L16.9495 5.63672L18.3637 7.05093L13.4139 12.0007L18.3637 16.9504L16.9495 18.3646L11.9997 13.4149L7.04996 18.3646L5.63574 16.9504L10.5855 12.0007L5.63574 7.05093L7.04996 5.63672L11.9997 10.5865Z"></path></svg>
        <//>
      </div>
    </header>
  `}function Dk(){return Vt`
    <footer class="${Fe("w-full text-center p-2 border-t-1 border-t-border")}">
      <p class="${Fe("text-xs text-foreground")}">
        Powered by
        <a target="_blank" href="https://stellarwalletskit.dev/" class="${Fe("font-semibold underline ml-1")}">
          Stellar Wallets Kit
        </a>
      </p>
    </footer>
  `}var SC=(function(t){return t.xs="w-6 h-6",t.sm="w-8 h-8",t.md="w-10 h-10",t.lg="w-12 h-12",t.xl="w-14 h-14",t})({});const Uk="inline-block rounded-full outline -outline-offset-1 outline-black/5 dark:outline-white/10";function AC(t){return Vt`
    <img alt="${t.alt}" src="${t.image}" class="${Fe(sc(Uk,t.size))}" />
  `}const Bk=Kl(()=>{const t=hC.value.reduce((s,i)=>({available:i.isAvailable?[...s.available,i]:s.available,unavailable:i.isAvailable?s.unavailable:[...s.unavailable,i]}),{available:[],unavailable:[]});let e;try{const s=globalThis?.localStorage.getItem(xs.usedWalletsIds);e=s?JSON.parse(s):[]}catch(s){console.error(s),e=[]}const r=[],n=[];for(const s of t.available)e.find(i=>i===s.id)?r.push(s):n.push(s);return[...r.sort((s,i)=>e.indexOf(s.id)-e.indexOf(i.id)),...n,...t.unavailable]});async function Lk(t){if(!t.isAvailable){globalThis.open(t.url,"_blank");return}if(Io.value=t.id,J6.next(t),t.type===Bo.HW_WALLET)Np(gi.HW_ACCOUNTS_FETCHER);else try{const{address:e}=await Ss.value.getAddress();ur.value=e,Cp.next(e)}catch(e){Cp.next(e)}}function Mk(){return kg.value="Connect Wallet",Vt`
    <ul class="${Fe("w-full grid gap-2 px-2 py-4")}">
      ${Bk.value.map(t=>Vt`
          <li
            onClick="${()=>Lk(t)}"
            class="${Fe("px-2 py-2 cursor-pointer flex justify-between items-center bg-background hover:border-light-gray border-1 border-transparent rounded-default duration-150 ease active:bg-background active:border-gray")}"
          >
            <div class="${Fe("flex items-center gap-2")}">
              <${AC} class="${Fe("mr-2")}" alt="${t.name} icon" image="${t.icon}" size="${SC.sm}" />
              <p class="${Fe("text-foreground font-semibold")}">${t.name}</p>
            </div>

            ${uC.value&&!t.isAvailable?Vt`
                <div class="${Fe("ml-4 flex items-center")}">
                  <small
                    class="${Fe("inline-flex items-center border-1 border-border px-2 py-1 rounded-default text-foreground-secondary text-xs bg-background-secondary")}"
                  >
                    ${G6.value}

                    <svg class="${Fe("w-4 h-4")}" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                      <path d="M16.0037 9.41421L7.39712 18.0208L5.98291 16.6066L14.5895 8H7.00373V6H18.0037V17H16.0037V9.41421Z"></path>
                    </svg>
                  </small>
                </div>
              `:""}
          </li>
        `)}
    </ul>
  `}function jk(){return Vt`
    <section class="${Fe("w-full p-4 pb-8 rounded-tl-default")}">
      <div class="${Fe("w-full mb-6")}">
        <h3 class="${Fe("text-foreground-strong font-semibold text-lg mb-2")}">What is a wallet?</h3>
        <p class="${Fe("text-foreground text-sm")}">
          Wallets are used to send, receive, and store the keys you use to sign blockchain transactions.
        </p>
      </div>

      <div class="w-full">
        <h3 class="${Fe("text-foreground-strong font-semibold text-lg mb-2")}">What is Stellar?</h3>
        <p class="${Fe("text-foreground text-sm")}">
          Stellar is a decentralized, public blockchain that gives developers the tools to create experiences that are more
          like cash than crypto.
        </p>
      </div>
    </section>
  `}function Bt(t){return{code:t?.error?.code||t?.code||-1,message:t?.error?.message||t?.message||typeof t=="string"&&t||"Unhandled error from the wallet",ext:t?.error?.ext||t?.ext}}function f1(){Ss.value?.disconnect&&Ss.value.disconnect(),Z6(),fC.next(),Nd.next()}const i0=yr(!1);function Fk(){if(!ur.value)throw new Error("Text to copy to the clipboard can't be undefined");navigator.clipboard.writeText(ur.value).then(()=>{i0.value=!0,setTimeout(()=>{i0.value=!1},2500)}).catch(t=>console.error(t))}function qk(){return kg.value="",Vt`
    <section class="${Fe("w-full flex flex-col pb-8")}">
      <div class="${Fe("w-full flex justify-center mb-4")}">
        <${AC} alt="${Ss.value?.productName} icon" image="${Ss.value?.productIcon}" size="${SC.xl}" />
      </div>
      
      <div class="${Fe("w-full flex items-center justify-center mb-2")}">
        <h1 class="${Fe("text-lg font-semibold text-foreground")}">
          ${ur.value&&`${ur.value.slice(0,6)}....${ur.value.slice(-6)}`}
        </h1>
      </div>
      
      <div class="${Fe("w-full flex flex-col items-center justify-center gap-2")}">
        <${kc} mode="${fi.ghost}" onClick="${Fk}" size="${kr.sm}">
          ${i0.value?"Address copied!":Vt`Copy address`} <svg class="${Fe("w-4 h-4 ml-2")}" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M6.9998 6V3C6.9998 2.44772 7.44752 2 7.9998 2H19.9998C20.5521 2 20.9998 2.44772 20.9998 3V17C20.9998 17.5523 20.5521 18 19.9998 18H16.9998V20.9991C16.9998 21.5519 16.5499 22 15.993 22H4.00666C3.45059 22 3 21.5554 3 20.9991L3.0026 7.00087C3.0027 6.44811 3.45264 6 4.00942 6H6.9998ZM5.00242 8L5.00019 20H14.9998V8H5.00242ZM8.9998 6H16.9998V16H18.9998V4H8.9998V6Z"></path></svg>
        <//>

        <${kc} mode="${fi.ghost}" onClick="${f1}" size="${kr.sm}">
          Disconnect <svg class="${Fe("w-4 h-4 ml-2")}" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M5 11H13V13H5V16L0 12L5 8V11ZM3.99927 18H6.70835C8.11862 19.2447 9.97111 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4C9.97111 4 8.11862 4.75527 6.70835 6H3.99927C5.82368 3.57111 8.72836 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C8.72836 22 5.82368 20.4289 3.99927 18Z"></path></svg>
        <//>
      </div>
    </section>
  `}const vE={error:null,loading:!0,accounts:[]};class zk extends Dl{stateSignal=yr(vE);componentWillMount(){kg.value="Wallet Accounts",this.fetchAccounts()}async fetchAccounts(){const e=Ss.value;this.stateSignal.value=vE,e.disconnect&&(await e.disconnect(),await new Promise(r=>setTimeout(r,500)));try{const r=await e.getAddresses();this.stateSignal.value={...this.stateSignal.value,loading:!1,accounts:r}}catch(r){this.stateSignal.value={...this.stateSignal.value,error:r.message}}}async selectAccount(e){ur.value=e.publicKey,Cp.next(e.publicKey)}render(){const e=Vt`
      <div class="${Fe("py-8 w-full flex justify-center items-center text-foreground")}">
        <svg class="${Fe("w-8 h-8 text-gray-200 animate-spin")}" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
          <path d="M12 3C16.9706 3 21 7.02944 21 12H19C19 8.13401 15.866 5 12 5V3Z"></path>
        </svg>
      </div>
    `,r=Vt`    
      <ul class="${Fe("w-full grid gap-2 px-2 py-4 text-foreground")}">
        ${Td.value.map(({publicKey:s,index:i})=>Vt`
            <li onClick=${()=>this.selectAccount({publicKey:s,index:i})}
                class="${Fe("px-2 py-2 cursor-pointer flex justify-between items-center bg-background hover:border-light-gray border-1 border-transparent rounded-default duration-150 ease active:bg-background active:border-gray")}">
              ${s.slice(0,6)}....${s.slice(-6)}

              <span class="dialog-text">(44'/148'/${i}')</span>
            </li>
          `)}
      </ul>
    `,n=Vt`
      <div class="${Fe("w-full text-center text-foreground py-4")}">
        <div class="${Fe("text-danger")}">
          <svg class="${Fe("inline-block mx-auto w-8 h-8 mb-2")}" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
            <path d="M12.8659 3.00017L22.3922 19.5002C22.6684 19.9785 22.5045 20.5901 22.0262 20.8662C21.8742 20.954 21.7017 21.0002 21.5262 21.0002H2.47363C1.92135 21.0002 1.47363 20.5525 1.47363 20.0002C1.47363 19.8246 1.51984 19.6522 1.60761 19.5002L11.1339 3.00017C11.41 2.52187 12.0216 2.358 12.4999 2.63414C12.6519 2.72191 12.7782 2.84815 12.8659 3.00017ZM4.20568 19.0002H19.7941L11.9999 5.50017L4.20568 19.0002ZM10.9999 16.0002H12.9999V18.0002H10.9999V16.0002ZM10.9999 9.00017H12.9999V14.0002H10.9999V9.00017Z"></path>
          </svg>
        </div>
        
        <h3 class="${Fe("text-sm font-semibold")}">
          Error while fetching accounts with reason:
        </h3>
        
        <p class="${Fe("mb-4 text-sm")}">
          ${this.stateSignal.value.error}
        </p>
        
        <div class="${Fe("w-full flex justify-center items-center")}">
          <${kc} onClick=${()=>this.fetchAccounts()} size="${kr.md}">
            Retry
          <//>
        </div>
      </div>
    `;return this.stateSignal.value.error?n:this.stateSignal.value.loading?e:r}}const Hk={[gi.AUTH_OPTIONS]:Mk,[gi.HELP_PAGE]:jk,[gi.PROFILE_PAGE]:qk,[gi.HW_ACCOUNTS_FETCHER]:zk},Wk=Ug`
  .glass {
    backdrop-filter: blur(10px);
    background-color: color-mix(in srgb, var(--swk-background) 25%, transparent);
  }
`;function EE(){const t=Fe(sc([Ip.value===dc.FIXED?"fixed flex left-0 top-0 z-[999] w-full h-full":"inline-flex","font-default justify-center items-center"]));return Vt`
    <section class="stellar-wallets-kit ${t} ${Fe(xC)} ${Fe(Wk)}">
      ${Ip.value===dc.FIXED?Vt`
          <div class="${Fe("absolute left-0 top-0 z-0 w-full h-full bg-[rgba(0,0,0,0.5)]")}" onClick="${()=>Nd.next()}"></div>
        `:""}

      <section
        class="${Fe("w-full h-fit relative max-w-[22rem] max-h-[39.4375rem] grid grid-cols-1 grid-rows-[auto_1fr_auto] bg-background rounded-default shadow-default transition-all duration-[0.5s] ease-in-out overflow-hidden max-h-[400px] overflow-y-scroll")}"
      >
        <div class="${Fe("col-span-1 top-0 sticky z-50")} glass">
          <${Rk} />
        </div>

        <div class="${Fe("col-span-1 relative z-10")}">
          <${Nk}
            currentRoute="${Pg.value}"
            pages="${Hk}"
            duration="${400}"
          />
        </div>

        <div class="${Fe("col-span-1 bottom-0 sticky z-50")} glass">
          <${Dk} />
        </div>
      </section>
    </section>
  `}async function Vk(t){if(t&&t(),typeof fd.value>"u")throw new Error("The kit hasn't been initiated.");!Ss.value||!ur.value?await Kn.authModal():await Kn.profileModal()}function Kk(t){const e=ur.value?`${ur.value.slice(0,4)}....${ur.value.slice(-6)}`:"Connect Wallet";return Vt`
    <div class="${Fe(xC)} ${Fe("inline-block")}">      
      <${kc} styles=${t.styles} 
                 classes=${t.classes}
                 mode=${t.mode||fi.primary}
                 shape=${t.shape||In.regular}
                 size=${t.size}
                 onClick=${()=>Vk(t.onClick)}>        
        ${t.children?t.children:e}
      <//>
    </div>
  `}class Kn{static init(e){fd.value=e.modules,e.selectedWalletId&&Kn.setWallet(e.selectedWalletId),e.network&&Kn.setNetwork(e.network),e.theme&&Kn.setTheme(e.theme),e.authModal&&(typeof e.authModal.showInstallLabel<"u"&&(uC.value=e.authModal.showInstallLabel),typeof e.authModal.hideUnsupportedWallets<"u"&&(K6.value=e.authModal.hideUnsupportedWallets))}static get selectedModule(){if(!Ss.value)throw{code:-3,message:"Please set the wallet first"};return Ss.value}static setWallet(e){const r=fd.value.find(n=>n.productId===e);if(!r)throw new Error(`Wallet id "${e}" is not and existing module`);Io.value=r.productId}static setNetwork(e){Pi.value=e}static setTheme(e=lC){dC.value=e}static async getAddress(){if(!ur.value)throw{code:-1,message:"No wallet has been connected."};return{address:ur.value}}static signTransaction(e,r){return Kn.selectedModule.signTransaction(e,{...r,networkPassphrase:r?.networkPassphrase||Pi.value})}static signAuthEntry(e,r){return Kn.selectedModule.signAuthEntry(e,{...r,networkPassphrase:r?.networkPassphrase||Pi.value})}static signMessage(e,r){return Kn.selectedModule.signMessage(e,{...r,networkPassphrase:r?.networkPassphrase||Pi.value})}static getNetwork(){return Kn.selectedModule.getNetwork()}static async disconnect(){f1()}static on(e,r){switch(e){case ol.STATE_UPDATED:{let n,s;return wi(()=>{(ur.value!==n||Pi.value!==s)&&(n=ur.value,s=Pi.value,r({eventType:ol.STATE_UPDATED,payload:{address:ur.value,networkPassphrase:Pi.value}}))})}case ol.WALLET_SELECTED:{let n;return wi(()=>{Io.value!==n&&(n=Io.value,r({eventType:ol.WALLET_SELECTED,payload:{id:Io.value}}))})}case ol.DISCONNECT:return fC.subscribe(()=>{r({eventType:ol.DISCONNECT,payload:{}})});default:throw new Error(`${e} event type is not supported`)}}static async refreshSupportedWallets(){const e=await Promise.all(fd.value.map(async r=>{const n=new Promise(s=>setTimeout(()=>s(!1),1e3));return{id:r.productId,name:r.productName,type:r.moduleType,icon:r.productIcon,isAvailable:await Promise.race([n,r.isAvailable()]),url:r.productUrl}}));return hC.value=e,e}static async createButton(e,r={}){Iu(Vt`
        <${Kk}
          styles="${r.styles}"
          classes="${r.classes}"
          mode="${r.mode}"
          shape="${r.shape}"
          size="${r.size}"
          onClick="${()=>r.onClick&&r.onClick()}"
          children="${r.children}"
        />
      `,e)}static async authModal(e){bE(),Np(gi.AUTH_OPTIONS),Ip.value=e?.container?dc.BLOCK:dc.FIXED,await Kn.refreshSupportedWallets();const r=document.createElement("div");(e?.container||document.body).appendChild(r),Iu(Vt`
        <${EE} />
      `,r);const n=[],s=()=>{for(const i of n)i();Iu(null,r),r.parentNode?.removeChild(r)};return new Promise((i,o)=>{const a=Cp.subscribe(l=>{typeof l=="string"?i({address:l}):o(Bt(l))}),c=Nd.subscribe(()=>{o({code:-1,message:"The user closed the modal."})});n.push(a),n.push(c)}).then(i=>(s(),i)).catch(i=>{throw s(),i})}static async profileModal(e){if(!ur.value)throw{code:-1,message:"There is no active address, the user needs to authenticate first."};bE(),Np(gi.PROFILE_PAGE),Ip.value=e?.container?dc.BLOCK:dc.FIXED;const r=document.createElement("div");(e?.container||document.body).appendChild(r),Iu(Vt`
        <${EE} />
      `,r);const n=Nd.subscribe(()=>{n(),Iu(null,r),r.parentNode?.removeChild(r)})}}function o0(){const t=new Uint32Array(4);if(typeof crypto<"u"&&crypto.getRandomValues)crypto.getRandomValues(t);else for(let e=0;e<t.length;e++)t[e]=Math.floor(Math.random()*4294967295);return Array.from(t).map(e=>e.toString(36)).join("")}const IC={public_key:{title:"View public key",description:"Requests account public key. It's a simple way of authentication for Stellar-based applications. The response ensures that a user owns the corresponding secret key.",implicitFlow:!1,params:{token:{description:"Verification token generated by the application (should be unique or random).",type:"string",required:!1},callback:{description:"Optional URL callback where Albedo will POST a signed token and public key.",type:"string",required:!1},require_existing:{description:"Allow existing Albedo accounts only.",type:"boolean",required:!1}},returns:{pubkey:{description:"User-selected public key.",type:"string"},signed_message:{description:"HEX-encoded authentication message derived from the public key and verification token.",type:"string"},signature:{description:"HEX-encoded ED25519 signature of the authentication message that can be further used to verify user's keypair ownership.",type:"string"}}},sign_message:{title:"Sign text message",description:"Requests arbitrary message signing. Can be used to implement identity/ownership verification.",implicitFlow:!0,params:{message:{description:"Text message to sign.",type:"string",required:!0},pubkey:{description:"Specific public key requested by the application.",type:"string",required:!1},callback:{description:"Optional URL callback where Albedo will POST a signed message.",type:"string",required:!1}},returns:{pubkey:{description:"User-selected public key.",type:"string"},original_message:{description:"Text message to sign from request.",type:"string"},signed_message:{description:"HEX-encoded message derived from the public key and original message.",type:"string"},message_signature:{description:"HEX-encoded ED25519 signature of the signed message.",type:"string"}}},tx:{title:"Sign transaction",description:"Requests a signature for the transaction. Returns the signed transaction envelope that can be submitted to the network or used for multi-sig coordination.",implicitFlow:!0,params:{xdr:{description:"XDR-encoded transaction envelope to sign.",type:"string",required:!0},pubkey:{description:"Specific public key requested by the application.",type:"string",required:!1},network:{description:"Stellar network identifier.",type:"string",required:!1},callback:{description:"Optional URL callback where Albedo will POST the signed transaction XDR instead of submitting it to Horizon.",type:"string",required:!1},description:{description:"Optional human-friendly short transaction description provided by developers.",type:"string",required:!1},submit:{description:"If set, the signed transaction will be submitted to the Horizon server instead of returning it to the application.",type:"boolean",required:!1}},returns:{xdr:{description:"XDR-encoded transaction envelope from request.",type:"string"},tx_hash:{description:"HEX-encoded transaction hash.",type:"string"},signed_envelope_xdr:{description:"XDR-encoded transaction envelope with new signatures.",type:"string"},network:{description:"Stellar network identifier.",type:"string"},result:{description:"Optional response from Horizon if the transaction has been submitted automatically.",type:"object"}}},pay:{title:"Make payment",description:"Requests a payment from a user. Works with any Stellar asset, supports transaction memo.",implicitFlow:!0,params:{amount:{description:"Requested payment amount.",type:"string",required:!0},destination:{description:"Payment destination address.",type:"string",required:!0},asset_code:{description:"Asset code (skip for XLM).",type:"string",required:!1},asset_issuer:{description:"Asset issuer (skip for XLM).",type:"string",required:!1},memo:{description:"Transaction memo (required for exchanges and some anchors).",type:"string",required:!1},memo_type:{description:"Transaction memo type.",type:"string",required:!1},pubkey:{description:"Specific public key requested by the application.",type:"string",required:!1},network:{description:"Stellar network identifier or private network passphrase.",type:"string",required:!1},callback:{description:"Optional URL callback where Albedo will POST the signed transaction XDR instead of submitting it to Horizon. ",type:"string",required:!1},submit:{description:"If set, the signed transaction will be submitted to the Horizon server instead of returning it to the application.",type:"boolean",required:!1}},returns:{amount:{description:"Payment amount from request.",type:"string"},destination:{description:"Payment destination address from request.",type:"string"},asset_code:{description:"Asset code from request.",type:"string"},asset_issuer:{description:"Asset issuer from request.",type:"string"},memo:{description:"Transaction memo from request.",type:"string"},memo_type:{description:"Transaction memo type from request.",type:"string"},tx_hash:{description:"HEX-encoded transaction hash.",type:"string"},signed_envelope_xdr:{description:"XDR-encoded transaction envelope with new signatures.",type:"string"},pubkey:{description:"User-selected public key.",type:"string"},network:{description:"Stellar network identifier.",type:"string"},result:{description:"Optional response from Horizon if the transaction has been submitted automatically.",type:"object"}}},trust:{title:"Establish trustline",description:"Requests permission to create a trustline to a given Stellar asset. Gradually simplifies the process of creating trustlines for anchors, ICOs, and airdrops.",implicitFlow:!0,params:{asset_code:{description:"Trustline asset code.",type:"string",required:!0},asset_issuer:{description:"Trustline asset issuer address.",type:"string",required:!0},limit:{description:"Trust limit.",type:"string",required:!1},memo:{description:"Transaction memo (required for exchanges and some anchors).",type:"string",required:!1},memo_type:{description:"Transaction memo type.",type:"string",required:!1},pubkey:{description:"Specific public key requested by the application.",type:"string",required:!1},network:{description:"Stellar network identifier or private network passphrase.",type:"string",required:!1},callback:{description:"Optional URL callback where Albedo will POST the signed transaction XDR instead of submitting it to Horizon. ",type:"string",required:!1},submit:{description:"If set, the signed transaction will be submitted to the Horizon server instead of returning it to the application.",type:"boolean",required:!1}},returns:{asset_code:{description:"Trustline asset code from request.",type:"string"},asset_issuer:{description:"Trustline asset issuer address from request.",type:"string"},limit:{description:"Trust limit from request.",type:"string"},tx_hash:{description:"HEX-encoded transaction hash.",type:"string"},signed_envelope_xdr:{description:"XDR-encoded transaction envelope with new signatures.",type:"string"},pubkey:{description:"User-selected public key.",type:"string"},network:{description:"Stellar network identifier.",type:"string"},result:{description:"Optional response from Horizon if the transaction has been submitted automatically.",type:"object"}}},exchange:{title:"Swap tokens",description:"Requests permission to buy tokens on Stellar DEX at market price.",implicitFlow:!1,params:{amount:{description:"The amount of asset to buy.",type:"string",required:!0},max_price:{description:"Maximum price the user willing to pay.",type:"string",required:!0},sell_asset_code:{description:"Asset code of the asset to sell.",type:"string",required:!1},sell_asset_issuer:{description:"Issuer account of the asset to sell.",type:"string",required:!1},buy_asset_code:{description:"Asset code of the asset to buy.",type:"string",required:!1},buy_asset_issuer:{description:"Issuer account of the asset to buy.",type:"string",required:!1},memo:{description:"Transaction memo (required for exchanges and some anchors).",type:"string",required:!1},memo_type:{description:"Transaction memo type.",type:"string",required:!1},pubkey:{description:"Specific public key requested by the application.",type:"string",required:!1},network:{description:"Stellar network identifier or private network passphrase.",type:"string",required:!1},callback:{description:"Optional URL callback where Albedo will POST the signed transaction XDR instead of submitting it to Horizon.",type:"string",required:!1},submit:{description:"If set, the signed transaction will be submitted to the Horizon server instead of returning it to the application.",type:"boolean",required:!1}},returns:{amount:{description:"The amount of asset to buy from request.",type:"string"},max_price:{description:"Maximum price the user willing to pay from request.",type:"string"},sell_asset_code:{description:"Asset code of the asset to sell from request.",type:"string"},sell_asset_issuer:{description:"Issuer account of the asset to sell from request.",type:"string"},buy_asset_code:{description:"Asset code of the asset to buy from request.",type:"string"},buy_asset_issuer:{description:"Issuer account of the asset to buy from request.",type:"string"},tx_hash:{description:"HEX-encoded transaction hash.",type:"string"},signed_envelope_xdr:{description:"XDR-encoded transaction envelope with new signatures.",type:"string"},pubkey:{description:"User-selected public key.",type:"string"},network:{description:"Stellar network identifier.",type:"string"},result:{description:"Optional response from Horizon if the transaction has been submitted automatically.",type:"object"}}},implicit_flow:{title:"Implicit permissions",description:'Requests temporary access token for one or more intents that can be used to execute actions without explicit confirmation from the user. In order to be executed implicitly, an implicit flow permissions for a given intent should be granted and "pubkey" parameter set.',implicitFlow:!1,params:{intents:{description:"Requested implicit flow intents.",type:"string|string[]",required:!0},network:{description:"Stellar network identifier or private network passphrase.",type:"string",required:!1}},returns:{granted:{description:"Whether a user granted permissions or not.",type:"boolean"},intents:{description:"Requested implicit flow intents.",type:"string[]"},grants:{description:"Implicit flow intents that have been granted.",type:"string[]"},session:{description:"Unique implicit session id.",type:"string"},valid_until:{description:"Session expiration timestamp.",type:"number"},pubkey:{description:"User-selected public key.",type:"string"},network:{description:"Stellar network identifier.",type:"string"}}},manage_account:{title:"Open account settings",description:"Opens account settings window for a given account.",implicitFlow:!1,params:{pubkey:{description:"Specific public key requested by the application.",type:"string",required:!0},network:{description:"Stellar network identifier or private network passphrase.",type:"string",required:!1}},returns:{pubkey:{description:"Public key from intent request.",type:"string"}}},batch:{title:"Intents batch",description:"Requests execution of several tx intents bundled together. This intent is atomic  a user confirms or rejects all bundled requests at once, with the same account and the same Stellar network.",implicitFlow:!0,params:{intents:{description:"Requested tx intents that should be executed together.",type:"object[]",required:!0},pubkey:{description:"Specific public key requested by the application.",type:"string",required:!1},network:{description:"Stellar network identifier or private network passphrase.",type:"string",required:!1}},returns:{intents:{description:"Requested tx intents.",type:"object[]"},results:{description:"Array of results for each requested intent.",type:"object[]"},pubkey:{description:"User-selected public key.",type:"string"},network:{description:"Stellar network identifier.",type:"string"}}}},p1={unhandledError:{message:"Unhandled error occurred. If this error persists, please contact Albedo support.",code:-1},externalError:{message:"External error occurred.",code:-2},invalidIntentRequest:{message:"Intent request is invalid.",code:-3},actionRejectedByUser:{message:"Action request was rejected by the user.",code:-4},horizonError:{message:"Transaction failed when submitted to Stellar network.",code:-5},callbackError:{message:"Callback redirect failed.",code:-6}};function g1(t,e=!1){this.windowHandler=t,this.ephemeral=!!e,this.isLoaded=!1,this.pendingRequests={},this.preprocessRequestParams=null,this.onLoaded=new Promise((r,n)=>this.onLoadedCallback=r).then(()=>this),this.messageHandler=this.messageHandler.bind(this),window.addEventListener("message",this.messageHandler,!1)}g1.prototype={isLoaded:!1,protocolVersion:3,markLoaded(){const{onLoadedCallback:t}=this;t&&(this.onLoadedCallback=null,this.isLoaded=!0,t())},messageHandler({data:t}){if(t.albedo)return this.matchProtocolVersion(t.albedo.protocol),this.markLoaded();if(t.albedoIntentResult){const{__reqid:e,...r}=t.albedoIntentResult,n=this.pendingRequests[e];n&&(delete this.pendingRequests[e],n(r),this.ephemeral&&(window.removeEventListener("message",this.messageHandler,!1),this.windowHandler.close()))}},transportCloseHandler(){for(let t in this.pendingRequests)if(this.pendingRequests.hasOwnProperty(t)){const e=this.pendingRequests[t];delete this.pendingRequests[t],e(p1.actionRejectedByUser)}},postMessage(t){const e=o0();return new Promise((r,n)=>{this.onLoaded.then(()=>{this.pendingRequests[e]=Gk.bind(this,r,n),t=Object.assign({__reqid:e,__albedo_intent_version:this.protocolVersion},t),this.preprocessRequestParams&&(t=this.preprocessRequestParams(t)),this.windowHandler.postMessage(t,"*")})})},matchProtocolVersion(t){const e=t-this.protocolVersion;if(e===0)return;const r=`@albedo-link/intent module protocol version (${this.protocolVersion}) is incompatible with current Albedo protocol version ${t}.`;if(e>0)console.warn(r+" Please update @albedo-link/intent module to avoid possible connection problems.");else if(e<0)throw this.windowHandler.close(),new Error(r)}};function Gk(t,e,r){r.error?e(r):t(r)}function Yk(t){const e=`${t}/confirm`,r=480,n=600,s=window.screenLeft!==void 0?window.screenLeft:window.screenX,i=window.screenTop!==void 0?window.screenTop:window.screenY,o=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width,a=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height,c=o/2-r/2+s,l=a/2-n/2+i,u=window.open(e,"auth.albedo.link",`height=${n},width=${r},top=${l},left=${c},menubar=0,toolbar=0,location=0,status=0,personalbar=0,scrollbars=0,dependent=1`);return new g1(u,!0).onLoaded}let My=null;function _E(t){if(!My){const e=document.createElement("iframe");e.style.border="none",Object.assign(e,{width:"0",height:"0",frameBorder:"0",referrerPolicy:"origin",src:`${t}`}),document.body.appendChild(e),My=new g1(e.contentWindow)}return My.onLoaded}function y1({session:t,pubkey:e,grants:r,valid_until:n}){this.key=t,this.pubkey=e,this.grants=r.slice(),this.validUntil=n,Object.freeze(this),Object.freeze(this.grants)}y1.prototype={key:"",pubkey:"",grants:[],validUntil:0,get isExpired(){return this.validUntil-2e3<new Date().getTime()},toJSON(){return{session:this.key,pubkey:this.pubkey,grants:this.grants.slice(),valid_until:this.validUntil}}};const Pd="albedo_session_";function Lg(){return window.sessionStorage}function Xk(t){const e=new y1(t);Lg().setItem(Pd+e.pubkey,JSON.stringify(e))}function CC(t){let e;{const r=Lg().getItem(Pd+t);r&&(e=new y1(JSON.parse(r)))}return e?e.isExpired?(TC(t),null):e:null}function $C(t,e){const r=CC(e);return!r||!r.grants.includes(t)?null:r}function Zk(){const t=Lg();return Object.keys(t).filter(e=>e.indexOf(Pd)===0).map(e=>CC(e.substr(Pd.length))).filter(e=>!!e)}function TC(t){Lg().removeItem(Pd+t)}function pd(t){return Object.assign(new Error,p1.invalidIntentRequest,{ext:t})}function Jk(t,e){try{const{intent:r}=t;if(!r)throw pd('Parameter "intent" is required.');const n=IC[r];if(!n)throw pd(`Unknown intent: "${r}".`);const s=t8(n,t);return Qk(s,e).then(i=>e8(s,i))}catch(r){const{code:n=-1,message:s,ext:i}=r,o={message:s,code:n};return i&&(o.ext=i),Promise.reject(o)}}function Qk(t,e){if(t.pubkey){const r=$C(t.intent,t.pubkey);if(r)return t.session=r.key,_E(e)}return setTimeout(()=>{t.intent==="implicit_flow"&&_E(e)},200),Yk(e)}function e8(t,e){return e.postMessage(t).then(r=>(r.intent==="implicit_flow"&&r.granted&&Xk(r),r))}function t8(t,e){if(typeof e!="object")throw pd("Intent parameters expected.");const{intent:r,pubkey:n}=e,s={intent:r};if(n&&!/^G[0-9A-Z]{55}$/.test(n))throw pd('Invalid "pubkey" parameter. Stellar account public key expected.');for(const i in t.params){const o=t.params[i],a=e[i];if(a)s[i]=a;else if(o.required)throw pd(`Parameter "${i}" is required for intent "${r}".`)}return s}function r8(t=null){t===null&&(t=window.location.search),t[0]==="?"&&(t=t.substr(1));const e={};for(let r of t.split("&")){const[n,s]=r.split("=").map(i=>decodeURIComponent(i));e[n]=s}return e}function n8(t){typeof document>"u"||!document.addEventListener||document.addEventListener("click",function(r){if(r.target.tagName!=="A"||(r.target.href||"").indexOf("web+stellar:")!==0)return;r.preventDefault(),r.stopImmediatePropagation();const{pathname:n,search:s}=new URL(r.target.href);if(!["tx","pay"].includes(n)){alert(`Invalid operation requested: ${n}. It's likely an external application error. Please contact support team of ${window.location.origin}.`);return}const i=r8(s);t.request(n,i)},!1)}if(typeof window=="object"&&typeof window.fetch!="function")throw new Error("Browser FetchAPI is not available. For legacy browsers support use polyfills such as whatwg-fetch.");function NC(){}NC.prototype={frontendUrl:"https://albedo.link",intentInterface:IC,intentErrors:p1,request(t,e){return Jk(Object.assign(e||{},{intent:t}),this.frontendUrl)},implicitFlow(t){return this.request("implicit_flow",t)},publicKey(t){return t=Object.assign({},t),t.token||(t.token=o0()),this.request("public_key",t)},tx(t){return this.request("tx",t)},batch(t){return this.request("batch",t)},pay(t){return this.request("pay",t)},trust(t){return this.request("trust",t)},exchange(t){return this.request("exchange",t)},signMessage(t){return t=Object.assign({},t,{message:s8(t.message)}),this.request("sign_message",t)},manageAccount(t){return this.request("manage_account",t)},generateRandomToken(){return o0()},isImplicitSessionAllowed(t,e){return!!$C(t,e)},listImplicitSessions(){return Zk()},forgetImplicitSession(t){TC(t)}};function s8(t){switch(typeof t){case"string":return t;case"undefined":return""}return JSON.stringify(t)}const Op=new NC;Op.default=Op;n8(Op);const xE=Op.default,i8="albedo";class o8{moduleType=Bo.HOT_WALLET;productId=i8;productName="Albedo";productUrl="https://albedo.link/";productIcon="https://stellar.creit.tech/wallet-icons/albedo.png";async isAvailable(){return!0}async getAddress(){try{return{address:(await xE.publicKey({})).pubkey}}catch(e){throw Bt(e)}}async signTransaction(e,r){try{const{signed_envelope_xdr:n}=await xE.tx({xdr:e,pubkey:r?.address,network:r?.networkPassphrase?r.networkPassphrase===Sa.PUBLIC?SE.PUBLIC:SE.TESTNET:void 0});return{signedTxXdr:n,signerAddress:r?.address}}catch(n){throw Bt(n)}}async signAuthEntry(){throw{code:-3,message:'Albedo does not support the "signAuthEntry" function'}}async signMessage(){throw{code:-3,message:'Albedo does not support the "signMessage" function'}}async getNetwork(){throw{code:-3,message:'Albedo does not support the "getNetwork" function'}}}var SE=(function(t){return t.PUBLIC="public",t.TESTNET="testnet",t})({}),Di=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Sh(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function m1(t){if(Object.prototype.hasOwnProperty.call(t,"__esModule"))return t;var e=t.default;if(typeof e=="function"){var r=function n(){var s=!1;try{s=this instanceof n}catch{}return s?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(n){var s=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(r,n,s.get?s:{enumerable:!0,get:function(){return t[n]}})}),r}var rp={exports:{}},a8=rp.exports,AE;function c8(){return AE||(AE=1,(function(t,e){(function(r,n){t.exports=n()})(a8,(()=>(()=>{var r,n,s={d:(P,R)=>{for(var T in R)s.o(R,T)&&!s.o(P,T)&&Object.defineProperty(P,T,{enumerable:!0,get:R[T]})},o:(P,R)=>Object.prototype.hasOwnProperty.call(P,R),r:P=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(P,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(P,"__esModule",{value:!0})}},i={};s.r(i),s.d(i,{WatchWalletChanges:()=>j,addToken:()=>y,default:()=>W,getAddress:()=>p,getNetwork:()=>E,getNetworkDetails:()=>v,isAllowed:()=>C,isBrowser:()=>D,isConnected:()=>A,requestAccess:()=>L,setAllowed:()=>O,signAuthEntry:()=>S,signMessage:()=>w,signTransaction:()=>g}),(function(P){P.CREATE_ACCOUNT="CREATE_ACCOUNT",P.FUND_ACCOUNT="FUND_ACCOUNT",P.ADD_ACCOUNT="ADD_ACCOUNT",P.IMPORT_ACCOUNT="IMPORT_ACCOUNT",P.IMPORT_HARDWARE_WALLET="IMPORT_HARDWARE_WALLET",P.LOAD_ACCOUNT="LOAD_ACCOUNT",P.MAKE_ACCOUNT_ACTIVE="MAKE_ACCOUNT_ACTIVE",P.UPDATE_ACCOUNT_NAME="UPDATE_ACCOUNT_NAME",P.GET_MNEMONIC_PHRASE="GET_MNEMONIC_PHRASE",P.CONFIRM_MNEMONIC_PHRASE="CONFIRM_MNEMONIC_PHRASE",P.CONFIRM_MIGRATED_MNEMONIC_PHRASE="CONFIRM_MIGRATED_MNEMONIC_PHRASE",P.RECOVER_ACCOUNT="RECOVER_ACCOUNT",P.CONFIRM_PASSWORD="CONFIRM_PASSWORD",P.REJECT_ACCESS="REJECT_ACCESS",P.GRANT_ACCESS="GRANT_ACCESS",P.ADD_TOKEN="ADD_TOKEN",P.SIGN_TRANSACTION="SIGN_TRANSACTION",P.SIGN_BLOB="SIGN_BLOB",P.SIGN_AUTH_ENTRY="SIGN_AUTH_ENTRY",P.HANDLE_SIGNED_HW_PAYLOAD="HANDLE_SIGNED_HW_PAYLOAD",P.REJECT_TRANSACTION="REJECT_TRANSACTION",P.SIGN_FREIGHTER_TRANSACTION="SIGN_FREIGHTER_TRANSACTION",P.SIGN_FREIGHTER_SOROBAN_TRANSACTION="SIGN_FREIGHTER_SOROBAN_TRANSACTION",P.ADD_RECENT_ADDRESS="ADD_RECENT_ADDRESS",P.LOAD_RECENT_ADDRESSES="LOAD_RECENT_ADDRESSES",P.LOAD_LAST_USED_ACCOUNT="LOAD_LAST_USED_ACCOUNT",P.SIGN_OUT="SIGN_OUT",P.SHOW_BACKUP_PHRASE="SHOW_BACKUP_PHRASE",P.SAVE_ALLOWLIST="SAVE_ALLOWLIST",P.SAVE_SETTINGS="SAVE_SETTINGS",P.SAVE_EXPERIMENTAL_FEATURES="SAVE_EXPERIMENTAL_FEATURES",P.LOAD_SETTINGS="LOAD_SETTINGS",P.GET_CACHED_ASSET_ICON="GET_CACHED_ASSET_ICON",P.CACHE_ASSET_ICON="CACHE_ASSET_ICON",P.GET_CACHED_ASSET_DOMAIN="GET_CACHED_ASSET_DOMAIN",P.CACHE_ASSET_DOMAIN="CACHE_ASSET_DOMAIN",P.GET_MEMO_REQUIRED_ACCOUNTS="GET_MEMO_REQUIRED_ACCOUNTS",P.ADD_CUSTOM_NETWORK="ADD_CUSTOM_NETWORK",P.CHANGE_NETWORK="CHANGE_NETWORK",P.REMOVE_CUSTOM_NETWORK="REMOVE_CUSTOM_NETWORK",P.EDIT_CUSTOM_NETWORK="EDIT_CUSTOM_NETWORK",P.RESET_EXP_DATA="RESET_EXP_DATA",P.ADD_TOKEN_ID="ADD_TOKEN_ID",P.GET_TOKEN_IDS="GET_TOKEN_IDS",P.REMOVE_TOKEN_ID="REMOVE_TOKEN_ID",P.GET_MIGRATABLE_ACCOUNTS="GET_MIGRATABLE_ACCOUNTS",P.GET_MIGRATED_MNEMONIC_PHRASE="GET_MIGRATED_MNEMONIC_PHRASE",P.MIGRATE_ACCOUNTS="MIGRATE_ACCOUNTS",P.ADD_ASSETS_LIST="ADD_ASSETS_LIST",P.MODIFY_ASSETS_LIST="MODIFY_ASSETS_LIST",P.CHANGE_ASSET_VISIBILITY="CHANGE_ASSET_VISIBILITY",P.GET_HIDDEN_ASSETS="GET_HIDDEN_ASSETS",P.GET_IS_ACCOUNT_MISMATCH="GET_IS_ACCOUNT_MISMATCH"})(r||(r={})),(function(P){P.REQUEST_ACCESS="REQUEST_ACCESS",P.REQUEST_PUBLIC_KEY="REQUEST_PUBLIC_KEY",P.SUBMIT_TOKEN="SUBMIT_TOKEN",P.SUBMIT_TRANSACTION="SUBMIT_TRANSACTION",P.SUBMIT_BLOB="SUBMIT_BLOB",P.SUBMIT_AUTH_ENTRY="SUBMIT_AUTH_ENTRY",P.REQUEST_NETWORK="REQUEST_NETWORK",P.REQUEST_NETWORK_DETAILS="REQUEST_NETWORK_DETAILS",P.REQUEST_CONNECTION_STATUS="REQUEST_CONNECTION_STATUS",P.REQUEST_ALLOWED_STATUS="REQUEST_ALLOWED_STATUS",P.SET_ALLOWED_STATUS="SET_ALLOWED_STATUS",P.REQUEST_USER_INFO="REQUEST_USER_INFO"})(n||(n={}));const o=P=>{const R=Date.now()+Math.random();return window.postMessage({source:"FREIGHTER_EXTERNAL_MSG_REQUEST",messageId:R,...P},window.location.origin),new Promise((T=>{let k=0;P.type!==n.REQUEST_CONNECTION_STATUS&&P.type!==n.REQUEST_PUBLIC_KEY||(k=setTimeout((()=>{T({isConnected:!1,publicKey:""}),window.removeEventListener("message",f)}),2e3));const f=m=>{var _,$;m.source===window&&((_=m?.data)===null||_===void 0?void 0:_.source)==="FREIGHTER_EXTERNAL_MSG_RESPONSE"&&(($=m?.data)===null||$===void 0?void 0:$.messagedId)===R&&(T(m.data),window.removeEventListener("message",f),clearTimeout(k))};window.addEventListener("message",f,!1)}))},a={code:-1,message:"Node environment is not supported"},c={code:-1,message:"The wallet encountered an internal error. Please try again or contact the wallet if the problem persists."},l=async()=>{let P;try{P=await o({type:n.REQUEST_ACCESS})}catch(T){console.error(T)}const{publicKey:R}=P||{publicKey:""};return{publicKey:R,error:P?.apiError}},u=async()=>{let P;try{P=await o({type:n.REQUEST_PUBLIC_KEY})}catch(R){console.error(R)}return{publicKey:P?.publicKey||"",error:P?.apiError}},d=async()=>{let P;try{P=await o({type:n.REQUEST_NETWORK_DETAILS})}catch($){console.error($)}const{networkDetails:R,apiError:T}=P||{networkDetails:{network:"",networkUrl:"",networkPassphrase:"",sorobanRpcUrl:void 0}},{network:k,networkUrl:f,networkPassphrase:m,sorobanRpcUrl:_}=R;return{network:k,networkUrl:f,networkPassphrase:m,sorobanRpcUrl:_,error:T}},h=async()=>{let P;try{P=await o({type:n.REQUEST_ALLOWED_STATUS})}catch(T){console.error(T)}const{isAllowed:R}=P||{isAllowed:!1};return{isAllowed:R,error:P?.apiError}},p=async()=>{let P="";if(D){const R=await u();return P=R.publicKey,R.error?{address:P,error:R.error}:{address:P}}return{address:P,error:a}},y=async P=>{if(D){const R=await(async T=>{let k;try{k=await o({contractId:T.contractId,networkPassphrase:T.networkPassphrase,type:n.SUBMIT_TOKEN})}catch{return{error:c}}return{contractId:k.contractId,error:k?.apiError}})(P);return R.error?{contractId:"",error:R.error}:{contractId:R.contractId||""}}return{contractId:"",error:a}},g=async(P,R)=>{if(D){const T=await(async(k,f)=>{let m,_,$,x;typeof f=="object"?(_=f.accountToSign,$=f.networkPassphrase):(m=f,_=void 0);try{x=await o({transactionXdr:k,network:m,networkPassphrase:$,accountToSign:_,type:n.SUBMIT_TRANSACTION})}catch{return{signedTransaction:"",signerAddress:"",error:c}}const{signedTransaction:N,signerAddress:H}=x;return{signedTransaction:N,signerAddress:H,error:x?.apiError}})(P,R);return T.error?{signedTxXdr:"",signerAddress:"",error:T.error}:{signedTxXdr:T.signedTransaction,signerAddress:T.signerAddress}}return{signedTxXdr:"",signerAddress:"",error:a}},w=async(P,R)=>{if(D){const{isAllowed:T}=await h();if(!T){const f=await l();if(f.error)return{signedMessage:null,signerAddress:"",error:f.error}}const k=await(async(f,m,_)=>{let $;const x=(_||{}).address;try{$=await o({blob:f,accountToSign:x,apiVersion:"5.0.0",networkPassphrase:_?.networkPassphrase,type:n.SUBMIT_BLOB})}catch{return{signedMessage:null,signerAddress:"",error:c}}const{signedBlob:N,signerAddress:H}=$;return{signedMessage:N||null,signerAddress:H,error:$?.apiError}})(P,0,R);return k.error?{signedMessage:null,signerAddress:"",error:k.error}:{signedMessage:k.signedMessage,signerAddress:k.signerAddress}}return{signedMessage:null,signerAddress:"",error:a}},S=async(P,R)=>{if(D){const{isAllowed:T}=await h();if(!T){const f=await l();if(f.error)return{signedAuthEntry:null,signerAddress:"",error:f.error}}const k=await(async(f,m,_)=>{const $=(_||{}).address;let x;try{x=await o({entryXdr:f,accountToSign:$,apiVersion:"5.0.0",networkPassphrase:_?.networkPassphrase,type:n.SUBMIT_AUTH_ENTRY})}catch(z){return console.error(z),{signedAuthEntry:null,signerAddress:"",error:c}}const{signedAuthEntry:N,signerAddress:H}=x;return{signedAuthEntry:N||null,signerAddress:H,error:x?.apiError}})(P,0,R);return k.error?{signedAuthEntry:null,signerAddress:"",error:k.error}:{signedAuthEntry:k.signedAuthEntry,signerAddress:k.signerAddress}}return{signedAuthEntry:null,signerAddress:"",error:a}},A=async()=>D?window.freighter?Promise.resolve({isConnected:window.freighter}):(async()=>{let P={isConnected:!1};try{P=await o({type:n.REQUEST_CONNECTION_STATUS})}catch(R){console.error(R)}return{isConnected:P.isConnected}})():{isConnected:!1,error:a},E=async()=>{if(D){const P=await(async()=>{let R;try{R=await o({type:n.REQUEST_NETWORK_DETAILS})}catch(k){console.error(k)}const{networkDetails:T}=R||{networkDetails:{network:"",networkPassphrase:""}};return{network:T?.network,networkPassphrase:T?.networkPassphrase,error:R?.apiError}})();return P.error?{network:"",networkPassphrase:"",error:P.error}:{network:P.network,networkPassphrase:P.networkPassphrase}}return{network:"",networkPassphrase:"",error:a}},v=async()=>{if(D){const P=await d();return P.error?{network:"",networkUrl:"",networkPassphrase:"",error:P.error}:{network:P.network,networkUrl:P.networkUrl,networkPassphrase:P.networkPassphrase,sorobanRpcUrl:P.sorobanRpcUrl}}return{network:"",networkUrl:"",networkPassphrase:"",error:a}},C=async()=>{let P=!1;if(D){const R=await h();return P=R.isAllowed,R.error?{isAllowed:P,error:R.error}:{isAllowed:P}}return{isAllowed:P,error:a}},O=async()=>{let P=!1;if(D){const R=await(async()=>{let T;try{T=await o({type:n.SET_ALLOWED_STATUS})}catch(f){console.error(f)}const{isAllowed:k}=T||{isAllowed:!1};return{isAllowed:k,error:T?.apiError}})();return P=R.isAllowed,R.error?{isAllowed:P,error:R.error}:{isAllowed:P}}return{isAllowed:P,error:a}},L=async()=>{let P="";if(D){const R=await l();return P=R.publicKey,R.error?{address:P,error:R.error}:{address:P}}return{address:P,error:a}};class j{constructor(R=3e3){this.fetchInfo=async T=>{if(!this.isRunning)return;const k=await u(),f=await d();(k.error||f.error)&&T({address:"",network:"",networkPassphrase:"",error:k.error||f.error}),this.currentAddress===k.publicKey&&this.currentNetwork===f.network&&this.currentNetworkPassphrase===f.networkPassphrase||(this.currentAddress=k.publicKey,this.currentNetwork=f.network,this.currentNetworkPassphrase=f.networkPassphrase,T({address:k.publicKey,network:f.network,networkPassphrase:f.networkPassphrase})),setTimeout((()=>this.fetchInfo(T)),this.timeout)},this.timeout=R,this.currentAddress="",this.currentNetwork="",this.currentNetworkPassphrase="",this.isRunning=!1}watch(R){return D?(this.isRunning=!0,this.fetchInfo(R),{}):{error:a}}stop(){this.isRunning=!1}}const D=typeof window<"u",W={getAddress:p,addToken:y,signTransaction:g,signMessage:w,signAuthEntry:S,isConnected:A,getNetwork:E,getNetworkDetails:v,isAllowed:C,setAllowed:O,requestAccess:L,WatchWalletChanges:j};return i})()))})(rp)),rp.exports}var za=c8();new TextEncoder;const w1={base32:new TextEncoder().encode("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),base32hex:new TextEncoder().encode("0123456789ABCDEFGHIJKLMNOPQRSTUV"),base32crockford:new TextEncoder().encode("0123456789ABCDEFGHJKMNPQRSTVWXYZ")},b1={base32:new Uint8Array(128).fill(32),base32hex:new Uint8Array(128).fill(32),base32crockford:new Uint8Array(128).fill(32)};w1.base32.forEach((t,e)=>b1.base32[t]=e);w1.base32hex.forEach((t,e)=>b1.base32hex[t]=e);w1.base32crockford.forEach((t,e)=>b1.base32crockford[t]=e);function l8(t,e){const r=t.length;if(t.byteOffset){const n=new Uint8Array(t.buffer);n.set(t),t=n.subarray(0,r)}return t=new Uint8Array(t.buffer.transfer(e)),t.set(t.subarray(0,r),e-r),[t,e-r]}const u8=new TextEncoder().encode("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),d8=new Uint8Array(128).fill(32);u8.forEach((t,e)=>d8[t]=e);const OC={base64:new TextEncoder().encode("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),base64url:new TextEncoder().encode("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_")},kC={base64:new Uint8Array(128).fill(64),base64url:new Uint8Array(128).fill(64)};OC.base64.forEach((t,e)=>kC.base64[t]=e);OC.base64url.forEach((t,e)=>kC.base64url[t]=e);function h8(t){return((t+2)/3|0)*4}function f8(t,e,r,n,s){for(e+=2;e<t.length;e+=3){const i=t[e-2]<<16|t[e-1]<<8|t[e];t[r++]=n[i>>18],t[r++]=n[i>>12&63],t[r++]=n[i>>6&63],t[r++]=n[i&63]}switch(e){case t.length+1:{const i=t[e-2]<<16;t[r++]=n[i>>18],t[r++]=n[i>>12&63],t[r++]=s,t[r++]=s;break}case t.length:{const i=t[e-2]<<16|t[e-1]<<8;t[r++]=n[i>>18],t[r++]=n[i>>12&63],t[r++]=n[i>>6&63],t[r++]=s;break}}return r}const p8=61,PC=new TextEncoder().encode("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),g8=new Uint8Array(128).fill(64);PC.forEach((t,e)=>g8[t]=e);function IE(t){typeof t=="string"?t=new TextEncoder().encode(t):t instanceof ArrayBuffer?t=new Uint8Array(t).slice():t=t.slice();const[e,r]=l8(t,h8(t.length));return f8(e,r,0,PC,p8),new TextDecoder().decode(e)}const y8=new TextEncoder().encode("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),m8=new Uint8Array(128).fill(64);y8.forEach((t,e)=>m8[t]=e);const w8=new TextEncoder().encode("0123456789abcdef"),RC=new Uint8Array(128).fill(16);w8.forEach((t,e)=>RC[t]=e);new TextEncoder().encode("ABCDEF").forEach((t,e)=>RC[t]=e+10);const b8=new TextEncoder().encode("0123456789abcdef"),DC=new Uint8Array(128).fill(16);b8.forEach((t,e)=>DC[t]=e);new TextEncoder().encode("ABCDEF").forEach((t,e)=>DC[t]=e+10);const v8=new ArrayBuffer(8);new BigUint64Array(v8);const E8="freighter";class _8{moduleType=Bo.HOT_WALLET;productId=E8;productName="Freighter";productUrl="https://freighter.app";productIcon="https://stellar.creit.tech/wallet-icons/freighter.png";async runChecks(){if(!await this.isAvailable())throw new Error("Freighter is not connected")}async isAvailable(){if(window.stellar?.provider==="freighter"&&window.stellar?.platform==="mobile")return!1;try{const e=await za.isConnected();return!e.error&&e.isConnected}catch(e){return console.error(e),!1}}async getAddress(e){try{if(await this.runChecks(),e?.skipRequestAccess!==!0){const s=await za.requestAccess();if(s.error)return Promise.reject(Bt(s.error))}const{address:r,error:n}=await za.getAddress();return n?Promise.reject(n):r?{address:r}:Promise.reject({code:-3,message:"Getting the address from Freighter is not allowed, please request access first."})}catch(r){throw Bt(r)}}async signTransaction(e,r){try{await this.runChecks();const{signedTxXdr:n,signerAddress:s,error:i}=await za.signTransaction(e,{address:r?.address,networkPassphrase:r?.networkPassphrase});return i?Promise.reject(i):{signedTxXdr:n,signerAddress:s}}catch(n){throw Bt(n)}}async signAuthEntry(e,r){try{await this.runChecks();const{signedAuthEntry:n,signerAddress:s,error:i}=await za.signAuthEntry(e,{address:r?.address,networkPassphrase:r?.networkPassphrase});return i?Promise.reject(i):n?{signedAuthEntry:typeof n=="string"?n:IE(new Uint8Array(n)),signerAddress:s}:Promise.reject({code:-3,message:"signedAuthEntry returned from Freighter is undefined."})}catch(n){throw Bt(n)}}async signMessage(e,r){try{await this.runChecks();const{signedMessage:n,signerAddress:s,error:i}=await za.signMessage(e,{address:r?.address,networkPassphrase:r?.networkPassphrase});return i?Promise.reject(i):n?{signedMessage:typeof n=="string"?n:IE(new Uint8Array(n)),signerAddress:s}:Promise.reject({code:-3,message:"signedMessage returned from Freighter is undefined."})}catch(n){throw Bt(n)}}async getNetwork(){try{await this.runChecks();const{network:e,networkPassphrase:r,error:n}=await za.getNetwork();return n?Promise.reject(n):{network:e,networkPassphrase:r}}catch(e){throw Bt(e)}}}var np={exports:{}},x8=np.exports,CE;function S8(){return CE||(CE=1,(function(t,e){(function(r,n){t.exports=n()})(x8,()=>(()=>{var r={d:(g,w)=>{for(var S in w)r.o(w,S)&&!r.o(g,S)&&Object.defineProperty(g,S,{enumerable:!0,get:w[S]})},o:(g,w)=>Object.prototype.hasOwnProperty.call(g,w),r:g=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(g,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(g,"__esModule",{value:!0})}},n={};r.r(n),r.d(n,{default:()=>y,getPublicKey:()=>l,isBrowser:()=>p,isConnected:()=>d,signMessage:()=>h,signTransaction:()=>u});let s=(function(g){return g[g.V1=0]="V1",g[g.V2=1]="V2",g})({}),i=(function(g){return g.REQUEST_ACCESS="REQUEST_ACCESS",g.SIGN="SIGN",g.SUBMIT_TRANSACTION="SUBMIT_TRANSACTION",g.SIGN_TRANSACTION="SIGN_TRANSACTION",g.REQUEST_CONNECTION_STATUS="REQUEST_CONNECTION_STATUS",g})({});const o="LOBSTR_CONNECTION_KEY",a=g=>{const w=Date.now()+Math.random();return window.postMessage({source:"LOBSTR_EXTERNAL_MSG_REQUEST",messageId:w,...g},window.location.origin),new Promise(S=>{let A=0;g.type===i.REQUEST_CONNECTION_STATUS&&(A=setTimeout(()=>{S({isConnected:!1}),window.removeEventListener("message",E)},2e3));const E=v=>{var C,O;v.source===window&&(v==null||(C=v.data)===null||C===void 0?void 0:C.source)==="LOBSTR_EXTERNAL_MSG_RESPONSE"&&(v==null||(O=v.data)===null||O===void 0?void 0:O.messagedId)===w&&(S(v.data),window.removeEventListener("message",E),clearTimeout(A))};window.addEventListener("message",E,!1)})},c=async(g,w,S)=>{let A={signedData:"",error:"",signerAddress:""};try{A=await a({dataToSign:g,connectionKey:w,signType:S,type:i.SIGN,version:s.V2})}catch(E){throw console.error(E),E}if(A.error)throw A.error;return A},l=async()=>{if(!p)return"";const{publicKey:g,connectionKey:w}=await(async()=>{let S={publicKey:"",error:"",connectionKey:""};try{S=await a({type:i.REQUEST_ACCESS,version:s.V2})}catch(C){console.error(C)}const{publicKey:A,connectionKey:E,error:v}=S;if(v)throw v;return{publicKey:A,connectionKey:E}})();return(S=>{var A,E;(A=window)===null||A===void 0||(E=A.sessionStorage)===null||E===void 0||E.setItem(o,S)})(w),g},u=async g=>{if(!p)return Promise.resolve("");const w=((S=window)===null||S===void 0||(A=S.sessionStorage)===null||A===void 0?void 0:A.getItem(o))||"";var S,A;return(await c(g,w,"transaction")).signedData},d=async()=>!!p&&(window.lobstrSignerExtension?window.lobstrSignerExtension:await(async()=>{let g={isConnected:!1};try{g=await a({type:i.REQUEST_CONNECTION_STATUS,version:s.V2})}catch(w){console.error(w)}return g.isConnected})()),h=async g=>{if(!p)return Promise.resolve(null);const w=((S=window)===null||S===void 0||(A=S.sessionStorage)===null||A===void 0?void 0:A.getItem(o))||"";var S,A;const E=await c(g,w,"message");return{signedMessage:E.signedData,signerAddress:E.signerAddress}},p=typeof window<"u",y={getPublicKey:l,signTransaction:u,isConnected:d,signMessage:h};return n})())})(np)),np.exports}var of=S8();const A8="lobstr";class I8{moduleType=Bo.HOT_WALLET;productId=A8;productName="LOBSTR";productUrl="https://lobstr.co";productIcon="https://stellar.creit.tech/wallet-icons/lobstr.png";async runChecks(){if(!await this.isAvailable())throw new Error("Lobstr is not connected")}async isAvailable(){return of.isConnected()}async getAddress(){try{return await this.runChecks(),{address:await of.getPublicKey()}}catch(e){throw Bt(e)}}async signTransaction(e,r){r?.address&&console.warn("Lobstr doesn't allow specifying what public key should sign the transaction, we skip the value"),r?.networkPassphrase&&console.warn("Lobstr doesn't allow specifying the network that should be used, we skip the value");try{return await this.runChecks(),{signedTxXdr:await of.signTransaction(e)}}catch(n){throw Bt(n)}}async signMessage(e,r){r?.address&&console.warn("Lobstr doesn't allow specifying what public key should sign the transaction, we skip the value"),r?.networkPassphrase&&console.warn("Lobstr doesn't allow specifying the network that should be used, we skip the value");try{await this.runChecks();const n=await of.signMessage(e);if(!n)throw new Error("Signing message failed");return n}catch(n){throw Bt(n)}}signAuthEntry(){return Promise.reject({code:-3,message:'Lobstr does not support the "signAuthEntry" function'})}getNetwork(){return Promise.reject({code:-3,message:'Lobstr does not support the "getNetwork" function'})}}const C8="rabet";class $8{moduleType=Bo.HOT_WALLET;productId=C8;productName="Rabet";productUrl="https://rabet.io/";productIcon="https://stellar.creit.tech/wallet-icons/rabet.png";async runChecks(){if(!await this.isAvailable())throw new Error("Rabet is not installed")}isAvailable(){return new Promise(e=>{setTimeout(()=>{e(typeof window<"u"&&!!window.rabet)},100)})}async getAddress(){try{await this.runChecks();const{publicKey:e}=await window.rabet.connect();return{address:e}}catch(e){throw Bt(e)}}async signTransaction(e,r){if(r?.networkPassphrase&&r.networkPassphrase!==Sa.PUBLIC&&r.networkPassphrase!==Sa.TESTNET)throw new Error(`Rabet doesn't support the network: ${r.networkPassphrase}`);r?.address&&console.warn("Rabet doesn't allow specifying the network that should be used, we skip the value");try{return await this.runChecks(),{signedTxXdr:(await window.rabet.sign(e,r?.networkPassphrase===Sa.PUBLIC?$E.PUBLIC:$E.TESTNET))?.xdr}}catch(n){throw Bt(n)}}signAuthEntry(){return Promise.reject({code:-3,message:'Rabet does not support the "signAuthEntry" function'})}signMessage(){return Promise.reject({code:-3,message:'Rabet does not support the "signMessage" function'})}getNetwork(){return Promise.reject({code:-3,message:'Rabet does not support the "getNetwork" function'})}}var $E=(function(t){return t.PUBLIC="mainnet",t.TESTNET="testnet",t})({});function T8(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var jy={exports:{}};const N8={},O8=Object.freeze(Object.defineProperty({__proto__:null,default:N8},Symbol.toStringTag,{value:"Module"})),k8=m1(O8);var TE;function P8(){return TE||(TE=1,(function(t){(function(e){var r=function(I){var B,U=new Float64Array(16);if(I)for(B=0;B<I.length;B++)U[B]=I[B];return U},n=function(){throw new Error("no PRNG")},s=new Uint8Array(16),i=new Uint8Array(32);i[0]=9;var o=r(),a=r([1]),c=r([56129,1]),l=r([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),u=r([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),d=r([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),h=r([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),p=r([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function y(I,B,U,b){I[B]=U>>24&255,I[B+1]=U>>16&255,I[B+2]=U>>8&255,I[B+3]=U&255,I[B+4]=b>>24&255,I[B+5]=b>>16&255,I[B+6]=b>>8&255,I[B+7]=b&255}function g(I,B,U,b,F){var Y,Z=0;for(Y=0;Y<F;Y++)Z|=I[B+Y]^U[b+Y];return(1&Z-1>>>8)-1}function w(I,B,U,b){return g(I,B,U,b,16)}function S(I,B,U,b){return g(I,B,U,b,32)}function A(I,B,U,b){for(var F=b[0]&255|(b[1]&255)<<8|(b[2]&255)<<16|(b[3]&255)<<24,Y=U[0]&255|(U[1]&255)<<8|(U[2]&255)<<16|(U[3]&255)<<24,Z=U[4]&255|(U[5]&255)<<8|(U[6]&255)<<16|(U[7]&255)<<24,oe=U[8]&255|(U[9]&255)<<8|(U[10]&255)<<16|(U[11]&255)<<24,pe=U[12]&255|(U[13]&255)<<8|(U[14]&255)<<16|(U[15]&255)<<24,Re=b[4]&255|(b[5]&255)<<8|(b[6]&255)<<16|(b[7]&255)<<24,Ce=B[0]&255|(B[1]&255)<<8|(B[2]&255)<<16|(B[3]&255)<<24,wt=B[4]&255|(B[5]&255)<<8|(B[6]&255)<<16|(B[7]&255)<<24,Te=B[8]&255|(B[9]&255)<<8|(B[10]&255)<<16|(B[11]&255)<<24,We=B[12]&255|(B[13]&255)<<8|(B[14]&255)<<16|(B[15]&255)<<24,Ke=b[8]&255|(b[9]&255)<<8|(b[10]&255)<<16|(b[11]&255)<<24,et=U[16]&255|(U[17]&255)<<8|(U[18]&255)<<16|(U[19]&255)<<24,Qe=U[20]&255|(U[21]&255)<<8|(U[22]&255)<<16|(U[23]&255)<<24,Ge=U[24]&255|(U[25]&255)<<8|(U[26]&255)<<16|(U[27]&255)<<24,Je=U[28]&255|(U[29]&255)<<8|(U[30]&255)<<16|(U[31]&255)<<24,Ye=b[12]&255|(b[13]&255)<<8|(b[14]&255)<<16|(b[15]&255)<<24,Oe=F,je=Y,$e=Z,ke=oe,Pe=pe,xe=Re,Q=Ce,ee=wt,ce=Te,ie=We,ae=Ke,he=et,ze=Qe,tt=Ge,nt=Je,rt=Ye,K,at=0;at<20;at+=2)K=Oe+ze|0,Pe^=K<<7|K>>>25,K=Pe+Oe|0,ce^=K<<9|K>>>23,K=ce+Pe|0,ze^=K<<13|K>>>19,K=ze+ce|0,Oe^=K<<18|K>>>14,K=xe+je|0,ie^=K<<7|K>>>25,K=ie+xe|0,tt^=K<<9|K>>>23,K=tt+ie|0,je^=K<<13|K>>>19,K=je+tt|0,xe^=K<<18|K>>>14,K=ae+Q|0,nt^=K<<7|K>>>25,K=nt+ae|0,$e^=K<<9|K>>>23,K=$e+nt|0,Q^=K<<13|K>>>19,K=Q+$e|0,ae^=K<<18|K>>>14,K=rt+he|0,ke^=K<<7|K>>>25,K=ke+rt|0,ee^=K<<9|K>>>23,K=ee+ke|0,he^=K<<13|K>>>19,K=he+ee|0,rt^=K<<18|K>>>14,K=Oe+ke|0,je^=K<<7|K>>>25,K=je+Oe|0,$e^=K<<9|K>>>23,K=$e+je|0,ke^=K<<13|K>>>19,K=ke+$e|0,Oe^=K<<18|K>>>14,K=xe+Pe|0,Q^=K<<7|K>>>25,K=Q+xe|0,ee^=K<<9|K>>>23,K=ee+Q|0,Pe^=K<<13|K>>>19,K=Pe+ee|0,xe^=K<<18|K>>>14,K=ae+ie|0,he^=K<<7|K>>>25,K=he+ae|0,ce^=K<<9|K>>>23,K=ce+he|0,ie^=K<<13|K>>>19,K=ie+ce|0,ae^=K<<18|K>>>14,K=rt+nt|0,ze^=K<<7|K>>>25,K=ze+rt|0,tt^=K<<9|K>>>23,K=tt+ze|0,nt^=K<<13|K>>>19,K=nt+tt|0,rt^=K<<18|K>>>14;Oe=Oe+F|0,je=je+Y|0,$e=$e+Z|0,ke=ke+oe|0,Pe=Pe+pe|0,xe=xe+Re|0,Q=Q+Ce|0,ee=ee+wt|0,ce=ce+Te|0,ie=ie+We|0,ae=ae+Ke|0,he=he+et|0,ze=ze+Qe|0,tt=tt+Ge|0,nt=nt+Je|0,rt=rt+Ye|0,I[0]=Oe>>>0&255,I[1]=Oe>>>8&255,I[2]=Oe>>>16&255,I[3]=Oe>>>24&255,I[4]=je>>>0&255,I[5]=je>>>8&255,I[6]=je>>>16&255,I[7]=je>>>24&255,I[8]=$e>>>0&255,I[9]=$e>>>8&255,I[10]=$e>>>16&255,I[11]=$e>>>24&255,I[12]=ke>>>0&255,I[13]=ke>>>8&255,I[14]=ke>>>16&255,I[15]=ke>>>24&255,I[16]=Pe>>>0&255,I[17]=Pe>>>8&255,I[18]=Pe>>>16&255,I[19]=Pe>>>24&255,I[20]=xe>>>0&255,I[21]=xe>>>8&255,I[22]=xe>>>16&255,I[23]=xe>>>24&255,I[24]=Q>>>0&255,I[25]=Q>>>8&255,I[26]=Q>>>16&255,I[27]=Q>>>24&255,I[28]=ee>>>0&255,I[29]=ee>>>8&255,I[30]=ee>>>16&255,I[31]=ee>>>24&255,I[32]=ce>>>0&255,I[33]=ce>>>8&255,I[34]=ce>>>16&255,I[35]=ce>>>24&255,I[36]=ie>>>0&255,I[37]=ie>>>8&255,I[38]=ie>>>16&255,I[39]=ie>>>24&255,I[40]=ae>>>0&255,I[41]=ae>>>8&255,I[42]=ae>>>16&255,I[43]=ae>>>24&255,I[44]=he>>>0&255,I[45]=he>>>8&255,I[46]=he>>>16&255,I[47]=he>>>24&255,I[48]=ze>>>0&255,I[49]=ze>>>8&255,I[50]=ze>>>16&255,I[51]=ze>>>24&255,I[52]=tt>>>0&255,I[53]=tt>>>8&255,I[54]=tt>>>16&255,I[55]=tt>>>24&255,I[56]=nt>>>0&255,I[57]=nt>>>8&255,I[58]=nt>>>16&255,I[59]=nt>>>24&255,I[60]=rt>>>0&255,I[61]=rt>>>8&255,I[62]=rt>>>16&255,I[63]=rt>>>24&255}function E(I,B,U,b){for(var F=b[0]&255|(b[1]&255)<<8|(b[2]&255)<<16|(b[3]&255)<<24,Y=U[0]&255|(U[1]&255)<<8|(U[2]&255)<<16|(U[3]&255)<<24,Z=U[4]&255|(U[5]&255)<<8|(U[6]&255)<<16|(U[7]&255)<<24,oe=U[8]&255|(U[9]&255)<<8|(U[10]&255)<<16|(U[11]&255)<<24,pe=U[12]&255|(U[13]&255)<<8|(U[14]&255)<<16|(U[15]&255)<<24,Re=b[4]&255|(b[5]&255)<<8|(b[6]&255)<<16|(b[7]&255)<<24,Ce=B[0]&255|(B[1]&255)<<8|(B[2]&255)<<16|(B[3]&255)<<24,wt=B[4]&255|(B[5]&255)<<8|(B[6]&255)<<16|(B[7]&255)<<24,Te=B[8]&255|(B[9]&255)<<8|(B[10]&255)<<16|(B[11]&255)<<24,We=B[12]&255|(B[13]&255)<<8|(B[14]&255)<<16|(B[15]&255)<<24,Ke=b[8]&255|(b[9]&255)<<8|(b[10]&255)<<16|(b[11]&255)<<24,et=U[16]&255|(U[17]&255)<<8|(U[18]&255)<<16|(U[19]&255)<<24,Qe=U[20]&255|(U[21]&255)<<8|(U[22]&255)<<16|(U[23]&255)<<24,Ge=U[24]&255|(U[25]&255)<<8|(U[26]&255)<<16|(U[27]&255)<<24,Je=U[28]&255|(U[29]&255)<<8|(U[30]&255)<<16|(U[31]&255)<<24,Ye=b[12]&255|(b[13]&255)<<8|(b[14]&255)<<16|(b[15]&255)<<24,Oe=F,je=Y,$e=Z,ke=oe,Pe=pe,xe=Re,Q=Ce,ee=wt,ce=Te,ie=We,ae=Ke,he=et,ze=Qe,tt=Ge,nt=Je,rt=Ye,K,at=0;at<20;at+=2)K=Oe+ze|0,Pe^=K<<7|K>>>25,K=Pe+Oe|0,ce^=K<<9|K>>>23,K=ce+Pe|0,ze^=K<<13|K>>>19,K=ze+ce|0,Oe^=K<<18|K>>>14,K=xe+je|0,ie^=K<<7|K>>>25,K=ie+xe|0,tt^=K<<9|K>>>23,K=tt+ie|0,je^=K<<13|K>>>19,K=je+tt|0,xe^=K<<18|K>>>14,K=ae+Q|0,nt^=K<<7|K>>>25,K=nt+ae|0,$e^=K<<9|K>>>23,K=$e+nt|0,Q^=K<<13|K>>>19,K=Q+$e|0,ae^=K<<18|K>>>14,K=rt+he|0,ke^=K<<7|K>>>25,K=ke+rt|0,ee^=K<<9|K>>>23,K=ee+ke|0,he^=K<<13|K>>>19,K=he+ee|0,rt^=K<<18|K>>>14,K=Oe+ke|0,je^=K<<7|K>>>25,K=je+Oe|0,$e^=K<<9|K>>>23,K=$e+je|0,ke^=K<<13|K>>>19,K=ke+$e|0,Oe^=K<<18|K>>>14,K=xe+Pe|0,Q^=K<<7|K>>>25,K=Q+xe|0,ee^=K<<9|K>>>23,K=ee+Q|0,Pe^=K<<13|K>>>19,K=Pe+ee|0,xe^=K<<18|K>>>14,K=ae+ie|0,he^=K<<7|K>>>25,K=he+ae|0,ce^=K<<9|K>>>23,K=ce+he|0,ie^=K<<13|K>>>19,K=ie+ce|0,ae^=K<<18|K>>>14,K=rt+nt|0,ze^=K<<7|K>>>25,K=ze+rt|0,tt^=K<<9|K>>>23,K=tt+ze|0,nt^=K<<13|K>>>19,K=nt+tt|0,rt^=K<<18|K>>>14;I[0]=Oe>>>0&255,I[1]=Oe>>>8&255,I[2]=Oe>>>16&255,I[3]=Oe>>>24&255,I[4]=xe>>>0&255,I[5]=xe>>>8&255,I[6]=xe>>>16&255,I[7]=xe>>>24&255,I[8]=ae>>>0&255,I[9]=ae>>>8&255,I[10]=ae>>>16&255,I[11]=ae>>>24&255,I[12]=rt>>>0&255,I[13]=rt>>>8&255,I[14]=rt>>>16&255,I[15]=rt>>>24&255,I[16]=Q>>>0&255,I[17]=Q>>>8&255,I[18]=Q>>>16&255,I[19]=Q>>>24&255,I[20]=ee>>>0&255,I[21]=ee>>>8&255,I[22]=ee>>>16&255,I[23]=ee>>>24&255,I[24]=ce>>>0&255,I[25]=ce>>>8&255,I[26]=ce>>>16&255,I[27]=ce>>>24&255,I[28]=ie>>>0&255,I[29]=ie>>>8&255,I[30]=ie>>>16&255,I[31]=ie>>>24&255}function v(I,B,U,b){A(I,B,U,b)}function C(I,B,U,b){E(I,B,U,b)}var O=new Uint8Array([101,120,112,97,110,100,32,51,50,45,98,121,116,101,32,107]);function L(I,B,U,b,F,Y,Z){var oe=new Uint8Array(16),pe=new Uint8Array(64),Re,Ce;for(Ce=0;Ce<16;Ce++)oe[Ce]=0;for(Ce=0;Ce<8;Ce++)oe[Ce]=Y[Ce];for(;F>=64;){for(v(pe,oe,Z,O),Ce=0;Ce<64;Ce++)I[B+Ce]=U[b+Ce]^pe[Ce];for(Re=1,Ce=8;Ce<16;Ce++)Re=Re+(oe[Ce]&255)|0,oe[Ce]=Re&255,Re>>>=8;F-=64,B+=64,b+=64}if(F>0)for(v(pe,oe,Z,O),Ce=0;Ce<F;Ce++)I[B+Ce]=U[b+Ce]^pe[Ce];return 0}function j(I,B,U,b,F){var Y=new Uint8Array(16),Z=new Uint8Array(64),oe,pe;for(pe=0;pe<16;pe++)Y[pe]=0;for(pe=0;pe<8;pe++)Y[pe]=b[pe];for(;U>=64;){for(v(Z,Y,F,O),pe=0;pe<64;pe++)I[B+pe]=Z[pe];for(oe=1,pe=8;pe<16;pe++)oe=oe+(Y[pe]&255)|0,Y[pe]=oe&255,oe>>>=8;U-=64,B+=64}if(U>0)for(v(Z,Y,F,O),pe=0;pe<U;pe++)I[B+pe]=Z[pe];return 0}function D(I,B,U,b,F){var Y=new Uint8Array(32);C(Y,b,F,O);for(var Z=new Uint8Array(8),oe=0;oe<8;oe++)Z[oe]=b[oe+16];return j(I,B,U,Z,Y)}function W(I,B,U,b,F,Y,Z){var oe=new Uint8Array(32);C(oe,Y,Z,O);for(var pe=new Uint8Array(8),Re=0;Re<8;Re++)pe[Re]=Y[Re+16];return L(I,B,U,b,F,pe,oe)}var P=function(I){this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.leftover=0,this.fin=0;var B,U,b,F,Y,Z,oe,pe;B=I[0]&255|(I[1]&255)<<8,this.r[0]=B&8191,U=I[2]&255|(I[3]&255)<<8,this.r[1]=(B>>>13|U<<3)&8191,b=I[4]&255|(I[5]&255)<<8,this.r[2]=(U>>>10|b<<6)&7939,F=I[6]&255|(I[7]&255)<<8,this.r[3]=(b>>>7|F<<9)&8191,Y=I[8]&255|(I[9]&255)<<8,this.r[4]=(F>>>4|Y<<12)&255,this.r[5]=Y>>>1&8190,Z=I[10]&255|(I[11]&255)<<8,this.r[6]=(Y>>>14|Z<<2)&8191,oe=I[12]&255|(I[13]&255)<<8,this.r[7]=(Z>>>11|oe<<5)&8065,pe=I[14]&255|(I[15]&255)<<8,this.r[8]=(oe>>>8|pe<<8)&8191,this.r[9]=pe>>>5&127,this.pad[0]=I[16]&255|(I[17]&255)<<8,this.pad[1]=I[18]&255|(I[19]&255)<<8,this.pad[2]=I[20]&255|(I[21]&255)<<8,this.pad[3]=I[22]&255|(I[23]&255)<<8,this.pad[4]=I[24]&255|(I[25]&255)<<8,this.pad[5]=I[26]&255|(I[27]&255)<<8,this.pad[6]=I[28]&255|(I[29]&255)<<8,this.pad[7]=I[30]&255|(I[31]&255)<<8};P.prototype.blocks=function(I,B,U){for(var b=this.fin?0:2048,F,Y,Z,oe,pe,Re,Ce,wt,Te,We,Ke,et,Qe,Ge,Je,Ye,Oe,je,$e,ke=this.h[0],Pe=this.h[1],xe=this.h[2],Q=this.h[3],ee=this.h[4],ce=this.h[5],ie=this.h[6],ae=this.h[7],he=this.h[8],ze=this.h[9],tt=this.r[0],nt=this.r[1],rt=this.r[2],K=this.r[3],at=this.r[4],bt=this.r[5],vt=this.r[6],st=this.r[7],pt=this.r[8],gt=this.r[9];U>=16;)F=I[B+0]&255|(I[B+1]&255)<<8,ke+=F&8191,Y=I[B+2]&255|(I[B+3]&255)<<8,Pe+=(F>>>13|Y<<3)&8191,Z=I[B+4]&255|(I[B+5]&255)<<8,xe+=(Y>>>10|Z<<6)&8191,oe=I[B+6]&255|(I[B+7]&255)<<8,Q+=(Z>>>7|oe<<9)&8191,pe=I[B+8]&255|(I[B+9]&255)<<8,ee+=(oe>>>4|pe<<12)&8191,ce+=pe>>>1&8191,Re=I[B+10]&255|(I[B+11]&255)<<8,ie+=(pe>>>14|Re<<2)&8191,Ce=I[B+12]&255|(I[B+13]&255)<<8,ae+=(Re>>>11|Ce<<5)&8191,wt=I[B+14]&255|(I[B+15]&255)<<8,he+=(Ce>>>8|wt<<8)&8191,ze+=wt>>>5|b,Te=0,We=Te,We+=ke*tt,We+=Pe*(5*gt),We+=xe*(5*pt),We+=Q*(5*st),We+=ee*(5*vt),Te=We>>>13,We&=8191,We+=ce*(5*bt),We+=ie*(5*at),We+=ae*(5*K),We+=he*(5*rt),We+=ze*(5*nt),Te+=We>>>13,We&=8191,Ke=Te,Ke+=ke*nt,Ke+=Pe*tt,Ke+=xe*(5*gt),Ke+=Q*(5*pt),Ke+=ee*(5*st),Te=Ke>>>13,Ke&=8191,Ke+=ce*(5*vt),Ke+=ie*(5*bt),Ke+=ae*(5*at),Ke+=he*(5*K),Ke+=ze*(5*rt),Te+=Ke>>>13,Ke&=8191,et=Te,et+=ke*rt,et+=Pe*nt,et+=xe*tt,et+=Q*(5*gt),et+=ee*(5*pt),Te=et>>>13,et&=8191,et+=ce*(5*st),et+=ie*(5*vt),et+=ae*(5*bt),et+=he*(5*at),et+=ze*(5*K),Te+=et>>>13,et&=8191,Qe=Te,Qe+=ke*K,Qe+=Pe*rt,Qe+=xe*nt,Qe+=Q*tt,Qe+=ee*(5*gt),Te=Qe>>>13,Qe&=8191,Qe+=ce*(5*pt),Qe+=ie*(5*st),Qe+=ae*(5*vt),Qe+=he*(5*bt),Qe+=ze*(5*at),Te+=Qe>>>13,Qe&=8191,Ge=Te,Ge+=ke*at,Ge+=Pe*K,Ge+=xe*rt,Ge+=Q*nt,Ge+=ee*tt,Te=Ge>>>13,Ge&=8191,Ge+=ce*(5*gt),Ge+=ie*(5*pt),Ge+=ae*(5*st),Ge+=he*(5*vt),Ge+=ze*(5*bt),Te+=Ge>>>13,Ge&=8191,Je=Te,Je+=ke*bt,Je+=Pe*at,Je+=xe*K,Je+=Q*rt,Je+=ee*nt,Te=Je>>>13,Je&=8191,Je+=ce*tt,Je+=ie*(5*gt),Je+=ae*(5*pt),Je+=he*(5*st),Je+=ze*(5*vt),Te+=Je>>>13,Je&=8191,Ye=Te,Ye+=ke*vt,Ye+=Pe*bt,Ye+=xe*at,Ye+=Q*K,Ye+=ee*rt,Te=Ye>>>13,Ye&=8191,Ye+=ce*nt,Ye+=ie*tt,Ye+=ae*(5*gt),Ye+=he*(5*pt),Ye+=ze*(5*st),Te+=Ye>>>13,Ye&=8191,Oe=Te,Oe+=ke*st,Oe+=Pe*vt,Oe+=xe*bt,Oe+=Q*at,Oe+=ee*K,Te=Oe>>>13,Oe&=8191,Oe+=ce*rt,Oe+=ie*nt,Oe+=ae*tt,Oe+=he*(5*gt),Oe+=ze*(5*pt),Te+=Oe>>>13,Oe&=8191,je=Te,je+=ke*pt,je+=Pe*st,je+=xe*vt,je+=Q*bt,je+=ee*at,Te=je>>>13,je&=8191,je+=ce*K,je+=ie*rt,je+=ae*nt,je+=he*tt,je+=ze*(5*gt),Te+=je>>>13,je&=8191,$e=Te,$e+=ke*gt,$e+=Pe*pt,$e+=xe*st,$e+=Q*vt,$e+=ee*bt,Te=$e>>>13,$e&=8191,$e+=ce*at,$e+=ie*K,$e+=ae*rt,$e+=he*nt,$e+=ze*tt,Te+=$e>>>13,$e&=8191,Te=(Te<<2)+Te|0,Te=Te+We|0,We=Te&8191,Te=Te>>>13,Ke+=Te,ke=We,Pe=Ke,xe=et,Q=Qe,ee=Ge,ce=Je,ie=Ye,ae=Oe,he=je,ze=$e,B+=16,U-=16;this.h[0]=ke,this.h[1]=Pe,this.h[2]=xe,this.h[3]=Q,this.h[4]=ee,this.h[5]=ce,this.h[6]=ie,this.h[7]=ae,this.h[8]=he,this.h[9]=ze},P.prototype.finish=function(I,B){var U=new Uint16Array(10),b,F,Y,Z;if(this.leftover){for(Z=this.leftover,this.buffer[Z++]=1;Z<16;Z++)this.buffer[Z]=0;this.fin=1,this.blocks(this.buffer,0,16)}for(b=this.h[1]>>>13,this.h[1]&=8191,Z=2;Z<10;Z++)this.h[Z]+=b,b=this.h[Z]>>>13,this.h[Z]&=8191;for(this.h[0]+=b*5,b=this.h[0]>>>13,this.h[0]&=8191,this.h[1]+=b,b=this.h[1]>>>13,this.h[1]&=8191,this.h[2]+=b,U[0]=this.h[0]+5,b=U[0]>>>13,U[0]&=8191,Z=1;Z<10;Z++)U[Z]=this.h[Z]+b,b=U[Z]>>>13,U[Z]&=8191;for(U[9]-=8192,F=(b^1)-1,Z=0;Z<10;Z++)U[Z]&=F;for(F=~F,Z=0;Z<10;Z++)this.h[Z]=this.h[Z]&F|U[Z];for(this.h[0]=(this.h[0]|this.h[1]<<13)&65535,this.h[1]=(this.h[1]>>>3|this.h[2]<<10)&65535,this.h[2]=(this.h[2]>>>6|this.h[3]<<7)&65535,this.h[3]=(this.h[3]>>>9|this.h[4]<<4)&65535,this.h[4]=(this.h[4]>>>12|this.h[5]<<1|this.h[6]<<14)&65535,this.h[5]=(this.h[6]>>>2|this.h[7]<<11)&65535,this.h[6]=(this.h[7]>>>5|this.h[8]<<8)&65535,this.h[7]=(this.h[8]>>>8|this.h[9]<<5)&65535,Y=this.h[0]+this.pad[0],this.h[0]=Y&65535,Z=1;Z<8;Z++)Y=(this.h[Z]+this.pad[Z]|0)+(Y>>>16)|0,this.h[Z]=Y&65535;I[B+0]=this.h[0]>>>0&255,I[B+1]=this.h[0]>>>8&255,I[B+2]=this.h[1]>>>0&255,I[B+3]=this.h[1]>>>8&255,I[B+4]=this.h[2]>>>0&255,I[B+5]=this.h[2]>>>8&255,I[B+6]=this.h[3]>>>0&255,I[B+7]=this.h[3]>>>8&255,I[B+8]=this.h[4]>>>0&255,I[B+9]=this.h[4]>>>8&255,I[B+10]=this.h[5]>>>0&255,I[B+11]=this.h[5]>>>8&255,I[B+12]=this.h[6]>>>0&255,I[B+13]=this.h[6]>>>8&255,I[B+14]=this.h[7]>>>0&255,I[B+15]=this.h[7]>>>8&255},P.prototype.update=function(I,B,U){var b,F;if(this.leftover){for(F=16-this.leftover,F>U&&(F=U),b=0;b<F;b++)this.buffer[this.leftover+b]=I[B+b];if(U-=F,B+=F,this.leftover+=F,this.leftover<16)return;this.blocks(this.buffer,0,16),this.leftover=0}if(U>=16&&(F=U-U%16,this.blocks(I,B,F),B+=F,U-=F),U){for(b=0;b<U;b++)this.buffer[this.leftover+b]=I[B+b];this.leftover+=U}};function R(I,B,U,b,F,Y){var Z=new P(Y);return Z.update(U,b,F),Z.finish(I,B),0}function T(I,B,U,b,F,Y){var Z=new Uint8Array(16);return R(Z,0,U,b,F,Y),w(I,B,Z,0)}function k(I,B,U,b,F){var Y;if(U<32)return-1;for(W(I,0,B,0,U,b,F),R(I,16,I,32,U-32,I),Y=0;Y<16;Y++)I[Y]=0;return 0}function f(I,B,U,b,F){var Y,Z=new Uint8Array(32);if(U<32||(D(Z,0,32,b,F),T(B,16,B,32,U-32,Z)!==0))return-1;for(W(I,0,B,0,U,b,F),Y=0;Y<32;Y++)I[Y]=0;return 0}function m(I,B){var U;for(U=0;U<16;U++)I[U]=B[U]|0}function _(I){var B,U,b=1;for(B=0;B<16;B++)U=I[B]+b+65535,b=Math.floor(U/65536),I[B]=U-b*65536;I[0]+=b-1+37*(b-1)}function $(I,B,U){for(var b,F=~(U-1),Y=0;Y<16;Y++)b=F&(I[Y]^B[Y]),I[Y]^=b,B[Y]^=b}function x(I,B){var U,b,F,Y=r(),Z=r();for(U=0;U<16;U++)Z[U]=B[U];for(_(Z),_(Z),_(Z),b=0;b<2;b++){for(Y[0]=Z[0]-65517,U=1;U<15;U++)Y[U]=Z[U]-65535-(Y[U-1]>>16&1),Y[U-1]&=65535;Y[15]=Z[15]-32767-(Y[14]>>16&1),F=Y[15]>>16&1,Y[14]&=65535,$(Z,Y,1-F)}for(U=0;U<16;U++)I[2*U]=Z[U]&255,I[2*U+1]=Z[U]>>8}function N(I,B){var U=new Uint8Array(32),b=new Uint8Array(32);return x(U,I),x(b,B),S(U,0,b,0)}function H(I){var B=new Uint8Array(32);return x(B,I),B[0]&1}function z(I,B){var U;for(U=0;U<16;U++)I[U]=B[2*U]+(B[2*U+1]<<8);I[15]&=32767}function G(I,B,U){for(var b=0;b<16;b++)I[b]=B[b]+U[b]}function M(I,B,U){for(var b=0;b<16;b++)I[b]=B[b]-U[b]}function V(I,B,U){var b,F,Y=0,Z=0,oe=0,pe=0,Re=0,Ce=0,wt=0,Te=0,We=0,Ke=0,et=0,Qe=0,Ge=0,Je=0,Ye=0,Oe=0,je=0,$e=0,ke=0,Pe=0,xe=0,Q=0,ee=0,ce=0,ie=0,ae=0,he=0,ze=0,tt=0,nt=0,rt=0,K=U[0],at=U[1],bt=U[2],vt=U[3],st=U[4],pt=U[5],gt=U[6],hr=U[7],Rt=U[8],ir=U[9],or=U[10],ar=U[11],Cr=U[12],pn=U[13],gn=U[14],yn=U[15];b=B[0],Y+=b*K,Z+=b*at,oe+=b*bt,pe+=b*vt,Re+=b*st,Ce+=b*pt,wt+=b*gt,Te+=b*hr,We+=b*Rt,Ke+=b*ir,et+=b*or,Qe+=b*ar,Ge+=b*Cr,Je+=b*pn,Ye+=b*gn,Oe+=b*yn,b=B[1],Z+=b*K,oe+=b*at,pe+=b*bt,Re+=b*vt,Ce+=b*st,wt+=b*pt,Te+=b*gt,We+=b*hr,Ke+=b*Rt,et+=b*ir,Qe+=b*or,Ge+=b*ar,Je+=b*Cr,Ye+=b*pn,Oe+=b*gn,je+=b*yn,b=B[2],oe+=b*K,pe+=b*at,Re+=b*bt,Ce+=b*vt,wt+=b*st,Te+=b*pt,We+=b*gt,Ke+=b*hr,et+=b*Rt,Qe+=b*ir,Ge+=b*or,Je+=b*ar,Ye+=b*Cr,Oe+=b*pn,je+=b*gn,$e+=b*yn,b=B[3],pe+=b*K,Re+=b*at,Ce+=b*bt,wt+=b*vt,Te+=b*st,We+=b*pt,Ke+=b*gt,et+=b*hr,Qe+=b*Rt,Ge+=b*ir,Je+=b*or,Ye+=b*ar,Oe+=b*Cr,je+=b*pn,$e+=b*gn,ke+=b*yn,b=B[4],Re+=b*K,Ce+=b*at,wt+=b*bt,Te+=b*vt,We+=b*st,Ke+=b*pt,et+=b*gt,Qe+=b*hr,Ge+=b*Rt,Je+=b*ir,Ye+=b*or,Oe+=b*ar,je+=b*Cr,$e+=b*pn,ke+=b*gn,Pe+=b*yn,b=B[5],Ce+=b*K,wt+=b*at,Te+=b*bt,We+=b*vt,Ke+=b*st,et+=b*pt,Qe+=b*gt,Ge+=b*hr,Je+=b*Rt,Ye+=b*ir,Oe+=b*or,je+=b*ar,$e+=b*Cr,ke+=b*pn,Pe+=b*gn,xe+=b*yn,b=B[6],wt+=b*K,Te+=b*at,We+=b*bt,Ke+=b*vt,et+=b*st,Qe+=b*pt,Ge+=b*gt,Je+=b*hr,Ye+=b*Rt,Oe+=b*ir,je+=b*or,$e+=b*ar,ke+=b*Cr,Pe+=b*pn,xe+=b*gn,Q+=b*yn,b=B[7],Te+=b*K,We+=b*at,Ke+=b*bt,et+=b*vt,Qe+=b*st,Ge+=b*pt,Je+=b*gt,Ye+=b*hr,Oe+=b*Rt,je+=b*ir,$e+=b*or,ke+=b*ar,Pe+=b*Cr,xe+=b*pn,Q+=b*gn,ee+=b*yn,b=B[8],We+=b*K,Ke+=b*at,et+=b*bt,Qe+=b*vt,Ge+=b*st,Je+=b*pt,Ye+=b*gt,Oe+=b*hr,je+=b*Rt,$e+=b*ir,ke+=b*or,Pe+=b*ar,xe+=b*Cr,Q+=b*pn,ee+=b*gn,ce+=b*yn,b=B[9],Ke+=b*K,et+=b*at,Qe+=b*bt,Ge+=b*vt,Je+=b*st,Ye+=b*pt,Oe+=b*gt,je+=b*hr,$e+=b*Rt,ke+=b*ir,Pe+=b*or,xe+=b*ar,Q+=b*Cr,ee+=b*pn,ce+=b*gn,ie+=b*yn,b=B[10],et+=b*K,Qe+=b*at,Ge+=b*bt,Je+=b*vt,Ye+=b*st,Oe+=b*pt,je+=b*gt,$e+=b*hr,ke+=b*Rt,Pe+=b*ir,xe+=b*or,Q+=b*ar,ee+=b*Cr,ce+=b*pn,ie+=b*gn,ae+=b*yn,b=B[11],Qe+=b*K,Ge+=b*at,Je+=b*bt,Ye+=b*vt,Oe+=b*st,je+=b*pt,$e+=b*gt,ke+=b*hr,Pe+=b*Rt,xe+=b*ir,Q+=b*or,ee+=b*ar,ce+=b*Cr,ie+=b*pn,ae+=b*gn,he+=b*yn,b=B[12],Ge+=b*K,Je+=b*at,Ye+=b*bt,Oe+=b*vt,je+=b*st,$e+=b*pt,ke+=b*gt,Pe+=b*hr,xe+=b*Rt,Q+=b*ir,ee+=b*or,ce+=b*ar,ie+=b*Cr,ae+=b*pn,he+=b*gn,ze+=b*yn,b=B[13],Je+=b*K,Ye+=b*at,Oe+=b*bt,je+=b*vt,$e+=b*st,ke+=b*pt,Pe+=b*gt,xe+=b*hr,Q+=b*Rt,ee+=b*ir,ce+=b*or,ie+=b*ar,ae+=b*Cr,he+=b*pn,ze+=b*gn,tt+=b*yn,b=B[14],Ye+=b*K,Oe+=b*at,je+=b*bt,$e+=b*vt,ke+=b*st,Pe+=b*pt,xe+=b*gt,Q+=b*hr,ee+=b*Rt,ce+=b*ir,ie+=b*or,ae+=b*ar,he+=b*Cr,ze+=b*pn,tt+=b*gn,nt+=b*yn,b=B[15],Oe+=b*K,je+=b*at,$e+=b*bt,ke+=b*vt,Pe+=b*st,xe+=b*pt,Q+=b*gt,ee+=b*hr,ce+=b*Rt,ie+=b*ir,ae+=b*or,he+=b*ar,ze+=b*Cr,tt+=b*pn,nt+=b*gn,rt+=b*yn,Y+=38*je,Z+=38*$e,oe+=38*ke,pe+=38*Pe,Re+=38*xe,Ce+=38*Q,wt+=38*ee,Te+=38*ce,We+=38*ie,Ke+=38*ae,et+=38*he,Qe+=38*ze,Ge+=38*tt,Je+=38*nt,Ye+=38*rt,F=1,b=Y+F+65535,F=Math.floor(b/65536),Y=b-F*65536,b=Z+F+65535,F=Math.floor(b/65536),Z=b-F*65536,b=oe+F+65535,F=Math.floor(b/65536),oe=b-F*65536,b=pe+F+65535,F=Math.floor(b/65536),pe=b-F*65536,b=Re+F+65535,F=Math.floor(b/65536),Re=b-F*65536,b=Ce+F+65535,F=Math.floor(b/65536),Ce=b-F*65536,b=wt+F+65535,F=Math.floor(b/65536),wt=b-F*65536,b=Te+F+65535,F=Math.floor(b/65536),Te=b-F*65536,b=We+F+65535,F=Math.floor(b/65536),We=b-F*65536,b=Ke+F+65535,F=Math.floor(b/65536),Ke=b-F*65536,b=et+F+65535,F=Math.floor(b/65536),et=b-F*65536,b=Qe+F+65535,F=Math.floor(b/65536),Qe=b-F*65536,b=Ge+F+65535,F=Math.floor(b/65536),Ge=b-F*65536,b=Je+F+65535,F=Math.floor(b/65536),Je=b-F*65536,b=Ye+F+65535,F=Math.floor(b/65536),Ye=b-F*65536,b=Oe+F+65535,F=Math.floor(b/65536),Oe=b-F*65536,Y+=F-1+37*(F-1),F=1,b=Y+F+65535,F=Math.floor(b/65536),Y=b-F*65536,b=Z+F+65535,F=Math.floor(b/65536),Z=b-F*65536,b=oe+F+65535,F=Math.floor(b/65536),oe=b-F*65536,b=pe+F+65535,F=Math.floor(b/65536),pe=b-F*65536,b=Re+F+65535,F=Math.floor(b/65536),Re=b-F*65536,b=Ce+F+65535,F=Math.floor(b/65536),Ce=b-F*65536,b=wt+F+65535,F=Math.floor(b/65536),wt=b-F*65536,b=Te+F+65535,F=Math.floor(b/65536),Te=b-F*65536,b=We+F+65535,F=Math.floor(b/65536),We=b-F*65536,b=Ke+F+65535,F=Math.floor(b/65536),Ke=b-F*65536,b=et+F+65535,F=Math.floor(b/65536),et=b-F*65536,b=Qe+F+65535,F=Math.floor(b/65536),Qe=b-F*65536,b=Ge+F+65535,F=Math.floor(b/65536),Ge=b-F*65536,b=Je+F+65535,F=Math.floor(b/65536),Je=b-F*65536,b=Ye+F+65535,F=Math.floor(b/65536),Ye=b-F*65536,b=Oe+F+65535,F=Math.floor(b/65536),Oe=b-F*65536,Y+=F-1+37*(F-1),I[0]=Y,I[1]=Z,I[2]=oe,I[3]=pe,I[4]=Re,I[5]=Ce,I[6]=wt,I[7]=Te,I[8]=We,I[9]=Ke,I[10]=et,I[11]=Qe,I[12]=Ge,I[13]=Je,I[14]=Ye,I[15]=Oe}function J(I,B){V(I,B,B)}function re(I,B){var U=r(),b;for(b=0;b<16;b++)U[b]=B[b];for(b=253;b>=0;b--)J(U,U),b!==2&&b!==4&&V(U,U,B);for(b=0;b<16;b++)I[b]=U[b]}function ye(I,B){var U=r(),b;for(b=0;b<16;b++)U[b]=B[b];for(b=250;b>=0;b--)J(U,U),b!==1&&V(U,U,B);for(b=0;b<16;b++)I[b]=U[b]}function ne(I,B,U){var b=new Uint8Array(32),F=new Float64Array(80),Y,Z,oe=r(),pe=r(),Re=r(),Ce=r(),wt=r(),Te=r();for(Z=0;Z<31;Z++)b[Z]=B[Z];for(b[31]=B[31]&127|64,b[0]&=248,z(F,U),Z=0;Z<16;Z++)pe[Z]=F[Z],Ce[Z]=oe[Z]=Re[Z]=0;for(oe[0]=Ce[0]=1,Z=254;Z>=0;--Z)Y=b[Z>>>3]>>>(Z&7)&1,$(oe,pe,Y),$(Re,Ce,Y),G(wt,oe,Re),M(oe,oe,Re),G(Re,pe,Ce),M(pe,pe,Ce),J(Ce,wt),J(Te,oe),V(oe,Re,oe),V(Re,pe,wt),G(wt,oe,Re),M(oe,oe,Re),J(pe,oe),M(Re,Ce,Te),V(oe,Re,c),G(oe,oe,Ce),V(Re,Re,oe),V(oe,Ce,Te),V(Ce,pe,F),J(pe,wt),$(oe,pe,Y),$(Re,Ce,Y);for(Z=0;Z<16;Z++)F[Z+16]=oe[Z],F[Z+32]=Re[Z],F[Z+48]=pe[Z],F[Z+64]=Ce[Z];var We=F.subarray(32),Ke=F.subarray(16);return re(We,We),V(Ke,Ke,We),x(I,Ke),0}function se(I,B){return ne(I,B,i)}function Ie(I,B){return n(B,32),se(I,B)}function Me(I,B,U){var b=new Uint8Array(32);return ne(b,U,B),C(I,s,b,O)}var Ve=k,Ze=f;function Nt(I,B,U,b,F,Y){var Z=new Uint8Array(32);return Me(Z,F,Y),Ve(I,B,U,b,Z)}function Br(I,B,U,b,F,Y){var Z=new Uint8Array(32);return Me(Z,F,Y),Ze(I,B,U,b,Z)}var sr=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function Ir(I,B,U,b){for(var F=new Int32Array(16),Y=new Int32Array(16),Z,oe,pe,Re,Ce,wt,Te,We,Ke,et,Qe,Ge,Je,Ye,Oe,je,$e,ke,Pe,xe,Q,ee,ce,ie,ae,he,ze=I[0],tt=I[1],nt=I[2],rt=I[3],K=I[4],at=I[5],bt=I[6],vt=I[7],st=B[0],pt=B[1],gt=B[2],hr=B[3],Rt=B[4],ir=B[5],or=B[6],ar=B[7],Cr=0;b>=128;){for(Pe=0;Pe<16;Pe++)xe=8*Pe+Cr,F[Pe]=U[xe+0]<<24|U[xe+1]<<16|U[xe+2]<<8|U[xe+3],Y[Pe]=U[xe+4]<<24|U[xe+5]<<16|U[xe+6]<<8|U[xe+7];for(Pe=0;Pe<80;Pe++)if(Z=ze,oe=tt,pe=nt,Re=rt,Ce=K,wt=at,Te=bt,We=vt,Ke=st,et=pt,Qe=gt,Ge=hr,Je=Rt,Ye=ir,Oe=or,je=ar,Q=vt,ee=ar,ce=ee&65535,ie=ee>>>16,ae=Q&65535,he=Q>>>16,Q=(K>>>14|Rt<<18)^(K>>>18|Rt<<14)^(Rt>>>9|K<<23),ee=(Rt>>>14|K<<18)^(Rt>>>18|K<<14)^(K>>>9|Rt<<23),ce+=ee&65535,ie+=ee>>>16,ae+=Q&65535,he+=Q>>>16,Q=K&at^~K&bt,ee=Rt&ir^~Rt&or,ce+=ee&65535,ie+=ee>>>16,ae+=Q&65535,he+=Q>>>16,Q=sr[Pe*2],ee=sr[Pe*2+1],ce+=ee&65535,ie+=ee>>>16,ae+=Q&65535,he+=Q>>>16,Q=F[Pe%16],ee=Y[Pe%16],ce+=ee&65535,ie+=ee>>>16,ae+=Q&65535,he+=Q>>>16,ie+=ce>>>16,ae+=ie>>>16,he+=ae>>>16,$e=ae&65535|he<<16,ke=ce&65535|ie<<16,Q=$e,ee=ke,ce=ee&65535,ie=ee>>>16,ae=Q&65535,he=Q>>>16,Q=(ze>>>28|st<<4)^(st>>>2|ze<<30)^(st>>>7|ze<<25),ee=(st>>>28|ze<<4)^(ze>>>2|st<<30)^(ze>>>7|st<<25),ce+=ee&65535,ie+=ee>>>16,ae+=Q&65535,he+=Q>>>16,Q=ze&tt^ze&nt^tt&nt,ee=st&pt^st&gt^pt&gt,ce+=ee&65535,ie+=ee>>>16,ae+=Q&65535,he+=Q>>>16,ie+=ce>>>16,ae+=ie>>>16,he+=ae>>>16,We=ae&65535|he<<16,je=ce&65535|ie<<16,Q=Re,ee=Ge,ce=ee&65535,ie=ee>>>16,ae=Q&65535,he=Q>>>16,Q=$e,ee=ke,ce+=ee&65535,ie+=ee>>>16,ae+=Q&65535,he+=Q>>>16,ie+=ce>>>16,ae+=ie>>>16,he+=ae>>>16,Re=ae&65535|he<<16,Ge=ce&65535|ie<<16,tt=Z,nt=oe,rt=pe,K=Re,at=Ce,bt=wt,vt=Te,ze=We,pt=Ke,gt=et,hr=Qe,Rt=Ge,ir=Je,or=Ye,ar=Oe,st=je,Pe%16===15)for(xe=0;xe<16;xe++)Q=F[xe],ee=Y[xe],ce=ee&65535,ie=ee>>>16,ae=Q&65535,he=Q>>>16,Q=F[(xe+9)%16],ee=Y[(xe+9)%16],ce+=ee&65535,ie+=ee>>>16,ae+=Q&65535,he+=Q>>>16,$e=F[(xe+1)%16],ke=Y[(xe+1)%16],Q=($e>>>1|ke<<31)^($e>>>8|ke<<24)^$e>>>7,ee=(ke>>>1|$e<<31)^(ke>>>8|$e<<24)^(ke>>>7|$e<<25),ce+=ee&65535,ie+=ee>>>16,ae+=Q&65535,he+=Q>>>16,$e=F[(xe+14)%16],ke=Y[(xe+14)%16],Q=($e>>>19|ke<<13)^(ke>>>29|$e<<3)^$e>>>6,ee=(ke>>>19|$e<<13)^($e>>>29|ke<<3)^(ke>>>6|$e<<26),ce+=ee&65535,ie+=ee>>>16,ae+=Q&65535,he+=Q>>>16,ie+=ce>>>16,ae+=ie>>>16,he+=ae>>>16,F[xe]=ae&65535|he<<16,Y[xe]=ce&65535|ie<<16;Q=ze,ee=st,ce=ee&65535,ie=ee>>>16,ae=Q&65535,he=Q>>>16,Q=I[0],ee=B[0],ce+=ee&65535,ie+=ee>>>16,ae+=Q&65535,he+=Q>>>16,ie+=ce>>>16,ae+=ie>>>16,he+=ae>>>16,I[0]=ze=ae&65535|he<<16,B[0]=st=ce&65535|ie<<16,Q=tt,ee=pt,ce=ee&65535,ie=ee>>>16,ae=Q&65535,he=Q>>>16,Q=I[1],ee=B[1],ce+=ee&65535,ie+=ee>>>16,ae+=Q&65535,he+=Q>>>16,ie+=ce>>>16,ae+=ie>>>16,he+=ae>>>16,I[1]=tt=ae&65535|he<<16,B[1]=pt=ce&65535|ie<<16,Q=nt,ee=gt,ce=ee&65535,ie=ee>>>16,ae=Q&65535,he=Q>>>16,Q=I[2],ee=B[2],ce+=ee&65535,ie+=ee>>>16,ae+=Q&65535,he+=Q>>>16,ie+=ce>>>16,ae+=ie>>>16,he+=ae>>>16,I[2]=nt=ae&65535|he<<16,B[2]=gt=ce&65535|ie<<16,Q=rt,ee=hr,ce=ee&65535,ie=ee>>>16,ae=Q&65535,he=Q>>>16,Q=I[3],ee=B[3],ce+=ee&65535,ie+=ee>>>16,ae+=Q&65535,he+=Q>>>16,ie+=ce>>>16,ae+=ie>>>16,he+=ae>>>16,I[3]=rt=ae&65535|he<<16,B[3]=hr=ce&65535|ie<<16,Q=K,ee=Rt,ce=ee&65535,ie=ee>>>16,ae=Q&65535,he=Q>>>16,Q=I[4],ee=B[4],ce+=ee&65535,ie+=ee>>>16,ae+=Q&65535,he+=Q>>>16,ie+=ce>>>16,ae+=ie>>>16,he+=ae>>>16,I[4]=K=ae&65535|he<<16,B[4]=Rt=ce&65535|ie<<16,Q=at,ee=ir,ce=ee&65535,ie=ee>>>16,ae=Q&65535,he=Q>>>16,Q=I[5],ee=B[5],ce+=ee&65535,ie+=ee>>>16,ae+=Q&65535,he+=Q>>>16,ie+=ce>>>16,ae+=ie>>>16,he+=ae>>>16,I[5]=at=ae&65535|he<<16,B[5]=ir=ce&65535|ie<<16,Q=bt,ee=or,ce=ee&65535,ie=ee>>>16,ae=Q&65535,he=Q>>>16,Q=I[6],ee=B[6],ce+=ee&65535,ie+=ee>>>16,ae+=Q&65535,he+=Q>>>16,ie+=ce>>>16,ae+=ie>>>16,he+=ae>>>16,I[6]=bt=ae&65535|he<<16,B[6]=or=ce&65535|ie<<16,Q=vt,ee=ar,ce=ee&65535,ie=ee>>>16,ae=Q&65535,he=Q>>>16,Q=I[7],ee=B[7],ce+=ee&65535,ie+=ee>>>16,ae+=Q&65535,he+=Q>>>16,ie+=ce>>>16,ae+=ie>>>16,he+=ae>>>16,I[7]=vt=ae&65535|he<<16,B[7]=ar=ce&65535|ie<<16,Cr+=128,b-=128}return b}function Ei(I,B,U){var b=new Int32Array(8),F=new Int32Array(8),Y=new Uint8Array(256),Z,oe=U;for(b[0]=1779033703,b[1]=3144134277,b[2]=1013904242,b[3]=2773480762,b[4]=1359893119,b[5]=2600822924,b[6]=528734635,b[7]=1541459225,F[0]=4089235720,F[1]=2227873595,F[2]=4271175723,F[3]=1595750129,F[4]=2917565137,F[5]=725511199,F[6]=4215389547,F[7]=327033209,Ir(b,F,B,U),U%=128,Z=0;Z<U;Z++)Y[Z]=B[oe-U+Z];for(Y[U]=128,U=256-128*(U<112?1:0),Y[U-9]=0,y(Y,U-8,oe/536870912|0,oe<<3),Ir(b,F,Y,U),Z=0;Z<8;Z++)y(I,8*Z,b[Z],F[Z]);return 0}function Ma(I,B){var U=r(),b=r(),F=r(),Y=r(),Z=r(),oe=r(),pe=r(),Re=r(),Ce=r();M(U,I[1],I[0]),M(Ce,B[1],B[0]),V(U,U,Ce),G(b,I[0],I[1]),G(Ce,B[0],B[1]),V(b,b,Ce),V(F,I[3],B[3]),V(F,F,u),V(Y,I[2],B[2]),G(Y,Y,Y),M(Z,b,U),M(oe,Y,F),G(pe,Y,F),G(Re,b,U),V(I[0],Z,oe),V(I[1],Re,pe),V(I[2],pe,oe),V(I[3],Z,Re)}function el(I,B,U){var b;for(b=0;b<4;b++)$(I[b],B[b],U)}function tl(I,B){var U=r(),b=r(),F=r();re(F,B[2]),V(U,B[0],F),V(b,B[1],F),x(I,b),I[31]^=H(U)<<7}function rl(I,B,U){var b,F;for(m(I[0],o),m(I[1],a),m(I[2],a),m(I[3],o),F=255;F>=0;--F)b=U[F/8|0]>>(F&7)&1,el(I,B,b),Ma(B,I),Ma(I,I),el(I,B,b)}function ja(I,B){var U=[r(),r(),r(),r()];m(U[0],d),m(U[1],h),m(U[2],a),V(U[3],d,h),rl(I,U,B)}function nl(I,B,U){var b=new Uint8Array(64),F=[r(),r(),r(),r()],Y;for(U||n(B,32),Ei(b,B,32),b[0]&=248,b[31]&=127,b[31]|=64,ja(F,b),tl(I,F),Y=0;Y<32;Y++)B[Y+32]=I[Y];return 0}var Fa=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function vu(I,B){var U,b,F,Y;for(b=63;b>=32;--b){for(U=0,F=b-32,Y=b-12;F<Y;++F)B[F]+=U-16*B[b]*Fa[F-(b-32)],U=Math.floor((B[F]+128)/256),B[F]-=U*256;B[F]+=U,B[b]=0}for(U=0,F=0;F<32;F++)B[F]+=U-(B[31]>>4)*Fa[F],U=B[F]>>8,B[F]&=255;for(F=0;F<32;F++)B[F]-=U*Fa[F];for(b=0;b<32;b++)B[b+1]+=B[b]>>8,I[b]=B[b]&255}function Eu(I){var B=new Float64Array(64),U;for(U=0;U<64;U++)B[U]=I[U];for(U=0;U<64;U++)I[U]=0;vu(I,B)}function ef(I,B,U,b){var F=new Uint8Array(64),Y=new Uint8Array(64),Z=new Uint8Array(64),oe,pe,Re=new Float64Array(64),Ce=[r(),r(),r(),r()];Ei(F,b,32),F[0]&=248,F[31]&=127,F[31]|=64;var wt=U+64;for(oe=0;oe<U;oe++)I[64+oe]=B[oe];for(oe=0;oe<32;oe++)I[32+oe]=F[32+oe];for(Ei(Z,I.subarray(32),U+32),Eu(Z),ja(Ce,Z),tl(I,Ce),oe=32;oe<64;oe++)I[oe]=b[oe];for(Ei(Y,I,U+64),Eu(Y),oe=0;oe<64;oe++)Re[oe]=0;for(oe=0;oe<32;oe++)Re[oe]=Z[oe];for(oe=0;oe<32;oe++)for(pe=0;pe<32;pe++)Re[oe+pe]+=Y[oe]*F[pe];return vu(I.subarray(32),Re),wt}function Sy(I,B){var U=r(),b=r(),F=r(),Y=r(),Z=r(),oe=r(),pe=r();return m(I[2],a),z(I[1],B),J(F,I[1]),V(Y,F,l),M(F,F,I[2]),G(Y,I[2],Y),J(Z,Y),J(oe,Z),V(pe,oe,Z),V(U,pe,F),V(U,U,Y),ye(U,U),V(U,U,F),V(U,U,Y),V(U,U,Y),V(I[0],U,Y),J(b,I[0]),V(b,b,Y),N(b,F)&&V(I[0],I[0],p),J(b,I[0]),V(b,b,Y),N(b,F)?-1:(H(I[0])===B[31]>>7&&M(I[0],o,I[0]),V(I[3],I[0],I[1]),0)}function Ay(I,B,U,b){var F,Y=new Uint8Array(32),Z=new Uint8Array(64),oe=[r(),r(),r(),r()],pe=[r(),r(),r(),r()];if(U<64||Sy(pe,b))return-1;for(F=0;F<U;F++)I[F]=B[F];for(F=0;F<32;F++)I[F+32]=b[F];if(Ei(Z,I,U),Eu(Z),rl(oe,pe,Z),ja(pe,B.subarray(32)),Ma(oe,pe),tl(Y,oe),U-=64,S(B,0,Y,0)){for(F=0;F<U;F++)I[F]=0;return-1}for(F=0;F<U;F++)I[F]=B[F+64];return U}var Iy=32,tf=24,_u=32,sl=16,xu=32,rf=32,Su=32,Au=32,Cy=32,zv=tf,A6=_u,I6=sl,Gi=64,qa=32,il=64,$y=32,Ty=64;e.lowlevel={crypto_core_hsalsa20:C,crypto_stream_xor:W,crypto_stream:D,crypto_stream_salsa20_xor:L,crypto_stream_salsa20:j,crypto_onetimeauth:R,crypto_onetimeauth_verify:T,crypto_verify_16:w,crypto_verify_32:S,crypto_secretbox:k,crypto_secretbox_open:f,crypto_scalarmult:ne,crypto_scalarmult_base:se,crypto_box_beforenm:Me,crypto_box_afternm:Ve,crypto_box:Nt,crypto_box_open:Br,crypto_box_keypair:Ie,crypto_hash:Ei,crypto_sign:ef,crypto_sign_keypair:nl,crypto_sign_open:Ay,crypto_secretbox_KEYBYTES:Iy,crypto_secretbox_NONCEBYTES:tf,crypto_secretbox_ZEROBYTES:_u,crypto_secretbox_BOXZEROBYTES:sl,crypto_scalarmult_BYTES:xu,crypto_scalarmult_SCALARBYTES:rf,crypto_box_PUBLICKEYBYTES:Su,crypto_box_SECRETKEYBYTES:Au,crypto_box_BEFORENMBYTES:Cy,crypto_box_NONCEBYTES:zv,crypto_box_ZEROBYTES:A6,crypto_box_BOXZEROBYTES:I6,crypto_sign_BYTES:Gi,crypto_sign_PUBLICKEYBYTES:qa,crypto_sign_SECRETKEYBYTES:il,crypto_sign_SEEDBYTES:$y,crypto_hash_BYTES:Ty,gf:r,D:l,L:Fa,pack25519:x,unpack25519:z,M:V,A:G,S:J,Z:M,pow2523:ye,add:Ma,set25519:m,modL:vu,scalarmult:rl,scalarbase:ja};function Hv(I,B){if(I.length!==Iy)throw new Error("bad key size");if(B.length!==tf)throw new Error("bad nonce size")}function C6(I,B){if(I.length!==Su)throw new Error("bad public key size");if(B.length!==Au)throw new Error("bad secret key size")}function ls(){for(var I=0;I<arguments.length;I++)if(!(arguments[I]instanceof Uint8Array))throw new TypeError("unexpected type, use Uint8Array")}function Wv(I){for(var B=0;B<I.length;B++)I[B]=0}e.randomBytes=function(I){var B=new Uint8Array(I);return n(B,I),B},e.secretbox=function(I,B,U){ls(I,B,U),Hv(U,B);for(var b=new Uint8Array(_u+I.length),F=new Uint8Array(b.length),Y=0;Y<I.length;Y++)b[Y+_u]=I[Y];return k(F,b,b.length,B,U),F.subarray(sl)},e.secretbox.open=function(I,B,U){ls(I,B,U),Hv(U,B);for(var b=new Uint8Array(sl+I.length),F=new Uint8Array(b.length),Y=0;Y<I.length;Y++)b[Y+sl]=I[Y];return b.length<32||f(F,b,b.length,B,U)!==0?null:F.subarray(_u)},e.secretbox.keyLength=Iy,e.secretbox.nonceLength=tf,e.secretbox.overheadLength=sl,e.scalarMult=function(I,B){if(ls(I,B),I.length!==rf)throw new Error("bad n size");if(B.length!==xu)throw new Error("bad p size");var U=new Uint8Array(xu);return ne(U,I,B),U},e.scalarMult.base=function(I){if(ls(I),I.length!==rf)throw new Error("bad n size");var B=new Uint8Array(xu);return se(B,I),B},e.scalarMult.scalarLength=rf,e.scalarMult.groupElementLength=xu,e.box=function(I,B,U,b){var F=e.box.before(U,b);return e.secretbox(I,B,F)},e.box.before=function(I,B){ls(I,B),C6(I,B);var U=new Uint8Array(Cy);return Me(U,I,B),U},e.box.after=e.secretbox,e.box.open=function(I,B,U,b){var F=e.box.before(U,b);return e.secretbox.open(I,B,F)},e.box.open.after=e.secretbox.open,e.box.keyPair=function(){var I=new Uint8Array(Su),B=new Uint8Array(Au);return Ie(I,B),{publicKey:I,secretKey:B}},e.box.keyPair.fromSecretKey=function(I){if(ls(I),I.length!==Au)throw new Error("bad secret key size");var B=new Uint8Array(Su);return se(B,I),{publicKey:B,secretKey:new Uint8Array(I)}},e.box.publicKeyLength=Su,e.box.secretKeyLength=Au,e.box.sharedKeyLength=Cy,e.box.nonceLength=zv,e.box.overheadLength=e.secretbox.overheadLength,e.sign=function(I,B){if(ls(I,B),B.length!==il)throw new Error("bad secret key size");var U=new Uint8Array(Gi+I.length);return ef(U,I,I.length,B),U},e.sign.open=function(I,B){if(ls(I,B),B.length!==qa)throw new Error("bad public key size");var U=new Uint8Array(I.length),b=Ay(U,I,I.length,B);if(b<0)return null;for(var F=new Uint8Array(b),Y=0;Y<F.length;Y++)F[Y]=U[Y];return F},e.sign.detached=function(I,B){for(var U=e.sign(I,B),b=new Uint8Array(Gi),F=0;F<b.length;F++)b[F]=U[F];return b},e.sign.detached.verify=function(I,B,U){if(ls(I,B,U),B.length!==Gi)throw new Error("bad signature size");if(U.length!==qa)throw new Error("bad public key size");var b=new Uint8Array(Gi+I.length),F=new Uint8Array(Gi+I.length),Y;for(Y=0;Y<Gi;Y++)b[Y]=B[Y];for(Y=0;Y<I.length;Y++)b[Y+Gi]=I[Y];return Ay(F,b,b.length,U)>=0},e.sign.keyPair=function(){var I=new Uint8Array(qa),B=new Uint8Array(il);return nl(I,B),{publicKey:I,secretKey:B}},e.sign.keyPair.fromSecretKey=function(I){if(ls(I),I.length!==il)throw new Error("bad secret key size");for(var B=new Uint8Array(qa),U=0;U<B.length;U++)B[U]=I[32+U];return{publicKey:B,secretKey:new Uint8Array(I)}},e.sign.keyPair.fromSeed=function(I){if(ls(I),I.length!==$y)throw new Error("bad seed size");for(var B=new Uint8Array(qa),U=new Uint8Array(il),b=0;b<32;b++)U[b]=I[b];return nl(B,U,!0),{publicKey:B,secretKey:U}},e.sign.publicKeyLength=qa,e.sign.secretKeyLength=il,e.sign.seedLength=$y,e.sign.signatureLength=Gi,e.hash=function(I){ls(I);var B=new Uint8Array(Ty);return Ei(B,I,I.length),B},e.hash.hashLength=Ty,e.verify=function(I,B){return ls(I,B),I.length===0||B.length===0||I.length!==B.length?!1:g(I,0,B,0,I.length)===0},e.setPRNG=function(I){n=I},(function(){var I=typeof self<"u"?self.crypto||self.msCrypto:null;if(I&&I.getRandomValues){var B=65536;e.setPRNG(function(U,b){var F,Y=new Uint8Array(b);for(F=0;F<b;F+=B)I.getRandomValues(Y.subarray(F,F+Math.min(b-F,B)));for(F=0;F<b;F++)U[F]=Y[F];Wv(Y)})}else typeof T8<"u"&&(I=k8,I&&I.randomBytes&&e.setPRNG(function(U,b){var F,Y=I.randomBytes(b);for(F=0;F<b;F++)U[F]=Y[F];Wv(Y)}))})()})(t.exports?t.exports:self.nacl=self.nacl||{})})(jy)),jy.exports}var $u=P8(),sp={exports:{}},R8=sp.exports,NE;function D8(){return NE||(NE=1,(function(t){(function(e,r){t.exports?t.exports=r():(e.nacl||(e.nacl={}),e.nacl.util=r())})(R8,function(){var e={};function r(n){if(!/^(?:[A-Za-z0-9+\/]{2}[A-Za-z0-9+\/]{2})*(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=)?$/.test(n))throw new TypeError("invalid encoding")}return e.decodeUTF8=function(n){if(typeof n!="string")throw new TypeError("expected string");var s,i=unescape(encodeURIComponent(n)),o=new Uint8Array(i.length);for(s=0;s<i.length;s++)o[s]=i.charCodeAt(s);return o},e.encodeUTF8=function(n){var s,i=[];for(s=0;s<n.length;s++)i.push(String.fromCharCode(n[s]));return decodeURIComponent(escape(i.join("")))},typeof atob>"u"?typeof Buffer.from<"u"?(e.encodeBase64=function(n){return Buffer.from(n).toString("base64")},e.decodeBase64=function(n){return r(n),new Uint8Array(Array.prototype.slice.call(Buffer.from(n,"base64"),0))}):(e.encodeBase64=function(n){return new Buffer(n).toString("base64")},e.decodeBase64=function(n){return r(n),new Uint8Array(Array.prototype.slice.call(new Buffer(n,"base64"),0))}):(e.encodeBase64=function(n){var s,i=[],o=n.length;for(s=0;s<o;s++)i.push(String.fromCharCode(n[s]));return btoa(i.join(""))},e.decodeBase64=function(n){r(n);var s,i=atob(n),o=new Uint8Array(i.length);for(s=0;s<i.length;s++)o[s]=i.charCodeAt(s);return o}),e})})(sp)),sp.exports}var Os=D8(),_s=(t=>(t.XBULL_CONNECT="XBULL_CONNECT",t.XBULL_GET_PUBLIC_KEY="XBULL_GET_PUBLIC_KEY",t.XBULL_SIGN_XDR="XBULL_SIGN_XDR",t.XBULL_GET_NETWORK="XBULL_GET_NETWORK",t.XBULL_SIGN_MESSAGE="XBULL_SIGN_MESSAGE",t.XBULL_INITIAL_RESPONSE="XBULL_INITIAL_RESPONSE",t.XBULL_CONNECT_RESPONSE="XBULL_CONNECT_RESPONSE",t.XBULL_SIGN="XBULL_SIGN",t.XBULL_SIGN_RESPONSE="XBULL_SIGN_RESPONSE",t.XBULL_SIGN_MESSAGE_RESPONSE="XBULL_SIGN_MESSAGE_RESPONSE",t))(_s||{});function Fy(t){return!!t.error}var a0=function(t,e){return a0=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(r[s]=n[s])},a0(t,e)};function Pa(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");a0(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}function U8(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})}function UC(t,e){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,o=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return o.next=a(0),o.throw=a(1),o.return=a(2),typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(l){return function(u){return c([l,u])}}function c(l){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,l[0]&&(r=0)),r;)try{if(n=1,s&&(i=l[0]&2?s.return:l[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,l[1])).done)return i;switch(s=0,i&&(l=[l[0]&2,i.value]),l[0]){case 0:case 1:i=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,s=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!i||l[1]>i[0]&&l[1]<i[3])){r.label=l[1];break}if(l[0]===6&&r.label<i[1]){r.label=i[1],i=l;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(l);break}i[2]&&r.ops.pop(),r.trys.pop();continue}l=e.call(t,r)}catch(u){l=[6,u],s=0}finally{n=i=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function Yl(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function kp(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),s,i=[],o;try{for(;(e===void 0||e-- >0)&&!(s=n.next()).done;)i.push(s.value)}catch(a){o={error:a}}finally{try{s&&!s.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return i}function Pp(t,e,r){if(r||arguments.length===2)for(var n=0,s=e.length,i;n<s;n++)(i||!(n in e))&&(i||(i=Array.prototype.slice.call(e,0,n)),i[n]=e[n]);return t.concat(i||Array.prototype.slice.call(e))}function Ul(t){return this instanceof Ul?(this.v=t,this):new Ul(t)}function B8(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(t,e||[]),s,i=[];return s=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",o),s[Symbol.asyncIterator]=function(){return this},s;function o(p){return function(y){return Promise.resolve(y).then(p,d)}}function a(p,y){n[p]&&(s[p]=function(g){return new Promise(function(w,S){i.push([p,g,w,S])>1||c(p,g)})},y&&(s[p]=y(s[p])))}function c(p,y){try{l(n[p](y))}catch(g){h(i[0][3],g)}}function l(p){p.value instanceof Ul?Promise.resolve(p.value.v).then(u,d):h(i[0][2],p)}function u(p){c("next",p)}function d(p){c("throw",p)}function h(p,y){p(y),i.shift(),i.length&&c(i[0][0],i[0][1])}}function L8(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof Yl=="function"?Yl(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(i){r[i]=t[i]&&function(o){return new Promise(function(a,c){o=t[i](o),s(a,c,o.done,o.value)})}}function s(i,o,a,c){Promise.resolve(c).then(function(l){i({value:l,done:a})},o)}}function Ur(t){return typeof t=="function"}function v1(t){var e=function(n){Error.call(n),n.stack=new Error().stack},r=t(e);return r.prototype=Object.create(Error.prototype),r.prototype.constructor=r,r}var qy=v1(function(t){return function(r){t(this),this.message=r?r.length+` errors occurred during unsubscription:
`+r.map(function(n,s){return s+1+") "+n.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=r}});function Rp(t,e){if(t){var r=t.indexOf(e);0<=r&&t.splice(r,1)}}var Ah=(function(){function t(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return t.prototype.unsubscribe=function(){var e,r,n,s,i;if(!this.closed){this.closed=!0;var o=this._parentage;if(o)if(this._parentage=null,Array.isArray(o))try{for(var a=Yl(o),c=a.next();!c.done;c=a.next()){var l=c.value;l.remove(this)}}catch(g){e={error:g}}finally{try{c&&!c.done&&(r=a.return)&&r.call(a)}finally{if(e)throw e.error}}else o.remove(this);var u=this.initialTeardown;if(Ur(u))try{u()}catch(g){i=g instanceof qy?g.errors:[g]}var d=this._finalizers;if(d){this._finalizers=null;try{for(var h=Yl(d),p=h.next();!p.done;p=h.next()){var y=p.value;try{OE(y)}catch(g){i=i??[],g instanceof qy?i=Pp(Pp([],kp(i)),kp(g.errors)):i.push(g)}}}catch(g){n={error:g}}finally{try{p&&!p.done&&(s=h.return)&&s.call(h)}finally{if(n)throw n.error}}}if(i)throw new qy(i)}},t.prototype.add=function(e){var r;if(e&&e!==this)if(this.closed)OE(e);else{if(e instanceof t){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(r=this._finalizers)!==null&&r!==void 0?r:[]).push(e)}},t.prototype._hasParent=function(e){var r=this._parentage;return r===e||Array.isArray(r)&&r.includes(e)},t.prototype._addParent=function(e){var r=this._parentage;this._parentage=Array.isArray(r)?(r.push(e),r):r?[r,e]:e},t.prototype._removeParent=function(e){var r=this._parentage;r===e?this._parentage=null:Array.isArray(r)&&Rp(r,e)},t.prototype.remove=function(e){var r=this._finalizers;r&&Rp(r,e),e instanceof t&&e._removeParent(this)},t.EMPTY=(function(){var e=new t;return e.closed=!0,e})(),t})(),BC=Ah.EMPTY;function LC(t){return t instanceof Ah||t&&"closed"in t&&Ur(t.remove)&&Ur(t.add)&&Ur(t.unsubscribe)}function OE(t){Ur(t)?t():t.unsubscribe()}var M8={Promise:void 0},j8={setTimeout:function(t,e){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return setTimeout.apply(void 0,Pp([t,e],kp(r)))},clearTimeout:function(t){return clearTimeout(t)},delegate:void 0};function MC(t){j8.setTimeout(function(){throw t})}function c0(){}function ip(t){t()}var E1=(function(t){Pa(e,t);function e(r){var n=t.call(this)||this;return n.isStopped=!1,r?(n.destination=r,LC(r)&&r.add(n)):n.destination=z8,n}return e.create=function(r,n,s){return new Dp(r,n,s)},e.prototype.next=function(r){this.isStopped||this._next(r)},e.prototype.error=function(r){this.isStopped||(this.isStopped=!0,this._error(r))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this),this.destination=null)},e.prototype._next=function(r){this.destination.next(r)},e.prototype._error=function(r){try{this.destination.error(r)}finally{this.unsubscribe()}},e.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},e})(Ah),F8=(function(){function t(e){this.partialObserver=e}return t.prototype.next=function(e){var r=this.partialObserver;if(r.next)try{r.next(e)}catch(n){af(n)}},t.prototype.error=function(e){var r=this.partialObserver;if(r.error)try{r.error(e)}catch(n){af(n)}else af(e)},t.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(r){af(r)}},t})(),Dp=(function(t){Pa(e,t);function e(r,n,s){var i=t.call(this)||this,o;return Ur(r)||!r?o={next:r??void 0,error:n??void 0,complete:s??void 0}:o=r,i.destination=new F8(o),i}return e})(E1);function af(t){MC(t)}function q8(t){throw t}var z8={closed:!0,next:c0,error:q8,complete:c0},_1=(function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"})();function H8(t){return t}function W8(t){return t.length===0?H8:t.length===1?t[0]:function(r){return t.reduce(function(n,s){return s(n)},r)}}var ss=(function(){function t(e){e&&(this._subscribe=e)}return t.prototype.lift=function(e){var r=new t;return r.source=this,r.operator=e,r},t.prototype.subscribe=function(e,r,n){var s=this,i=K8(e)?e:new Dp(e,r,n);return ip(function(){var o=s,a=o.operator,c=o.source;i.add(a?a.call(i,c):c?s._subscribe(i):s._trySubscribe(i))}),i},t.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(r){e.error(r)}},t.prototype.forEach=function(e,r){var n=this;return r=kE(r),new r(function(s,i){var o=new Dp({next:function(a){try{e(a)}catch(c){i(c),o.unsubscribe()}},error:i,complete:s});n.subscribe(o)})},t.prototype._subscribe=function(e){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(e)},t.prototype[_1]=function(){return this},t.prototype.pipe=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return W8(e)(this)},t.prototype.toPromise=function(e){var r=this;return e=kE(e),new e(function(n,s){var i;r.subscribe(function(o){return i=o},function(o){return s(o)},function(){return n(i)})})},t.create=function(e){return new t(e)},t})();function kE(t){var e;return(e=t??M8.Promise)!==null&&e!==void 0?e:Promise}function V8(t){return t&&Ur(t.next)&&Ur(t.error)&&Ur(t.complete)}function K8(t){return t&&t instanceof E1||V8(t)&&LC(t)}function G8(t){return Ur(t?.lift)}function Ih(t){return function(e){if(G8(e))return e.lift(function(r){try{return t(r,this)}catch(n){this.error(n)}});throw new TypeError("Unable to lift unknown Observable type")}}function Rd(t,e,r,n,s){return new Y8(t,e,r,n,s)}var Y8=(function(t){Pa(e,t);function e(r,n,s,i,o,a){var c=t.call(this,r)||this;return c.onFinalize=o,c.shouldUnsubscribe=a,c._next=n?function(l){try{n(l)}catch(u){r.error(u)}}:t.prototype._next,c._error=i?function(l){try{i(l)}catch(u){r.error(u)}finally{this.unsubscribe()}}:t.prototype._error,c._complete=s?function(){try{s()}catch(l){r.error(l)}finally{this.unsubscribe()}}:t.prototype._complete,c}return e.prototype.unsubscribe=function(){var r;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var n=this.closed;t.prototype.unsubscribe.call(this),!n&&((r=this.onFinalize)===null||r===void 0||r.call(this))}},e})(E1),X8=v1(function(t){return function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),oi=(function(t){Pa(e,t);function e(){var r=t.call(this)||this;return r.closed=!1,r.currentObservers=null,r.observers=[],r.isStopped=!1,r.hasError=!1,r.thrownError=null,r}return e.prototype.lift=function(r){var n=new PE(this,this);return n.operator=r,n},e.prototype._throwIfClosed=function(){if(this.closed)throw new X8},e.prototype.next=function(r){var n=this;ip(function(){var s,i;if(n._throwIfClosed(),!n.isStopped){n.currentObservers||(n.currentObservers=Array.from(n.observers));try{for(var o=Yl(n.currentObservers),a=o.next();!a.done;a=o.next()){var c=a.value;c.next(r)}}catch(l){s={error:l}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(s)throw s.error}}}})},e.prototype.error=function(r){var n=this;ip(function(){if(n._throwIfClosed(),!n.isStopped){n.hasError=n.isStopped=!0,n.thrownError=r;for(var s=n.observers;s.length;)s.shift().error(r)}})},e.prototype.complete=function(){var r=this;ip(function(){if(r._throwIfClosed(),!r.isStopped){r.isStopped=!0;for(var n=r.observers;n.length;)n.shift().complete()}})},e.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(e.prototype,"observed",{get:function(){var r;return((r=this.observers)===null||r===void 0?void 0:r.length)>0},enumerable:!1,configurable:!0}),e.prototype._trySubscribe=function(r){return this._throwIfClosed(),t.prototype._trySubscribe.call(this,r)},e.prototype._subscribe=function(r){return this._throwIfClosed(),this._checkFinalizedStatuses(r),this._innerSubscribe(r)},e.prototype._innerSubscribe=function(r){var n=this,s=this,i=s.hasError,o=s.isStopped,a=s.observers;return i||o?BC:(this.currentObservers=null,a.push(r),new Ah(function(){n.currentObservers=null,Rp(a,r)}))},e.prototype._checkFinalizedStatuses=function(r){var n=this,s=n.hasError,i=n.thrownError,o=n.isStopped;s?r.error(i):o&&r.complete()},e.prototype.asObservable=function(){var r=new ss;return r.source=this,r},e.create=function(r,n){return new PE(r,n)},e})(ss),PE=(function(t){Pa(e,t);function e(r,n){var s=t.call(this)||this;return s.destination=r,s.source=n,s}return e.prototype.next=function(r){var n,s;(s=(n=this.destination)===null||n===void 0?void 0:n.next)===null||s===void 0||s.call(n,r)},e.prototype.error=function(r){var n,s;(s=(n=this.destination)===null||n===void 0?void 0:n.error)===null||s===void 0||s.call(n,r)},e.prototype.complete=function(){var r,n;(n=(r=this.destination)===null||r===void 0?void 0:r.complete)===null||n===void 0||n.call(r)},e.prototype._subscribe=function(r){var n,s;return(s=(n=this.source)===null||n===void 0?void 0:n.subscribe(r))!==null&&s!==void 0?s:BC},e})(oi),Z8={now:function(){return Date.now()}},J8=(function(t){Pa(e,t);function e(r,n){return t.call(this)||this}return e.prototype.schedule=function(r,n){return this},e})(Ah),RE={setInterval:function(t,e){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return setInterval.apply(void 0,Pp([t,e],kp(r)))},clearInterval:function(t){return clearInterval(t)},delegate:void 0},Q8=(function(t){Pa(e,t);function e(r,n){var s=t.call(this,r,n)||this;return s.scheduler=r,s.work=n,s.pending=!1,s}return e.prototype.schedule=function(r,n){var s;if(n===void 0&&(n=0),this.closed)return this;this.state=r;var i=this.id,o=this.scheduler;return i!=null&&(this.id=this.recycleAsyncId(o,i,n)),this.pending=!0,this.delay=n,this.id=(s=this.id)!==null&&s!==void 0?s:this.requestAsyncId(o,this.id,n),this},e.prototype.requestAsyncId=function(r,n,s){return s===void 0&&(s=0),RE.setInterval(r.flush.bind(r,this),s)},e.prototype.recycleAsyncId=function(r,n,s){if(s===void 0&&(s=0),s!=null&&this.delay===s&&this.pending===!1)return n;n!=null&&RE.clearInterval(n)},e.prototype.execute=function(r,n){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var s=this._execute(r,n);if(s)return s;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},e.prototype._execute=function(r,n){var s=!1,i;try{this.work(r)}catch(o){s=!0,i=o||new Error("Scheduled action threw falsy error")}if(s)return this.unsubscribe(),i},e.prototype.unsubscribe=function(){if(!this.closed){var r=this,n=r.id,s=r.scheduler,i=s.actions;this.work=this.state=this.scheduler=null,this.pending=!1,Rp(i,this),n!=null&&(this.id=this.recycleAsyncId(s,n,null)),this.delay=null,t.prototype.unsubscribe.call(this)}},e})(J8),DE=(function(){function t(e,r){r===void 0&&(r=t.now),this.schedulerActionCtor=e,this.now=r}return t.prototype.schedule=function(e,r,n){return r===void 0&&(r=0),new this.schedulerActionCtor(this,e).schedule(n,r)},t.now=Z8.now,t})(),eP=(function(t){Pa(e,t);function e(r,n){n===void 0&&(n=DE.now);var s=t.call(this,r,n)||this;return s.actions=[],s._active=!1,s}return e.prototype.flush=function(r){var n=this.actions;if(this._active){n.push(r);return}var s;this._active=!0;do if(s=r.execute(r.state,r.delay))break;while(r=n.shift());if(this._active=!1,s){for(;r=n.shift();)r.unsubscribe();throw s}},e})(DE),tP=new eP(Q8),rP=tP,nP=new ss(function(t){return t.complete()});function jC(t){return t&&Ur(t.schedule)}function sP(t){return t[t.length-1]}function iP(t){return jC(sP(t))?t.pop():void 0}var FC=(function(t){return t&&typeof t.length=="number"&&typeof t!="function"});function qC(t){return Ur(t?.then)}function zC(t){return Ur(t[_1])}function HC(t){return Symbol.asyncIterator&&Ur(t?.[Symbol.asyncIterator])}function WC(t){return new TypeError("You provided "+(t!==null&&typeof t=="object"?"an invalid object":"'"+t+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function oP(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var VC=oP();function KC(t){return Ur(t?.[VC])}function GC(t){return B8(this,arguments,function(){var r,n,s,i;return UC(this,function(o){switch(o.label){case 0:r=t.getReader(),o.label=1;case 1:o.trys.push([1,,9,10]),o.label=2;case 2:return[4,Ul(r.read())];case 3:return n=o.sent(),s=n.value,i=n.done,i?[4,Ul(void 0)]:[3,5];case 4:return[2,o.sent()];case 5:return[4,Ul(s)];case 6:return[4,o.sent()];case 7:return o.sent(),[3,2];case 8:return[3,10];case 9:return r.releaseLock(),[7];case 10:return[2]}})})}function YC(t){return Ur(t?.getReader)}function Ch(t){if(t instanceof ss)return t;if(t!=null){if(zC(t))return aP(t);if(FC(t))return cP(t);if(qC(t))return lP(t);if(HC(t))return XC(t);if(KC(t))return uP(t);if(YC(t))return dP(t)}throw WC(t)}function aP(t){return new ss(function(e){var r=t[_1]();if(Ur(r.subscribe))return r.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function cP(t){return new ss(function(e){for(var r=0;r<t.length&&!e.closed;r++)e.next(t[r]);e.complete()})}function lP(t){return new ss(function(e){t.then(function(r){e.closed||(e.next(r),e.complete())},function(r){return e.error(r)}).then(null,MC)})}function uP(t){return new ss(function(e){var r,n;try{for(var s=Yl(t),i=s.next();!i.done;i=s.next()){var o=i.value;if(e.next(o),e.closed)return}}catch(a){r={error:a}}finally{try{i&&!i.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}e.complete()})}function XC(t){return new ss(function(e){hP(t,e).catch(function(r){return e.error(r)})})}function dP(t){return XC(GC(t))}function hP(t,e){var r,n,s,i;return U8(this,void 0,void 0,function(){var o,a;return UC(this,function(c){switch(c.label){case 0:c.trys.push([0,5,6,11]),r=L8(t),c.label=1;case 1:return[4,r.next()];case 2:if(n=c.sent(),!!n.done)return[3,4];if(o=n.value,e.next(o),e.closed)return[2];c.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return a=c.sent(),s={error:a},[3,11];case 6:return c.trys.push([6,,9,10]),n&&!n.done&&(i=r.return)?[4,i.call(r)]:[3,8];case 7:c.sent(),c.label=8;case 8:return[3,10];case 9:if(s)throw s.error;return[7];case 10:return[7];case 11:return e.complete(),[2]}})})}function Ac(t,e,r,n,s){n===void 0&&(n=0),s===void 0&&(s=!1);var i=e.schedule(function(){r(),s?t.add(this.schedule(null,n)):this.unsubscribe()},n);if(t.add(i),!s)return i}function ZC(t,e){return e===void 0&&(e=0),Ih(function(r,n){r.subscribe(Rd(n,function(s){return Ac(n,t,function(){return n.next(s)},e)},function(){return Ac(n,t,function(){return n.complete()},e)},function(s){return Ac(n,t,function(){return n.error(s)},e)}))})}function JC(t,e){return e===void 0&&(e=0),Ih(function(r,n){n.add(t.schedule(function(){return r.subscribe(n)},e))})}function fP(t,e){return Ch(t).pipe(JC(e),ZC(e))}function pP(t,e){return Ch(t).pipe(JC(e),ZC(e))}function gP(t,e){return new ss(function(r){var n=0;return e.schedule(function(){n===t.length?r.complete():(r.next(t[n++]),r.closed||this.schedule())})})}function yP(t,e){return new ss(function(r){var n;return Ac(r,e,function(){n=t[VC](),Ac(r,e,function(){var s,i,o;try{s=n.next(),i=s.value,o=s.done}catch(a){r.error(a);return}o?r.complete():r.next(i)},0,!0)}),function(){return Ur(n?.return)&&n.return()}})}function QC(t,e){if(!t)throw new Error("Iterable cannot be null");return new ss(function(r){Ac(r,e,function(){var n=t[Symbol.asyncIterator]();Ac(r,e,function(){n.next().then(function(s){s.done?r.complete():r.next(s.value)})},0,!0)})})}function mP(t,e){return QC(GC(t),e)}function wP(t,e){if(t!=null){if(zC(t))return fP(t,e);if(FC(t))return gP(t,e);if(qC(t))return pP(t,e);if(HC(t))return QC(t,e);if(KC(t))return yP(t,e);if(YC(t))return mP(t,e)}throw WC(t)}function bP(t,e){return e?wP(t,e):Ch(t)}function zy(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=iP(t);return bP(t,r)}function Hy(t,e){var r=Ur(t)?t:function(){return t},n=function(s){return s.error(r())};return new ss(n)}var vP=v1(function(t){return function(){t(this),this.name="EmptyError",this.message="no elements in sequence"}});function cf(t,e){return new Promise(function(r,n){var s=new Dp({next:function(i){r(i),s.unsubscribe()},error:n,complete:function(){n(new vP)}});t.subscribe(s)})}function EP(t){return t instanceof Date&&!isNaN(t)}function _P(t,e,r){r===void 0&&(r=rP);var n=-1;return jC(e)?r=e:n=e,new ss(function(s){var i=EP(t)?+t-r.now():t;i<0&&(i=0);var o=0;return r.schedule(function(){s.closed||(s.next(o++),0<=n?this.schedule(void 0,n):s.complete())},i)})}function lf(t){return t<=0?function(){return nP}:Ih(function(e,r){var n=0;e.subscribe(Rd(r,function(s){++n<=t&&(r.next(s),t<=n&&r.complete())}))})}function Wy(t,e){return Ih(function(r,n){var s=null,i=0,o=!1,a=function(){return o&&!s&&n.complete()};r.subscribe(Rd(n,function(c){s?.unsubscribe();var l=0,u=i++;Ch(t(c,u)).subscribe(s=Rd(n,function(d){return n.next(e?e(c,d,u,l++):d)},function(){s=null,a()}))},function(){o=!0,a()}))})}function ds(t){return Ih(function(e,r){Ch(t).subscribe(Rd(r,function(){return r.complete()},c0)),!r.closed&&e.subscribe(r)})}let Vy=class{constructor(){this.isConnected=!1}sendEventToContentScript(e,r,n){return new Promise((s=>{const i=o=>{o.source!==window||!o.data||o.origin!==window.origin||o.data.eventId===n&&(s(o),window.removeEventListener("message",i,!1))};window.addEventListener("message",i,!1),window.webkit.messageHandlers.cordova_iab.postMessage(JSON.stringify({type:e,eventId:n,detail:r}))}))}async enableConnection(){const e={origin:window.origin,host:window.location.host,permissions:{canRequestPublicKey:!0,canRequestSign:!0}},r=await this.sendEventToContentScript(_s.XBULL_CONNECT,e,crypto.randomUUID()),{detail:n}=r.data;if(!n||n.error)throw{code:n?.code||-1,message:n?.errorMessage||"Unexpected error"};this.isConnected=!0}async getAddress(){try{await this.enableConnection()}catch(s){return{error:{code:s?.code||-1,message:s?.message||"Unexpected error"}}}const e={origin:window.origin,host:window.location.host},r=await this.sendEventToContentScript(_s.XBULL_GET_PUBLIC_KEY,e,crypto.randomUUID()),{detail:n}=r.data;return!n||n.error?{error:{code:n?.code||-1,message:n?.errorMessage||"Unexpected error"}}:{address:n.payload}}async signTransaction(e){if(e.opts?.submit||e.opts?.submitUrl)return{error:{code:-1,message:"Parameters `submit` and `submitUrl` are not supported"}};try{await this.enableConnection()}catch(i){return{error:{code:i?.code||-1,message:i?.message||"Unexpected error"}}}const r={origin:window.origin,host:window.location.host,network:e.opts?.networkPassphrase,publicKey:e.opts?.address,xdr:e.xdr,xdrType:"Transaction"},n=await this.sendEventToContentScript(_s.XBULL_SIGN_XDR,r,crypto.randomUUID()),{detail:s}=n.data;return!s||s.error?{error:{code:s?.code||-1,message:s?.errorMessage||"Unexpected error"}}:{signedTxXdr:s.payload.signedXdr,signerAddress:s.payload.signerAddress}}async signMessage(e,r){if(!e)return{error:{code:-1,message:"The message must be defined."}};try{await this.enableConnection()}catch(o){return{error:{code:o?.code||-1,message:o?.message||"Unexpected error"}}}const n={origin:window.origin,host:window.location.host,message:e,publicKey:r?.address,network:r?.networkPassphrase},s=await this.sendEventToContentScript(_s.XBULL_SIGN_MESSAGE,n,crypto.randomUUID()),{detail:i}=s.data;return!i||i.error?{error:{code:i?.code||-1,message:i?.errorMessage||"Unexpected error"}}:{signedMessage:i.payload.signedMessage,signerAddress:i.payload.signerAddress}}async getNetwork(){try{await this.enableConnection()}catch(s){return{error:{code:s?.code||-1,message:s?.message||"Unexpected error"}}}const e={origin:window.origin,host:window.location.host},r=await this.sendEventToContentScript(_s.XBULL_GET_NETWORK,e,crypto.randomUUID()),{detail:n}=r.data;return!n||n.error?{error:{code:n?.code||-1,message:n?.errorMessage||"Unexpected error"}}:{network:n.payload.network,networkPassphrase:n.payload.networkPassphrase}}},Ky=class{constructor(e){this.closeCurrentPromises$=new oi,this.closeObservables$=new oi,this.initialResponse$=new oi,this.initialResponseCompleted$=new oi,this.connectResponse$=new oi,this.connectResult$=new oi,this.signResponse$=new oi,this.signResult$=new oi,this.signMessageResponse$=new oi,this.signMessageResult$=new oi,this.closeCurrentPromisesSubscription=_P(1e3,1e3).pipe(ds(this.closeObservables$)).subscribe((()=>{this.target?.closed&&this.closeCurrentPromises$.next()})),this.onInititalResponseSubscription=this.initialResponse$.pipe(ds(this.closeObservables$)).subscribe((i=>{const o=this.decryptFromReceiver({oneTimeCode:i.data.oneTimeCode,payload:i.data.message,senderPublicKey:i.data.publicKey});JSON.parse(o).providedSession===this.session()&&(this.targetPublicKey=i.data.publicKey,this.initialResponseCompleted$.next())})),this.onConnectResponseSubscription=this.connectResponse$.pipe(ds(this.closeObservables$)).subscribe((i=>{if(!this.targetPublicKey)return void this.connectResult$.next({success:!1,message:"Wallet encryption public key is not provided, request rejected."});if(!i.data.success)return void this.connectResult$.next({success:!1,message:"Request rejected from the wallet"});const o=this.decryptFromReceiver({oneTimeCode:i.data.oneTimeCode,payload:i.data.message,senderPublicKey:this.targetPublicKey}),a=JSON.parse(o);this.connectResult$.next({success:!0,publicKey:a.publicKey})})),this.onSignResponseSubscription=this.signResponse$.pipe(ds(this.closeObservables$)).subscribe((i=>{if(!this.targetPublicKey)return void this.signResult$.next({success:!1,message:"Wallet encryption public key is not provided, request rejected."});if(!i.data.success)return void this.signResult$.next({success:!1,message:"Request rejected from the wallet"});const o=this.decryptFromReceiver({oneTimeCode:i.data.oneTimeCode,payload:i.data.message,senderPublicKey:this.targetPublicKey}),a=JSON.parse(o);this.signResult$.next({success:!0,xdr:a.xdr})})),this.onSignMessageResponseSubscription=this.signMessageResponse$.pipe(ds(this.closeObservables$)).subscribe((i=>{if(!this.targetPublicKey)return void this.signMessageResult$.next({success:!1,message:"Wallet encryption public key is not provided, request rejected."});if(!i.data.success)return void this.signMessageResult$.next({success:!1,message:"Request rejected from the wallet"});const o=this.decryptFromReceiver({oneTimeCode:i.data.oneTimeCode,payload:i.data.message,senderPublicKey:this.targetPublicKey}),a=JSON.parse(o);this.signMessageResult$.next({success:!0,...a})})),this.preferredTarget=e?.preferredTarget||"extension",this.walletUrl=e?.url||"https://wallet.xbull.app/connect";const r=$u.box.keyPair(),n=Os.encodeBase64($u.randomBytes(24));this.encryptForReceiver=i=>{const o=$u.randomBytes(24),a=$u.box(Os.decodeUTF8(i.data),o,i.receiverPublicKey,r.secretKey);return{message:Os.encodeBase64(a),oneTimeCode:Os.encodeBase64(o)}},this.decryptFromReceiver=i=>{const o=$u.box.open(Os.decodeBase64(i.payload),Os.decodeBase64(i.oneTimeCode),Os.decodeBase64(i.senderPublicKey),r.secretKey);if(!o)throw new Error("Decrypted message is null");return Os.encodeUTF8(o)},this.publicKey=()=>r.publicKey,this.session=()=>n.slice();const s=i=>{switch(i.data.type){case _s.XBULL_INITIAL_RESPONSE:this.initialResponse$.next(i);break;case _s.XBULL_CONNECT_RESPONSE:this.connectResponse$.next(i);break;case _s.XBULL_SIGN_RESPONSE:this.signResponse$.next(i);break;case _s.XBULL_SIGN_MESSAGE_RESPONSE:this.signMessageResponse$.next(i)}};window.addEventListener("message",s),this.closeObservables$.asObservable().pipe(lf(1)).subscribe((()=>{window.removeEventListener("message",s)}))}openWallet(){return this.target&&!this.target.closed&&(this.target.close(),this.target=null,this.closeCurrentPromises$.next()),this.target=window.open(`${this.walletUrl}?public=${encodeURIComponent(Os.encodeBase64(this.publicKey()))}&session=${encodeURIComponent(this.session())}`,"xBull_Wallet_app","width=380,height=640,left=100,top=100"),cf(this.initialResponseCompleted$.pipe(ds(this.closeCurrentPromises$)).pipe(ds(this.closeObservables$)))}closeWallet(){this.target&&(this.target?.close(),this.target=null)}async connect(e={canRequestPublicKey:!0,canRequestSign:!0}){const r=window?.webkit?.messageHandlers?.cordova_iab?new Vy:window.xBullSDK;if(r&&this.preferredTarget==="extension"){const n=await r.getAddress();if(Fy(n))throw n.error;return n.address}{if(await this.openWallet(),!this.target||!this.targetPublicKey)throw new Error("xBull Wallet is not open, we can't connect with it");const{message:n,oneTimeCode:s}=this.encryptForReceiver({data:JSON.stringify(e),receiverPublicKey:Os.decodeBase64(this.targetPublicKey)}),i={type:_s.XBULL_CONNECT,message:n,oneTimeCode:s};this.target.postMessage(i,"*");const o=this.connectResult$.asObservable().pipe(Wy((a=>a.success?(this.closeWallet(),zy(a.publicKey)):(this.closeWallet(),Hy((()=>new Error(a.message))))))).pipe(lf(1)).pipe(ds(this.closeCurrentPromises$)).pipe(ds(this.closeObservables$));return cf(o)}}async sign(e){const r=window?.webkit?.messageHandlers?.cordova_iab?new Vy:window.xBullSDK;if(r&&this.preferredTarget==="extension"){const n=await r.signTransaction({xdr:e.xdr,opts:{networkPassphrase:e.network,address:e.publicKey}});if(Fy(n))throw n.error;return n.signedTxXdr}{if(await this.openWallet(),!this.target||!this.targetPublicKey)throw new Error("xBull Wallet is not open, we can't connect with it");if(typeof e.xdr!="string")throw new Error("XDR provided needs to be a string value");const{message:n,oneTimeCode:s}=this.encryptForReceiver({data:JSON.stringify(e),receiverPublicKey:Os.decodeBase64(this.targetPublicKey)}),i={type:_s.XBULL_SIGN,message:n,oneTimeCode:s};this.target.postMessage(i,"*");const o=this.signResult$.asObservable().pipe(Wy((a=>a.success?(this.closeWallet(),zy(a.xdr)):(this.closeWallet(),Hy((()=>new Error(a.message))))))).pipe(lf(1)).pipe(ds(this.closeCurrentPromises$)).pipe(ds(this.closeObservables$));return cf(o)}}async signMessage(e,r){const n=window?.webkit?.messageHandlers?.cordova_iab?new Vy:window.xBullSDK;if(n&&this.preferredTarget==="extension"){const s=await n.signMessage(e,r);if(Fy(s))throw s.error;return s}{if(await this.openWallet(),!this.target||!this.targetPublicKey)throw new Error("xBull Wallet is not open, we can't connect with it");if(typeof e!="string")throw new Error("XDR provided needs to be a string value");const s=this.encryptForReceiver({data:JSON.stringify({message:e,opts:r}),receiverPublicKey:Os.decodeBase64(this.targetPublicKey)}),i={type:_s.XBULL_SIGN_MESSAGE,message:s.message,oneTimeCode:s.oneTimeCode};this.target.postMessage(i,"*");const o=this.signMessageResult$.asObservable().pipe(Wy((a=>a.success?(this.closeWallet(),zy({signedMessage:a.signedMessage,signerAddress:a.signerAddress})):(this.closeWallet(),Hy((()=>new Error(a.message))))))).pipe(lf(1)).pipe(ds(this.closeCurrentPromises$)).pipe(ds(this.closeObservables$));return cf(o)}}closeConnections(){this.closeObservables$.next(),this.closeCurrentPromises$.next(),this.closeObservables$.complete(),this.closeCurrentPromises$.complete()}};const xP="xbull";class SP{moduleType=Bo.HOT_WALLET;productId=xP;productName="xBull";productUrl="https://xbull.app";productIcon="https://stellar.creit.tech/wallet-icons/xbull.png";isAvailable(){return Promise.resolve(!0)}async getAddress(){try{const e=new Ky,r=await e.connect();return e.closeConnections(),{address:r}}catch(e){throw Bt(e)}}async signTransaction(e,r){try{const n=new Ky,s=await n.sign({xdr:e,publicKey:r?.address,network:r?.networkPassphrase});return n.closeConnections(),{signedTxXdr:s,signerAddress:r?.address}}catch(n){throw Bt(n)}}signAuthEntry(){return Promise.reject({code:-3,message:'xBull does not support the "signAuthEntry" function'})}async signMessage(e,r){try{const n=new Ky,s=await n.signMessage(e,{address:r?.address,networkPassphrase:r?.networkPassphrase});return n.closeConnections(),s}catch(n){throw Bt(n)}}getNetwork(){return Promise.reject({code:-3,message:'xBull does not support the "getNetwork" function'})}}const AP="hana";class IP{moduleType=Bo.HOT_WALLET;productId=AP;productName="Hana Wallet";productUrl="https://hanawallet.io/";productIcon="https://stellar.creit.tech/wallet-icons/hana.png";async runChecks(){if(!await this.isAvailable())throw new Error("Hana Wallet is not installed")}async isAvailable(){return typeof window<"u"&&!!window.hanaWallet?.stellar}async getAddress(){try{return await this.runChecks(),{address:await window.hanaWallet.stellar.getPublicKey()}}catch(e){throw Bt(e)}}async signTransaction(e,r){try{return await this.runChecks(),{signedTxXdr:await window.hanaWallet.stellar.signTransaction({xdr:e,accountToSign:r?.address,networkPassphrase:r?.networkPassphrase}),signerAddress:r?.address}}catch(n){throw Bt(n)}}async signAuthEntry(e,r){try{return await this.runChecks(),{signedAuthEntry:await window.hanaWallet.stellar.signAuthEntry({xdr:e,accountToSign:r?.address}),signerAddress:r?.address}}catch(n){throw Bt(n)}}async signMessage(e,r){try{return await this.runChecks(),{signedMessage:await window.hanaWallet.stellar.signMessage({message:e,accountToSign:r?.address}),signerAddress:r?.address}}catch(n){throw Bt(n)}}async getNetwork(){throw{code:-3,message:'Hana does not support the "getNetwork" function'}}}const CP="klever";class $P{moduleType=Bo.HOT_WALLET;productId=CP;productName="Klever Wallet";productUrl="https://klever.io/";productIcon="https://stellar.creit.tech/wallet-icons/klever.png";async runChecks(){if(!await this.isAvailable())throw new Error("Klever Wallet is not installed")}async isAvailable(){return typeof window<"u"&&!!window.kleverWallet?.stellar}async getAddress(){return this.runChecks().then(()=>window.kleverWallet.stellar.getAddress()).catch(e=>{throw Bt(e)})}async signTransaction(e,r){return this.runChecks().then(()=>window.kleverWallet.stellar.signTransaction(e,r)).catch(n=>{throw Bt(n)})}async signAuthEntry(e,r){return this.runChecks().then(()=>window.kleverWallet.stellar.signAuthEntry(e,r)).catch(n=>{throw Bt(n)})}async signMessage(e,r){return this.runChecks().then(()=>window.kleverWallet.stellar.signMessage(e,r)).catch(n=>{throw Bt(n)})}async getNetwork(){return this.runChecks().then(()=>window.kleverWallet.stellar.getNetwork()).catch(e=>{throw Bt(e)})}}function TP(t){const e=[new o8,new _8,new $8,new SP,new I8,new IP,new $P];return t?.filterBy?e.filter(t.filterBy):e}var uf={exports:{}},UE;function NP(){if(UE)return uf.exports;UE=1;var t=typeof Reflect=="object"?Reflect:null,e=t&&typeof t.apply=="function"?t.apply:function(C,O,L){return Function.prototype.apply.call(C,O,L)},r;t&&typeof t.ownKeys=="function"?r=t.ownKeys:Object.getOwnPropertySymbols?r=function(C){return Object.getOwnPropertyNames(C).concat(Object.getOwnPropertySymbols(C))}:r=function(C){return Object.getOwnPropertyNames(C)};function n(v){console&&console.warn&&console.warn(v)}var s=Number.isNaN||function(C){return C!==C};function i(){i.init.call(this)}uf.exports=i,uf.exports.once=S,i.EventEmitter=i,i.prototype._events=void 0,i.prototype._eventsCount=0,i.prototype._maxListeners=void 0;var o=10;function a(v){if(typeof v!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof v)}Object.defineProperty(i,"defaultMaxListeners",{enumerable:!0,get:function(){return o},set:function(v){if(typeof v!="number"||v<0||s(v))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+v+".");o=v}}),i.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},i.prototype.setMaxListeners=function(C){if(typeof C!="number"||C<0||s(C))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+C+".");return this._maxListeners=C,this};function c(v){return v._maxListeners===void 0?i.defaultMaxListeners:v._maxListeners}i.prototype.getMaxListeners=function(){return c(this)},i.prototype.emit=function(C){for(var O=[],L=1;L<arguments.length;L++)O.push(arguments[L]);var j=C==="error",D=this._events;if(D!==void 0)j=j&&D.error===void 0;else if(!j)return!1;if(j){var W;if(O.length>0&&(W=O[0]),W instanceof Error)throw W;var P=new Error("Unhandled error."+(W?" ("+W.message+")":""));throw P.context=W,P}var R=D[C];if(R===void 0)return!1;if(typeof R=="function")e(R,this,O);else for(var T=R.length,k=y(R,T),L=0;L<T;++L)e(k[L],this,O);return!0};function l(v,C,O,L){var j,D,W;if(a(O),D=v._events,D===void 0?(D=v._events=Object.create(null),v._eventsCount=0):(D.newListener!==void 0&&(v.emit("newListener",C,O.listener?O.listener:O),D=v._events),W=D[C]),W===void 0)W=D[C]=O,++v._eventsCount;else if(typeof W=="function"?W=D[C]=L?[O,W]:[W,O]:L?W.unshift(O):W.push(O),j=c(v),j>0&&W.length>j&&!W.warned){W.warned=!0;var P=new Error("Possible EventEmitter memory leak detected. "+W.length+" "+String(C)+" listeners added. Use emitter.setMaxListeners() to increase limit");P.name="MaxListenersExceededWarning",P.emitter=v,P.type=C,P.count=W.length,n(P)}return v}i.prototype.addListener=function(C,O){return l(this,C,O,!1)},i.prototype.on=i.prototype.addListener,i.prototype.prependListener=function(C,O){return l(this,C,O,!0)};function u(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function d(v,C,O){var L={fired:!1,wrapFn:void 0,target:v,type:C,listener:O},j=u.bind(L);return j.listener=O,L.wrapFn=j,j}i.prototype.once=function(C,O){return a(O),this.on(C,d(this,C,O)),this},i.prototype.prependOnceListener=function(C,O){return a(O),this.prependListener(C,d(this,C,O)),this},i.prototype.removeListener=function(C,O){var L,j,D,W,P;if(a(O),j=this._events,j===void 0)return this;if(L=j[C],L===void 0)return this;if(L===O||L.listener===O)--this._eventsCount===0?this._events=Object.create(null):(delete j[C],j.removeListener&&this.emit("removeListener",C,L.listener||O));else if(typeof L!="function"){for(D=-1,W=L.length-1;W>=0;W--)if(L[W]===O||L[W].listener===O){P=L[W].listener,D=W;break}if(D<0)return this;D===0?L.shift():g(L,D),L.length===1&&(j[C]=L[0]),j.removeListener!==void 0&&this.emit("removeListener",C,P||O)}return this},i.prototype.off=i.prototype.removeListener,i.prototype.removeAllListeners=function(C){var O,L,j;if(L=this._events,L===void 0)return this;if(L.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):L[C]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete L[C]),this;if(arguments.length===0){var D=Object.keys(L),W;for(j=0;j<D.length;++j)W=D[j],W!=="removeListener"&&this.removeAllListeners(W);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(O=L[C],typeof O=="function")this.removeListener(C,O);else if(O!==void 0)for(j=O.length-1;j>=0;j--)this.removeListener(C,O[j]);return this};function h(v,C,O){var L=v._events;if(L===void 0)return[];var j=L[C];return j===void 0?[]:typeof j=="function"?O?[j.listener||j]:[j]:O?w(j):y(j,j.length)}i.prototype.listeners=function(C){return h(this,C,!0)},i.prototype.rawListeners=function(C){return h(this,C,!1)},i.listenerCount=function(v,C){return typeof v.listenerCount=="function"?v.listenerCount(C):p.call(v,C)},i.prototype.listenerCount=p;function p(v){var C=this._events;if(C!==void 0){var O=C[v];if(typeof O=="function")return 1;if(O!==void 0)return O.length}return 0}i.prototype.eventNames=function(){return this._eventsCount>0?r(this._events):[]};function y(v,C){for(var O=new Array(C),L=0;L<C;++L)O[L]=v[L];return O}function g(v,C){for(;C+1<v.length;C++)v[C]=v[C+1];v.pop()}function w(v){for(var C=new Array(v.length),O=0;O<C.length;++O)C[O]=v[O].listener||v[O];return C}function S(v,C){return new Promise(function(O,L){function j(W){v.removeListener(C,D),L(W)}function D(){typeof v.removeListener=="function"&&v.removeListener("error",j),O([].slice.call(arguments))}E(v,C,D,{once:!0}),C!=="error"&&A(v,j,{once:!0})})}function A(v,C,O){typeof v.on=="function"&&E(v,"error",C,O)}function E(v,C,O,L){if(typeof v.on=="function")L.once?v.once(C,O):v.on(C,O);else if(typeof v.addEventListener=="function")v.addEventListener(C,function j(D){L.once&&v.removeEventListener(C,j),O(D)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof v)}return uf.exports}var dr=NP();const $h=Sh(dr);var Gy={};var l0=function(t,e){return l0=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var s in n)n.hasOwnProperty(s)&&(r[s]=n[s])},l0(t,e)};function OP(t,e){l0(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var u0=function(){return u0=Object.assign||function(e){for(var r,n=1,s=arguments.length;n<s;n++){r=arguments[n];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},u0.apply(this,arguments)};function kP(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r}function PP(t,e,r,n){var s=arguments.length,i=s<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,r):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(t,e,r,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(i=(s<3?o(i):s>3?o(e,r,i):o(e,r))||i);return s>3&&i&&Object.defineProperty(e,r,i),i}function RP(t,e){return function(r,n){e(r,n,t)}}function DP(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function UP(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})}function BP(t,e){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(l){return function(u){return c([l,u])}}function c(l){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,s&&(i=l[0]&2?s.return:l[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,l[1])).done)return i;switch(s=0,i&&(l=[l[0]&2,i.value]),l[0]){case 0:case 1:i=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,s=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!i||l[1]>i[0]&&l[1]<i[3])){r.label=l[1];break}if(l[0]===6&&r.label<i[1]){r.label=i[1],i=l;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(l);break}i[2]&&r.ops.pop(),r.trys.pop();continue}l=e.call(t,r)}catch(u){l=[6,u],s=0}finally{n=i=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function LP(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}function MP(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function d0(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function e3(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),s,i=[],o;try{for(;(e===void 0||e-- >0)&&!(s=n.next()).done;)i.push(s.value)}catch(a){o={error:a}}finally{try{s&&!s.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return i}function jP(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(e3(arguments[e]));return t}function FP(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),s=0,e=0;e<r;e++)for(var i=arguments[e],o=0,a=i.length;o<a;o++,s++)n[s]=i[o];return n}function Dd(t){return this instanceof Dd?(this.v=t,this):new Dd(t)}function qP(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(t,e||[]),s,i=[];return s={},o("next"),o("throw"),o("return"),s[Symbol.asyncIterator]=function(){return this},s;function o(h){n[h]&&(s[h]=function(p){return new Promise(function(y,g){i.push([h,p,y,g])>1||a(h,p)})})}function a(h,p){try{c(n[h](p))}catch(y){d(i[0][3],y)}}function c(h){h.value instanceof Dd?Promise.resolve(h.value.v).then(l,u):d(i[0][2],h)}function l(h){a("next",h)}function u(h){a("throw",h)}function d(h,p){h(p),i.shift(),i.length&&a(i[0][0],i[0][1])}}function zP(t){var e,r;return e={},n("next"),n("throw",function(s){throw s}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(s,i){e[s]=t[s]?function(o){return(r=!r)?{value:Dd(t[s](o)),done:s==="return"}:i?i(o):o}:i}}function HP(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof d0=="function"?d0(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(i){r[i]=t[i]&&function(o){return new Promise(function(a,c){o=t[i](o),s(a,c,o.done,o.value)})}}function s(i,o,a,c){Promise.resolve(c).then(function(l){i({value:l,done:a})},o)}}function WP(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function VP(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function KP(t){return t&&t.__esModule?t:{default:t}}function GP(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function YP(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}const XP=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return u0},__asyncDelegator:zP,__asyncGenerator:qP,__asyncValues:HP,__await:Dd,__awaiter:UP,__classPrivateFieldGet:GP,__classPrivateFieldSet:YP,__createBinding:LP,__decorate:PP,__exportStar:MP,__extends:OP,__generator:BP,__importDefault:KP,__importStar:VP,__makeTemplateObject:WP,__metadata:DP,__param:RP,__read:e3,__rest:kP,__spread:jP,__spreadArrays:FP,__values:d0},Symbol.toStringTag,{value:"Module"})),Mg=m1(XP);var Yy={},Tu={},BE;function ZP(){if(BE)return Tu;BE=1,Object.defineProperty(Tu,"__esModule",{value:!0}),Tu.delay=void 0;function t(e){return new Promise(r=>{setTimeout(()=>{r(!0)},e)})}return Tu.delay=t,Tu}var Ha={},Xy={},Wa={},LE;function JP(){return LE||(LE=1,Object.defineProperty(Wa,"__esModule",{value:!0}),Wa.ONE_THOUSAND=Wa.ONE_HUNDRED=void 0,Wa.ONE_HUNDRED=100,Wa.ONE_THOUSAND=1e3),Wa}var Zy={},ME;function QP(){return ME||(ME=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ONE_YEAR=t.FOUR_WEEKS=t.THREE_WEEKS=t.TWO_WEEKS=t.ONE_WEEK=t.THIRTY_DAYS=t.SEVEN_DAYS=t.FIVE_DAYS=t.THREE_DAYS=t.ONE_DAY=t.TWENTY_FOUR_HOURS=t.TWELVE_HOURS=t.SIX_HOURS=t.THREE_HOURS=t.ONE_HOUR=t.SIXTY_MINUTES=t.THIRTY_MINUTES=t.TEN_MINUTES=t.FIVE_MINUTES=t.ONE_MINUTE=t.SIXTY_SECONDS=t.THIRTY_SECONDS=t.TEN_SECONDS=t.FIVE_SECONDS=t.ONE_SECOND=void 0,t.ONE_SECOND=1,t.FIVE_SECONDS=5,t.TEN_SECONDS=10,t.THIRTY_SECONDS=30,t.SIXTY_SECONDS=60,t.ONE_MINUTE=t.SIXTY_SECONDS,t.FIVE_MINUTES=t.ONE_MINUTE*5,t.TEN_MINUTES=t.ONE_MINUTE*10,t.THIRTY_MINUTES=t.ONE_MINUTE*30,t.SIXTY_MINUTES=t.ONE_MINUTE*60,t.ONE_HOUR=t.SIXTY_MINUTES,t.THREE_HOURS=t.ONE_HOUR*3,t.SIX_HOURS=t.ONE_HOUR*6,t.TWELVE_HOURS=t.ONE_HOUR*12,t.TWENTY_FOUR_HOURS=t.ONE_HOUR*24,t.ONE_DAY=t.TWENTY_FOUR_HOURS,t.THREE_DAYS=t.ONE_DAY*3,t.FIVE_DAYS=t.ONE_DAY*5,t.SEVEN_DAYS=t.ONE_DAY*7,t.THIRTY_DAYS=t.ONE_DAY*30,t.ONE_WEEK=t.SEVEN_DAYS,t.TWO_WEEKS=t.ONE_WEEK*2,t.THREE_WEEKS=t.ONE_WEEK*3,t.FOUR_WEEKS=t.ONE_WEEK*4,t.ONE_YEAR=t.ONE_DAY*365})(Zy)),Zy}var jE;function t3(){return jE||(jE=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Mg;e.__exportStar(JP(),t),e.__exportStar(QP(),t)})(Xy)),Xy}var FE;function e4(){if(FE)return Ha;FE=1,Object.defineProperty(Ha,"__esModule",{value:!0}),Ha.fromMiliseconds=Ha.toMiliseconds=void 0;const t=t3();function e(n){return n*t.ONE_THOUSAND}Ha.toMiliseconds=e;function r(n){return Math.floor(n/t.ONE_THOUSAND)}return Ha.fromMiliseconds=r,Ha}var qE;function t4(){return qE||(qE=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Mg;e.__exportStar(ZP(),t),e.__exportStar(e4(),t)})(Yy)),Yy}var cl={},zE;function r4(){if(zE)return cl;zE=1,Object.defineProperty(cl,"__esModule",{value:!0}),cl.Watch=void 0;class t{constructor(){this.timestamps=new Map}start(r){if(this.timestamps.has(r))throw new Error(`Watch already started for label: ${r}`);this.timestamps.set(r,{started:Date.now()})}stop(r){const n=this.get(r);if(typeof n.elapsed<"u")throw new Error(`Watch already stopped for label: ${r}`);const s=Date.now()-n.started;this.timestamps.set(r,{started:n.started,elapsed:s})}get(r){const n=this.timestamps.get(r);if(typeof n>"u")throw new Error(`No timestamp found for label: ${r}`);return n}elapsed(r){const n=this.get(r);return n.elapsed||Date.now()-n.started}}return cl.Watch=t,cl.default=t,cl}var Jy={},Nu={},HE;function n4(){if(HE)return Nu;HE=1,Object.defineProperty(Nu,"__esModule",{value:!0}),Nu.IWatch=void 0;class t{}return Nu.IWatch=t,Nu}var WE;function s4(){return WE||(WE=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),Mg.__exportStar(n4(),t)})(Jy)),Jy}var VE;function i4(){return VE||(VE=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Mg;e.__exportStar(t4(),t),e.__exportStar(r4(),t),e.__exportStar(s4(),t),e.__exportStar(t3(),t)})(Gy)),Gy}var X=i4();let is=class{},o4=class extends is{constructor(e){super()}};const KE=X.FIVE_SECONDS,zc={pulse:"heartbeat_pulse"};let a4=class r3 extends o4{constructor(e){super(e),this.events=new dr.EventEmitter,this.interval=KE,this.interval=e?.interval||KE}static async init(e){const r=new r3(e);return await r.init(),r}async init(){await this.initialize()}stop(){clearInterval(this.intervalRef)}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async initialize(){this.intervalRef=setInterval(()=>this.pulse(),X.toMiliseconds(this.interval))}pulse(){this.events.emit(zc.pulse)}};const c4=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,l4=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,u4=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function d4(t,e){if(t==="__proto__"||t==="constructor"&&e&&typeof e=="object"&&"prototype"in e){h4(t);return}return e}function h4(t){console.warn(`[destr] Dropping "${t}" key to prevent prototype pollution.`)}function df(t,e={}){if(typeof t!="string")return t;if(t[0]==='"'&&t[t.length-1]==='"'&&t.indexOf("\\")===-1)return t.slice(1,-1);const r=t.trim();if(r.length<=9)switch(r.toLowerCase()){case"true":return!0;case"false":return!1;case"undefined":return;case"null":return null;case"nan":return Number.NaN;case"infinity":return Number.POSITIVE_INFINITY;case"-infinity":return Number.NEGATIVE_INFINITY}if(!u4.test(t)){if(e.strict)throw new SyntaxError("[destr] Invalid JSON");return t}try{if(c4.test(t)||l4.test(t)){if(e.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(t,d4)}return JSON.parse(t)}catch(n){if(e.strict)throw n;return t}}function f4(t){return!t||typeof t.then!="function"?Promise.resolve(t):t}function zr(t,...e){try{return f4(t(...e))}catch(r){return Promise.reject(r)}}function p4(t){const e=typeof t;return t===null||e!=="object"&&e!=="function"}function g4(t){const e=Object.getPrototypeOf(t);return!e||e.isPrototypeOf(Object)}function op(t){if(p4(t))return String(t);if(g4(t)||Array.isArray(t))return JSON.stringify(t);if(typeof t.toJSON=="function")return op(t.toJSON());throw new Error("[unstorage] Cannot stringify value!")}const h0="base64:";function y4(t){return typeof t=="string"?t:h0+b4(t)}function m4(t){return typeof t!="string"||!t.startsWith(h0)?t:w4(t.slice(h0.length))}function w4(t){return globalThis.Buffer?Buffer.from(t,"base64"):Uint8Array.from(globalThis.atob(t),e=>e.codePointAt(0))}function b4(t){return globalThis.Buffer?Buffer.from(t).toString("base64"):globalThis.btoa(String.fromCodePoint(...t))}function Hn(t){return t&&t.split("?")[0]?.replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,"")||""}function v4(...t){return Hn(t.join(":"))}function hf(t){return t=Hn(t),t?t+":":""}function E4(t,e){if(e===void 0)return!0;let r=0,n=t.indexOf(":");for(;n>-1;)r++,n=t.indexOf(":",n+1);return r<=e}function _4(t,e){return e?t.startsWith(e)&&t[t.length-1]!=="$":t[t.length-1]!=="$"}const x4="memory",S4=()=>{const t=new Map;return{name:x4,getInstance:()=>t,hasItem(e){return t.has(e)},getItem(e){return t.get(e)??null},getItemRaw(e){return t.get(e)??null},setItem(e,r){t.set(e,r)},setItemRaw(e,r){t.set(e,r)},removeItem(e){t.delete(e)},getKeys(){return[...t.keys()]},clear(){t.clear()},dispose(){t.clear()}}};function A4(t={}){const e={mounts:{"":t.driver||S4()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},r=l=>{for(const u of e.mountpoints)if(l.startsWith(u))return{base:u,relativeKey:l.slice(u.length),driver:e.mounts[u]};return{base:"",relativeKey:l,driver:e.mounts[""]}},n=(l,u)=>e.mountpoints.filter(d=>d.startsWith(l)||u&&l.startsWith(d)).map(d=>({relativeBase:l.length>d.length?l.slice(d.length):void 0,mountpoint:d,driver:e.mounts[d]})),s=(l,u)=>{if(e.watching){u=Hn(u);for(const d of e.watchListeners)d(l,u)}},i=async()=>{if(!e.watching){e.watching=!0;for(const l in e.mounts)e.unwatch[l]=await GE(e.mounts[l],s,l)}},o=async()=>{if(e.watching){for(const l in e.unwatch)await e.unwatch[l]();e.unwatch={},e.watching=!1}},a=(l,u,d)=>{const h=new Map,p=y=>{let g=h.get(y.base);return g||(g={driver:y.driver,base:y.base,items:[]},h.set(y.base,g)),g};for(const y of l){const g=typeof y=="string",w=Hn(g?y:y.key),S=g?void 0:y.value,A=g||!y.options?u:{...u,...y.options},E=r(w);p(E).items.push({key:w,value:S,relativeKey:E.relativeKey,options:A})}return Promise.all([...h.values()].map(y=>d(y))).then(y=>y.flat())},c={hasItem(l,u={}){l=Hn(l);const{relativeKey:d,driver:h}=r(l);return zr(h.hasItem,d,u)},getItem(l,u={}){l=Hn(l);const{relativeKey:d,driver:h}=r(l);return zr(h.getItem,d,u).then(p=>df(p))},getItems(l,u={}){return a(l,u,d=>d.driver.getItems?zr(d.driver.getItems,d.items.map(h=>({key:h.relativeKey,options:h.options})),u).then(h=>h.map(p=>({key:v4(d.base,p.key),value:df(p.value)}))):Promise.all(d.items.map(h=>zr(d.driver.getItem,h.relativeKey,h.options).then(p=>({key:h.key,value:df(p)})))))},getItemRaw(l,u={}){l=Hn(l);const{relativeKey:d,driver:h}=r(l);return h.getItemRaw?zr(h.getItemRaw,d,u):zr(h.getItem,d,u).then(p=>m4(p))},async setItem(l,u,d={}){if(u===void 0)return c.removeItem(l);l=Hn(l);const{relativeKey:h,driver:p}=r(l);p.setItem&&(await zr(p.setItem,h,op(u),d),p.watch||s("update",l))},async setItems(l,u){await a(l,u,async d=>{if(d.driver.setItems)return zr(d.driver.setItems,d.items.map(h=>({key:h.relativeKey,value:op(h.value),options:h.options})),u);d.driver.setItem&&await Promise.all(d.items.map(h=>zr(d.driver.setItem,h.relativeKey,op(h.value),h.options)))})},async setItemRaw(l,u,d={}){if(u===void 0)return c.removeItem(l,d);l=Hn(l);const{relativeKey:h,driver:p}=r(l);if(p.setItemRaw)await zr(p.setItemRaw,h,u,d);else if(p.setItem)await zr(p.setItem,h,y4(u),d);else return;p.watch||s("update",l)},async removeItem(l,u={}){typeof u=="boolean"&&(u={removeMeta:u}),l=Hn(l);const{relativeKey:d,driver:h}=r(l);h.removeItem&&(await zr(h.removeItem,d,u),(u.removeMeta||u.removeMata)&&await zr(h.removeItem,d+"$",u),h.watch||s("remove",l))},async getMeta(l,u={}){typeof u=="boolean"&&(u={nativeOnly:u}),l=Hn(l);const{relativeKey:d,driver:h}=r(l),p=Object.create(null);if(h.getMeta&&Object.assign(p,await zr(h.getMeta,d,u)),!u.nativeOnly){const y=await zr(h.getItem,d+"$",u).then(g=>df(g));y&&typeof y=="object"&&(typeof y.atime=="string"&&(y.atime=new Date(y.atime)),typeof y.mtime=="string"&&(y.mtime=new Date(y.mtime)),Object.assign(p,y))}return p},setMeta(l,u,d={}){return this.setItem(l+"$",u,d)},removeMeta(l,u={}){return this.removeItem(l+"$",u)},async getKeys(l,u={}){l=hf(l);const d=n(l,!0);let h=[];const p=[];let y=!0;for(const w of d){w.driver.flags?.maxDepth||(y=!1);const S=await zr(w.driver.getKeys,w.relativeBase,u);for(const A of S){const E=w.mountpoint+Hn(A);h.some(v=>E.startsWith(v))||p.push(E)}h=[w.mountpoint,...h.filter(A=>!A.startsWith(w.mountpoint))]}const g=u.maxDepth!==void 0&&!y;return p.filter(w=>(!g||E4(w,u.maxDepth))&&_4(w,l))},async clear(l,u={}){l=hf(l),await Promise.all(n(l,!1).map(async d=>{if(d.driver.clear)return zr(d.driver.clear,d.relativeBase,u);if(d.driver.removeItem){const h=await d.driver.getKeys(d.relativeBase||"",u);return Promise.all(h.map(p=>d.driver.removeItem(p,u)))}}))},async dispose(){await Promise.all(Object.values(e.mounts).map(l=>YE(l)))},async watch(l){return await i(),e.watchListeners.push(l),async()=>{e.watchListeners=e.watchListeners.filter(u=>u!==l),e.watchListeners.length===0&&await o()}},async unwatch(){e.watchListeners=[],await o()},mount(l,u){if(l=hf(l),l&&e.mounts[l])throw new Error(`already mounted at ${l}`);return l&&(e.mountpoints.push(l),e.mountpoints.sort((d,h)=>h.length-d.length)),e.mounts[l]=u,e.watching&&Promise.resolve(GE(u,s,l)).then(d=>{e.unwatch[l]=d}).catch(console.error),c},async unmount(l,u=!0){l=hf(l),!(!l||!e.mounts[l])&&(e.watching&&l in e.unwatch&&(e.unwatch[l]?.(),delete e.unwatch[l]),u&&await YE(e.mounts[l]),e.mountpoints=e.mountpoints.filter(d=>d!==l),delete e.mounts[l])},getMount(l=""){l=Hn(l)+":";const u=r(l);return{driver:u.driver,base:u.base}},getMounts(l="",u={}){return l=Hn(l),n(l,u.parents).map(h=>({driver:h.driver,base:h.mountpoint}))},keys:(l,u={})=>c.getKeys(l,u),get:(l,u={})=>c.getItem(l,u),set:(l,u,d={})=>c.setItem(l,u,d),has:(l,u={})=>c.hasItem(l,u),del:(l,u={})=>c.removeItem(l,u),remove:(l,u={})=>c.removeItem(l,u)};return c}function GE(t,e,r){return t.watch?t.watch((n,s)=>e(n,r+s)):()=>{}}async function YE(t){typeof t.dispose=="function"&&await zr(t.dispose)}function Hc(t){return new Promise((e,r)=>{t.oncomplete=t.onsuccess=()=>e(t.result),t.onabort=t.onerror=()=>r(t.error)})}function n3(t,e){let r;const n=()=>{if(r)return r;const s=indexedDB.open(t);return s.onupgradeneeded=()=>s.result.createObjectStore(e),r=Hc(s),r.then(i=>{i.onclose=()=>r=void 0},()=>{}),r};return(s,i)=>n().then(o=>i(o.transaction(e,s).objectStore(e)))}let Qy;function Th(){return Qy||(Qy=n3("keyval-store","keyval")),Qy}function XE(t,e=Th()){return e("readonly",r=>Hc(r.get(t)))}function I4(t,e,r=Th()){return r("readwrite",n=>(n.put(e,t),Hc(n.transaction)))}function C4(t,e=Th()){return e("readwrite",r=>(r.delete(t),Hc(r.transaction)))}function $4(t=Th()){return t("readwrite",e=>(e.clear(),Hc(e.transaction)))}function T4(t,e){return t.openCursor().onsuccess=function(){this.result&&(e(this.result),this.result.continue())},Hc(t.transaction)}function N4(t=Th()){return t("readonly",e=>{if(e.getAllKeys)return Hc(e.getAllKeys());const r=[];return T4(e,n=>r.push(n.key)).then(()=>r)})}const O4=t=>JSON.stringify(t,(e,r)=>typeof r=="bigint"?r.toString()+"n":r),k4=t=>{const e=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,r=t.replace(e,'$1"$2n"$3');return JSON.parse(r,(n,s)=>typeof s=="string"&&s.match(/^\d+n$/)?BigInt(s.substring(0,s.length-1)):s)};function Wi(t){if(typeof t!="string")throw new Error(`Cannot safe json parse value of type ${typeof t}`);try{return k4(t)}catch{return t}}function Bn(t){return typeof t=="string"?t:O4(t)||""}const P4="idb-keyval";var R4=(t={})=>{const e=t.base&&t.base.length>0?`${t.base}:`:"",r=s=>e+s;let n;return t.dbName&&t.storeName&&(n=n3(t.dbName,t.storeName)),{name:P4,options:t,async hasItem(s){return!(typeof await XE(r(s),n)>"u")},async getItem(s){return await XE(r(s),n)??null},setItem(s,i){return I4(r(s),i,n)},removeItem(s){return C4(r(s),n)},getKeys(){return N4(n)},clear(){return $4(n)}}};const D4="WALLET_CONNECT_V2_INDEXED_DB",U4="keyvaluestorage";let B4=class{constructor(){this.indexedDb=A4({driver:R4({dbName:D4,storeName:U4})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(e=>[e.key,e.value])}async getItem(e){const r=await this.indexedDb.getItem(e);if(r!==null)return r}async setItem(e,r){await this.indexedDb.setItem(e,Bn(r))}async removeItem(e){await this.indexedDb.removeItem(e)}};var em=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},ap={exports:{}};(function(){let t;function e(){}t=e,t.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},t.prototype.setItem=function(r,n){this[r]=String(n)},t.prototype.removeItem=function(r){delete this[r]},t.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(n){r[n]=void 0,delete r[n]})},t.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},t.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof em<"u"&&em.localStorage?ap.exports=em.localStorage:typeof window<"u"&&window.localStorage?ap.exports=window.localStorage:ap.exports=new e})();function L4(t){var e;return[t[0],Wi((e=t[1])!=null?e:"")]}let M4=class{constructor(){this.localStorage=ap.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(L4)}async getItem(e){const r=this.localStorage.getItem(e);if(r!==null)return Wi(r)}async setItem(e,r){this.localStorage.setItem(e,Bn(r))}async removeItem(e){this.localStorage.removeItem(e)}};const j4="wc_storage_version",ZE=1,F4=async(t,e,r)=>{const n=j4,s=await e.getItem(n);if(s&&s>=ZE){r(e);return}const i=await t.getKeys();if(!i.length){r(e);return}const o=[];for(;i.length;){const a=i.shift();if(!a)continue;const c=a.toLowerCase();if(c.includes("wc@")||c.includes("walletconnect")||c.includes("wc_")||c.includes("wallet_connect")){const l=await t.getItem(a);await e.setItem(a,l),o.push(a)}}await e.setItem(n,ZE),r(e),q4(t,o)},q4=async(t,e)=>{e.length&&e.forEach(async r=>{await t.removeItem(r)})};let s3=class{constructor(){this.initialized=!1,this.setInitialized=r=>{this.storage=r,this.initialized=!0};const e=new M4;this.storage=e;try{const r=new B4;F4(e,r,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(e){return await this.initialize(),this.storage.getItem(e)}async setItem(e,r){return await this.initialize(),this.storage.setItem(e,r)}async removeItem(e){return await this.initialize(),this.storage.removeItem(e)}async initialize(){this.initialized||await new Promise(e=>{const r=setInterval(()=>{this.initialized&&(clearInterval(r),e())},20)})}};var Ou={exports:{}},tm,JE;function x1(){if(JE)return tm;JE=1;function t(r){try{return JSON.stringify(r)}catch{return'"[Circular]"'}}tm=e;function e(r,n,s){var i=s&&s.stringify||t,o=1;if(typeof r=="object"&&r!==null){var a=n.length+o;if(a===1)return r;var c=new Array(a);c[0]=i(r);for(var l=1;l<a;l++)c[l]=i(n[l]);return c.join(" ")}if(typeof r!="string")return r;var u=n.length;if(u===0)return r;for(var d="",h=1-o,p=-1,y=r&&r.length||0,g=0;g<y;){if(r.charCodeAt(g)===37&&g+1<y){switch(p=p>-1?p:0,r.charCodeAt(g+1)){case 100:case 102:if(h>=u||n[h]==null)break;p<g&&(d+=r.slice(p,g)),d+=Number(n[h]),p=g+2,g++;break;case 105:if(h>=u||n[h]==null)break;p<g&&(d+=r.slice(p,g)),d+=Math.floor(Number(n[h])),p=g+2,g++;break;case 79:case 111:case 106:if(h>=u||n[h]===void 0)break;p<g&&(d+=r.slice(p,g));var w=typeof n[h];if(w==="string"){d+="'"+n[h]+"'",p=g+2,g++;break}if(w==="function"){d+=n[h].name||"<anonymous>",p=g+2,g++;break}d+=i(n[h]),p=g+2,g++;break;case 115:if(h>=u)break;p<g&&(d+=r.slice(p,g)),d+=String(n[h]),p=g+2,g++;break;case 37:p<g&&(d+=r.slice(p,g)),d+="%",p=g+2,g++,h--;break}++h}++g}return p===-1?r:(p<y&&(d+=r.slice(p)),d)}return tm}var QE;function z4(){if(QE)return Ou.exports;QE=1;const t=x1();Ou.exports=u;const e=k().console||{},r={mapHttpRequest:L,mapHttpResponse:L,wrapRequestSerializer:j,wrapResponseSerializer:j,wrapErrorSerializer:j,req:L,res:L,err:C,errWithCause:C};function n(f,m){return f==="silent"?1/0:m.levels.values[f]}const s=Symbol("pino.logFuncs"),i=Symbol("pino.hierarchy"),o={error:"log",fatal:"error",warn:"error",info:"log",debug:"log",trace:"log"};function a(f,m){const _={logger:m,parent:f[i]};m[i]=_}function c(f,m,_){const $={};m.forEach(x=>{$[x]=_[x]?_[x]:e[x]||e[o[x]||"log"]||D}),f[s]=$}function l(f,m){return Array.isArray(f)?f.filter(function($){return $!=="!stdSerializers.err"}):f===!0?Object.keys(m):!1}function u(f){f=f||{},f.browser=f.browser||{};const m=f.browser.transmit;if(m&&typeof m.send!="function")throw Error("pino: transmit option must have a send function");const _=f.browser.write||e;f.browser.write&&(f.browser.asObject=!0);const $=f.serializers||{},x=l(f.browser.serialize,$);let N=f.browser.serialize;Array.isArray(f.browser.serialize)&&f.browser.serialize.indexOf("!stdSerializers.err")>-1&&(N=!1);const H=Object.keys(f.customLevels||{}),z=["error","fatal","warn","info","debug","trace"].concat(H);typeof _=="function"&&z.forEach(function(se){_[se]=_}),(f.enabled===!1||f.browser.disabled)&&(f.level="silent");const G=f.level||"info",M=Object.create(_);M.log||(M.log=D),c(M,z,_),a({},M),Object.defineProperty(M,"levelVal",{get:J}),Object.defineProperty(M,"level",{get:re,set:ye});const V={transmit:m,serialize:x,asObject:f.browser.asObject,asObjectBindingsOnly:f.browser.asObjectBindingsOnly,formatters:f.browser.formatters,levels:z,timestamp:O(f),messageKey:f.messageKey||"msg",onChild:f.onChild||D};M.levels=d(f),M.level=G,M.isLevelEnabled=function(se){return this.levels.values[se]?this.levels.values[se]>=this.levels.values[this.level]:!1},M.setMaxListeners=M.getMaxListeners=M.emit=M.addListener=M.on=M.prependListener=M.once=M.prependOnceListener=M.removeListener=M.removeAllListeners=M.listeners=M.listenerCount=M.eventNames=M.write=M.flush=D,M.serializers=$,M._serialize=x,M._stdErrSerialize=N,M.child=function(...se){return ne.call(this,V,...se)},m&&(M._logEvent=v());function J(){return n(this.level,this)}function re(){return this._level}function ye(se){if(se!=="silent"&&!this.levels.values[se])throw Error("unknown level "+se);this._level=se,y(this,V,M,"error"),y(this,V,M,"fatal"),y(this,V,M,"warn"),y(this,V,M,"info"),y(this,V,M,"debug"),y(this,V,M,"trace"),H.forEach(Ie=>{y(this,V,M,Ie)})}function ne(se,Ie,Me){if(!Ie)throw new Error("missing bindings for child Pino");Me=Me||{},x&&Ie.serializers&&(Me.serializers=Ie.serializers);const Ve=Me.serializers;if(x&&Ve){var Ze=Object.assign({},$,Ve),Nt=f.browser.serialize===!0?Object.keys(Ze):x;delete Ie.serializers,A([Ie],Nt,Ze,this._stdErrSerialize)}function Br(Ir){this._childLevel=(Ir._childLevel|0)+1,this.bindings=Ie,Ze&&(this.serializers=Ze,this._serialize=Nt),m&&(this._logEvent=v([].concat(Ir._logEvent.bindings,Ie)))}Br.prototype=this;const sr=new Br(this);return a(this,sr),sr.child=function(...Ir){return ne.call(this,se,...Ir)},sr.level=Me.level||this.level,se.onChild(sr),sr}return M}function d(f){const m=f.customLevels||{},_=Object.assign({},u.levels.values,m),$=Object.assign({},u.levels.labels,h(m));return{values:_,labels:$}}function h(f){const m={};return Object.keys(f).forEach(function(_){m[f[_]]=_}),m}u.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},u.stdSerializers=r,u.stdTimeFunctions=Object.assign({},{nullTime:W,epochTime:P,unixTime:R,isoTime:T});function p(f){const m=[];f.bindings&&m.push(f.bindings);let _=f[i];for(;_.parent;)_=_.parent,_.logger.bindings&&m.push(_.logger.bindings);return m.reverse()}function y(f,m,_,$){if(Object.defineProperty(f,$,{value:n(f.level,_)>n($,_)?D:_[s][$],writable:!0,enumerable:!0,configurable:!0}),f[$]===D){if(!m.transmit)return;const N=m.transmit.level||f.level,H=n(N,_);if(n($,_)<H)return}f[$]=w(f,m,_,$);const x=p(f);x.length!==0&&(f[$]=g(x,f[$]))}function g(f,m){return function(){return m.apply(this,[...f,...arguments])}}function w(f,m,_,$){return(function(x){return function(){const H=m.timestamp(),z=new Array(arguments.length),G=Object.getPrototypeOf&&Object.getPrototypeOf(this)===e?e:this;for(var M=0;M<z.length;M++)z[M]=arguments[M];var V=!1;if(m.serialize&&(A(z,this._serialize,this.serializers,this._stdErrSerialize),V=!0),m.asObject||m.formatters?x.call(G,...S(this,$,z,H,m)):x.apply(G,z),m.transmit){const J=m.transmit.level||f._level,re=n(J,_),ye=n($,_);if(ye<re)return;E(this,{ts:H,methodLevel:$,methodValue:ye,transmitValue:_.levels.values[m.transmit.level||f._level],send:m.transmit.send,val:n(f._level,_)},z,V)}}})(f[s][$])}function S(f,m,_,$,x){const{level:N,log:H=J=>J}=x.formatters||{},z=_.slice();let G=z[0];const M={};let V=(f._childLevel|0)+1;if(V<1&&(V=1),$&&(M.time=$),N){const J=N(m,f.levels.values[m]);Object.assign(M,J)}else M.level=f.levels.values[m];if(x.asObjectBindingsOnly){if(G!==null&&typeof G=="object")for(;V--&&typeof z[0]=="object";)Object.assign(M,z.shift());return[H(M),...z]}else{if(G!==null&&typeof G=="object"){for(;V--&&typeof z[0]=="object";)Object.assign(M,z.shift());G=z.length?t(z.shift(),z):void 0}else typeof G=="string"&&(G=t(z.shift(),z));return G!==void 0&&(M[x.messageKey]=G),[H(M)]}}function A(f,m,_,$){for(const x in f)if($&&f[x]instanceof Error)f[x]=u.stdSerializers.err(f[x]);else if(typeof f[x]=="object"&&!Array.isArray(f[x])&&m)for(const N in f[x])m.indexOf(N)>-1&&N in _&&(f[x][N]=_[N](f[x][N]))}function E(f,m,_,$=!1){const x=m.send,N=m.ts,H=m.methodLevel,z=m.methodValue,G=m.val,M=f._logEvent.bindings;$||A(_,f._serialize||Object.keys(f.serializers),f.serializers,f._stdErrSerialize===void 0?!0:f._stdErrSerialize),f._logEvent.ts=N,f._logEvent.messages=_.filter(function(V){return M.indexOf(V)===-1}),f._logEvent.level.label=H,f._logEvent.level.value=z,x(H,f._logEvent,G),f._logEvent=v(M)}function v(f){return{ts:0,messages:[],bindings:f||[],level:{label:"",value:0}}}function C(f){const m={type:f.constructor.name,msg:f.message,stack:f.stack};for(const _ in f)m[_]===void 0&&(m[_]=f[_]);return m}function O(f){return typeof f.timestamp=="function"?f.timestamp:f.timestamp===!1?W:P}function L(){return{}}function j(f){return f}function D(){}function W(){return!1}function P(){return Date.now()}function R(){return Math.round(Date.now()/1e3)}function T(){return new Date(Date.now()).toISOString()}function k(){function f(m){return typeof m<"u"&&m}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return f(self)||f(window)||f(this)||{}}}return Ou.exports.default=u,Ou.exports.pino=u,Ou.exports}var Sl=z4();const i3=Sh(Sl),H4={level:"info"},jg="custom_context",S1=1e3*1024;var W4=Object.defineProperty,V4=(t,e,r)=>e in t?W4(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ha=(t,e,r)=>V4(t,typeof e!="symbol"?e+"":e,r);let K4=class{constructor(e){ha(this,"nodeValue"),ha(this,"sizeInBytes"),ha(this,"next"),this.nodeValue=e,this.sizeInBytes=new TextEncoder().encode(this.nodeValue).length,this.next=null}get value(){return this.nodeValue}get size(){return this.sizeInBytes}},e_=class{constructor(e){ha(this,"lengthInNodes"),ha(this,"sizeInBytes"),ha(this,"head"),ha(this,"tail"),ha(this,"maxSizeInBytes"),this.head=null,this.tail=null,this.lengthInNodes=0,this.maxSizeInBytes=e,this.sizeInBytes=0}append(e){const r=new K4(e);if(r.size>this.maxSizeInBytes)throw new Error(`[LinkedList] Value too big to insert into list: ${e} with size ${r.size}`);for(;this.size+r.size>this.maxSizeInBytes;)this.shift();this.head?(this.tail&&(this.tail.next=r),this.tail=r):(this.head=r,this.tail=r),this.lengthInNodes++,this.sizeInBytes+=r.size}shift(){if(!this.head)return;const e=this.head;this.head=this.head.next,this.head||(this.tail=null),this.lengthInNodes--,this.sizeInBytes-=e.size}toArray(){const e=[];let r=this.head;for(;r!==null;)e.push(r.value),r=r.next;return e}get length(){return this.lengthInNodes}get size(){return this.sizeInBytes}toOrderedArray(){return Array.from(this)}[Symbol.iterator](){let e=this.head;return{next:()=>{if(!e)return{done:!0,value:null};const r=e.value;return e=e.next,{done:!1,value:r}}}}};var G4=Object.defineProperty,Y4=(t,e,r)=>e in t?G4(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ff=(t,e,r)=>Y4(t,typeof e!="symbol"?e+"":e,r);let o3=class{constructor(e,r=S1){ff(this,"logs"),ff(this,"level"),ff(this,"levelValue"),ff(this,"MAX_LOG_SIZE_IN_BYTES"),this.level=e??"error",this.levelValue=Sl.levels.values[this.level],this.MAX_LOG_SIZE_IN_BYTES=r,this.logs=new e_(this.MAX_LOG_SIZE_IN_BYTES)}forwardToConsole(e,r){r===Sl.levels.values.error?console.error(e):r===Sl.levels.values.warn?console.warn(e):r===Sl.levels.values.debug?console.debug(e):r===Sl.levels.values.trace?console.trace(e):console.log(e)}appendToLogs(e){this.logs.append(Bn({timestamp:new Date().toISOString(),log:e}));const r=typeof e=="string"?JSON.parse(e).level:e.level;r>=this.levelValue&&this.forwardToConsole(e,r)}getLogs(){return this.logs}clearLogs(){this.logs=new e_(this.MAX_LOG_SIZE_IN_BYTES)}getLogArray(){return Array.from(this.logs)}logsToBlob(e){const r=this.getLogArray();return r.push(Bn({extraMetadata:e})),new Blob(r,{type:"application/json"})}};var X4=Object.defineProperty,Z4=(t,e,r)=>e in t?X4(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,J4=(t,e,r)=>Z4(t,e+"",r);let Q4=class{constructor(e,r=S1){J4(this,"baseChunkLogger"),this.baseChunkLogger=new o3(e,r)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}downloadLogsBlobInBrowser(e){const r=URL.createObjectURL(this.logsToBlob(e)),n=document.createElement("a");n.href=r,n.download=`walletconnect-logs-${new Date().toISOString()}.txt`,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(r)}};var eR=Object.defineProperty,tR=(t,e,r)=>e in t?eR(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,rR=(t,e,r)=>tR(t,e+"",r);let nR=class{constructor(e,r=S1){rR(this,"baseChunkLogger"),this.baseChunkLogger=new o3(e,r)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}};var sR=Object.defineProperty,iR=Object.defineProperties,oR=Object.getOwnPropertyDescriptors,t_=Object.getOwnPropertySymbols,aR=Object.prototype.hasOwnProperty,cR=Object.prototype.propertyIsEnumerable,r_=(t,e,r)=>e in t?sR(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Up=(t,e)=>{for(var r in e||(e={}))aR.call(e,r)&&r_(t,r,e[r]);if(t_)for(var r of t_(e))cR.call(e,r)&&r_(t,r,e[r]);return t},Bp=(t,e)=>iR(t,oR(e));function lR(t){return Bp(Up({},t),{level:t?.level||H4.level})}function uR(t,e,r=jg){return t[r]=e,t}function os(t,e=jg){return t[e]||""}function dR(t,e,r=jg){const n=os(t,r);return n.trim()?`${n}/${e}`:e}function Cs(t,e,r=jg){const n=dR(t,e,r),s=t.child({context:n});return uR(s,n,r)}function hR(t){var e,r;const n=new Q4((e=t.opts)==null?void 0:e.level,t.maxSizeInBytes);return{logger:i3(Bp(Up({},t.opts),{level:"trace",browser:Bp(Up({},(r=t.opts)==null?void 0:r.browser),{write:s=>n.write(s)})})),chunkLoggerController:n}}function fR(t){var e;const r=new nR((e=t.opts)==null?void 0:e.level,t.maxSizeInBytes);return{logger:i3(Bp(Up({},t.opts),{level:"trace"}),r),chunkLoggerController:r}}function a3(t){return typeof t.loggerOverride<"u"&&typeof t.loggerOverride!="string"?{logger:t.loggerOverride,chunkLoggerController:null}:typeof window<"u"?hR(t):fR(t)}var pR=Object.defineProperty,gR=(t,e,r)=>e in t?pR(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,n_=(t,e,r)=>gR(t,typeof e!="symbol"?e+"":e,r);let yR=class extends is{constructor(e){super(),this.opts=e,n_(this,"protocol","wc"),n_(this,"version",2)}};var mR=Object.defineProperty,wR=(t,e,r)=>e in t?mR(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,bR=(t,e,r)=>wR(t,e+"",r);let vR=class extends is{constructor(e,r){super(),this.core=e,this.logger=r,bR(this,"records",new Map)}},ER=class{constructor(e,r){this.logger=e,this.core=r}},_R=class extends is{constructor(e,r){super(),this.relayer=e,this.logger=r}},xR=class extends is{constructor(e){super()}},SR=class{constructor(e,r,n,s){this.core=e,this.logger=r,this.name=n}},AR=class extends is{constructor(e,r){super(),this.relayer=e,this.logger=r}},IR=class extends is{constructor(e,r){super(),this.core=e,this.logger=r}},CR=class{constructor(e,r,n){this.core=e,this.logger=r,this.store=n}},$R=class{constructor(e,r){this.projectId=e,this.logger=r}},TR=class{constructor(e,r,n){this.core=e,this.logger=r,this.telemetryEnabled=n}};var NR=Object.defineProperty,OR=(t,e,r)=>e in t?NR(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,s_=(t,e,r)=>OR(t,typeof e!="symbol"?e+"":e,r);let kR=class{constructor(e){this.opts=e,s_(this,"protocol","wc"),s_(this,"version",2)}},PR=class{constructor(e){this.client=e}};function RR(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function c3(t,...e){if(!RR(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function i_(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function DR(t,e){c3(t);const r=e.outputLen;if(t.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}const ll=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;const rm=t=>new DataView(t.buffer,t.byteOffset,t.byteLength);function UR(t){if(typeof t!="string")throw new Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array(new TextEncoder().encode(t))}function l3(t){return typeof t=="string"&&(t=UR(t)),c3(t),t}let BR=class{clone(){return this._cloneInto()}};function LR(t){const e=n=>t().update(l3(n)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function u3(t=32){if(ll&&typeof ll.getRandomValues=="function")return ll.getRandomValues(new Uint8Array(t));if(ll&&typeof ll.randomBytes=="function")return ll.randomBytes(t);throw new Error("crypto.getRandomValues must be defined")}function MR(t,e,r,n){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,n);const s=BigInt(32),i=BigInt(4294967295),o=Number(r>>s&i),a=Number(r&i),c=n?4:0,l=n?0:4;t.setUint32(e+c,o,n),t.setUint32(e+l,a,n)}let jR=class extends BR{constructor(e,r,n,s){super(),this.blockLen=e,this.outputLen=r,this.padOffset=n,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=rm(this.buffer)}update(e){i_(this);const{view:r,buffer:n,blockLen:s}=this;e=l3(e);const i=e.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const c=rm(e);for(;s<=i-o;o+=s)this.process(c,o);continue}n.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){i_(this),DR(e,this),this.finished=!0;const{buffer:r,view:n,blockLen:s,isLE:i}=this;let{pos:o}=this;r[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>s-o&&(this.process(n,0),o=0);for(let d=o;d<s;d++)r[d]=0;MR(n,s-8,BigInt(this.length*8),i),this.process(n,0);const a=rm(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=c/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<l;d++)a.setUint32(4*d,u[d],i)}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const n=e.slice(0,r);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:r,buffer:n,length:s,finished:i,destroyed:o,pos:a}=this;return e.length=s,e.pos=a,e.finished=i,e.destroyed=o,s%r&&e.buffer.set(n),e}};const pf=BigInt(2**32-1),f0=BigInt(32);function d3(t,e=!1){return e?{h:Number(t&pf),l:Number(t>>f0&pf)}:{h:Number(t>>f0&pf)|0,l:Number(t&pf)|0}}function FR(t,e=!1){let r=new Uint32Array(t.length),n=new Uint32Array(t.length);for(let s=0;s<t.length;s++){const{h:i,l:o}=d3(t[s],e);[r[s],n[s]]=[i,o]}return[r,n]}const qR=(t,e)=>BigInt(t>>>0)<<f0|BigInt(e>>>0),zR=(t,e,r)=>t>>>r,HR=(t,e,r)=>t<<32-r|e>>>r,WR=(t,e,r)=>t>>>r|e<<32-r,VR=(t,e,r)=>t<<32-r|e>>>r,KR=(t,e,r)=>t<<64-r|e>>>r-32,GR=(t,e,r)=>t>>>r-32|e<<64-r,YR=(t,e)=>e,XR=(t,e)=>t,ZR=(t,e,r)=>t<<r|e>>>32-r,JR=(t,e,r)=>e<<r|t>>>32-r,QR=(t,e,r)=>e<<r-32|t>>>64-r,eD=(t,e,r)=>t<<r-32|e>>>64-r;function tD(t,e,r,n){const s=(e>>>0)+(n>>>0);return{h:t+r+(s/2**32|0)|0,l:s|0}}const rD=(t,e,r)=>(t>>>0)+(e>>>0)+(r>>>0),nD=(t,e,r,n)=>e+r+n+(t/2**32|0)|0,sD=(t,e,r,n)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0),iD=(t,e,r,n,s)=>e+r+n+s+(t/2**32|0)|0,oD=(t,e,r,n,s)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0)+(s>>>0),aD=(t,e,r,n,s,i)=>e+r+n+s+i+(t/2**32|0)|0,it={fromBig:d3,split:FR,toBig:qR,shrSH:zR,shrSL:HR,rotrSH:WR,rotrSL:VR,rotrBH:KR,rotrBL:GR,rotr32H:YR,rotr32L:XR,rotlSH:ZR,rotlSL:JR,rotlBH:QR,rotlBL:eD,add:tD,add3L:rD,add3H:nD,add4L:sD,add4H:iD,add5H:aD,add5L:oD},[cD,lD]=it.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),Lo=new Uint32Array(80),Mo=new Uint32Array(80);let uD=class extends jR{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:r,Bh:n,Bl:s,Ch:i,Cl:o,Dh:a,Dl:c,Eh:l,El:u,Fh:d,Fl:h,Gh:p,Gl:y,Hh:g,Hl:w}=this;return[e,r,n,s,i,o,a,c,l,u,d,h,p,y,g,w]}set(e,r,n,s,i,o,a,c,l,u,d,h,p,y,g,w){this.Ah=e|0,this.Al=r|0,this.Bh=n|0,this.Bl=s|0,this.Ch=i|0,this.Cl=o|0,this.Dh=a|0,this.Dl=c|0,this.Eh=l|0,this.El=u|0,this.Fh=d|0,this.Fl=h|0,this.Gh=p|0,this.Gl=y|0,this.Hh=g|0,this.Hl=w|0}process(e,r){for(let E=0;E<16;E++,r+=4)Lo[E]=e.getUint32(r),Mo[E]=e.getUint32(r+=4);for(let E=16;E<80;E++){const v=Lo[E-15]|0,C=Mo[E-15]|0,O=it.rotrSH(v,C,1)^it.rotrSH(v,C,8)^it.shrSH(v,C,7),L=it.rotrSL(v,C,1)^it.rotrSL(v,C,8)^it.shrSL(v,C,7),j=Lo[E-2]|0,D=Mo[E-2]|0,W=it.rotrSH(j,D,19)^it.rotrBH(j,D,61)^it.shrSH(j,D,6),P=it.rotrSL(j,D,19)^it.rotrBL(j,D,61)^it.shrSL(j,D,6),R=it.add4L(L,P,Mo[E-7],Mo[E-16]),T=it.add4H(R,O,W,Lo[E-7],Lo[E-16]);Lo[E]=T|0,Mo[E]=R|0}let{Ah:n,Al:s,Bh:i,Bl:o,Ch:a,Cl:c,Dh:l,Dl:u,Eh:d,El:h,Fh:p,Fl:y,Gh:g,Gl:w,Hh:S,Hl:A}=this;for(let E=0;E<80;E++){const v=it.rotrSH(d,h,14)^it.rotrSH(d,h,18)^it.rotrBH(d,h,41),C=it.rotrSL(d,h,14)^it.rotrSL(d,h,18)^it.rotrBL(d,h,41),O=d&p^~d&g,L=h&y^~h&w,j=it.add5L(A,C,L,lD[E],Mo[E]),D=it.add5H(j,S,v,O,cD[E],Lo[E]),W=j|0,P=it.rotrSH(n,s,28)^it.rotrBH(n,s,34)^it.rotrBH(n,s,39),R=it.rotrSL(n,s,28)^it.rotrBL(n,s,34)^it.rotrBL(n,s,39),T=n&i^n&a^i&a,k=s&o^s&c^o&c;S=g|0,A=w|0,g=p|0,w=y|0,p=d|0,y=h|0,{h:d,l:h}=it.add(l|0,u|0,D|0,W|0),l=a|0,u=c|0,a=i|0,c=o|0,i=n|0,o=s|0;const f=it.add3L(W,R,k);n=it.add3H(f,D,P,T),s=f|0}({h:n,l:s}=it.add(this.Ah|0,this.Al|0,n|0,s|0)),{h:i,l:o}=it.add(this.Bh|0,this.Bl|0,i|0,o|0),{h:a,l:c}=it.add(this.Ch|0,this.Cl|0,a|0,c|0),{h:l,l:u}=it.add(this.Dh|0,this.Dl|0,l|0,u|0),{h:d,l:h}=it.add(this.Eh|0,this.El|0,d|0,h|0),{h:p,l:y}=it.add(this.Fh|0,this.Fl|0,p|0,y|0),{h:g,l:w}=it.add(this.Gh|0,this.Gl|0,g|0,w|0),{h:S,l:A}=it.add(this.Hh|0,this.Hl|0,S|0,A|0),this.set(n,s,i,o,a,c,l,u,d,h,p,y,g,w,S,A)}roundClean(){Lo.fill(0),Mo.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};const dD=LR(()=>new uD);const A1=BigInt(0),h3=BigInt(1),hD=BigInt(2);function I1(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function C1(t){if(!I1(t))throw new Error("Uint8Array expected")}function nm(t,e){if(typeof e!="boolean")throw new Error(t+" boolean expected, got "+e)}const fD=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function $1(t){C1(t);let e="";for(let r=0;r<t.length;r++)e+=fD[t[r]];return e}function f3(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return t===""?A1:BigInt("0x"+t)}const Yi={_0:48,_9:57,A:65,F:70,a:97,f:102};function o_(t){if(t>=Yi._0&&t<=Yi._9)return t-Yi._0;if(t>=Yi.A&&t<=Yi.F)return t-(Yi.A-10);if(t>=Yi.a&&t<=Yi.f)return t-(Yi.a-10)}function p3(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);const e=t.length,r=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(r);for(let s=0,i=0;s<r;s++,i+=2){const o=o_(t.charCodeAt(i)),a=o_(t.charCodeAt(i+1));if(o===void 0||a===void 0){const c=t[i]+t[i+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+i)}n[s]=o*16+a}return n}function pD(t){return f3($1(t))}function cp(t){return C1(t),f3($1(Uint8Array.from(t).reverse()))}function g3(t,e){return p3(t.toString(16).padStart(e*2,"0"))}function p0(t,e){return g3(t,e).reverse()}function Xi(t,e,r){let n;if(typeof e=="string")try{n=p3(e)}catch(i){throw new Error(t+" must be hex string or Uint8Array, cause: "+i)}else if(I1(e))n=Uint8Array.from(e);else throw new Error(t+" must be hex string or Uint8Array");const s=n.length;if(typeof r=="number"&&s!==r)throw new Error(t+" of length "+r+" expected, got "+s);return n}function a_(...t){let e=0;for(let n=0;n<t.length;n++){const s=t[n];C1(s),e+=s.length}const r=new Uint8Array(e);for(let n=0,s=0;n<t.length;n++){const i=t[n];r.set(i,s),s+=i.length}return r}const sm=t=>typeof t=="bigint"&&A1<=t;function gD(t,e,r){return sm(t)&&sm(e)&&sm(r)&&e<=t&&t<r}function ku(t,e,r,n){if(!gD(e,r,n))throw new Error("expected valid "+t+": "+r+" <= n < "+n+", got "+e)}function yD(t){let e;for(e=0;t>A1;t>>=h3,e+=1);return e}const mD=t=>(hD<<BigInt(t-1))-h3,wD={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||I1(t),isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function T1(t,e,r={}){const n=(s,i,o)=>{const a=wD[i];if(typeof a!="function")throw new Error("invalid validator function");const c=t[s];if(!(o&&c===void 0)&&!a(c,t))throw new Error("param "+String(s)+" is invalid. Expected "+i+", got "+c)};for(const[s,i]of Object.entries(e))n(s,i,!1);for(const[s,i]of Object.entries(r))n(s,i,!0);return t}function c_(t){const e=new WeakMap;return(r,...n)=>{const s=e.get(r);if(s!==void 0)return s;const i=t(r,...n);return e.set(r,i),i}}const Yr=BigInt(0),gr=BigInt(1),oc=BigInt(2),bD=BigInt(3),g0=BigInt(4),l_=BigInt(5),u_=BigInt(8);function Pr(t,e){const r=t%e;return r>=Yr?r:e+r}function vD(t,e,r){if(e<Yr)throw new Error("invalid exponent, negatives unsupported");if(r<=Yr)throw new Error("invalid modulus");if(r===gr)return Yr;let n=gr;for(;e>Yr;)e&gr&&(n=n*t%r),t=t*t%r,e>>=gr;return n}function _i(t,e,r){let n=t;for(;e-- >Yr;)n*=n,n%=r;return n}function d_(t,e){if(t===Yr)throw new Error("invert: expected non-zero number");if(e<=Yr)throw new Error("invert: expected positive modulus, got "+e);let r=Pr(t,e),n=e,s=Yr,i=gr;for(;r!==Yr;){const o=n/r,a=n%r,c=s-i*o;n=r,r=a,s=i,i=c}if(n!==gr)throw new Error("invert: does not exist");return Pr(s,e)}function ED(t){const e=(t-gr)/oc;let r,n,s;for(r=t-gr,n=0;r%oc===Yr;r/=oc,n++);for(s=oc;s<t&&vD(s,e,t)!==t-gr;s++)if(s>1e3)throw new Error("Cannot find square root: likely non-prime P");if(n===1){const o=(t+gr)/g0;return function(a,c){const l=a.pow(c,o);if(!a.eql(a.sqr(l),c))throw new Error("Cannot find square root");return l}}const i=(r+gr)/oc;return function(o,a){if(o.pow(a,e)===o.neg(o.ONE))throw new Error("Cannot find square root");let c=n,l=o.pow(o.mul(o.ONE,s),r),u=o.pow(a,i),d=o.pow(a,r);for(;!o.eql(d,o.ONE);){if(o.eql(d,o.ZERO))return o.ZERO;let h=1;for(let y=o.sqr(d);h<c&&!o.eql(y,o.ONE);h++)y=o.sqr(y);const p=o.pow(l,gr<<BigInt(c-h-1));l=o.sqr(p),u=o.mul(u,p),d=o.mul(d,l),c=h}return u}}function _D(t){if(t%g0===bD){const e=(t+gr)/g0;return function(r,n){const s=r.pow(n,e);if(!r.eql(r.sqr(s),n))throw new Error("Cannot find square root");return s}}if(t%u_===l_){const e=(t-l_)/u_;return function(r,n){const s=r.mul(n,oc),i=r.pow(s,e),o=r.mul(n,i),a=r.mul(r.mul(o,oc),i),c=r.mul(o,r.sub(a,r.ONE));if(!r.eql(r.sqr(c),n))throw new Error("Cannot find square root");return c}}return ED(t)}const xD=(t,e)=>(Pr(t,e)&gr)===gr,SD=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function AD(t){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},r=SD.reduce((n,s)=>(n[s]="function",n),e);return T1(t,r)}function ID(t,e,r){if(r<Yr)throw new Error("invalid exponent, negatives unsupported");if(r===Yr)return t.ONE;if(r===gr)return e;let n=t.ONE,s=e;for(;r>Yr;)r&gr&&(n=t.mul(n,s)),s=t.sqr(s),r>>=gr;return n}function CD(t,e){const r=new Array(e.length),n=e.reduce((i,o,a)=>t.is0(o)?i:(r[a]=i,t.mul(i,o)),t.ONE),s=t.inv(n);return e.reduceRight((i,o,a)=>t.is0(o)?i:(r[a]=t.mul(i,r[a]),t.mul(i,o)),s),r}function y3(t,e){const r=e!==void 0?e:t.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}function m3(t,e,r=!1,n={}){if(t<=Yr)throw new Error("invalid field: expected ORDER > 0, got "+t);const{nBitLength:s,nByteLength:i}=y3(t,e);if(i>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let o;const a=Object.freeze({ORDER:t,isLE:r,BITS:s,BYTES:i,MASK:mD(s),ZERO:Yr,ONE:gr,create:c=>Pr(c,t),isValid:c=>{if(typeof c!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof c);return Yr<=c&&c<t},is0:c=>c===Yr,isOdd:c=>(c&gr)===gr,neg:c=>Pr(-c,t),eql:(c,l)=>c===l,sqr:c=>Pr(c*c,t),add:(c,l)=>Pr(c+l,t),sub:(c,l)=>Pr(c-l,t),mul:(c,l)=>Pr(c*l,t),pow:(c,l)=>ID(a,c,l),div:(c,l)=>Pr(c*d_(l,t),t),sqrN:c=>c*c,addN:(c,l)=>c+l,subN:(c,l)=>c-l,mulN:(c,l)=>c*l,inv:c=>d_(c,t),sqrt:n.sqrt||(c=>(o||(o=_D(t)),o(a,c))),invertBatch:c=>CD(a,c),cmov:(c,l,u)=>u?l:c,toBytes:c=>r?p0(c,i):g3(c,i),fromBytes:c=>{if(c.length!==i)throw new Error("Field.fromBytes: expected "+i+" bytes, got "+c.length);return r?cp(c):pD(c)}});return Object.freeze(a)}const h_=BigInt(0),gf=BigInt(1);function im(t,e){const r=e.negate();return t?r:e}function w3(t,e){if(!Number.isSafeInteger(t)||t<=0||t>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+t)}function om(t,e){w3(t,e);const r=Math.ceil(e/t)+1,n=2**(t-1);return{windows:r,windowSize:n}}function $D(t,e){if(!Array.isArray(t))throw new Error("array expected");t.forEach((r,n)=>{if(!(r instanceof e))throw new Error("invalid point at index "+n)})}function TD(t,e){if(!Array.isArray(t))throw new Error("array of scalars expected");t.forEach((r,n)=>{if(!e.isValid(r))throw new Error("invalid scalar at index "+n)})}const am=new WeakMap,b3=new WeakMap;function cm(t){return b3.get(t)||1}function ND(t,e){return{constTimeNegate:im,hasPrecomputes(r){return cm(r)!==1},unsafeLadder(r,n,s=t.ZERO){let i=r;for(;n>h_;)n&gf&&(s=s.add(i)),i=i.double(),n>>=gf;return s},precomputeWindow(r,n){const{windows:s,windowSize:i}=om(n,e),o=[];let a=r,c=a;for(let l=0;l<s;l++){c=a,o.push(c);for(let u=1;u<i;u++)c=c.add(a),o.push(c);a=c.double()}return o},wNAF(r,n,s){const{windows:i,windowSize:o}=om(r,e);let a=t.ZERO,c=t.BASE;const l=BigInt(2**r-1),u=2**r,d=BigInt(r);for(let h=0;h<i;h++){const p=h*o;let y=Number(s&l);s>>=d,y>o&&(y-=u,s+=gf);const g=p,w=p+Math.abs(y)-1,S=h%2!==0,A=y<0;y===0?c=c.add(im(S,n[g])):a=a.add(im(A,n[w]))}return{p:a,f:c}},wNAFUnsafe(r,n,s,i=t.ZERO){const{windows:o,windowSize:a}=om(r,e),c=BigInt(2**r-1),l=2**r,u=BigInt(r);for(let d=0;d<o;d++){const h=d*a;if(s===h_)break;let p=Number(s&c);if(s>>=u,p>a&&(p-=l,s+=gf),p===0)continue;let y=n[h+Math.abs(p)-1];p<0&&(y=y.negate()),i=i.add(y)}return i},getPrecomputes(r,n,s){let i=am.get(n);return i||(i=this.precomputeWindow(n,r),r!==1&&am.set(n,s(i))),i},wNAFCached(r,n,s){const i=cm(r);return this.wNAF(i,this.getPrecomputes(i,r,s),n)},wNAFCachedUnsafe(r,n,s,i){const o=cm(r);return o===1?this.unsafeLadder(r,n,i):this.wNAFUnsafe(o,this.getPrecomputes(o,r,s),n,i)},setWindowSize(r,n){w3(n,e),b3.set(r,n),am.delete(r)}}}function OD(t,e,r,n){if($D(r,t),TD(n,e),r.length!==n.length)throw new Error("arrays of points and scalars must have equal length");const s=t.ZERO,i=yD(BigInt(r.length)),o=i>12?i-3:i>4?i-2:i?2:1,a=(1<<o)-1,c=new Array(a+1).fill(s),l=Math.floor((e.BITS-1)/o)*o;let u=s;for(let d=l;d>=0;d-=o){c.fill(s);for(let p=0;p<n.length;p++){const y=n[p],g=Number(y>>BigInt(d)&BigInt(a));c[g]=c[g].add(r[p])}let h=s;for(let p=c.length-1,y=s;p>0;p--)y=y.add(c[p]),h=h.add(y);if(u=u.add(h),d!==0)for(let p=0;p<o;p++)u=u.double()}return u}function kD(t){return AD(t.Fp),T1(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...y3(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}const ei=BigInt(0),Ln=BigInt(1),yf=BigInt(2),PD=BigInt(8),RD={zip215:!0};function DD(t){const e=kD(t);return T1(t,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}function UD(t){const e=DD(t),{Fp:r,n,prehash:s,hash:i,randomBytes:o,nByteLength:a,h:c}=e,l=yf<<BigInt(a*8)-Ln,u=r.create,d=m3(e.n,e.nBitLength),h=e.uvRatio||((f,m)=>{try{return{isValid:!0,value:r.sqrt(f*r.inv(m))}}catch{return{isValid:!1,value:ei}}}),p=e.adjustScalarBytes||(f=>f),y=e.domain||((f,m,_)=>{if(nm("phflag",_),m.length||_)throw new Error("Contexts/pre-hash are not supported");return f});function g(f,m){ku("coordinate "+f,m,ei,l)}function w(f){if(!(f instanceof E))throw new Error("ExtendedPoint expected")}const S=c_((f,m)=>{const{ex:_,ey:$,ez:x}=f,N=f.is0();m==null&&(m=N?PD:r.inv(x));const H=u(_*m),z=u($*m),G=u(x*m);if(N)return{x:ei,y:Ln};if(G!==Ln)throw new Error("invZ was invalid");return{x:H,y:z}}),A=c_(f=>{const{a:m,d:_}=e;if(f.is0())throw new Error("bad point: ZERO");const{ex:$,ey:x,ez:N,et:H}=f,z=u($*$),G=u(x*x),M=u(N*N),V=u(M*M),J=u(z*m),re=u(M*u(J+G)),ye=u(V+u(_*u(z*G)));if(re!==ye)throw new Error("bad point: equation left != right (1)");const ne=u($*x),se=u(N*H);if(ne!==se)throw new Error("bad point: equation left != right (2)");return!0});class E{constructor(m,_,$,x){this.ex=m,this.ey=_,this.ez=$,this.et=x,g("x",m),g("y",_),g("z",$),g("t",x),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(m){if(m instanceof E)throw new Error("extended point not allowed");const{x:_,y:$}=m||{};return g("x",_),g("y",$),new E(_,$,Ln,u(_*$))}static normalizeZ(m){const _=r.invertBatch(m.map($=>$.ez));return m.map(($,x)=>$.toAffine(_[x])).map(E.fromAffine)}static msm(m,_){return OD(E,d,m,_)}_setWindowSize(m){O.setWindowSize(this,m)}assertValidity(){A(this)}equals(m){w(m);const{ex:_,ey:$,ez:x}=this,{ex:N,ey:H,ez:z}=m,G=u(_*z),M=u(N*x),V=u($*z),J=u(H*x);return G===M&&V===J}is0(){return this.equals(E.ZERO)}negate(){return new E(u(-this.ex),this.ey,this.ez,u(-this.et))}double(){const{a:m}=e,{ex:_,ey:$,ez:x}=this,N=u(_*_),H=u($*$),z=u(yf*u(x*x)),G=u(m*N),M=_+$,V=u(u(M*M)-N-H),J=G+H,re=J-z,ye=G-H,ne=u(V*re),se=u(J*ye),Ie=u(V*ye),Me=u(re*J);return new E(ne,se,Me,Ie)}add(m){w(m);const{a:_,d:$}=e,{ex:x,ey:N,ez:H,et:z}=this,{ex:G,ey:M,ez:V,et:J}=m;if(_===BigInt(-1)){const Ei=u((N-x)*(M+G)),Ma=u((N+x)*(M-G)),el=u(Ma-Ei);if(el===ei)return this.double();const tl=u(H*yf*J),rl=u(z*yf*V),ja=rl+tl,nl=Ma+Ei,Fa=rl-tl,vu=u(ja*el),Eu=u(nl*Fa),ef=u(ja*Fa),Sy=u(el*nl);return new E(vu,Eu,Sy,ef)}const re=u(x*G),ye=u(N*M),ne=u(z*$*J),se=u(H*V),Ie=u((x+N)*(G+M)-re-ye),Me=se-ne,Ve=se+ne,Ze=u(ye-_*re),Nt=u(Ie*Me),Br=u(Ve*Ze),sr=u(Ie*Ze),Ir=u(Me*Ve);return new E(Nt,Br,Ir,sr)}subtract(m){return this.add(m.negate())}wNAF(m){return O.wNAFCached(this,m,E.normalizeZ)}multiply(m){const _=m;ku("scalar",_,Ln,n);const{p:$,f:x}=this.wNAF(_);return E.normalizeZ([$,x])[0]}multiplyUnsafe(m,_=E.ZERO){const $=m;return ku("scalar",$,ei,n),$===ei?C:this.is0()||$===Ln?this:O.wNAFCachedUnsafe(this,$,E.normalizeZ,_)}isSmallOrder(){return this.multiplyUnsafe(c).is0()}isTorsionFree(){return O.unsafeLadder(this,n).is0()}toAffine(m){return S(this,m)}clearCofactor(){const{h:m}=e;return m===Ln?this:this.multiplyUnsafe(m)}static fromHex(m,_=!1){const{d:$,a:x}=e,N=r.BYTES;m=Xi("pointHex",m,N),nm("zip215",_);const H=m.slice(),z=m[N-1];H[N-1]=z&-129;const G=cp(H),M=_?l:r.ORDER;ku("pointHex.y",G,ei,M);const V=u(G*G),J=u(V-Ln),re=u($*V-x);let{isValid:ye,value:ne}=h(J,re);if(!ye)throw new Error("Point.fromHex: invalid y coordinate");const se=(ne&Ln)===Ln,Ie=(z&128)!==0;if(!_&&ne===ei&&Ie)throw new Error("Point.fromHex: x=0 and x_0=1");return Ie!==se&&(ne=u(-ne)),E.fromAffine({x:ne,y:G})}static fromPrivateKey(m){return D(m).point}toRawBytes(){const{x:m,y:_}=this.toAffine(),$=p0(_,r.BYTES);return $[$.length-1]|=m&Ln?128:0,$}toHex(){return $1(this.toRawBytes())}}E.BASE=new E(e.Gx,e.Gy,Ln,u(e.Gx*e.Gy)),E.ZERO=new E(ei,Ln,Ln,ei);const{BASE:v,ZERO:C}=E,O=ND(E,a*8);function L(f){return Pr(f,n)}function j(f){return L(cp(f))}function D(f){const m=r.BYTES;f=Xi("private key",f,m);const _=Xi("hashed private key",i(f),2*m),$=p(_.slice(0,m)),x=_.slice(m,2*m),N=j($),H=v.multiply(N),z=H.toRawBytes();return{head:$,prefix:x,scalar:N,point:H,pointBytes:z}}function W(f){return D(f).pointBytes}function P(f=new Uint8Array,...m){const _=a_(...m);return j(i(y(_,Xi("context",f),!!s)))}function R(f,m,_={}){f=Xi("message",f),s&&(f=s(f));const{prefix:$,scalar:x,pointBytes:N}=D(m),H=P(_.context,$,f),z=v.multiply(H).toRawBytes(),G=P(_.context,z,N,f),M=L(H+G*x);ku("signature.s",M,ei,n);const V=a_(z,p0(M,r.BYTES));return Xi("result",V,r.BYTES*2)}const T=RD;function k(f,m,_,$=T){const{context:x,zip215:N}=$,H=r.BYTES;f=Xi("signature",f,2*H),m=Xi("message",m),_=Xi("publicKey",_,H),N!==void 0&&nm("zip215",N),s&&(m=s(m));const z=cp(f.slice(H,2*H));let G,M,V;try{G=E.fromHex(_,N),M=E.fromHex(f.slice(0,H),N),V=v.multiplyUnsafe(z)}catch{return!1}if(!N&&G.isSmallOrder())return!1;const J=P(x,M.toRawBytes(),G.toRawBytes(),m);return M.add(G.multiplyUnsafe(J)).subtract(V).clearCofactor().equals(E.ZERO)}return v._setWindowSize(8),{CURVE:e,getPublicKey:W,sign:R,verify:k,ExtendedPoint:E,utils:{getExtendedPublicKey:D,randomPrivateKey:()=>o(r.BYTES),precompute(f=8,m=E.BASE){return m._setWindowSize(f),m.multiply(BigInt(3)),m}}}}BigInt(0),BigInt(1);const N1=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),f_=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt(0);const BD=BigInt(1),p_=BigInt(2);BigInt(3);const LD=BigInt(5),MD=BigInt(8);function jD(t){const e=BigInt(10),r=BigInt(20),n=BigInt(40),s=BigInt(80),i=N1,o=t*t%i*t%i,a=_i(o,p_,i)*o%i,c=_i(a,BD,i)*t%i,l=_i(c,LD,i)*c%i,u=_i(l,e,i)*l%i,d=_i(u,r,i)*u%i,h=_i(d,n,i)*d%i,p=_i(h,s,i)*h%i,y=_i(p,s,i)*h%i,g=_i(y,e,i)*l%i;return{pow_p_5_8:_i(g,p_,i)*t%i,b2:o}}function FD(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}function qD(t,e){const r=N1,n=Pr(e*e*e,r),s=Pr(n*n*e,r),i=jD(t*s).pow_p_5_8;let o=Pr(t*n*i,r);const a=Pr(e*o*o,r),c=o,l=Pr(o*f_,r),u=a===t,d=a===Pr(-t,r),h=a===Pr(-t*f_,r);return u&&(o=c),(d||h)&&(o=l),xD(o,r)&&(o=Pr(-o,r)),{isValid:u||d,value:o}}const zD=m3(N1,void 0,!0),HD={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:zD,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:MD,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:dD,randomBytes:u3,adjustScalarBytes:FD,uvRatio:qD},v3=UD(HD),WD="EdDSA",VD="JWT",Lp=".",Fg="base64url",E3="utf8",_3="utf8",KD=":",GD="did",YD="key",g_="base58btc",XD="z",ZD="K36",JD=32;function O1(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function x3(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?O1(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function S3(t,e){e||(e=t.reduce((s,i)=>s+i.length,0));const r=x3(e);let n=0;for(const s of t)r.set(s,n),n+=s.length;return O1(r)}function QD(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var s=0;s<t.length;s++){var i=t.charAt(s),o=i.charCodeAt(0);if(r[o]!==255)throw new TypeError(i+" is ambiguous");r[o]=s}var a=t.length,c=t.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function d(y){if(y instanceof Uint8Array||(ArrayBuffer.isView(y)?y=new Uint8Array(y.buffer,y.byteOffset,y.byteLength):Array.isArray(y)&&(y=Uint8Array.from(y))),!(y instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(y.length===0)return"";for(var g=0,w=0,S=0,A=y.length;S!==A&&y[S]===0;)S++,g++;for(var E=(A-S)*u+1>>>0,v=new Uint8Array(E);S!==A;){for(var C=y[S],O=0,L=E-1;(C!==0||O<w)&&L!==-1;L--,O++)C+=256*v[L]>>>0,v[L]=C%a>>>0,C=C/a>>>0;if(C!==0)throw new Error("Non-zero carry");w=O,S++}for(var j=E-w;j!==E&&v[j]===0;)j++;for(var D=c.repeat(g);j<E;++j)D+=t.charAt(v[j]);return D}function h(y){if(typeof y!="string")throw new TypeError("Expected String");if(y.length===0)return new Uint8Array;var g=0;if(y[g]!==" "){for(var w=0,S=0;y[g]===c;)w++,g++;for(var A=(y.length-g)*l+1>>>0,E=new Uint8Array(A);y[g];){var v=r[y.charCodeAt(g)];if(v===255)return;for(var C=0,O=A-1;(v!==0||C<S)&&O!==-1;O--,C++)v+=a*E[O]>>>0,E[O]=v%256>>>0,v=v/256>>>0;if(v!==0)throw new Error("Non-zero carry");S=C,g++}if(y[g]!==" "){for(var L=A-S;L!==A&&E[L]===0;)L++;for(var j=new Uint8Array(w+(A-L)),D=w;L!==A;)j[D++]=E[L++];return j}}}function p(y){var g=h(y);if(g)return g;throw new Error(`Non-${e} character`)}return{encode:d,decodeUnsafe:h,decode:p}}var eU=QD,tU=eU;const A3=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},rU=t=>new TextEncoder().encode(t),nU=t=>new TextDecoder().decode(t);let sU=class{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},iU=class{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return I3(this,e)}},oU=class{constructor(e){this.decoders=e}or(e){return I3(this,e)}decode(e){const r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};const I3=(t,e)=>new oU({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});let aU=class{constructor(e,r,n,s){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=s,this.encoder=new sU(e,r,n),this.decoder=new iU(e,r,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}};const qg=({name:t,prefix:e,encode:r,decode:n})=>new aU(t,e,r,n),Nh=({prefix:t,name:e,alphabet:r})=>{const{encode:n,decode:s}=tU(r,e);return qg({prefix:t,name:e,encode:n,decode:i=>A3(s(i))})},cU=(t,e,r,n)=>{const s={};for(let u=0;u<e.length;++u)s[e[u]]=u;let i=t.length;for(;t[i-1]==="=";)--i;const o=new Uint8Array(i*r/8|0);let a=0,c=0,l=0;for(let u=0;u<i;++u){const d=s[t[u]];if(d===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<r|d,a+=r,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},lU=(t,e,r)=>{const n=e[e.length-1]==="=",s=(1<<r)-1;let i="",o=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],o+=8;o>r;)o-=r,i+=e[s&a>>o];if(o&&(i+=e[s&a<<r-o]),n)for(;i.length*r&7;)i+="=";return i},un=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>qg({prefix:e,name:t,encode(s){return lU(s,n,r)},decode(s){return cU(s,n,r,t)}}),uU=qg({prefix:"\0",name:"identity",encode:t=>nU(t),decode:t=>rU(t)});var dU=Object.freeze({__proto__:null,identity:uU});const hU=un({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var fU=Object.freeze({__proto__:null,base2:hU});const pU=un({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var gU=Object.freeze({__proto__:null,base8:pU});const yU=Nh({prefix:"9",name:"base10",alphabet:"0123456789"});var mU=Object.freeze({__proto__:null,base10:yU});const wU=un({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),bU=un({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var vU=Object.freeze({__proto__:null,base16:wU,base16upper:bU});const EU=un({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),_U=un({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),xU=un({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),SU=un({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),AU=un({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),IU=un({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),CU=un({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),$U=un({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),TU=un({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var NU=Object.freeze({__proto__:null,base32:EU,base32upper:_U,base32pad:xU,base32padupper:SU,base32hex:AU,base32hexupper:IU,base32hexpad:CU,base32hexpadupper:$U,base32z:TU});const OU=Nh({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),kU=Nh({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var PU=Object.freeze({__proto__:null,base36:OU,base36upper:kU});const RU=Nh({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),DU=Nh({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var UU=Object.freeze({__proto__:null,base58btc:RU,base58flickr:DU});const BU=un({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),LU=un({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),MU=un({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),jU=un({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var FU=Object.freeze({__proto__:null,base64:BU,base64pad:LU,base64url:MU,base64urlpad:jU});const C3=Array.from(""),qU=C3.reduce((t,e,r)=>(t[r]=e,t),[]),zU=C3.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function HU(t){return t.reduce((e,r)=>(e+=qU[r],e),"")}function WU(t){const e=[];for(const r of t){const n=zU[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}const VU=qg({prefix:"",name:"base256emoji",encode:HU,decode:WU});var KU=Object.freeze({__proto__:null,base256emoji:VU}),GU=$3,y_=128,YU=-128,XU=Math.pow(2,31);function $3(t,e,r){e=e||[],r=r||0;for(var n=r;t>=XU;)e[r++]=t&255|y_,t/=128;for(;t&YU;)e[r++]=t&255|y_,t>>>=7;return e[r]=t|0,$3.bytes=r-n+1,e}var ZU=y0,JU=128,m_=127;function y0(t,n){var r=0,n=n||0,s=0,i=n,o,a=t.length;do{if(i>=a)throw y0.bytes=0,new RangeError("Could not decode varint");o=t[i++],r+=s<28?(o&m_)<<s:(o&m_)*Math.pow(2,s),s+=7}while(o>=JU);return y0.bytes=i-n,r}var QU=Math.pow(2,7),eB=Math.pow(2,14),tB=Math.pow(2,21),rB=Math.pow(2,28),nB=Math.pow(2,35),sB=Math.pow(2,42),iB=Math.pow(2,49),oB=Math.pow(2,56),aB=Math.pow(2,63),cB=function(t){return t<QU?1:t<eB?2:t<tB?3:t<rB?4:t<nB?5:t<sB?6:t<iB?7:t<oB?8:t<aB?9:10},lB={encode:GU,decode:ZU,encodingLength:cB},T3=lB;const w_=(t,e,r=0)=>(T3.encode(t,e,r),e),b_=t=>T3.encodingLength(t),m0=(t,e)=>{const r=e.byteLength,n=b_(t),s=n+b_(r),i=new Uint8Array(s+r);return w_(t,i,0),w_(r,i,n),i.set(e,s),new uB(t,r,e,i)};let uB=class{constructor(e,r,n,s){this.code=e,this.size=r,this.digest=n,this.bytes=s}};const N3=({name:t,code:e,encode:r})=>new dB(t,e,r);let dB=class{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){const r=this.encode(e);return r instanceof Uint8Array?m0(this.code,r):r.then(n=>m0(this.code,n))}else throw Error("Unknown type, must be binary type")}};const O3=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),hB=N3({name:"sha2-256",code:18,encode:O3("SHA-256")}),fB=N3({name:"sha2-512",code:19,encode:O3("SHA-512")});var pB=Object.freeze({__proto__:null,sha256:hB,sha512:fB});const k3=0,gB="identity",P3=A3,yB=t=>m0(k3,P3(t)),mB={code:k3,name:gB,encode:P3,digest:yB};var wB=Object.freeze({__proto__:null,identity:mB});new TextEncoder,new TextDecoder;const v_={...dU,...fU,...gU,...mU,...vU,...NU,...PU,...UU,...FU,...KU};({...pB,...wB});function R3(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}const E_=R3("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),lm=R3("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);const e=x3(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),D3={utf8:E_,"utf-8":E_,hex:v_.base16,latin1:lm,ascii:lm,binary:lm,...v_};function zg(t,e="utf8"){const r=D3[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}function fu(t,e="utf8"){const r=D3[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?O1(globalThis.Buffer.from(t,"utf-8")):r.decoder.decode(`${r.prefix}${t}`)}function __(t){return Wi(zg(fu(t,Fg),E3))}function Mp(t){return zg(fu(Bn(t),E3),Fg)}function k1(t){const e=fu(ZD,g_),r=XD+zg(S3([e,t]),g_);return[GD,YD,r].join(KD)}function bB(t){return zg(t,Fg)}function vB(t){return fu(t,Fg)}function EB(t){return fu([Mp(t.header),Mp(t.payload)].join(Lp),_3)}function _B(t){return[Mp(t.header),Mp(t.payload),bB(t.signature)].join(Lp)}function Xl(t){const e=t.split(Lp),r=__(e[0]),n=__(e[1]),s=vB(e[2]),i=fu(e.slice(0,2).join(Lp),_3);return{header:r,payload:n,signature:s,data:i}}function jp(t=u3(JD)){const e=v3.getPublicKey(t);return{secretKey:S3([t,e]),publicKey:e}}async function U3(t,e,r,n,s=X.fromMiliseconds(Date.now())){const i={alg:WD,typ:VD},o=k1(n.publicKey),a=s+r,c={iss:o,sub:t,aud:e,iat:s,exp:a},l=EB({header:i,payload:c}),u=v3.sign(l,n.secretKey.slice(0,32));return _B({header:i,payload:c,signature:u})}var x_=function(t,e,r){if(r||arguments.length===2)for(var n=0,s=e.length,i;n<s;n++)(i||!(n in e))&&(i||(i=Array.prototype.slice.call(e,0,n)),i[n]=e[n]);return t.concat(i||Array.prototype.slice.call(e))},xB=(function(){function t(e,r,n){this.name=e,this.version=r,this.os=n,this.type="browser"}return t})(),SB=(function(){function t(e){this.version=e,this.type="node",this.name="node",this.os=process.platform}return t})(),AB=(function(){function t(e,r,n,s){this.name=e,this.version=r,this.os=n,this.bot=s,this.type="bot-device"}return t})(),IB=(function(){function t(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return t})(),CB=(function(){function t(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return t})(),$B=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,TB=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,S_=3,NB=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",$B]],A_=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function B3(t){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new CB:typeof navigator<"u"?kB(navigator.userAgent):RB()}function OB(t){return t!==""&&NB.reduce(function(e,r){var n=r[0],s=r[1];if(e)return e;var i=s.exec(t);return!!i&&[n,i]},!1)}function kB(t){var e=OB(t);if(!e)return null;var r=e[0],n=e[1];if(r==="searchbot")return new IB;var s=n[1]&&n[1].split(".").join("_").split("_").slice(0,3);s?s.length<S_&&(s=x_(x_([],s,!0),DB(S_-s.length),!0)):s=[];var i=s.join("."),o=PB(t),a=TB.exec(t);return a&&a[1]?new AB(r,i,o,a[1]):new xB(r,i,o)}function PB(t){for(var e=0,r=A_.length;e<r;e++){var n=A_[e],s=n[0],i=n[1],o=i.exec(t);if(o)return s}return null}function RB(){var t=typeof process<"u"&&process.version;return t?new SB(process.version.slice(1)):null}function DB(t){for(var e=[],r=0;r<t;r++)e.push("0");return e}var Ft={},I_;function L3(){if(I_)return Ft;I_=1,Object.defineProperty(Ft,"__esModule",{value:!0}),Ft.getLocalStorage=Ft.getLocalStorageOrThrow=Ft.getCrypto=Ft.getCryptoOrThrow=Ft.getLocation=Ft.getLocationOrThrow=Ft.getNavigator=Ft.getNavigatorOrThrow=Ft.getDocument=Ft.getDocumentOrThrow=Ft.getFromWindowOrThrow=Ft.getFromWindow=void 0;function t(h){let p;return typeof window<"u"&&typeof window[h]<"u"&&(p=window[h]),p}Ft.getFromWindow=t;function e(h){const p=t(h);if(!p)throw new Error(`${h} is not defined in Window`);return p}Ft.getFromWindowOrThrow=e;function r(){return e("document")}Ft.getDocumentOrThrow=r;function n(){return t("document")}Ft.getDocument=n;function s(){return e("navigator")}Ft.getNavigatorOrThrow=s;function i(){return t("navigator")}Ft.getNavigator=i;function o(){return e("location")}Ft.getLocationOrThrow=o;function a(){return t("location")}Ft.getLocation=a;function c(){return e("crypto")}Ft.getCryptoOrThrow=c;function l(){return t("crypto")}Ft.getCrypto=l;function u(){return e("localStorage")}Ft.getLocalStorageOrThrow=u;function d(){return t("localStorage")}return Ft.getLocalStorage=d,Ft}var Xr=L3(),Pu={},C_;function UB(){if(C_)return Pu;C_=1,Object.defineProperty(Pu,"__esModule",{value:!0}),Pu.getWindowMetadata=void 0;const t=L3();function e(){let r,n;try{r=t.getDocumentOrThrow(),n=t.getLocationOrThrow()}catch{return null}function s(){const p=r.getElementsByTagName("link"),y=[];for(let g=0;g<p.length;g++){const w=p[g],S=w.getAttribute("rel");if(S&&S.toLowerCase().indexOf("icon")>-1){const A=w.getAttribute("href");if(A)if(A.toLowerCase().indexOf("https:")===-1&&A.toLowerCase().indexOf("http:")===-1&&A.indexOf("//")!==0){let E=n.protocol+"//"+n.host;if(A.indexOf("/")===0)E+=A;else{const v=n.pathname.split("/");v.pop();const C=v.join("/");E+=C+"/"+A}y.push(E)}else if(A.indexOf("//")===0){const E=n.protocol+A;y.push(E)}else y.push(A)}}return y}function i(...p){const y=r.getElementsByTagName("meta");for(let g=0;g<y.length;g++){const w=y[g],S=["itemprop","property","name"].map(A=>w.getAttribute(A)).filter(A=>A?p.includes(A):!1);if(S.length&&S){const A=w.getAttribute("content");if(A)return A}}return""}function o(){let p=i("name","og:site_name","og:title","twitter:title");return p||(p=r.title),p}function a(){return i("description","og:description","twitter:description","keywords")}const c=o(),l=a(),u=n.origin,d=s();return{description:l,url:u,icons:d,name:c}}return Pu.getWindowMetadata=e,Pu}var M3=UB();const BB="0.1.1";function LB(){return BB}let mr=class w0 extends Error{constructor(e,r={}){const n=(()=>{if(r.cause instanceof w0){if(r.cause.details)return r.cause.details;if(r.cause.shortMessage)return r.cause.shortMessage}return r.cause&&"details"in r.cause&&typeof r.cause.details=="string"?r.cause.details:r.cause?.message?r.cause.message:r.details})(),s=r.cause instanceof w0&&r.cause.docsPath||r.docsPath,o=`https://oxlib.sh${s??""}`,a=[e||"An error occurred.",...r.metaMessages?["",...r.metaMessages]:[],...n||s?["",n?`Details: ${n}`:void 0,s?`See: ${o}`:void 0]:[]].filter(c=>typeof c=="string").join(`
`);super(a,r.cause?{cause:r.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:`ox@${LB()}`}),this.cause=r.cause,this.details=n,this.docs=o,this.docsPath=s,this.shortMessage=e}walk(e){return j3(this,e)}};function j3(t,e){return e?.(t)?t:t&&typeof t=="object"&&"cause"in t&&t.cause?j3(t.cause,e):e?null:t}const ul=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function MB(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function Ud(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function Pc(t,...e){if(!MB(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function jB(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");Ud(t.outputLen),Ud(t.blockLen)}function Zl(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function F3(t,e){Pc(t);const r=e.outputLen;if(t.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}function FB(t){return new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4))}function Jl(...t){for(let e=0;e<t.length;e++)t[e].fill(0)}function um(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function xi(t,e){return t<<32-e|t>>>e}const qB=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function zB(t){return t<<24&4278190080|t<<8&16711680|t>>>8&65280|t>>>24&255}function HB(t){for(let e=0;e<t.length;e++)t[e]=zB(t[e]);return t}const $_=qB?t=>t:HB;function WB(t){if(typeof t!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(t))}function Hg(t){return typeof t=="string"&&(t=WB(t)),Pc(t),t}function VB(...t){let e=0;for(let n=0;n<t.length;n++){const s=t[n];Pc(s),e+=s.length}const r=new Uint8Array(e);for(let n=0,s=0;n<t.length;n++){const i=t[n];r.set(i,s),s+=i.length}return r}let P1=class{};function q3(t){const e=n=>t().update(Hg(n)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function KB(t=32){if(ul&&typeof ul.getRandomValues=="function")return ul.getRandomValues(new Uint8Array(t));if(ul&&typeof ul.randomBytes=="function")return Uint8Array.from(ul.randomBytes(t));throw new Error("crypto.getRandomValues must be defined")}function GB(t,e,r,n){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,n);const s=BigInt(32),i=BigInt(4294967295),o=Number(r>>s&i),a=Number(r&i),c=n?4:0,l=n?0:4;t.setUint32(e+c,o,n),t.setUint32(e+l,a,n)}function YB(t,e,r){return t&e^~t&r}function XB(t,e,r){return t&e^t&r^e&r}let ZB=class extends P1{constructor(e,r,n,s){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=e,this.outputLen=r,this.padOffset=n,this.isLE=s,this.buffer=new Uint8Array(e),this.view=um(this.buffer)}update(e){Zl(this),e=Hg(e),Pc(e);const{view:r,buffer:n,blockLen:s}=this,i=e.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const c=um(e);for(;s<=i-o;o+=s)this.process(c,o);continue}n.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Zl(this),F3(e,this),this.finished=!0;const{buffer:r,view:n,blockLen:s,isLE:i}=this;let{pos:o}=this;r[o++]=128,Jl(this.buffer.subarray(o)),this.padOffset>s-o&&(this.process(n,0),o=0);for(let d=o;d<s;d++)r[d]=0;GB(n,s-8,BigInt(this.length*8),i),this.process(n,0);const a=um(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=c/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<l;d++)a.setUint32(4*d,u[d],i)}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const n=e.slice(0,r);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:r,buffer:n,length:s,finished:i,destroyed:o,pos:a}=this;return e.destroyed=o,e.finished=i,e.length=s,e.pos=a,s%r&&e.buffer.set(n),e}clone(){return this._cloneInto()}};const jo=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),mf=BigInt(2**32-1),T_=BigInt(32);function JB(t,e=!1){return e?{h:Number(t&mf),l:Number(t>>T_&mf)}:{h:Number(t>>T_&mf)|0,l:Number(t&mf)|0}}function QB(t,e=!1){const r=t.length;let n=new Uint32Array(r),s=new Uint32Array(r);for(let i=0;i<r;i++){const{h:o,l:a}=JB(t[i],e);[n[i],s[i]]=[o,a]}return[n,s]}const eL=(t,e,r)=>t<<r|e>>>32-r,tL=(t,e,r)=>e<<r|t>>>32-r,rL=(t,e,r)=>e<<r-32|t>>>64-r,nL=(t,e,r)=>t<<r-32|e>>>64-r,sL=BigInt(0),Ru=BigInt(1),iL=BigInt(2),oL=BigInt(7),aL=BigInt(256),cL=BigInt(113),z3=[],H3=[],W3=[];for(let t=0,e=Ru,r=1,n=0;t<24;t++){[r,n]=[n,(2*r+3*n)%5],z3.push(2*(5*n+r)),H3.push((t+1)*(t+2)/2%64);let s=sL;for(let i=0;i<7;i++)e=(e<<Ru^(e>>oL)*cL)%aL,e&iL&&(s^=Ru<<(Ru<<BigInt(i))-Ru);W3.push(s)}const V3=QB(W3,!0),lL=V3[0],uL=V3[1],N_=(t,e,r)=>r>32?rL(t,e,r):eL(t,e,r),O_=(t,e,r)=>r>32?nL(t,e,r):tL(t,e,r);function dL(t,e=24){const r=new Uint32Array(10);for(let n=24-e;n<24;n++){for(let o=0;o<10;o++)r[o]=t[o]^t[o+10]^t[o+20]^t[o+30]^t[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,c=(o+2)%10,l=r[c],u=r[c+1],d=N_(l,u,1)^r[a],h=O_(l,u,1)^r[a+1];for(let p=0;p<50;p+=10)t[o+p]^=d,t[o+p+1]^=h}let s=t[2],i=t[3];for(let o=0;o<24;o++){const a=H3[o],c=N_(s,i,a),l=O_(s,i,a),u=z3[o];s=t[u],i=t[u+1],t[u]=c,t[u+1]=l}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)r[a]=t[o+a];for(let a=0;a<10;a++)t[o+a]^=~r[(a+2)%10]&r[(a+4)%10]}t[0]^=lL[n],t[1]^=uL[n]}Jl(r)}let hL=class K3 extends P1{constructor(e,r,n,s=!1,i=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=e,this.suffix=r,this.outputLen=n,this.enableXOF=s,this.rounds=i,Ud(n),!(0<e&&e<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=FB(this.state)}clone(){return this._cloneInto()}keccak(){$_(this.state32),dL(this.state32,this.rounds),$_(this.state32),this.posOut=0,this.pos=0}update(e){Zl(this),e=Hg(e),Pc(e);const{blockLen:r,state:n}=this,s=e.length;for(let i=0;i<s;){const o=Math.min(r-this.pos,s-i);for(let a=0;a<o;a++)n[this.pos++]^=e[i++];this.pos===r&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:r,pos:n,blockLen:s}=this;e[n]^=r,(r&128)!==0&&n===s-1&&this.keccak(),e[s-1]^=128,this.keccak()}writeInto(e){Zl(this,!1),Pc(e),this.finish();const r=this.state,{blockLen:n}=this;for(let s=0,i=e.length;s<i;){this.posOut>=n&&this.keccak();const o=Math.min(n-this.posOut,i-s);e.set(r.subarray(this.posOut,this.posOut+o),s),this.posOut+=o,s+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return Ud(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(F3(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,Jl(this.state)}_cloneInto(e){const{blockLen:r,suffix:n,outputLen:s,rounds:i,enableXOF:o}=this;return e||(e=new K3(r,n,s,o,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=n,e.outputLen=s,e.enableXOF=o,e.destroyed=this.destroyed,e}};const fL=(t,e,r)=>q3(()=>new hL(e,t,r)),pL=fL(1,136,256/8),gL=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Fo=new Uint32Array(64);let yL=class extends ZB{constructor(e=32){super(64,e,8,!1),this.A=jo[0]|0,this.B=jo[1]|0,this.C=jo[2]|0,this.D=jo[3]|0,this.E=jo[4]|0,this.F=jo[5]|0,this.G=jo[6]|0,this.H=jo[7]|0}get(){const{A:e,B:r,C:n,D:s,E:i,F:o,G:a,H:c}=this;return[e,r,n,s,i,o,a,c]}set(e,r,n,s,i,o,a,c){this.A=e|0,this.B=r|0,this.C=n|0,this.D=s|0,this.E=i|0,this.F=o|0,this.G=a|0,this.H=c|0}process(e,r){for(let d=0;d<16;d++,r+=4)Fo[d]=e.getUint32(r,!1);for(let d=16;d<64;d++){const h=Fo[d-15],p=Fo[d-2],y=xi(h,7)^xi(h,18)^h>>>3,g=xi(p,17)^xi(p,19)^p>>>10;Fo[d]=g+Fo[d-7]+y+Fo[d-16]|0}let{A:n,B:s,C:i,D:o,E:a,F:c,G:l,H:u}=this;for(let d=0;d<64;d++){const h=xi(a,6)^xi(a,11)^xi(a,25),p=u+h+YB(a,c,l)+gL[d]+Fo[d]|0,g=(xi(n,2)^xi(n,13)^xi(n,22))+XB(n,s,i)|0;u=l,l=c,c=a,a=o+p|0,o=i,i=s,s=n,n=p+g|0}n=n+this.A|0,s=s+this.B|0,i=i+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,l=l+this.G|0,u=u+this.H|0,this.set(n,s,i,o,a,c,l,u)}roundClean(){Jl(Fo)}destroy(){this.set(0,0,0,0,0,0,0,0),Jl(this.buffer)}};const mL=q3(()=>new yL);const R1=BigInt(0),b0=BigInt(1);function Oh(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function D1(t){if(!Oh(t))throw new Error("Uint8Array expected")}function Bd(t,e){if(typeof e!="boolean")throw new Error(t+" boolean expected, got "+e)}function wf(t){const e=t.toString(16);return e.length&1?"0"+e:e}function G3(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return t===""?R1:BigInt("0x"+t)}const Y3=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",wL=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Ld(t){if(D1(t),Y3)return t.toHex();let e="";for(let r=0;r<t.length;r++)e+=wL[t[r]];return e}const Zi={_0:48,_9:57,A:65,F:70,a:97,f:102};function k_(t){if(t>=Zi._0&&t<=Zi._9)return t-Zi._0;if(t>=Zi.A&&t<=Zi.F)return t-(Zi.A-10);if(t>=Zi.a&&t<=Zi.f)return t-(Zi.a-10)}function Fp(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);if(Y3)return Uint8Array.fromHex(t);const e=t.length,r=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(r);for(let s=0,i=0;s<r;s++,i+=2){const o=k_(t.charCodeAt(i)),a=k_(t.charCodeAt(i+1));if(o===void 0||a===void 0){const c=t[i]+t[i+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+i)}n[s]=o*16+a}return n}function Ic(t){return G3(Ld(t))}function X3(t){return D1(t),G3(Ld(Uint8Array.from(t).reverse()))}function kh(t,e){return Fp(t.toString(16).padStart(e*2,"0"))}function Z3(t,e){return kh(t,e).reverse()}function Hs(t,e,r){let n;if(typeof e=="string")try{n=Fp(e)}catch(i){throw new Error(t+" must be hex string or Uint8Array, cause: "+i)}else if(Oh(e))n=Uint8Array.from(e);else throw new Error(t+" must be hex string or Uint8Array");const s=n.length;if(typeof r=="number"&&s!==r)throw new Error(t+" of length "+r+" expected, got "+s);return n}function qp(...t){let e=0;for(let n=0;n<t.length;n++){const s=t[n];D1(s),e+=s.length}const r=new Uint8Array(e);for(let n=0,s=0;n<t.length;n++){const i=t[n];r.set(i,s),s+=i.length}return r}const dm=t=>typeof t=="bigint"&&R1<=t;function U1(t,e,r){return dm(t)&&dm(e)&&dm(r)&&e<=t&&t<r}function Bl(t,e,r,n){if(!U1(e,r,n))throw new Error("expected valid "+t+": "+r+" <= n < "+n+", got "+e)}function bL(t){let e;for(e=0;t>R1;t>>=b0,e+=1);return e}const Wg=t=>(b0<<BigInt(t))-b0,hm=t=>new Uint8Array(t),P_=t=>Uint8Array.from(t);function vL(t,e,r){if(typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof r!="function")throw new Error("hmacFn must be a function");let n=hm(t),s=hm(t),i=0;const o=()=>{n.fill(1),s.fill(0),i=0},a=(...d)=>r(s,n,...d),c=(d=hm(0))=>{s=a(P_([0]),d),n=a(),d.length!==0&&(s=a(P_([1]),d),n=a())},l=()=>{if(i++>=1e3)throw new Error("drbg: tried 1000 values");let d=0;const h=[];for(;d<e;){n=a();const p=n.slice();h.push(p),d+=n.length}return qp(...h)};return(d,h)=>{o(),c(d);let p;for(;!(p=h(l()));)c();return o(),p}}const EL={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||Oh(t),isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function Vg(t,e,r={}){const n=(s,i,o)=>{const a=EL[i];if(typeof a!="function")throw new Error("invalid validator function");const c=t[s];if(!(o&&c===void 0)&&!a(c,t))throw new Error("param "+String(s)+" is invalid. Expected "+i+", got "+c)};for(const[s,i]of Object.entries(e))n(s,i,!1);for(const[s,i]of Object.entries(r))n(s,i,!0);return t}function R_(t){const e=new WeakMap;return(r,...n)=>{const s=e.get(r);if(s!==void 0)return s;const i=t(r,...n);return e.set(r,i),i}}function _L(t,e){if(L_(t)>e)throw new zL({givenSize:L_(t),maxSize:e})}const Ji={zero:48,nine:57,A:65,F:70,a:97,f:102};function D_(t){if(t>=Ji.zero&&t<=Ji.nine)return t-Ji.zero;if(t>=Ji.A&&t<=Ji.F)return t-(Ji.A-10);if(t>=Ji.a&&t<=Ji.f)return t-(Ji.a-10)}function xL(t,e={}){const{dir:r,size:n=32}=e;if(n===0)return t;if(t.length>n)throw new HL({size:t.length,targetSize:n,type:"Bytes"});const s=new Uint8Array(n);for(let i=0;i<n;i++){const o=r==="right";s[o?i:n-i-1]=t[o?i:t.length-i-1]}return s}function J3(t,e){if($a(t)>e)throw new PL({givenSize:$a(t),maxSize:e})}function SL(t,e){if(typeof e=="number"&&e>0&&e>$a(t)-1)throw new t$({offset:e,position:"start",size:$a(t)})}function AL(t,e,r){if(typeof e=="number"&&typeof r=="number"&&$a(t)!==r-e)throw new t$({offset:r,position:"end",size:$a(t)})}function Q3(t,e={}){const{dir:r,size:n=32}=e;if(n===0)return t;const s=t.replace("0x","");if(s.length>n*2)throw new RL({size:Math.ceil(s.length/2),targetSize:n,type:"Hex"});return`0x${s[r==="right"?"padEnd":"padStart"](n*2,"0")}`}const IL="#__bigint";function B1(t,e,r){return JSON.stringify(t,(n,s)=>typeof s=="bigint"?s.toString()+IL:s,r)}const CL=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function $L(t,e={}){const{strict:r=!1}=e;if(!t)throw new U_(t);if(typeof t!="string")throw new U_(t);if(r&&!/^0x[0-9a-fA-F]*$/.test(t))throw new B_(t);if(!t.startsWith("0x"))throw new B_(t)}function TL(...t){return`0x${t.reduce((e,r)=>e+r.replace("0x",""),"")}`}function L1(t){return t instanceof Uint8Array?zp(t):Array.isArray(t)?zp(new Uint8Array(t)):t}function zp(t,e={}){let r="";for(let s=0;s<t.length;s++)r+=CL[t[s]];const n=`0x${r}`;return typeof e.size=="number"?(J3(n,e.size),e$(n,e.size)):n}function fm(t,e={}){const{signed:r,size:n}=e,s=BigInt(t);let i;n?r?i=(1n<<BigInt(n)*8n-1n)-1n:i=2n**(BigInt(n)*8n)-1n:typeof t=="number"&&(i=BigInt(Number.MAX_SAFE_INTEGER));const o=typeof i=="bigint"&&r?-i-1n:0;if(i&&s>i||s<o){const l=typeof t=="bigint"?"n":"";throw new kL({max:i?`${i}${l}`:void 0,min:`${o}${l}`,signed:r,size:n,value:`${t}${l}`})}const c=`0x${(r&&s<0?(1n<<BigInt(n*8))+BigInt(s):s).toString(16)}`;return n?NL(c,n):c}function NL(t,e){return Q3(t,{dir:"left",size:e})}function e$(t,e){return Q3(t,{dir:"right",size:e})}function fo(t,e,r,n={}){const{strict:s}=n;SL(t,e);const i=`0x${t.replace("0x","").slice((e??0)*2,(r??t.length)*2)}`;return s&&AL(i,e,r),i}function $a(t){return Math.ceil((t.length-2)/2)}function OL(t,e={}){const{strict:r=!1}=e;try{return $L(t,{strict:r}),!0}catch{return!1}}let kL=class extends mr{constructor({max:e,min:r,signed:n,size:s,value:i}){super(`Number \`${i}\` is not in safe${s?` ${s*8}-bit`:""}${n?" signed":" unsigned"} integer range ${e?`(\`${r}\` to \`${e}\`)`:`(above \`${r}\`)`}`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.IntegerOutOfRangeError"})}},U_=class extends mr{constructor(e){super(`Value \`${typeof e=="object"?B1(e):e}\` of type \`${typeof e}\` is an invalid hex type.`,{metaMessages:['Hex types must be represented as `"0x${string}"`.']}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.InvalidHexTypeError"})}},B_=class extends mr{constructor(e){super(`Value \`${e}\` is an invalid hex value.`,{metaMessages:['Hex values must start with `"0x"` and contain only hexadecimal characters (0-9, a-f, A-F).']}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.InvalidHexValueError"})}},PL=class extends mr{constructor({givenSize:e,maxSize:r}){super(`Size cannot exceed \`${r}\` bytes. Given size: \`${e}\` bytes.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SizeOverflowError"})}},t$=class extends mr{constructor({offset:e,position:r,size:n}){super(`Slice ${r==="start"?"starting":"ending"} at offset \`${e}\` is out-of-bounds (size: \`${n}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SliceOffsetOutOfBoundsError"})}},RL=class extends mr{constructor({size:e,targetSize:r,type:n}){super(`${n.charAt(0).toUpperCase()}${n.slice(1).toLowerCase()} size (\`${e}\`) exceeds padding size (\`${r}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SizeExceedsPaddingSizeError"})}};const DL=new TextEncoder;function UL(t){if(!(t instanceof Uint8Array)){if(!t)throw new bf(t);if(typeof t!="object")throw new bf(t);if(!("BYTES_PER_ELEMENT"in t))throw new bf(t);if(t.BYTES_PER_ELEMENT!==1||t.constructor.name!=="Uint8Array")throw new bf(t)}}function BL(t){return t instanceof Uint8Array?t:typeof t=="string"?ML(t):LL(t)}function LL(t){return t instanceof Uint8Array?t:new Uint8Array(t)}function ML(t,e={}){const{size:r}=e;let n=t;r&&(J3(t,r),n=e$(t,r));let s=n.slice(2);s.length%2&&(s=`0${s}`);const i=s.length/2,o=new Uint8Array(i);for(let a=0,c=0;a<i;a++){const l=D_(s.charCodeAt(c++)),u=D_(s.charCodeAt(c++));if(l===void 0||u===void 0)throw new mr(`Invalid byte sequence ("${s[c-2]}${s[c-1]}" in "${s}").`);o[a]=l*16+u}return o}function jL(t,e={}){const{size:r}=e,n=DL.encode(t);return typeof r=="number"?(_L(n,r),FL(n,r)):n}function FL(t,e){return xL(t,{dir:"right",size:e})}function L_(t){return t.length}function qL(t){try{return UL(t),!0}catch{return!1}}let bf=class extends mr{constructor(e){super(`Value \`${typeof e=="object"?B1(e):e}\` of type \`${typeof e}\` is an invalid Bytes value.`,{metaMessages:["Bytes values must be of type `Bytes`."]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Bytes.InvalidBytesTypeError"})}},zL=class extends mr{constructor({givenSize:e,maxSize:r}){super(`Size cannot exceed \`${r}\` bytes. Given size: \`${e}\` bytes.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Bytes.SizeOverflowError"})}},HL=class extends mr{constructor({size:e,targetSize:r,type:n}){super(`${n.charAt(0).toUpperCase()}${n.slice(1).toLowerCase()} size (\`${e}\`) exceeds padding size (\`${r}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Bytes.SizeExceedsPaddingSizeError"})}};function r$(t,e={}){const{as:r=typeof t=="string"?"Hex":"Bytes"}=e,n=pL(BL(t));return r==="Bytes"?n:zp(n)}let WL=class extends Map{constructor(e){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=e}get(e){const r=super.get(e);return super.has(e)&&r!==void 0&&(this.delete(e),super.set(e,r)),r}set(e,r){if(super.set(e,r),this.maxSize&&this.size>this.maxSize){const n=this.keys().next().value;n&&this.delete(n)}return this}};const VL={checksum:new WL(8192)},pm=VL.checksum;function n$(t,e={}){const{compressed:r}=e,{prefix:n,x:s,y:i}=t;if(r===!1||typeof s=="bigint"&&typeof i=="bigint"){if(n!==4)throw new M_({prefix:n,cause:new JL});return}if(r===!0||typeof s=="bigint"&&typeof i>"u"){if(n!==3&&n!==2)throw new M_({prefix:n,cause:new ZL});return}throw new XL({publicKey:t})}function KL(t){const e=(()=>{if(OL(t))return s$(t);if(qL(t))return GL(t);const{prefix:r,x:n,y:s}=t;return typeof n=="bigint"&&typeof s=="bigint"?{prefix:r??4,x:n,y:s}:{prefix:r,x:n}})();return n$(e),e}function GL(t){return s$(zp(t))}function s$(t){if(t.length!==132&&t.length!==130&&t.length!==68)throw new QL({publicKey:t});if(t.length===130){const n=BigInt(fo(t,0,32)),s=BigInt(fo(t,32,64));return{prefix:4,x:n,y:s}}if(t.length===132){const n=Number(fo(t,0,1)),s=BigInt(fo(t,1,33)),i=BigInt(fo(t,33,65));return{prefix:n,x:s,y:i}}const e=Number(fo(t,0,1)),r=BigInt(fo(t,1,33));return{prefix:e,x:r}}function YL(t,e={}){n$(t);const{prefix:r,x:n,y:s}=t,{includePrefix:i=!0}=e;return TL(i?fm(r,{size:1}):"0x",fm(n,{size:32}),typeof s=="bigint"?fm(s,{size:32}):"0x")}let XL=class extends mr{constructor({publicKey:e}){super(`Value \`${B1(e)}\` is not a valid public key.`,{metaMessages:["Public key must contain:","- an `x` and `prefix` value (compressed)","- an `x`, `y`, and `prefix` value (uncompressed)"]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidError"})}},M_=class extends mr{constructor({prefix:e,cause:r}){super(`Prefix "${e}" is invalid.`,{cause:r}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidPrefixError"})}},ZL=class extends mr{constructor(){super("Prefix must be 2 or 3 for compressed public keys."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidCompressedPrefixError"})}},JL=class extends mr{constructor(){super("Prefix must be 4 for uncompressed public keys."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidUncompressedPrefixError"})}},QL=class extends mr{constructor({publicKey:e}){super(`Value \`${e}\` is an invalid public key size.`,{metaMessages:["Expected: 33 bytes (compressed + prefix), 64 bytes (uncompressed) or 65 bytes (uncompressed + prefix).",`Received ${$a(L1(e))} bytes.`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidSerializedSizeError"})}};const e9=/^0x[a-fA-F0-9]{40}$/;function i$(t,e={}){const{strict:r=!0}=e;if(!e9.test(t))throw new j_({address:t,cause:new n9});if(r){if(t.toLowerCase()===t)return;if(o$(t)!==t)throw new j_({address:t,cause:new s9})}}function o$(t){if(pm.has(t))return pm.get(t);i$(t,{strict:!1});const e=t.substring(2).toLowerCase(),r=r$(jL(e),{as:"Bytes"}),n=e.split("");for(let i=0;i<40;i+=2)r[i>>1]>>4>=8&&n[i]&&(n[i]=n[i].toUpperCase()),(r[i>>1]&15)>=8&&n[i+1]&&(n[i+1]=n[i+1].toUpperCase());const s=`0x${n.join("")}`;return pm.set(t,s),s}function t9(t,e={}){const{checksum:r=!1}=e;return i$(t),r?o$(t):t}function r9(t,e={}){const r=r$(`0x${YL(t).slice(4)}`).substring(26);return t9(`0x${r}`,e)}let j_=class extends mr{constructor({address:e,cause:r}){super(`Address "${e}" is invalid.`,{cause:r}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Address.InvalidAddressError"})}},n9=class extends mr{constructor(){super("Address is not a 20 byte (40 hexadecimal character) value."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Address.InvalidInputError"})}},s9=class extends mr{constructor(){super("Address does not match its checksum counterpart."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Address.InvalidChecksumError"})}},a$=class extends P1{constructor(e,r){super(),this.finished=!1,this.destroyed=!1,jB(e);const n=Hg(r);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const s=this.blockLen,i=new Uint8Array(s);i.set(n.length>s?e.create().update(n).digest():n);for(let o=0;o<i.length;o++)i[o]^=54;this.iHash.update(i),this.oHash=e.create();for(let o=0;o<i.length;o++)i[o]^=106;this.oHash.update(i),Jl(i)}update(e){return Zl(this),this.iHash.update(e),this}digestInto(e){Zl(this),Pc(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:r,iHash:n,finished:s,destroyed:i,blockLen:o,outputLen:a}=this;return e=e,e.finished=s,e.destroyed=i,e.blockLen=o,e.outputLen=a,e.oHash=r._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};const c$=(t,e,r)=>new a$(t,e).update(r).digest();c$.create=(t,e)=>new a$(t,e);const es=BigInt(0),On=BigInt(1),hc=BigInt(2),i9=BigInt(3),l$=BigInt(4),u$=BigInt(5),d$=BigInt(8);function Gn(t,e){const r=t%e;return r>=es?r:e+r}function ks(t,e,r){let n=t;for(;e-- >es;)n*=n,n%=r;return n}function v0(t,e){if(t===es)throw new Error("invert: expected non-zero number");if(e<=es)throw new Error("invert: expected positive modulus, got "+e);let r=Gn(t,e),n=e,s=es,i=On;for(;r!==es;){const a=n/r,c=n%r,l=s-i*a;n=r,r=c,s=i,i=l}if(n!==On)throw new Error("invert: does not exist");return Gn(s,e)}function h$(t,e){const r=(t.ORDER+On)/l$,n=t.pow(e,r);if(!t.eql(t.sqr(n),e))throw new Error("Cannot find square root");return n}function o9(t,e){const r=(t.ORDER-u$)/d$,n=t.mul(e,hc),s=t.pow(n,r),i=t.mul(e,s),o=t.mul(t.mul(i,hc),s),a=t.mul(i,t.sub(o,t.ONE));if(!t.eql(t.sqr(a),e))throw new Error("Cannot find square root");return a}function a9(t){if(t<BigInt(3))throw new Error("sqrt is not defined for small field");let e=t-On,r=0;for(;e%hc===es;)e/=hc,r++;let n=hc;const s=M1(t);for(;F_(s,n)===1;)if(n++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(r===1)return h$;let i=s.pow(n,e);const o=(e+On)/hc;return function(c,l){if(c.is0(l))return l;if(F_(c,l)!==1)throw new Error("Cannot find square root");let u=r,d=c.mul(c.ONE,i),h=c.pow(l,e),p=c.pow(l,o);for(;!c.eql(h,c.ONE);){if(c.is0(h))return c.ZERO;let y=1,g=c.sqr(h);for(;!c.eql(g,c.ONE);)if(y++,g=c.sqr(g),y===u)throw new Error("Cannot find square root");const w=On<<BigInt(u-y-1),S=c.pow(d,w);u=y,d=c.sqr(S),h=c.mul(h,d),p=c.mul(p,S)}return p}}function c9(t){return t%l$===i9?h$:t%d$===u$?o9:a9(t)}const l9=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function u9(t){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},r=l9.reduce((n,s)=>(n[s]="function",n),e);return Vg(t,r)}function d9(t,e,r){if(r<es)throw new Error("invalid exponent, negatives unsupported");if(r===es)return t.ONE;if(r===On)return e;let n=t.ONE,s=e;for(;r>es;)r&On&&(n=t.mul(n,s)),s=t.sqr(s),r>>=On;return n}function f$(t,e,r=!1){const n=new Array(e.length).fill(r?t.ZERO:void 0),s=e.reduce((o,a,c)=>t.is0(a)?o:(n[c]=o,t.mul(o,a)),t.ONE),i=t.inv(s);return e.reduceRight((o,a,c)=>t.is0(a)?o:(n[c]=t.mul(o,n[c]),t.mul(o,a)),i),n}function F_(t,e){const r=(t.ORDER-On)/hc,n=t.pow(e,r),s=t.eql(n,t.ONE),i=t.eql(n,t.ZERO),o=t.eql(n,t.neg(t.ONE));if(!s&&!i&&!o)throw new Error("invalid Legendre symbol result");return s?1:i?0:-1}function p$(t,e){e!==void 0&&Ud(e);const r=e!==void 0?e:t.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}function M1(t,e,r=!1,n={}){if(t<=es)throw new Error("invalid field: expected ORDER > 0, got "+t);const{nBitLength:s,nByteLength:i}=p$(t,e);if(i>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let o;const a=Object.freeze({ORDER:t,isLE:r,BITS:s,BYTES:i,MASK:Wg(s),ZERO:es,ONE:On,create:c=>Gn(c,t),isValid:c=>{if(typeof c!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof c);return es<=c&&c<t},is0:c=>c===es,isOdd:c=>(c&On)===On,neg:c=>Gn(-c,t),eql:(c,l)=>c===l,sqr:c=>Gn(c*c,t),add:(c,l)=>Gn(c+l,t),sub:(c,l)=>Gn(c-l,t),mul:(c,l)=>Gn(c*l,t),pow:(c,l)=>d9(a,c,l),div:(c,l)=>Gn(c*v0(l,t),t),sqrN:c=>c*c,addN:(c,l)=>c+l,subN:(c,l)=>c-l,mulN:(c,l)=>c*l,inv:c=>v0(c,t),sqrt:n.sqrt||(c=>(o||(o=c9(t)),o(a,c))),toBytes:c=>r?Z3(c,i):kh(c,i),fromBytes:c=>{if(c.length!==i)throw new Error("Field.fromBytes: expected "+i+" bytes, got "+c.length);return r?X3(c):Ic(c)},invertBatch:c=>f$(a,c),cmov:(c,l,u)=>u?l:c});return Object.freeze(a)}function g$(t){if(typeof t!="bigint")throw new Error("field order must be bigint");const e=t.toString(2).length;return Math.ceil(e/8)}function y$(t){const e=g$(t);return e+Math.ceil(e/2)}function h9(t,e,r=!1){const n=t.length,s=g$(e),i=y$(e);if(n<16||n<i||n>1024)throw new Error("expected "+i+"-1024 bytes of input, got "+n);const o=r?X3(t):Ic(t),a=Gn(o,e-On)+On;return r?Z3(a,s):kh(a,s)}const q_=BigInt(0),E0=BigInt(1);function gm(t,e){const r=e.negate();return t?r:e}function m$(t,e){if(!Number.isSafeInteger(t)||t<=0||t>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+t)}function ym(t,e){m$(t,e);const r=Math.ceil(e/t)+1,n=2**(t-1),s=2**t,i=Wg(t),o=BigInt(t);return{windows:r,windowSize:n,mask:i,maxNumber:s,shiftBy:o}}function z_(t,e,r){const{windowSize:n,mask:s,maxNumber:i,shiftBy:o}=r;let a=Number(t&s),c=t>>o;a>n&&(a-=i,c+=E0);const l=e*n,u=l+Math.abs(a)-1,d=a===0,h=a<0,p=e%2!==0;return{nextN:c,offset:u,isZero:d,isNeg:h,isNegF:p,offsetF:l}}function f9(t,e){if(!Array.isArray(t))throw new Error("array expected");t.forEach((r,n)=>{if(!(r instanceof e))throw new Error("invalid point at index "+n)})}function p9(t,e){if(!Array.isArray(t))throw new Error("array of scalars expected");t.forEach((r,n)=>{if(!e.isValid(r))throw new Error("invalid scalar at index "+n)})}const mm=new WeakMap,w$=new WeakMap;function wm(t){return w$.get(t)||1}function g9(t,e){return{constTimeNegate:gm,hasPrecomputes(r){return wm(r)!==1},unsafeLadder(r,n,s=t.ZERO){let i=r;for(;n>q_;)n&E0&&(s=s.add(i)),i=i.double(),n>>=E0;return s},precomputeWindow(r,n){const{windows:s,windowSize:i}=ym(n,e),o=[];let a=r,c=a;for(let l=0;l<s;l++){c=a,o.push(c);for(let u=1;u<i;u++)c=c.add(a),o.push(c);a=c.double()}return o},wNAF(r,n,s){let i=t.ZERO,o=t.BASE;const a=ym(r,e);for(let c=0;c<a.windows;c++){const{nextN:l,offset:u,isZero:d,isNeg:h,isNegF:p,offsetF:y}=z_(s,c,a);s=l,d?o=o.add(gm(p,n[y])):i=i.add(gm(h,n[u]))}return{p:i,f:o}},wNAFUnsafe(r,n,s,i=t.ZERO){const o=ym(r,e);for(let a=0;a<o.windows&&s!==q_;a++){const{nextN:c,offset:l,isZero:u,isNeg:d}=z_(s,a,o);if(s=c,!u){const h=n[l];i=i.add(d?h.negate():h)}}return i},getPrecomputes(r,n,s){let i=mm.get(n);return i||(i=this.precomputeWindow(n,r),r!==1&&mm.set(n,s(i))),i},wNAFCached(r,n,s){const i=wm(r);return this.wNAF(i,this.getPrecomputes(i,r,s),n)},wNAFCachedUnsafe(r,n,s,i){const o=wm(r);return o===1?this.unsafeLadder(r,n,i):this.wNAFUnsafe(o,this.getPrecomputes(o,r,s),n,i)},setWindowSize(r,n){m$(n,e),w$.set(r,n),mm.delete(r)}}}function y9(t,e,r,n){f9(r,t),p9(n,e);const s=r.length,i=n.length;if(s!==i)throw new Error("arrays of points and scalars must have equal length");const o=t.ZERO,a=bL(BigInt(s));let c=1;a>12?c=a-3:a>4?c=a-2:a>0&&(c=2);const l=Wg(c),u=new Array(Number(l)+1).fill(o),d=Math.floor((e.BITS-1)/c)*c;let h=o;for(let p=d;p>=0;p-=c){u.fill(o);for(let g=0;g<i;g++){const w=n[g],S=Number(w>>BigInt(p)&l);u[S]=u[S].add(r[g])}let y=o;for(let g=u.length-1,w=o;g>0;g--)w=w.add(u[g]),y=y.add(w);if(h=h.add(y),p!==0)for(let g=0;g<c;g++)h=h.double()}return h}function b$(t){return u9(t.Fp),Vg(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...p$(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}function H_(t){t.lowS!==void 0&&Bd("lowS",t.lowS),t.prehash!==void 0&&Bd("prehash",t.prehash)}function m9(t){const e=b$(t);Vg(e,{a:"field",b:"field"},{allowInfinityPoint:"boolean",allowedPrivateKeyLengths:"array",clearCofactor:"function",fromBytes:"function",isTorsionFree:"function",toBytes:"function",wrapPrivateKey:"boolean"});const{endo:r,Fp:n,a:s}=e;if(r){if(!n.eql(s,n.ZERO))throw new Error("invalid endo: CURVE.a must be 0");if(typeof r!="object"||typeof r.beta!="bigint"||typeof r.splitScalar!="function")throw new Error('invalid endo: expected "beta": bigint and "splitScalar": function')}return Object.freeze({...e})}let w9=class extends Error{constructor(e=""){super(e)}};const mo={Err:w9,_tlv:{encode:(t,e)=>{const{Err:r}=mo;if(t<0||t>256)throw new r("tlv.encode: wrong tag");if(e.length&1)throw new r("tlv.encode: unpadded data");const n=e.length/2,s=wf(n);if(s.length/2&128)throw new r("tlv.encode: long form length too big");const i=n>127?wf(s.length/2|128):"";return wf(t)+i+s+e},decode(t,e){const{Err:r}=mo;let n=0;if(t<0||t>256)throw new r("tlv.encode: wrong tag");if(e.length<2||e[n++]!==t)throw new r("tlv.decode: wrong tlv");const s=e[n++],i=!!(s&128);let o=0;if(!i)o=s;else{const c=s&127;if(!c)throw new r("tlv.decode(long): indefinite length not supported");if(c>4)throw new r("tlv.decode(long): byte length is too big");const l=e.subarray(n,n+c);if(l.length!==c)throw new r("tlv.decode: length bytes not complete");if(l[0]===0)throw new r("tlv.decode(long): zero leftmost byte");for(const u of l)o=o<<8|u;if(n+=c,o<128)throw new r("tlv.decode(long): not minimal encoding")}const a=e.subarray(n,n+o);if(a.length!==o)throw new r("tlv.decode: wrong value length");return{v:a,l:e.subarray(n+o)}}},_int:{encode(t){const{Err:e}=mo;if(t<Eo)throw new e("integer: negative integers are not allowed");let r=wf(t);if(Number.parseInt(r[0],16)&8&&(r="00"+r),r.length&1)throw new e("unexpected DER parsing assertion: unpadded hex");return r},decode(t){const{Err:e}=mo;if(t[0]&128)throw new e("invalid signature integer: negative");if(t[0]===0&&!(t[1]&128))throw new e("invalid signature integer: unnecessary leading zero");return Ic(t)}},toSig(t){const{Err:e,_int:r,_tlv:n}=mo,s=Hs("signature",t),{v:i,l:o}=n.decode(48,s);if(o.length)throw new e("invalid signature: left bytes after parsing");const{v:a,l:c}=n.decode(2,i),{v:l,l:u}=n.decode(2,c);if(u.length)throw new e("invalid signature: left bytes after parsing");return{r:r.decode(a),s:r.decode(l)}},hexFromSig(t){const{_tlv:e,_int:r}=mo,n=e.encode(2,r.encode(t.r)),s=e.encode(2,r.encode(t.s)),i=n+s;return e.encode(48,i)}};function bm(t,e){return Ld(kh(t,e))}const Eo=BigInt(0),Hr=BigInt(1);BigInt(2);const vm=BigInt(3),b9=BigInt(4);function v9(t){const e=m9(t),{Fp:r}=e,n=M1(e.n,e.nBitLength),s=e.toBytes||((E,v,C)=>{const O=v.toAffine();return qp(Uint8Array.from([4]),r.toBytes(O.x),r.toBytes(O.y))}),i=e.fromBytes||(E=>{const v=E.subarray(1),C=r.fromBytes(v.subarray(0,r.BYTES)),O=r.fromBytes(v.subarray(r.BYTES,2*r.BYTES));return{x:C,y:O}});function o(E){const{a:v,b:C}=e,O=r.sqr(E),L=r.mul(O,E);return r.add(r.add(L,r.mul(E,v)),C)}function a(E,v){const C=r.sqr(v),O=o(E);return r.eql(C,O)}if(!a(e.Gx,e.Gy))throw new Error("bad curve params: generator point");const c=r.mul(r.pow(e.a,vm),b9),l=r.mul(r.sqr(e.b),BigInt(27));if(r.is0(r.add(c,l)))throw new Error("bad curve params: a or b");function u(E){return U1(E,Hr,e.n)}function d(E){const{allowedPrivateKeyLengths:v,nByteLength:C,wrapPrivateKey:O,n:L}=e;if(v&&typeof E!="bigint"){if(Oh(E)&&(E=Ld(E)),typeof E!="string"||!v.includes(E.length))throw new Error("invalid private key");E=E.padStart(C*2,"0")}let j;try{j=typeof E=="bigint"?E:Ic(Hs("private key",E,C))}catch{throw new Error("invalid private key, expected hex or "+C+" bytes, got "+typeof E)}return O&&(j=Gn(j,L)),Bl("private key",j,Hr,L),j}function h(E){if(!(E instanceof g))throw new Error("ProjectivePoint expected")}const p=R_((E,v)=>{const{px:C,py:O,pz:L}=E;if(r.eql(L,r.ONE))return{x:C,y:O};const j=E.is0();v==null&&(v=j?r.ONE:r.inv(L));const D=r.mul(C,v),W=r.mul(O,v),P=r.mul(L,v);if(j)return{x:r.ZERO,y:r.ZERO};if(!r.eql(P,r.ONE))throw new Error("invZ was invalid");return{x:D,y:W}}),y=R_(E=>{if(E.is0()){if(e.allowInfinityPoint&&!r.is0(E.py))return;throw new Error("bad point: ZERO")}const{x:v,y:C}=E.toAffine();if(!r.isValid(v)||!r.isValid(C))throw new Error("bad point: x or y not FE");if(!a(v,C))throw new Error("bad point: equation left != right");if(!E.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});class g{constructor(v,C,O){if(v==null||!r.isValid(v))throw new Error("x required");if(C==null||!r.isValid(C)||r.is0(C))throw new Error("y required");if(O==null||!r.isValid(O))throw new Error("z required");this.px=v,this.py=C,this.pz=O,Object.freeze(this)}static fromAffine(v){const{x:C,y:O}=v||{};if(!v||!r.isValid(C)||!r.isValid(O))throw new Error("invalid affine point");if(v instanceof g)throw new Error("projective point not allowed");const L=j=>r.eql(j,r.ZERO);return L(C)&&L(O)?g.ZERO:new g(C,O,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(v){const C=f$(r,v.map(O=>O.pz));return v.map((O,L)=>O.toAffine(C[L])).map(g.fromAffine)}static fromHex(v){const C=g.fromAffine(i(Hs("pointHex",v)));return C.assertValidity(),C}static fromPrivateKey(v){return g.BASE.multiply(d(v))}static msm(v,C){return y9(g,n,v,C)}_setWindowSize(v){A.setWindowSize(this,v)}assertValidity(){y(this)}hasEvenY(){const{y:v}=this.toAffine();if(r.isOdd)return!r.isOdd(v);throw new Error("Field doesn't support isOdd")}equals(v){h(v);const{px:C,py:O,pz:L}=this,{px:j,py:D,pz:W}=v,P=r.eql(r.mul(C,W),r.mul(j,L)),R=r.eql(r.mul(O,W),r.mul(D,L));return P&&R}negate(){return new g(this.px,r.neg(this.py),this.pz)}double(){const{a:v,b:C}=e,O=r.mul(C,vm),{px:L,py:j,pz:D}=this;let W=r.ZERO,P=r.ZERO,R=r.ZERO,T=r.mul(L,L),k=r.mul(j,j),f=r.mul(D,D),m=r.mul(L,j);return m=r.add(m,m),R=r.mul(L,D),R=r.add(R,R),W=r.mul(v,R),P=r.mul(O,f),P=r.add(W,P),W=r.sub(k,P),P=r.add(k,P),P=r.mul(W,P),W=r.mul(m,W),R=r.mul(O,R),f=r.mul(v,f),m=r.sub(T,f),m=r.mul(v,m),m=r.add(m,R),R=r.add(T,T),T=r.add(R,T),T=r.add(T,f),T=r.mul(T,m),P=r.add(P,T),f=r.mul(j,D),f=r.add(f,f),T=r.mul(f,m),W=r.sub(W,T),R=r.mul(f,k),R=r.add(R,R),R=r.add(R,R),new g(W,P,R)}add(v){h(v);const{px:C,py:O,pz:L}=this,{px:j,py:D,pz:W}=v;let P=r.ZERO,R=r.ZERO,T=r.ZERO;const k=e.a,f=r.mul(e.b,vm);let m=r.mul(C,j),_=r.mul(O,D),$=r.mul(L,W),x=r.add(C,O),N=r.add(j,D);x=r.mul(x,N),N=r.add(m,_),x=r.sub(x,N),N=r.add(C,L);let H=r.add(j,W);return N=r.mul(N,H),H=r.add(m,$),N=r.sub(N,H),H=r.add(O,L),P=r.add(D,W),H=r.mul(H,P),P=r.add(_,$),H=r.sub(H,P),T=r.mul(k,N),P=r.mul(f,$),T=r.add(P,T),P=r.sub(_,T),T=r.add(_,T),R=r.mul(P,T),_=r.add(m,m),_=r.add(_,m),$=r.mul(k,$),N=r.mul(f,N),_=r.add(_,$),$=r.sub(m,$),$=r.mul(k,$),N=r.add(N,$),m=r.mul(_,N),R=r.add(R,m),m=r.mul(H,N),P=r.mul(x,P),P=r.sub(P,m),m=r.mul(x,_),T=r.mul(H,T),T=r.add(T,m),new g(P,R,T)}subtract(v){return this.add(v.negate())}is0(){return this.equals(g.ZERO)}wNAF(v){return A.wNAFCached(this,v,g.normalizeZ)}multiplyUnsafe(v){const{endo:C,n:O}=e;Bl("scalar",v,Eo,O);const L=g.ZERO;if(v===Eo)return L;if(this.is0()||v===Hr)return this;if(!C||A.hasPrecomputes(this))return A.wNAFCachedUnsafe(this,v,g.normalizeZ);let{k1neg:j,k1:D,k2neg:W,k2:P}=C.splitScalar(v),R=L,T=L,k=this;for(;D>Eo||P>Eo;)D&Hr&&(R=R.add(k)),P&Hr&&(T=T.add(k)),k=k.double(),D>>=Hr,P>>=Hr;return j&&(R=R.negate()),W&&(T=T.negate()),T=new g(r.mul(T.px,C.beta),T.py,T.pz),R.add(T)}multiply(v){const{endo:C,n:O}=e;Bl("scalar",v,Hr,O);let L,j;if(C){const{k1neg:D,k1:W,k2neg:P,k2:R}=C.splitScalar(v);let{p:T,f:k}=this.wNAF(W),{p:f,f:m}=this.wNAF(R);T=A.constTimeNegate(D,T),f=A.constTimeNegate(P,f),f=new g(r.mul(f.px,C.beta),f.py,f.pz),L=T.add(f),j=k.add(m)}else{const{p:D,f:W}=this.wNAF(v);L=D,j=W}return g.normalizeZ([L,j])[0]}multiplyAndAddUnsafe(v,C,O){const L=g.BASE,j=(W,P)=>P===Eo||P===Hr||!W.equals(L)?W.multiplyUnsafe(P):W.multiply(P),D=j(this,C).add(j(v,O));return D.is0()?void 0:D}toAffine(v){return p(this,v)}isTorsionFree(){const{h:v,isTorsionFree:C}=e;if(v===Hr)return!0;if(C)return C(g,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:v,clearCofactor:C}=e;return v===Hr?this:C?C(g,this):this.multiplyUnsafe(e.h)}toRawBytes(v=!0){return Bd("isCompressed",v),this.assertValidity(),s(g,this,v)}toHex(v=!0){return Bd("isCompressed",v),Ld(this.toRawBytes(v))}}g.BASE=new g(e.Gx,e.Gy,r.ONE),g.ZERO=new g(r.ZERO,r.ONE,r.ZERO);const{endo:w,nBitLength:S}=e,A=g9(g,w?Math.ceil(S/2):S);return{CURVE:e,ProjectivePoint:g,normPrivateKeyToScalar:d,weierstrassEquation:o,isWithinCurveOrder:u}}function E9(t){const e=b$(t);return Vg(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}function _9(t){const e=E9(t),{Fp:r,n,nByteLength:s,nBitLength:i}=e,o=r.BYTES+1,a=2*r.BYTES+1;function c(f){return Gn(f,n)}function l(f){return v0(f,n)}const{ProjectivePoint:u,normPrivateKeyToScalar:d,weierstrassEquation:h,isWithinCurveOrder:p}=v9({...e,toBytes(f,m,_){const $=m.toAffine(),x=r.toBytes($.x),N=qp;return Bd("isCompressed",_),_?N(Uint8Array.from([m.hasEvenY()?2:3]),x):N(Uint8Array.from([4]),x,r.toBytes($.y))},fromBytes(f){const m=f.length,_=f[0],$=f.subarray(1);if(m===o&&(_===2||_===3)){const x=Ic($);if(!U1(x,Hr,r.ORDER))throw new Error("Point is not on curve");const N=h(x);let H;try{H=r.sqrt(N)}catch(M){const V=M instanceof Error?": "+M.message:"";throw new Error("Point is not on curve"+V)}const z=(H&Hr)===Hr;return(_&1)===1!==z&&(H=r.neg(H)),{x,y:H}}else if(m===a&&_===4){const x=r.fromBytes($.subarray(0,r.BYTES)),N=r.fromBytes($.subarray(r.BYTES,2*r.BYTES));return{x,y:N}}else{const x=o,N=a;throw new Error("invalid Point, expected length of "+x+", or uncompressed "+N+", got "+m)}}});function y(f){const m=n>>Hr;return f>m}function g(f){return y(f)?c(-f):f}const w=(f,m,_)=>Ic(f.slice(m,_));class S{constructor(m,_,$){Bl("r",m,Hr,n),Bl("s",_,Hr,n),this.r=m,this.s=_,$!=null&&(this.recovery=$),Object.freeze(this)}static fromCompact(m){const _=s;return m=Hs("compactSignature",m,_*2),new S(w(m,0,_),w(m,_,2*_))}static fromDER(m){const{r:_,s:$}=mo.toSig(Hs("DER",m));return new S(_,$)}assertValidity(){}addRecoveryBit(m){return new S(this.r,this.s,m)}recoverPublicKey(m){const{r:_,s:$,recovery:x}=this,N=L(Hs("msgHash",m));if(x==null||![0,1,2,3].includes(x))throw new Error("recovery id invalid");const H=x===2||x===3?_+e.n:_;if(H>=r.ORDER)throw new Error("recovery id 2 or 3 invalid");const z=(x&1)===0?"02":"03",G=u.fromHex(z+bm(H,r.BYTES)),M=l(H),V=c(-N*M),J=c($*M),re=u.BASE.multiplyAndAddUnsafe(G,V,J);if(!re)throw new Error("point at infinify");return re.assertValidity(),re}hasHighS(){return y(this.s)}normalizeS(){return this.hasHighS()?new S(this.r,c(-this.s),this.recovery):this}toDERRawBytes(){return Fp(this.toDERHex())}toDERHex(){return mo.hexFromSig(this)}toCompactRawBytes(){return Fp(this.toCompactHex())}toCompactHex(){const m=s;return bm(this.r,m)+bm(this.s,m)}}const A={isValidPrivateKey(f){try{return d(f),!0}catch{return!1}},normPrivateKeyToScalar:d,randomPrivateKey:()=>{const f=y$(e.n);return h9(e.randomBytes(f),e.n)},precompute(f=8,m=u.BASE){return m._setWindowSize(f),m.multiply(BigInt(3)),m}};function E(f,m=!0){return u.fromPrivateKey(f).toRawBytes(m)}function v(f){if(typeof f=="bigint")return!1;if(f instanceof u)return!0;const _=Hs("key",f).length,$=r.BYTES,x=$+1,N=2*$+1;if(!(e.allowedPrivateKeyLengths||s===x))return _===x||_===N}function C(f,m,_=!0){if(v(f)===!0)throw new Error("first arg must be private key");if(v(m)===!1)throw new Error("second arg must be public key");return u.fromHex(m).multiply(d(f)).toRawBytes(_)}const O=e.bits2int||function(f){if(f.length>8192)throw new Error("input is too large");const m=Ic(f),_=f.length*8-i;return _>0?m>>BigInt(_):m},L=e.bits2int_modN||function(f){return c(O(f))},j=Wg(i);function D(f){return Bl("num < 2^"+i,f,Eo,j),kh(f,s)}function W(f,m,_=P){if(["recovered","canonical"].some(ne=>ne in _))throw new Error("sign() legacy options not supported");const{hash:$,randomBytes:x}=e;let{lowS:N,prehash:H,extraEntropy:z}=_;N==null&&(N=!0),f=Hs("msgHash",f),H_(_),H&&(f=Hs("prehashed msgHash",$(f)));const G=L(f),M=d(m),V=[D(M),D(G)];if(z!=null&&z!==!1){const ne=z===!0?x(r.BYTES):z;V.push(Hs("extraEntropy",ne))}const J=qp(...V),re=G;function ye(ne){const se=O(ne);if(!p(se))return;const Ie=l(se),Me=u.BASE.multiply(se).toAffine(),Ve=c(Me.x);if(Ve===Eo)return;const Ze=c(Ie*c(re+Ve*M));if(Ze===Eo)return;let Nt=(Me.x===Ve?0:2)|Number(Me.y&Hr),Br=Ze;return N&&y(Ze)&&(Br=g(Ze),Nt^=1),new S(Ve,Br,Nt)}return{seed:J,k2sig:ye}}const P={lowS:e.lowS,prehash:!1},R={lowS:e.lowS,prehash:!1};function T(f,m,_=P){const{seed:$,k2sig:x}=W(f,m,_),N=e;return vL(N.hash.outputLen,N.nByteLength,N.hmac)($,x)}u.BASE._setWindowSize(8);function k(f,m,_,$=R){const x=f;m=Hs("msgHash",m),_=Hs("publicKey",_);const{lowS:N,prehash:H,format:z}=$;if(H_($),"strict"in $)throw new Error("options.strict was renamed to lowS");if(z!==void 0&&z!=="compact"&&z!=="der")throw new Error("format must be compact or der");const G=typeof x=="string"||Oh(x),M=!G&&!z&&typeof x=="object"&&x!==null&&typeof x.r=="bigint"&&typeof x.s=="bigint";if(!G&&!M)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");let V,J;try{if(M&&(V=new S(x.r,x.s)),G){try{z!=="compact"&&(V=S.fromDER(x))}catch(Nt){if(!(Nt instanceof mo.Err))throw Nt}!V&&z!=="der"&&(V=S.fromCompact(x))}J=u.fromHex(_)}catch{return!1}if(!V||N&&V.hasHighS())return!1;H&&(m=e.hash(m));const{r:re,s:ye}=V,ne=L(m),se=l(ye),Ie=c(ne*se),Me=c(re*se),Ve=u.BASE.multiplyAndAddUnsafe(J,Ie,Me)?.toAffine();return Ve?c(Ve.x)===re:!1}return{CURVE:e,getPublicKey:E,getSharedSecret:C,sign:T,verify:k,ProjectivePoint:u,Signature:S,utils:A}}function x9(t){return{hash:t,hmac:(e,...r)=>c$(t,e,VB(...r)),randomBytes:KB}}function S9(t,e){const r=n=>_9({...t,...x9(n)});return{...r(e),create:r}}const v$=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),W_=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),A9=BigInt(0),I9=BigInt(1),_0=BigInt(2),V_=(t,e)=>(t+e/_0)/e;function C9(t){const e=v$,r=BigInt(3),n=BigInt(6),s=BigInt(11),i=BigInt(22),o=BigInt(23),a=BigInt(44),c=BigInt(88),l=t*t*t%e,u=l*l*t%e,d=ks(u,r,e)*u%e,h=ks(d,r,e)*u%e,p=ks(h,_0,e)*l%e,y=ks(p,s,e)*p%e,g=ks(y,i,e)*y%e,w=ks(g,a,e)*g%e,S=ks(w,c,e)*w%e,A=ks(S,a,e)*g%e,E=ks(A,r,e)*u%e,v=ks(E,o,e)*y%e,C=ks(v,n,e)*l%e,O=ks(C,_0,e);if(!x0.eql(x0.sqr(O),t))throw new Error("Cannot find square root");return O}const x0=M1(v$,void 0,void 0,{sqrt:C9}),$9=S9({a:A9,b:BigInt(7),Fp:x0,n:W_,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:t=>{const e=W_,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-I9*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),s=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),i=r,o=BigInt("0x100000000000000000000000000000000"),a=V_(i*t,e),c=V_(-n*t,e);let l=Gn(t-a*r-c*s,e),u=Gn(-a*n-c*i,e);const d=l>o,h=u>o;if(d&&(l=e-l),h&&(u=e-u),l>o||u>o)throw new Error("splitScalar: Endomorphism failed, k="+t);return{k1neg:d,k1:l,k2neg:h,k2:u}}}},mL);function T9(t){if(t.length!==130&&t.length!==132)throw new O9({signature:t});const e=BigInt(fo(t,0,32)),r=BigInt(fo(t,32,64)),n=(()=>{const s=+`0x${t.slice(130)}`;if(!Number.isNaN(s))try{return N9(s)}catch{throw new k9({value:s})}})();return typeof n>"u"?{r:e,s:r}:{r:e,s:r,yParity:n}}function N9(t){if(t===0||t===27)return 0;if(t===1||t===28)return 1;if(t>=35)return t%2===0?1:0;throw new P9({value:t})}let O9=class extends mr{constructor({signature:e}){super(`Value \`${e}\` is an invalid signature size.`,{metaMessages:["Expected: 64 bytes or 65 bytes.",`Received ${$a(L1(e))} bytes.`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.InvalidSerializedSizeError"})}},k9=class extends mr{constructor({value:e}){super(`Value \`${e}\` is an invalid y-parity value. Y-parity must be 0 or 1.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.InvalidYParityError"})}},P9=class extends mr{constructor({value:e}){super(`Value \`${e}\` is an invalid v value. v must be 27, 28 or >=35.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.InvalidVError"})}};function R9(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function E$(t,e){return Array.isArray(e)?e.length===0?!0:t?e.every(r=>typeof r=="string"):e.every(r=>Number.isSafeInteger(r)):!1}function Hp(t,e){if(typeof e!="string")throw new Error(`${t}: string expected`);return!0}function j1(t){if(!Number.isSafeInteger(t))throw new Error(`invalid integer: ${t}`)}function S0(t){if(!Array.isArray(t))throw new Error("array expected")}function Wp(t,e){if(!E$(!0,e))throw new Error(`${t}: array of strings expected`)}function D9(t,e){if(!E$(!1,e))throw new Error(`${t}: array of numbers expected`)}function U9(...t){const e=i=>i,r=(i,o)=>a=>i(o(a)),n=t.map(i=>i.encode).reduceRight(r,e),s=t.map(i=>i.decode).reduce(r,e);return{encode:n,decode:s}}function B9(t){const e=typeof t=="string"?t.split(""):t,r=e.length;Wp("alphabet",e);const n=new Map(e.map((s,i)=>[s,i]));return{encode:s=>(S0(s),s.map(i=>{if(!Number.isSafeInteger(i)||i<0||i>=r)throw new Error(`alphabet.encode: digit index outside alphabet "${i}". Allowed: ${t}`);return e[i]})),decode:s=>(S0(s),s.map(i=>{Hp("alphabet.decode",i);const o=n.get(i);if(o===void 0)throw new Error(`Unknown letter: "${i}". Allowed: ${t}`);return o}))}}function L9(t=""){return Hp("join",t),{encode:e=>(Wp("join.decode",e),e.join(t)),decode:e=>(Hp("join.decode",e),e.split(t))}}function M9(t,e="="){return j1(t),Hp("padding",e),{encode(r){for(Wp("padding.encode",r);r.length*t%8;)r.push(e);return r},decode(r){Wp("padding.decode",r);let n=r.length;if(n*t%8)throw new Error("padding: invalid, string should have whole number of bytes");for(;n>0&&r[n-1]===e;n--)if((n-1)*t%8===0)throw new Error("padding: invalid, string has too much padding");return r.slice(0,n)}}}const _$=(t,e)=>e===0?t:_$(e,t%e),Vp=(t,e)=>t+(e-_$(t,e)),Em=(()=>{let t=[];for(let e=0;e<40;e++)t.push(2**e);return t})();function K_(t,e,r,n){if(S0(t),e<=0||e>32)throw new Error(`convertRadix2: wrong from=${e}`);if(r<=0||r>32)throw new Error(`convertRadix2: wrong to=${r}`);if(Vp(e,r)>32)throw new Error(`convertRadix2: carry overflow from=${e} to=${r} carryBits=${Vp(e,r)}`);let s=0,i=0;const o=Em[e],a=Em[r]-1,c=[];for(const l of t){if(j1(l),l>=o)throw new Error(`convertRadix2: invalid data word=${l} from=${e}`);if(s=s<<e|l,i+e>32)throw new Error(`convertRadix2: carry overflow pos=${i} from=${e}`);for(i+=e;i>=r;i-=r)c.push((s>>i-r&a)>>>0);const u=Em[i];if(u===void 0)throw new Error("invalid carry");s&=u-1}if(s=s<<r-i&a,!n&&i>=e)throw new Error("Excess padding");if(!n&&s>0)throw new Error(`Non-zero padding: ${s}`);return n&&i>0&&c.push(s>>>0),c}function j9(t,e=!1){if(j1(t),t<=0||t>32)throw new Error("radix2: bits should be in (0..32]");if(Vp(8,t)>32||Vp(t,8)>32)throw new Error("radix2: carry overflow");return{encode:r=>{if(!R9(r))throw new Error("radix2.encode input should be Uint8Array");return K_(Array.from(r),8,t,!e)},decode:r=>(D9("radix2.decode",r),Uint8Array.from(K_(r,t,8,e)))}}const x$=U9(j9(5),B9("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),M9(5),L9(""));function F9(t){return r9(q9(t))}function q9(t){const{payload:e,signature:r}=t,{r:n,s,yParity:i}=r,a=new $9.Signature(BigInt(n),BigInt(s)).addRecoveryBit(i).recoverPublicKey(L1(e).substring(2));return KL(a)}function z9(t){if(t.length>=255)throw new TypeError("Alphabet too long");const e=new Uint8Array(256);for(let l=0;l<e.length;l++)e[l]=255;for(let l=0;l<t.length;l++){const u=t.charAt(l),d=u.charCodeAt(0);if(e[d]!==255)throw new TypeError(u+" is ambiguous");e[d]=l}const r=t.length,n=t.charAt(0),s=Math.log(r)/Math.log(256),i=Math.log(256)/Math.log(r);function o(l){if(l instanceof Uint8Array||(ArrayBuffer.isView(l)?l=new Uint8Array(l.buffer,l.byteOffset,l.byteLength):Array.isArray(l)&&(l=Uint8Array.from(l))),!(l instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(l.length===0)return"";let u=0,d=0,h=0;const p=l.length;for(;h!==p&&l[h]===0;)h++,u++;const y=(p-h)*i+1>>>0,g=new Uint8Array(y);for(;h!==p;){let A=l[h],E=0;for(let v=y-1;(A!==0||E<d)&&v!==-1;v--,E++)A+=256*g[v]>>>0,g[v]=A%r>>>0,A=A/r>>>0;if(A!==0)throw new Error("Non-zero carry");d=E,h++}let w=y-d;for(;w!==y&&g[w]===0;)w++;let S=n.repeat(u);for(;w<y;++w)S+=t.charAt(g[w]);return S}function a(l){if(typeof l!="string")throw new TypeError("Expected String");if(l.length===0)return new Uint8Array;let u=0,d=0,h=0;for(;l[u]===n;)d++,u++;const p=(l.length-u)*s+1>>>0,y=new Uint8Array(p);for(;u<l.length;){const A=l.charCodeAt(u);if(A>255)return;let E=e[A];if(E===255)return;let v=0;for(let C=p-1;(E!==0||v<h)&&C!==-1;C--,v++)E+=r*y[C]>>>0,y[C]=E%256>>>0,E=E/256>>>0;if(E!==0)throw new Error("Non-zero carry");h=v,u++}let g=p-h;for(;g!==p&&y[g]===0;)g++;const w=new Uint8Array(d+(p-g));let S=d;for(;g!==p;)w[S++]=y[g++];return w}function c(l){const u=a(l);if(u)return u;throw new Error("Non-base"+r+" character")}return{encode:o,decodeUnsafe:a,decode:c}}var H9="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";const Ph=z9(H9);function W9(t){const e=t.length;let r=0,n=0;for(;n<e;){let s=t.charCodeAt(n++);if((s&4294967168)===0){r++;continue}else if((s&4294965248)===0)r+=2;else{if(s>=55296&&s<=56319&&n<e){const i=t.charCodeAt(n);(i&64512)===56320&&(++n,s=((s&1023)<<10)+(i&1023)+65536)}(s&4294901760)===0?r+=3:r+=4}}return r}function V9(t,e,r){const n=t.length;let s=r,i=0;for(;i<n;){let o=t.charCodeAt(i++);if((o&4294967168)===0){e[s++]=o;continue}else if((o&4294965248)===0)e[s++]=o>>6&31|192;else{if(o>=55296&&o<=56319&&i<n){const a=t.charCodeAt(i);(a&64512)===56320&&(++i,o=((o&1023)<<10)+(a&1023)+65536)}(o&4294901760)===0?(e[s++]=o>>12&15|224,e[s++]=o>>6&63|128):(e[s++]=o>>18&7|240,e[s++]=o>>12&63|128,e[s++]=o>>6&63|128)}e[s++]=o&63|128}}const K9=new TextEncoder,G9=50;function Y9(t,e,r){K9.encodeInto(t,e.subarray(r))}function X9(t,e,r){t.length>G9?Y9(t,e,r):V9(t,e,r)}const Z9=4096;function S$(t,e,r){let n=e;const s=n+r,i=[];let o="";for(;n<s;){const a=t[n++];if((a&128)===0)i.push(a);else if((a&224)===192){const c=t[n++]&63;i.push((a&31)<<6|c)}else if((a&240)===224){const c=t[n++]&63,l=t[n++]&63;i.push((a&31)<<12|c<<6|l)}else if((a&248)===240){const c=t[n++]&63,l=t[n++]&63,u=t[n++]&63;let d=(a&7)<<18|c<<12|l<<6|u;d>65535&&(d-=65536,i.push(d>>>10&1023|55296),d=56320|d&1023),i.push(d)}else i.push(a);i.length>=Z9&&(o+=String.fromCharCode(...i),i.length=0)}return i.length>0&&(o+=String.fromCharCode(...i)),o}const J9=new TextDecoder,Q9=200;function eM(t,e,r){const n=t.subarray(e,e+r);return J9.decode(n)}function tM(t,e,r){return r>Q9?eM(t,e,r):S$(t,e,r)}class vf{constructor(e,r){this.type=e,this.data=r}}class bs extends Error{constructor(e){super(e);const r=Object.create(bs.prototype);Object.setPrototypeOf(this,r),Object.defineProperty(this,"name",{configurable:!0,enumerable:!1,value:bs.name})}}const Du=4294967295;function rM(t,e,r){const n=r/4294967296,s=r;t.setUint32(e,n),t.setUint32(e+4,s)}function A$(t,e,r){const n=Math.floor(r/4294967296),s=r;t.setUint32(e,n),t.setUint32(e+4,s)}function I$(t,e){const r=t.getInt32(e),n=t.getUint32(e+4);return r*4294967296+n}function nM(t,e){const r=t.getUint32(e),n=t.getUint32(e+4);return r*4294967296+n}const sM=-1,iM=4294967296-1,oM=17179869184-1;function aM({sec:t,nsec:e}){if(t>=0&&e>=0&&t<=oM)if(e===0&&t<=iM){const r=new Uint8Array(4);return new DataView(r.buffer).setUint32(0,t),r}else{const r=t/4294967296,n=t&4294967295,s=new Uint8Array(8),i=new DataView(s.buffer);return i.setUint32(0,e<<2|r&3),i.setUint32(4,n),s}else{const r=new Uint8Array(12),n=new DataView(r.buffer);return n.setUint32(0,e),A$(n,4,t),r}}function cM(t){const e=t.getTime(),r=Math.floor(e/1e3),n=(e-r*1e3)*1e6,s=Math.floor(n/1e9);return{sec:r+s,nsec:n-s*1e9}}function lM(t){if(t instanceof Date){const e=cM(t);return aM(e)}else return null}function uM(t){const e=new DataView(t.buffer,t.byteOffset,t.byteLength);switch(t.byteLength){case 4:return{sec:e.getUint32(0),nsec:0};case 8:{const r=e.getUint32(0),n=e.getUint32(4),s=(r&3)*4294967296+n,i=r>>>2;return{sec:s,nsec:i}}case 12:{const r=I$(e,4),n=e.getUint32(0);return{sec:r,nsec:n}}default:throw new bs(`Unrecognized data size for timestamp (expected 4, 8, or 12): ${t.length}`)}}function dM(t){const e=uM(t);return new Date(e.sec*1e3+e.nsec/1e6)}const hM={type:sM,encode:lM,decode:dM};class Kp{constructor(){this.builtInEncoders=[],this.builtInDecoders=[],this.encoders=[],this.decoders=[],this.register(hM)}register({type:e,encode:r,decode:n}){if(e>=0)this.encoders[e]=r,this.decoders[e]=n;else{const s=-1-e;this.builtInEncoders[s]=r,this.builtInDecoders[s]=n}}tryToEncode(e,r){for(let n=0;n<this.builtInEncoders.length;n++){const s=this.builtInEncoders[n];if(s!=null){const i=s(e,r);if(i!=null){const o=-1-n;return new vf(o,i)}}}for(let n=0;n<this.encoders.length;n++){const s=this.encoders[n];if(s!=null){const i=s(e,r);if(i!=null){const o=n;return new vf(o,i)}}}return e instanceof vf?e:null}decode(e,r,n){const s=r<0?this.builtInDecoders[-1-r]:this.decoders[r];return s?s(e,r,n):new vf(r,e)}}Kp.defaultCodec=new Kp;function fM(t){return t instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&t instanceof SharedArrayBuffer}function A0(t){return t instanceof Uint8Array?t:ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):fM(t)?new Uint8Array(t):Uint8Array.from(t)}const pM=100,gM=2048;let yM=class C${constructor(e){this.entered=!1,this.extensionCodec=e?.extensionCodec??Kp.defaultCodec,this.context=e?.context,this.useBigInt64=e?.useBigInt64??!1,this.maxDepth=e?.maxDepth??pM,this.initialBufferSize=e?.initialBufferSize??gM,this.sortKeys=e?.sortKeys??!1,this.forceFloat32=e?.forceFloat32??!1,this.ignoreUndefined=e?.ignoreUndefined??!1,this.forceIntegerToFloat=e?.forceIntegerToFloat??!1,this.pos=0,this.view=new DataView(new ArrayBuffer(this.initialBufferSize)),this.bytes=new Uint8Array(this.view.buffer)}clone(){return new C$({extensionCodec:this.extensionCodec,context:this.context,useBigInt64:this.useBigInt64,maxDepth:this.maxDepth,initialBufferSize:this.initialBufferSize,sortKeys:this.sortKeys,forceFloat32:this.forceFloat32,ignoreUndefined:this.ignoreUndefined,forceIntegerToFloat:this.forceIntegerToFloat})}reinitializeState(){this.pos=0}encodeSharedRef(e){if(this.entered)return this.clone().encodeSharedRef(e);try{return this.entered=!0,this.reinitializeState(),this.doEncode(e,1),this.bytes.subarray(0,this.pos)}finally{this.entered=!1}}encode(e){if(this.entered)return this.clone().encode(e);try{return this.entered=!0,this.reinitializeState(),this.doEncode(e,1),this.bytes.slice(0,this.pos)}finally{this.entered=!1}}doEncode(e,r){if(r>this.maxDepth)throw new Error(`Too deep objects in depth ${r}`);e==null?this.encodeNil():typeof e=="boolean"?this.encodeBoolean(e):typeof e=="number"?this.forceIntegerToFloat?this.encodeNumberAsFloat(e):this.encodeNumber(e):typeof e=="string"?this.encodeString(e):this.useBigInt64&&typeof e=="bigint"?this.encodeBigInt64(e):this.encodeObject(e,r)}ensureBufferSizeToWrite(e){const r=this.pos+e;this.view.byteLength<r&&this.resizeBuffer(r*2)}resizeBuffer(e){const r=new ArrayBuffer(e),n=new Uint8Array(r),s=new DataView(r);n.set(this.bytes),this.view=s,this.bytes=n}encodeNil(){this.writeU8(192)}encodeBoolean(e){e===!1?this.writeU8(194):this.writeU8(195)}encodeNumber(e){!this.forceIntegerToFloat&&Number.isSafeInteger(e)?e>=0?e<128?this.writeU8(e):e<256?(this.writeU8(204),this.writeU8(e)):e<65536?(this.writeU8(205),this.writeU16(e)):e<4294967296?(this.writeU8(206),this.writeU32(e)):this.useBigInt64?this.encodeNumberAsFloat(e):(this.writeU8(207),this.writeU64(e)):e>=-32?this.writeU8(224|e+32):e>=-128?(this.writeU8(208),this.writeI8(e)):e>=-32768?(this.writeU8(209),this.writeI16(e)):e>=-2147483648?(this.writeU8(210),this.writeI32(e)):this.useBigInt64?this.encodeNumberAsFloat(e):(this.writeU8(211),this.writeI64(e)):this.encodeNumberAsFloat(e)}encodeNumberAsFloat(e){this.forceFloat32?(this.writeU8(202),this.writeF32(e)):(this.writeU8(203),this.writeF64(e))}encodeBigInt64(e){e>=BigInt(0)?(this.writeU8(207),this.writeBigUint64(e)):(this.writeU8(211),this.writeBigInt64(e))}writeStringHeader(e){if(e<32)this.writeU8(160+e);else if(e<256)this.writeU8(217),this.writeU8(e);else if(e<65536)this.writeU8(218),this.writeU16(e);else if(e<4294967296)this.writeU8(219),this.writeU32(e);else throw new Error(`Too long string: ${e} bytes in UTF-8`)}encodeString(e){const n=W9(e);this.ensureBufferSizeToWrite(5+n),this.writeStringHeader(n),X9(e,this.bytes,this.pos),this.pos+=n}encodeObject(e,r){const n=this.extensionCodec.tryToEncode(e,this.context);if(n!=null)this.encodeExtension(n);else if(Array.isArray(e))this.encodeArray(e,r);else if(ArrayBuffer.isView(e))this.encodeBinary(e);else if(typeof e=="object")this.encodeMap(e,r);else throw new Error(`Unrecognized object: ${Object.prototype.toString.apply(e)}`)}encodeBinary(e){const r=e.byteLength;if(r<256)this.writeU8(196),this.writeU8(r);else if(r<65536)this.writeU8(197),this.writeU16(r);else if(r<4294967296)this.writeU8(198),this.writeU32(r);else throw new Error(`Too large binary: ${r}`);const n=A0(e);this.writeU8a(n)}encodeArray(e,r){const n=e.length;if(n<16)this.writeU8(144+n);else if(n<65536)this.writeU8(220),this.writeU16(n);else if(n<4294967296)this.writeU8(221),this.writeU32(n);else throw new Error(`Too large array: ${n}`);for(const s of e)this.doEncode(s,r+1)}countWithoutUndefined(e,r){let n=0;for(const s of r)e[s]!==void 0&&n++;return n}encodeMap(e,r){const n=Object.keys(e);this.sortKeys&&n.sort();const s=this.ignoreUndefined?this.countWithoutUndefined(e,n):n.length;if(s<16)this.writeU8(128+s);else if(s<65536)this.writeU8(222),this.writeU16(s);else if(s<4294967296)this.writeU8(223),this.writeU32(s);else throw new Error(`Too large map object: ${s}`);for(const i of n){const o=e[i];this.ignoreUndefined&&o===void 0||(this.encodeString(i),this.doEncode(o,r+1))}}encodeExtension(e){if(typeof e.data=="function"){const n=e.data(this.pos+6),s=n.length;if(s>=4294967296)throw new Error(`Too large extension object: ${s}`);this.writeU8(201),this.writeU32(s),this.writeI8(e.type),this.writeU8a(n);return}const r=e.data.length;if(r===1)this.writeU8(212);else if(r===2)this.writeU8(213);else if(r===4)this.writeU8(214);else if(r===8)this.writeU8(215);else if(r===16)this.writeU8(216);else if(r<256)this.writeU8(199),this.writeU8(r);else if(r<65536)this.writeU8(200),this.writeU16(r);else if(r<4294967296)this.writeU8(201),this.writeU32(r);else throw new Error(`Too large extension object: ${r}`);this.writeI8(e.type),this.writeU8a(e.data)}writeU8(e){this.ensureBufferSizeToWrite(1),this.view.setUint8(this.pos,e),this.pos++}writeU8a(e){const r=e.length;this.ensureBufferSizeToWrite(r),this.bytes.set(e,this.pos),this.pos+=r}writeI8(e){this.ensureBufferSizeToWrite(1),this.view.setInt8(this.pos,e),this.pos++}writeU16(e){this.ensureBufferSizeToWrite(2),this.view.setUint16(this.pos,e),this.pos+=2}writeI16(e){this.ensureBufferSizeToWrite(2),this.view.setInt16(this.pos,e),this.pos+=2}writeU32(e){this.ensureBufferSizeToWrite(4),this.view.setUint32(this.pos,e),this.pos+=4}writeI32(e){this.ensureBufferSizeToWrite(4),this.view.setInt32(this.pos,e),this.pos+=4}writeF32(e){this.ensureBufferSizeToWrite(4),this.view.setFloat32(this.pos,e),this.pos+=4}writeF64(e){this.ensureBufferSizeToWrite(8),this.view.setFloat64(this.pos,e),this.pos+=8}writeU64(e){this.ensureBufferSizeToWrite(8),rM(this.view,this.pos,e),this.pos+=8}writeI64(e){this.ensureBufferSizeToWrite(8),A$(this.view,this.pos,e),this.pos+=8}writeBigUint64(e){this.ensureBufferSizeToWrite(8),this.view.setBigUint64(this.pos,e),this.pos+=8}writeBigInt64(e){this.ensureBufferSizeToWrite(8),this.view.setBigInt64(this.pos,e),this.pos+=8}};function $$(t,e){return new yM(e).encodeSharedRef(t)}function _m(t){return`${t<0?"-":""}0x${Math.abs(t).toString(16).padStart(2,"0")}`}const mM=16,wM=16;class bM{constructor(e=mM,r=wM){this.hit=0,this.miss=0,this.maxKeyLength=e,this.maxLengthPerKey=r,this.caches=[];for(let n=0;n<this.maxKeyLength;n++)this.caches.push([])}canBeCached(e){return e>0&&e<=this.maxKeyLength}find(e,r,n){const s=this.caches[n-1];e:for(const i of s){const o=i.bytes;for(let a=0;a<n;a++)if(o[a]!==e[r+a])continue e;return i.str}return null}store(e,r){const n=this.caches[e.length-1],s={bytes:e,str:r};n.length>=this.maxLengthPerKey?n[Math.random()*n.length|0]=s:n.push(s)}decode(e,r,n){const s=this.find(e,r,n);if(s!=null)return this.hit++,s;this.miss++;const i=S$(e,r,n),o=Uint8Array.prototype.slice.call(e,r,r+n);return this.store(o,i),i}}const I0="array",gd="map_key",T$="map_value",vM=t=>{if(typeof t=="string"||typeof t=="number")return t;throw new bs("The type of key must be string or number but "+typeof t)};class EM{constructor(){this.stack=[],this.stackHeadPosition=-1}get length(){return this.stackHeadPosition+1}top(){return this.stack[this.stackHeadPosition]}pushArrayState(e){const r=this.getUninitializedStateFromPool();r.type=I0,r.position=0,r.size=e,r.array=new Array(e)}pushMapState(e){const r=this.getUninitializedStateFromPool();r.type=gd,r.readCount=0,r.size=e,r.map={}}getUninitializedStateFromPool(){if(this.stackHeadPosition++,this.stackHeadPosition===this.stack.length){const e={type:void 0,size:0,array:void 0,position:0,readCount:0,map:void 0,key:null};this.stack.push(e)}return this.stack[this.stackHeadPosition]}release(e){if(this.stack[this.stackHeadPosition]!==e)throw new Error("Invalid stack state. Released state is not on top of the stack.");if(e.type===I0){const n=e;n.size=0,n.array=void 0,n.position=0,n.type=void 0}if(e.type===gd||e.type===T$){const n=e;n.size=0,n.map=void 0,n.readCount=0,n.type=void 0}this.stackHeadPosition--}reset(){this.stack.length=0,this.stackHeadPosition=-1}}const Uu=-1,F1=new DataView(new ArrayBuffer(0)),_M=new Uint8Array(F1.buffer);try{F1.getInt8(0)}catch(t){if(!(t instanceof RangeError))throw new Error("This module is not supported in the current JavaScript engine because DataView does not throw RangeError on out-of-bounds access")}const G_=new RangeError("Insufficient data"),xM=new bM;let SM=class N${constructor(e){this.totalPos=0,this.pos=0,this.view=F1,this.bytes=_M,this.headByte=Uu,this.stack=new EM,this.entered=!1,this.extensionCodec=e?.extensionCodec??Kp.defaultCodec,this.context=e?.context,this.useBigInt64=e?.useBigInt64??!1,this.rawStrings=e?.rawStrings??!1,this.maxStrLength=e?.maxStrLength??Du,this.maxBinLength=e?.maxBinLength??Du,this.maxArrayLength=e?.maxArrayLength??Du,this.maxMapLength=e?.maxMapLength??Du,this.maxExtLength=e?.maxExtLength??Du,this.keyDecoder=e?.keyDecoder!==void 0?e.keyDecoder:xM,this.mapKeyConverter=e?.mapKeyConverter??vM}clone(){return new N$({extensionCodec:this.extensionCodec,context:this.context,useBigInt64:this.useBigInt64,rawStrings:this.rawStrings,maxStrLength:this.maxStrLength,maxBinLength:this.maxBinLength,maxArrayLength:this.maxArrayLength,maxMapLength:this.maxMapLength,maxExtLength:this.maxExtLength,keyDecoder:this.keyDecoder})}reinitializeState(){this.totalPos=0,this.headByte=Uu,this.stack.reset()}setBuffer(e){const r=A0(e);this.bytes=r,this.view=new DataView(r.buffer,r.byteOffset,r.byteLength),this.pos=0}appendBuffer(e){if(this.headByte===Uu&&!this.hasRemaining(1))this.setBuffer(e);else{const r=this.bytes.subarray(this.pos),n=A0(e),s=new Uint8Array(r.length+n.length);s.set(r),s.set(n,r.length),this.setBuffer(s)}}hasRemaining(e){return this.view.byteLength-this.pos>=e}createExtraByteError(e){const{view:r,pos:n}=this;return new RangeError(`Extra ${r.byteLength-n} of ${r.byteLength} byte(s) found at buffer[${e}]`)}decode(e){if(this.entered)return this.clone().decode(e);try{this.entered=!0,this.reinitializeState(),this.setBuffer(e);const r=this.doDecodeSync();if(this.hasRemaining(1))throw this.createExtraByteError(this.pos);return r}finally{this.entered=!1}}*decodeMulti(e){if(this.entered){yield*this.clone().decodeMulti(e);return}try{for(this.entered=!0,this.reinitializeState(),this.setBuffer(e);this.hasRemaining(1);)yield this.doDecodeSync()}finally{this.entered=!1}}async decodeAsync(e){if(this.entered)return this.clone().decodeAsync(e);try{this.entered=!0;let r=!1,n;for await(const a of e){if(r)throw this.entered=!1,this.createExtraByteError(this.totalPos);this.appendBuffer(a);try{n=this.doDecodeSync(),r=!0}catch(c){if(!(c instanceof RangeError))throw c}this.totalPos+=this.pos}if(r){if(this.hasRemaining(1))throw this.createExtraByteError(this.totalPos);return n}const{headByte:s,pos:i,totalPos:o}=this;throw new RangeError(`Insufficient data in parsing ${_m(s)} at ${o} (${i} in the current buffer)`)}finally{this.entered=!1}}decodeArrayStream(e){return this.decodeMultiAsync(e,!0)}decodeStream(e){return this.decodeMultiAsync(e,!1)}async*decodeMultiAsync(e,r){if(this.entered){yield*this.clone().decodeMultiAsync(e,r);return}try{this.entered=!0;let n=r,s=-1;for await(const i of e){if(r&&s===0)throw this.createExtraByteError(this.totalPos);this.appendBuffer(i),n&&(s=this.readArraySize(),n=!1,this.complete());try{for(;yield this.doDecodeSync(),--s!==0;);}catch(o){if(!(o instanceof RangeError))throw o}this.totalPos+=this.pos}}finally{this.entered=!1}}doDecodeSync(){e:for(;;){const e=this.readHeadByte();let r;if(e>=224)r=e-256;else if(e<192)if(e<128)r=e;else if(e<144){const s=e-128;if(s!==0){this.pushMapState(s),this.complete();continue e}else r={}}else if(e<160){const s=e-144;if(s!==0){this.pushArrayState(s),this.complete();continue e}else r=[]}else{const s=e-160;r=this.decodeString(s,0)}else if(e===192)r=null;else if(e===194)r=!1;else if(e===195)r=!0;else if(e===202)r=this.readF32();else if(e===203)r=this.readF64();else if(e===204)r=this.readU8();else if(e===205)r=this.readU16();else if(e===206)r=this.readU32();else if(e===207)this.useBigInt64?r=this.readU64AsBigInt():r=this.readU64();else if(e===208)r=this.readI8();else if(e===209)r=this.readI16();else if(e===210)r=this.readI32();else if(e===211)this.useBigInt64?r=this.readI64AsBigInt():r=this.readI64();else if(e===217){const s=this.lookU8();r=this.decodeString(s,1)}else if(e===218){const s=this.lookU16();r=this.decodeString(s,2)}else if(e===219){const s=this.lookU32();r=this.decodeString(s,4)}else if(e===220){const s=this.readU16();if(s!==0){this.pushArrayState(s),this.complete();continue e}else r=[]}else if(e===221){const s=this.readU32();if(s!==0){this.pushArrayState(s),this.complete();continue e}else r=[]}else if(e===222){const s=this.readU16();if(s!==0){this.pushMapState(s),this.complete();continue e}else r={}}else if(e===223){const s=this.readU32();if(s!==0){this.pushMapState(s),this.complete();continue e}else r={}}else if(e===196){const s=this.lookU8();r=this.decodeBinary(s,1)}else if(e===197){const s=this.lookU16();r=this.decodeBinary(s,2)}else if(e===198){const s=this.lookU32();r=this.decodeBinary(s,4)}else if(e===212)r=this.decodeExtension(1,0);else if(e===213)r=this.decodeExtension(2,0);else if(e===214)r=this.decodeExtension(4,0);else if(e===215)r=this.decodeExtension(8,0);else if(e===216)r=this.decodeExtension(16,0);else if(e===199){const s=this.lookU8();r=this.decodeExtension(s,1)}else if(e===200){const s=this.lookU16();r=this.decodeExtension(s,2)}else if(e===201){const s=this.lookU32();r=this.decodeExtension(s,4)}else throw new bs(`Unrecognized type byte: ${_m(e)}`);this.complete();const n=this.stack;for(;n.length>0;){const s=n.top();if(s.type===I0)if(s.array[s.position]=r,s.position++,s.position===s.size)r=s.array,n.release(s);else continue e;else if(s.type===gd){if(r==="__proto__")throw new bs("The key __proto__ is not allowed");s.key=this.mapKeyConverter(r),s.type=T$;continue e}else if(s.map[s.key]=r,s.readCount++,s.readCount===s.size)r=s.map,n.release(s);else{s.key=null,s.type=gd;continue e}}return r}}readHeadByte(){return this.headByte===Uu&&(this.headByte=this.readU8()),this.headByte}complete(){this.headByte=Uu}readArraySize(){const e=this.readHeadByte();switch(e){case 220:return this.readU16();case 221:return this.readU32();default:{if(e<160)return e-144;throw new bs(`Unrecognized array type byte: ${_m(e)}`)}}}pushMapState(e){if(e>this.maxMapLength)throw new bs(`Max length exceeded: map length (${e}) > maxMapLengthLength (${this.maxMapLength})`);this.stack.pushMapState(e)}pushArrayState(e){if(e>this.maxArrayLength)throw new bs(`Max length exceeded: array length (${e}) > maxArrayLength (${this.maxArrayLength})`);this.stack.pushArrayState(e)}decodeString(e,r){return!this.rawStrings||this.stateIsMapKey()?this.decodeUtf8String(e,r):this.decodeBinary(e,r)}decodeUtf8String(e,r){if(e>this.maxStrLength)throw new bs(`Max length exceeded: UTF-8 byte length (${e}) > maxStrLength (${this.maxStrLength})`);if(this.bytes.byteLength<this.pos+r+e)throw G_;const n=this.pos+r;let s;return this.stateIsMapKey()&&this.keyDecoder?.canBeCached(e)?s=this.keyDecoder.decode(this.bytes,n,e):s=tM(this.bytes,n,e),this.pos+=r+e,s}stateIsMapKey(){return this.stack.length>0?this.stack.top().type===gd:!1}decodeBinary(e,r){if(e>this.maxBinLength)throw new bs(`Max length exceeded: bin length (${e}) > maxBinLength (${this.maxBinLength})`);if(!this.hasRemaining(e+r))throw G_;const n=this.pos+r,s=this.bytes.subarray(n,n+e);return this.pos+=r+e,s}decodeExtension(e,r){if(e>this.maxExtLength)throw new bs(`Max length exceeded: ext length (${e}) > maxExtLength (${this.maxExtLength})`);const n=this.view.getInt8(this.pos+r),s=this.decodeBinary(e,r+1);return this.extensionCodec.decode(s,n,this.context)}lookU8(){return this.view.getUint8(this.pos)}lookU16(){return this.view.getUint16(this.pos)}lookU32(){return this.view.getUint32(this.pos)}readU8(){const e=this.view.getUint8(this.pos);return this.pos++,e}readI8(){const e=this.view.getInt8(this.pos);return this.pos++,e}readU16(){const e=this.view.getUint16(this.pos);return this.pos+=2,e}readI16(){const e=this.view.getInt16(this.pos);return this.pos+=2,e}readU32(){const e=this.view.getUint32(this.pos);return this.pos+=4,e}readI32(){const e=this.view.getInt32(this.pos);return this.pos+=4,e}readU64(){const e=nM(this.view,this.pos);return this.pos+=8,e}readI64(){const e=I$(this.view,this.pos);return this.pos+=8,e}readU64AsBigInt(){const e=this.view.getBigUint64(this.pos);return this.pos+=8,e}readI64AsBigInt(){const e=this.view.getBigInt64(this.pos);return this.pos+=8,e}readF32(){const e=this.view.getFloat32(this.pos);return this.pos+=4,e}readF64(){const e=this.view.getFloat64(this.pos);return this.pos+=8,e}};function O$(t,e){return new SM(e).decode(t)}function q1(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function k$(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?q1(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function Fi(t,e){e||(e=t.reduce((s,i)=>s+i.length,0));const r=k$(e);let n=0;for(const s of t)r.set(s,n),n+=s.length;return q1(r)}function AM(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var s=0;s<t.length;s++){var i=t.charAt(s),o=i.charCodeAt(0);if(r[o]!==255)throw new TypeError(i+" is ambiguous");r[o]=s}var a=t.length,c=t.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function d(y){if(y instanceof Uint8Array||(ArrayBuffer.isView(y)?y=new Uint8Array(y.buffer,y.byteOffset,y.byteLength):Array.isArray(y)&&(y=Uint8Array.from(y))),!(y instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(y.length===0)return"";for(var g=0,w=0,S=0,A=y.length;S!==A&&y[S]===0;)S++,g++;for(var E=(A-S)*u+1>>>0,v=new Uint8Array(E);S!==A;){for(var C=y[S],O=0,L=E-1;(C!==0||O<w)&&L!==-1;L--,O++)C+=256*v[L]>>>0,v[L]=C%a>>>0,C=C/a>>>0;if(C!==0)throw new Error("Non-zero carry");w=O,S++}for(var j=E-w;j!==E&&v[j]===0;)j++;for(var D=c.repeat(g);j<E;++j)D+=t.charAt(v[j]);return D}function h(y){if(typeof y!="string")throw new TypeError("Expected String");if(y.length===0)return new Uint8Array;var g=0;if(y[g]!==" "){for(var w=0,S=0;y[g]===c;)w++,g++;for(var A=(y.length-g)*l+1>>>0,E=new Uint8Array(A);y[g];){var v=r[y.charCodeAt(g)];if(v===255)return;for(var C=0,O=A-1;(v!==0||C<S)&&O!==-1;O--,C++)v+=a*E[O]>>>0,E[O]=v%256>>>0,v=v/256>>>0;if(v!==0)throw new Error("Non-zero carry");S=C,g++}if(y[g]!==" "){for(var L=A-S;L!==A&&E[L]===0;)L++;for(var j=new Uint8Array(w+(A-L)),D=w;L!==A;)j[D++]=E[L++];return j}}}function p(y){var g=h(y);if(g)return g;throw new Error(`Non-${e} character`)}return{encode:d,decodeUnsafe:h,decode:p}}var IM=AM,CM=IM;const $M=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},TM=t=>new TextEncoder().encode(t),NM=t=>new TextDecoder().decode(t);class OM{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class kM{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return P$(this,e)}}class PM{constructor(e){this.decoders=e}or(e){return P$(this,e)}decode(e){const r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const P$=(t,e)=>new PM({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});class RM{constructor(e,r,n,s){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=s,this.encoder=new OM(e,r,n),this.decoder=new kM(e,r,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Kg=({name:t,prefix:e,encode:r,decode:n})=>new RM(t,e,r,n),Rh=({prefix:t,name:e,alphabet:r})=>{const{encode:n,decode:s}=CM(r,e);return Kg({prefix:t,name:e,encode:n,decode:i=>$M(s(i))})},DM=(t,e,r,n)=>{const s={};for(let u=0;u<e.length;++u)s[e[u]]=u;let i=t.length;for(;t[i-1]==="=";)--i;const o=new Uint8Array(i*r/8|0);let a=0,c=0,l=0;for(let u=0;u<i;++u){const d=s[t[u]];if(d===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<r|d,a+=r,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},UM=(t,e,r)=>{const n=e[e.length-1]==="=",s=(1<<r)-1;let i="",o=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],o+=8;o>r;)o-=r,i+=e[s&a>>o];if(o&&(i+=e[s&a<<r-o]),n)for(;i.length*r&7;)i+="=";return i},dn=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>Kg({prefix:e,name:t,encode(s){return UM(s,n,r)},decode(s){return DM(s,n,r,t)}}),BM=Kg({prefix:"\0",name:"identity",encode:t=>NM(t),decode:t=>TM(t)}),LM=Object.freeze(Object.defineProperty({__proto__:null,identity:BM},Symbol.toStringTag,{value:"Module"})),MM=dn({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),jM=Object.freeze(Object.defineProperty({__proto__:null,base2:MM},Symbol.toStringTag,{value:"Module"})),FM=dn({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),qM=Object.freeze(Object.defineProperty({__proto__:null,base8:FM},Symbol.toStringTag,{value:"Module"})),zM=Rh({prefix:"9",name:"base10",alphabet:"0123456789"}),HM=Object.freeze(Object.defineProperty({__proto__:null,base10:zM},Symbol.toStringTag,{value:"Module"})),WM=dn({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),VM=dn({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),KM=Object.freeze(Object.defineProperty({__proto__:null,base16:WM,base16upper:VM},Symbol.toStringTag,{value:"Module"})),GM=dn({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),YM=dn({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),XM=dn({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),ZM=dn({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),JM=dn({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),QM=dn({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),e7=dn({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),t7=dn({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),r7=dn({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),n7=Object.freeze(Object.defineProperty({__proto__:null,base32:GM,base32hex:JM,base32hexpad:e7,base32hexpadupper:t7,base32hexupper:QM,base32pad:XM,base32padupper:ZM,base32upper:YM,base32z:r7},Symbol.toStringTag,{value:"Module"})),s7=Rh({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),i7=Rh({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),o7=Object.freeze(Object.defineProperty({__proto__:null,base36:s7,base36upper:i7},Symbol.toStringTag,{value:"Module"})),a7=Rh({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),c7=Rh({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),l7=Object.freeze(Object.defineProperty({__proto__:null,base58btc:a7,base58flickr:c7},Symbol.toStringTag,{value:"Module"})),u7=dn({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),d7=dn({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),h7=dn({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),f7=dn({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),p7=Object.freeze(Object.defineProperty({__proto__:null,base64:u7,base64pad:d7,base64url:h7,base64urlpad:f7},Symbol.toStringTag,{value:"Module"})),R$=Array.from(""),g7=R$.reduce((t,e,r)=>(t[r]=e,t),[]),y7=R$.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function m7(t){return t.reduce((e,r)=>(e+=g7[r],e),"")}function w7(t){const e=[];for(const r of t){const n=y7[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}const b7=Kg({prefix:"",name:"base256emoji",encode:m7,decode:w7}),v7=Object.freeze(Object.defineProperty({__proto__:null,base256emoji:b7},Symbol.toStringTag,{value:"Module"}));new TextEncoder;new TextDecoder;const Y_={...LM,...jM,...qM,...HM,...KM,...n7,...o7,...l7,...p7,...v7};function D$(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}const X_=D$("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),xm=D$("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);const e=k$(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),U$={utf8:X_,"utf-8":X_,hex:Y_.base16,latin1:xm,ascii:xm,binary:xm,...Y_};function tr(t,e="utf8"){const r=U$[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?q1(globalThis.Buffer.from(t,"utf-8")):r.decoder.decode(`${r.prefix}${t}`)}function jt(t,e="utf8"){const r=U$[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}const B$={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe",batchFetchMessages:"waku_batchFetchMessages"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe",batchFetchMessages:"irn_batchFetchMessages"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe",batchFetchMessages:"iridium_batchFetchMessages"}};var Sm,Z_;function L$(){if(Z_)return Sm;Z_=1;const t="Input must be an string, Buffer or Uint8Array";function e(o){let a;if(o instanceof Uint8Array)a=o;else if(typeof o=="string")a=new TextEncoder().encode(o);else throw new Error(t);return a}function r(o){return Array.prototype.map.call(o,function(a){return(a<16?"0":"")+a.toString(16)}).join("")}function n(o){return(4294967296+o).toString(16).substring(1)}function s(o,a,c){let l=`
`+o+" = ";for(let u=0;u<a.length;u+=2){if(c===32)l+=n(a[u]).toUpperCase(),l+=" ",l+=n(a[u+1]).toUpperCase();else if(c===64)l+=n(a[u+1]).toUpperCase(),l+=n(a[u]).toUpperCase();else throw new Error("Invalid size "+c);u%6===4?l+=`
`+new Array(o.length+4).join(" "):u<a.length-2&&(l+=" ")}console.log(l)}function i(o,a,c){let l=new Date().getTime();const u=new Uint8Array(a);for(let h=0;h<a;h++)u[h]=h%256;const d=new Date().getTime();console.log("Generated random input in "+(d-l)+"ms"),l=d;for(let h=0;h<c;h++){const p=o(u),y=new Date().getTime(),g=y-l;l=y,console.log("Hashed in "+g+"ms: "+p.substring(0,20)+"..."),console.log(Math.round(a/(1<<20)/(g/1e3)*100)/100+" MB PER SECOND")}}return Sm={normalizeInput:e,toHex:r,debugPrint:s,testSpeed:i},Sm}var Am,J_;function E7(){if(J_)return Am;J_=1;const t=L$();function e(S,A,E){const v=S[A]+S[E];let C=S[A+1]+S[E+1];v>=4294967296&&C++,S[A]=v,S[A+1]=C}function r(S,A,E,v){let C=S[A]+E;E<0&&(C+=4294967296);let O=S[A+1]+v;C>=4294967296&&O++,S[A]=C,S[A+1]=O}function n(S,A){return S[A]^S[A+1]<<8^S[A+2]<<16^S[A+3]<<24}function s(S,A,E,v,C,O){const L=l[C],j=l[C+1],D=l[O],W=l[O+1];e(c,S,A),r(c,S,L,j);let P=c[v]^c[S],R=c[v+1]^c[S+1];c[v]=R,c[v+1]=P,e(c,E,v),P=c[A]^c[E],R=c[A+1]^c[E+1],c[A]=P>>>24^R<<8,c[A+1]=R>>>24^P<<8,e(c,S,A),r(c,S,D,W),P=c[v]^c[S],R=c[v+1]^c[S+1],c[v]=P>>>16^R<<16,c[v+1]=R>>>16^P<<16,e(c,E,v),P=c[A]^c[E],R=c[A+1]^c[E+1],c[A]=R>>>31^P<<1,c[A+1]=P>>>31^R<<1}const i=new Uint32Array([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),o=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3],a=new Uint8Array(o.map(function(S){return S*2})),c=new Uint32Array(32),l=new Uint32Array(32);function u(S,A){let E=0;for(E=0;E<16;E++)c[E]=S.h[E],c[E+16]=i[E];for(c[24]=c[24]^S.t,c[25]=c[25]^S.t/4294967296,A&&(c[28]=~c[28],c[29]=~c[29]),E=0;E<32;E++)l[E]=n(S.b,4*E);for(E=0;E<12;E++)s(0,8,16,24,a[E*16+0],a[E*16+1]),s(2,10,18,26,a[E*16+2],a[E*16+3]),s(4,12,20,28,a[E*16+4],a[E*16+5]),s(6,14,22,30,a[E*16+6],a[E*16+7]),s(0,10,20,30,a[E*16+8],a[E*16+9]),s(2,12,22,24,a[E*16+10],a[E*16+11]),s(4,14,16,26,a[E*16+12],a[E*16+13]),s(6,8,18,28,a[E*16+14],a[E*16+15]);for(E=0;E<16;E++)S.h[E]=S.h[E]^c[E]^c[E+16]}const d=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);function h(S,A,E,v){if(S===0||S>64)throw new Error("Illegal output length, expected 0 < length <= 64");if(A&&A.length>64)throw new Error("Illegal key, expected Uint8Array with 0 < length <= 64");if(E&&E.length!==16)throw new Error("Illegal salt, expected Uint8Array with length is 16");if(v&&v.length!==16)throw new Error("Illegal personal, expected Uint8Array with length is 16");const C={b:new Uint8Array(128),h:new Uint32Array(16),t:0,c:0,outlen:S};d.fill(0),d[0]=S,A&&(d[1]=A.length),d[2]=1,d[3]=1,E&&d.set(E,32),v&&d.set(v,48);for(let O=0;O<16;O++)C.h[O]=i[O]^n(d,O*4);return A&&(p(C,A),C.c=128),C}function p(S,A){for(let E=0;E<A.length;E++)S.c===128&&(S.t+=S.c,u(S,!1),S.c=0),S.b[S.c++]=A[E]}function y(S){for(S.t+=S.c;S.c<128;)S.b[S.c++]=0;u(S,!0);const A=new Uint8Array(S.outlen);for(let E=0;E<S.outlen;E++)A[E]=S.h[E>>2]>>8*(E&3);return A}function g(S,A,E,v,C){E=E||64,S=t.normalizeInput(S),v&&(v=t.normalizeInput(v)),C&&(C=t.normalizeInput(C));const O=h(E,A,v,C);return p(O,S),y(O)}function w(S,A,E,v,C){const O=g(S,A,E,v,C);return t.toHex(O)}return Am={blake2b:g,blake2bHex:w,blake2bInit:h,blake2bUpdate:p,blake2bFinal:y},Am}var Im,Q_;function _7(){if(Q_)return Im;Q_=1;const t=L$();function e(y,g){return y[g]^y[g+1]<<8^y[g+2]<<16^y[g+3]<<24}function r(y,g,w,S,A,E){o[y]=o[y]+o[g]+A,o[S]=n(o[S]^o[y],16),o[w]=o[w]+o[S],o[g]=n(o[g]^o[w],12),o[y]=o[y]+o[g]+E,o[S]=n(o[S]^o[y],8),o[w]=o[w]+o[S],o[g]=n(o[g]^o[w],7)}function n(y,g){return y>>>g^y<<32-g}const s=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),i=new Uint8Array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0]),o=new Uint32Array(16),a=new Uint32Array(16);function c(y,g){let w=0;for(w=0;w<8;w++)o[w]=y.h[w],o[w+8]=s[w];for(o[12]^=y.t,o[13]^=y.t/4294967296,g&&(o[14]=~o[14]),w=0;w<16;w++)a[w]=e(y.b,4*w);for(w=0;w<10;w++)r(0,4,8,12,a[i[w*16+0]],a[i[w*16+1]]),r(1,5,9,13,a[i[w*16+2]],a[i[w*16+3]]),r(2,6,10,14,a[i[w*16+4]],a[i[w*16+5]]),r(3,7,11,15,a[i[w*16+6]],a[i[w*16+7]]),r(0,5,10,15,a[i[w*16+8]],a[i[w*16+9]]),r(1,6,11,12,a[i[w*16+10]],a[i[w*16+11]]),r(2,7,8,13,a[i[w*16+12]],a[i[w*16+13]]),r(3,4,9,14,a[i[w*16+14]],a[i[w*16+15]]);for(w=0;w<8;w++)y.h[w]^=o[w]^o[w+8]}function l(y,g){if(!(y>0&&y<=32))throw new Error("Incorrect output length, should be in [1, 32]");const w=g?g.length:0;if(g&&!(w>0&&w<=32))throw new Error("Incorrect key length, should be in [1, 32]");const S={h:new Uint32Array(s),b:new Uint8Array(64),c:0,t:0,outlen:y};return S.h[0]^=16842752^w<<8^y,w>0&&(u(S,g),S.c=64),S}function u(y,g){for(let w=0;w<g.length;w++)y.c===64&&(y.t+=y.c,c(y,!1),y.c=0),y.b[y.c++]=g[w]}function d(y){for(y.t+=y.c;y.c<64;)y.b[y.c++]=0;c(y,!0);const g=new Uint8Array(y.outlen);for(let w=0;w<y.outlen;w++)g[w]=y.h[w>>2]>>8*(w&3)&255;return g}function h(y,g,w){w=w||32,y=t.normalizeInput(y);const S=l(w,g);return u(S,y),d(S)}function p(y,g,w){const S=h(y,g,w);return t.toHex(S)}return Im={blake2s:h,blake2sHex:p,blake2sInit:l,blake2sUpdate:u,blake2sFinal:d},Im}var Cm,e2;function x7(){if(e2)return Cm;e2=1;const t=E7(),e=_7();return Cm={blake2b:t.blake2b,blake2bHex:t.blake2bHex,blake2bInit:t.blake2bInit,blake2bUpdate:t.blake2bUpdate,blake2bFinal:t.blake2bFinal,blake2s:e.blake2s,blake2sHex:e.blake2sHex,blake2sInit:e.blake2sInit,blake2sUpdate:e.blake2sUpdate,blake2sFinal:e.blake2sFinal},Cm}var M$=x7(),S7={};const A7=":";function lp(t){const[e,r]=t.split(A7);return{namespace:e,reference:r}}function j$(t,e){return t.includes(":")?[t]:e.chains||[]}var I7=Object.defineProperty,C7=Object.defineProperties,$7=Object.getOwnPropertyDescriptors,t2=Object.getOwnPropertySymbols,T7=Object.prototype.hasOwnProperty,N7=Object.prototype.propertyIsEnumerable,C0=(t,e,r)=>e in t?I7(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,r2=(t,e)=>{for(var r in e||(e={}))T7.call(e,r)&&C0(t,r,e[r]);if(t2)for(var r of t2(e))N7.call(e,r)&&C0(t,r,e[r]);return t},O7=(t,e)=>C7(t,$7(e)),n2=(t,e,r)=>C0(t,typeof e!="symbol"?e+"":e,r);const k7="ReactNative",As={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},P7="js";function Gp(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function Ra(){return!Xr.getDocument()&&!!Xr.getNavigator()&&navigator.product===k7}function R7(){return Ra()&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"&&(global==null?void 0:global.Platform.OS)==="android"}function D7(){return Ra()&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"&&(global==null?void 0:global.Platform.OS)==="ios"}function pu(){return!Gp()&&!!Xr.getNavigator()&&!!Xr.getDocument()}function Dh(){return Ra()?As.reactNative:Gp()?As.node:pu()?As.browser:As.unknown}function s2(){var t;try{return Ra()&&typeof global<"u"&&typeof(global==null?void 0:global.Application)<"u"?(t=global.Application)==null?void 0:t.applicationId:void 0}catch{return}}function U7(t,e){const r=new URLSearchParams(t);return Object.entries(e).sort(([n],[s])=>n.localeCompare(s)).forEach(([n,s])=>{s!=null&&r.set(n,String(s))}),r.toString()}function B7(t){var e,r;const n=F$();try{return t!=null&&t.url&&n.url&&new URL(t.url).host!==new URL(n.url).host&&(console.warn(`The configured WalletConnect 'metadata.url':${t.url} differs from the actual page url:${n.url}. This is probably unintended and can lead to issues.`),t.url=n.url),(e=t?.icons)!=null&&e.length&&t.icons.length>0&&(t.icons=t.icons.filter(s=>s!=="")),O7(r2(r2({},n),t),{url:t?.url||n.url,name:t?.name||n.name,description:t?.description||n.description,icons:(r=t?.icons)!=null&&r.length&&t.icons.length>0?t.icons:n.icons})}catch(s){return console.warn("Error populating app metadata",s),t||n}}function F$(){return M3.getWindowMetadata()||{name:"",description:"",url:"",icons:[""]}}function L7(){if(Dh()===As.reactNative&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"){const{OS:r,Version:n}=global.Platform;return[r,n].join("-")}const t=B3();if(t===null)return"unknown";const e=t.os?t.os.replace(" ","").toLowerCase():"unknown";return t.type==="browser"?[e,t.name,t.version].join("-"):[e,t.version].join("-")}function M7(){var t;const e=Dh();return e===As.browser?[e,((t=Xr.getLocation())==null?void 0:t.host)||"unknown"].join(":"):e}function q$(t,e,r){const n=L7(),s=M7();return[[t,e].join("-"),[P7,r].join("-"),n,s].join("/")}function j7({protocol:t,version:e,relayUrl:r,sdkVersion:n,auth:s,projectId:i,useOnCloseEvent:o,bundleId:a,packageName:c}){const l=r.split("?"),u=q$(t,e,n),d={auth:s,ua:u,projectId:i,useOnCloseEvent:o,packageName:c||void 0,bundleId:a||void 0},h=U7(l[1]||"",d);return l[0]+"?"+h}function fc(t,e){return t.filter(r=>e.includes(r)).length===t.length}function $0(t){return Object.fromEntries(t.entries())}function T0(t){return new Map(Object.entries(t))}function ec(t=X.FIVE_MINUTES,e){const r=X.toMiliseconds(t||X.FIVE_MINUTES);let n,s,i,o;return{resolve:a=>{i&&n&&(clearTimeout(i),n(a),o=Promise.resolve(a))},reject:a=>{i&&s&&(clearTimeout(i),s(a))},done:()=>new Promise((a,c)=>{if(o)return a(o);i=setTimeout(()=>{const l=new Error(e);o=Promise.reject(l),c(l)},r),n=a,s=c})}}function Bi(t,e,r){return new Promise(async(n,s)=>{const i=setTimeout(()=>s(new Error(r)),e);try{const o=await t;n(o)}catch(o){s(o)}clearTimeout(i)})}function z$(t,e){if(typeof e=="string"&&e.startsWith(`${t}:`))return e;if(t.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(t.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${t}`)}function F7(t){return z$("topic",t)}function q7(t){return z$("id",t)}function H$(t){const[e,r]=t.split(":"),n={id:void 0,topic:void 0};if(e==="topic"&&typeof r=="string")n.topic=r;else if(e==="id"&&Number.isInteger(Number(r)))n.id=Number(r);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${r}`);return n}function Or(t,e){return X.fromMiliseconds(Date.now()+X.toMiliseconds(t))}function ia(t){return Date.now()>=X.toMiliseconds(t)}function Ut(t,e){return`${t}${e?`:${e}`:""}`}function Cc(t=[],e=[]){return[...new Set([...t,...e])]}async function z7({id:t,topic:e,wcDeepLink:r}){var n;try{if(!r)return;const s=typeof r=="string"?JSON.parse(r):r,i=s?.href;if(typeof i!="string")return;const o=H7(i,t,e),a=Dh();if(a===As.browser){if(!((n=Xr.getDocument())!=null&&n.hasFocus())){console.warn("Document does not have focus, skipping deeplink.");return}W7(o)}else a===As.reactNative&&typeof(global==null?void 0:global.Linking)<"u"&&await global.Linking.openURL(o)}catch(s){console.error(s)}}function H7(t,e,r){const n=`requestId=${e}&sessionTopic=${r}`;t.endsWith("/")&&(t=t.slice(0,-1));let s=`${t}`;if(t.startsWith("https://t.me")){const i=t.includes("?")?"&startapp=":"?startapp=";s=`${s}${i}${Y7(n,!0)}`}else s=`${s}/wc?${n}`;return s}function W7(t){let e="_self";G7()?e="_top":(K7()||t.startsWith("https://")||t.startsWith("http://"))&&(e="_blank"),window.open(t,e,"noreferrer noopener")}async function V7(t,e){let r="";try{if(pu()&&(r=localStorage.getItem(e),r))return r;r=await t.getItem(e)}catch(n){console.error(n)}return r}function i2(t,e){if(!t.includes(e))return null;const r=t.split(/([&,?,=])/),n=r.indexOf(e);return r[n+2]}function o2(){return typeof crypto<"u"&&crypto!=null&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,t=>{const e=Math.random()*16|0;return(t==="x"?e:e&3|8).toString(16)})}function z1(){return typeof process<"u"&&S7.IS_VITEST==="true"}function K7(){return typeof window<"u"&&(!!window.TelegramWebviewProxy||!!window.Telegram||!!window.TelegramWebviewProxyProto)}function G7(){try{return window.self!==window.top}catch{return!1}}function Y7(t,e=!1){const r=Buffer.from(t).toString("base64");return e?r.replace(/[=]/g,""):r}function W$(t){return Buffer.from(t,"base64").toString("utf-8")}function X7(t){return new Promise(e=>setTimeout(e,t))}let Z7=class{constructor({limit:e}){n2(this,"limit"),n2(this,"set"),this.limit=e,this.set=new Set}add(e){if(!this.set.has(e)){if(this.set.size>=this.limit){const r=this.set.values().next().value;r&&this.set.delete(r)}this.set.add(e)}}has(e){return this.set.has(e)}};const Ef=BigInt(2**32-1),a2=BigInt(32);function V$(t,e=!1){return e?{h:Number(t&Ef),l:Number(t>>a2&Ef)}:{h:Number(t>>a2&Ef)|0,l:Number(t&Ef)|0}}function K$(t,e=!1){const r=t.length;let n=new Uint32Array(r),s=new Uint32Array(r);for(let i=0;i<r;i++){const{h:o,l:a}=V$(t[i],e);[n[i],s[i]]=[o,a]}return[n,s]}const c2=(t,e,r)=>t>>>r,l2=(t,e,r)=>t<<32-r|e>>>r,oa=(t,e,r)=>t>>>r|e<<32-r,aa=(t,e,r)=>t<<32-r|e>>>r,sd=(t,e,r)=>t<<64-r|e>>>r-32,id=(t,e,r)=>t>>>r-32|e<<64-r,J7=(t,e)=>e,Q7=(t,e)=>t,ej=(t,e,r)=>t<<r|e>>>32-r,tj=(t,e,r)=>e<<r|t>>>32-r,rj=(t,e,r)=>e<<r-32|t>>>64-r,nj=(t,e,r)=>t<<r-32|e>>>64-r;function li(t,e,r,n){const s=(e>>>0)+(n>>>0);return{h:t+r+(s/2**32|0)|0,l:s|0}}const H1=(t,e,r)=>(t>>>0)+(e>>>0)+(r>>>0),W1=(t,e,r,n)=>e+r+n+(t/2**32|0)|0,sj=(t,e,r,n)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0),ij=(t,e,r,n,s)=>e+r+n+s+(t/2**32|0)|0,oj=(t,e,r,n,s)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0)+(s>>>0),aj=(t,e,r,n,s,i)=>e+r+n+s+i+(t/2**32|0)|0,dl=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function Gg(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function Ro(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function bi(t,...e){if(!Gg(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function Yg(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");Ro(t.outputLen),Ro(t.blockLen)}function Ta(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function V1(t,e){bi(t);const r=e.outputLen;if(t.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}function Md(t){return new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4))}function Xs(...t){for(let e=0;e<t.length;e++)t[e].fill(0)}function $m(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Si(t,e){return t<<32-e|t>>>e}const G$=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function Y$(t){return t<<24&4278190080|t<<8&16711680|t>>>8&65280|t>>>24&255}const oo=G$?t=>t:t=>Y$(t);function cj(t){for(let e=0;e<t.length;e++)t[e]=Y$(t[e]);return t}const ca=G$?t=>t:cj,X$=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",lj=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Ll(t){if(bi(t),X$)return t.toHex();let e="";for(let r=0;r<t.length;r++)e+=lj[t[r]];return e}const Qi={_0:48,_9:57,A:65,F:70,a:97,f:102};function u2(t){if(t>=Qi._0&&t<=Qi._9)return t-Qi._0;if(t>=Qi.A&&t<=Qi.F)return t-(Qi.A-10);if(t>=Qi.a&&t<=Qi.f)return t-(Qi.a-10)}function Yp(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);if(X$)return Uint8Array.fromHex(t);const e=t.length,r=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(r);for(let s=0,i=0;s<r;s++,i+=2){const o=u2(t.charCodeAt(i)),a=u2(t.charCodeAt(i+1));if(o===void 0||a===void 0){const c=t[i]+t[i+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+i)}n[s]=o*16+a}return n}function Z$(t){if(typeof t!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(t))}function yi(t){return typeof t=="string"&&(t=Z$(t)),bi(t),t}function fa(...t){let e=0;for(let n=0;n<t.length;n++){const s=t[n];bi(s),e+=s.length}const r=new Uint8Array(e);for(let n=0,s=0;n<t.length;n++){const i=t[n];r.set(i,s),s+=i.length}return r}let Xg=class{};function Uh(t){const e=n=>t().update(yi(n)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function uj(t){const e=(n,s)=>t(s).update(yi(n)).digest(),r=t({});return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=n=>t(n),e}function Wc(t=32){if(dl&&typeof dl.getRandomValues=="function")return dl.getRandomValues(new Uint8Array(t));if(dl&&typeof dl.randomBytes=="function")return Uint8Array.from(dl.randomBytes(t));throw new Error("crypto.getRandomValues must be defined")}const dj=BigInt(0),Bu=BigInt(1),hj=BigInt(2),fj=BigInt(7),pj=BigInt(256),gj=BigInt(113),J$=[],Q$=[],eT=[];for(let t=0,e=Bu,r=1,n=0;t<24;t++){[r,n]=[n,(2*r+3*n)%5],J$.push(2*(5*n+r)),Q$.push((t+1)*(t+2)/2%64);let s=dj;for(let i=0;i<7;i++)e=(e<<Bu^(e>>fj)*gj)%pj,e&hj&&(s^=Bu<<(Bu<<BigInt(i))-Bu);eT.push(s)}const tT=K$(eT,!0),yj=tT[0],mj=tT[1],d2=(t,e,r)=>r>32?rj(t,e,r):ej(t,e,r),h2=(t,e,r)=>r>32?nj(t,e,r):tj(t,e,r);function wj(t,e=24){const r=new Uint32Array(10);for(let n=24-e;n<24;n++){for(let o=0;o<10;o++)r[o]=t[o]^t[o+10]^t[o+20]^t[o+30]^t[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,c=(o+2)%10,l=r[c],u=r[c+1],d=d2(l,u,1)^r[a],h=h2(l,u,1)^r[a+1];for(let p=0;p<50;p+=10)t[o+p]^=d,t[o+p+1]^=h}let s=t[2],i=t[3];for(let o=0;o<24;o++){const a=Q$[o],c=d2(s,i,a),l=h2(s,i,a),u=J$[o];s=t[u],i=t[u+1],t[u]=c,t[u+1]=l}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)r[a]=t[o+a];for(let a=0;a<10;a++)t[o+a]^=~r[(a+2)%10]&r[(a+4)%10]}t[0]^=yj[n],t[1]^=mj[n]}Xs(r)}let bj=class rT extends Xg{constructor(e,r,n,s=!1,i=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=e,this.suffix=r,this.outputLen=n,this.enableXOF=s,this.rounds=i,Ro(n),!(0<e&&e<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=Md(this.state)}clone(){return this._cloneInto()}keccak(){ca(this.state32),wj(this.state32,this.rounds),ca(this.state32),this.posOut=0,this.pos=0}update(e){Ta(this),e=yi(e),bi(e);const{blockLen:r,state:n}=this,s=e.length;for(let i=0;i<s;){const o=Math.min(r-this.pos,s-i);for(let a=0;a<o;a++)n[this.pos++]^=e[i++];this.pos===r&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:r,pos:n,blockLen:s}=this;e[n]^=r,(r&128)!==0&&n===s-1&&this.keccak(),e[s-1]^=128,this.keccak()}writeInto(e){Ta(this,!1),bi(e),this.finish();const r=this.state,{blockLen:n}=this;for(let s=0,i=e.length;s<i;){this.posOut>=n&&this.keccak();const o=Math.min(n-this.posOut,i-s);e.set(r.subarray(this.posOut,this.posOut+o),s),this.posOut+=o,s+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return Ro(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(V1(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,Xs(this.state)}_cloneInto(e){const{blockLen:r,suffix:n,outputLen:s,rounds:i,enableXOF:o}=this;return e||(e=new rT(r,n,s,o,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=n,e.outputLen=s,e.enableXOF=o,e.destroyed=this.destroyed,e}};const vj=(t,e,r)=>Uh(()=>new bj(e,t,r)),Ej=vj(1,136,256/8);function _j(t,e,r,n){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,n);const s=BigInt(32),i=BigInt(4294967295),o=Number(r>>s&i),a=Number(r&i),c=n?4:0,l=n?0:4;t.setUint32(e+c,o,n),t.setUint32(e+l,a,n)}function xj(t,e,r){return t&e^~t&r}function Sj(t,e,r){return t&e^t&r^e&r}let nT=class extends Xg{constructor(e,r,n,s){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=e,this.outputLen=r,this.padOffset=n,this.isLE=s,this.buffer=new Uint8Array(e),this.view=$m(this.buffer)}update(e){Ta(this),e=yi(e),bi(e);const{view:r,buffer:n,blockLen:s}=this,i=e.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const c=$m(e);for(;s<=i-o;o+=s)this.process(c,o);continue}n.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Ta(this),V1(e,this),this.finished=!0;const{buffer:r,view:n,blockLen:s,isLE:i}=this;let{pos:o}=this;r[o++]=128,Xs(this.buffer.subarray(o)),this.padOffset>s-o&&(this.process(n,0),o=0);for(let d=o;d<s;d++)r[d]=0;_j(n,s-8,BigInt(this.length*8),i),this.process(n,0);const a=$m(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=c/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<l;d++)a.setUint32(4*d,u[d],i)}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const n=e.slice(0,r);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:r,buffer:n,length:s,finished:i,destroyed:o,pos:a}=this;return e.destroyed=o,e.finished=i,e.length=s,e.pos=a,s%r&&e.buffer.set(n),e}clone(){return this._cloneInto()}};const qo=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),mn=Uint32Array.from([3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]),wn=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]),Aj=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),zo=new Uint32Array(64);let Ij=class extends nT{constructor(e=32){super(64,e,8,!1),this.A=qo[0]|0,this.B=qo[1]|0,this.C=qo[2]|0,this.D=qo[3]|0,this.E=qo[4]|0,this.F=qo[5]|0,this.G=qo[6]|0,this.H=qo[7]|0}get(){const{A:e,B:r,C:n,D:s,E:i,F:o,G:a,H:c}=this;return[e,r,n,s,i,o,a,c]}set(e,r,n,s,i,o,a,c){this.A=e|0,this.B=r|0,this.C=n|0,this.D=s|0,this.E=i|0,this.F=o|0,this.G=a|0,this.H=c|0}process(e,r){for(let d=0;d<16;d++,r+=4)zo[d]=e.getUint32(r,!1);for(let d=16;d<64;d++){const h=zo[d-15],p=zo[d-2],y=Si(h,7)^Si(h,18)^h>>>3,g=Si(p,17)^Si(p,19)^p>>>10;zo[d]=g+zo[d-7]+y+zo[d-16]|0}let{A:n,B:s,C:i,D:o,E:a,F:c,G:l,H:u}=this;for(let d=0;d<64;d++){const h=Si(a,6)^Si(a,11)^Si(a,25),p=u+h+xj(a,c,l)+Aj[d]+zo[d]|0,y=(Si(n,2)^Si(n,13)^Si(n,22))+Sj(n,s,i)|0;u=l,l=c,c=a,a=o+p|0,o=i,i=s,s=n,n=p+y|0}n=n+this.A|0,s=s+this.B|0,i=i+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,l=l+this.G|0,u=u+this.H|0,this.set(n,s,i,o,a,c,l,u)}roundClean(){Xs(zo)}destroy(){this.set(0,0,0,0,0,0,0,0),Xs(this.buffer)}};const sT=K$(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),Cj=sT[0],$j=sT[1],Ho=new Uint32Array(80),Wo=new Uint32Array(80);let K1=class extends nT{constructor(e=64){super(128,e,16,!1),this.Ah=wn[0]|0,this.Al=wn[1]|0,this.Bh=wn[2]|0,this.Bl=wn[3]|0,this.Ch=wn[4]|0,this.Cl=wn[5]|0,this.Dh=wn[6]|0,this.Dl=wn[7]|0,this.Eh=wn[8]|0,this.El=wn[9]|0,this.Fh=wn[10]|0,this.Fl=wn[11]|0,this.Gh=wn[12]|0,this.Gl=wn[13]|0,this.Hh=wn[14]|0,this.Hl=wn[15]|0}get(){const{Ah:e,Al:r,Bh:n,Bl:s,Ch:i,Cl:o,Dh:a,Dl:c,Eh:l,El:u,Fh:d,Fl:h,Gh:p,Gl:y,Hh:g,Hl:w}=this;return[e,r,n,s,i,o,a,c,l,u,d,h,p,y,g,w]}set(e,r,n,s,i,o,a,c,l,u,d,h,p,y,g,w){this.Ah=e|0,this.Al=r|0,this.Bh=n|0,this.Bl=s|0,this.Ch=i|0,this.Cl=o|0,this.Dh=a|0,this.Dl=c|0,this.Eh=l|0,this.El=u|0,this.Fh=d|0,this.Fl=h|0,this.Gh=p|0,this.Gl=y|0,this.Hh=g|0,this.Hl=w|0}process(e,r){for(let E=0;E<16;E++,r+=4)Ho[E]=e.getUint32(r),Wo[E]=e.getUint32(r+=4);for(let E=16;E<80;E++){const v=Ho[E-15]|0,C=Wo[E-15]|0,O=oa(v,C,1)^oa(v,C,8)^c2(v,C,7),L=aa(v,C,1)^aa(v,C,8)^l2(v,C,7),j=Ho[E-2]|0,D=Wo[E-2]|0,W=oa(j,D,19)^sd(j,D,61)^c2(j,D,6),P=aa(j,D,19)^id(j,D,61)^l2(j,D,6),R=sj(L,P,Wo[E-7],Wo[E-16]),T=ij(R,O,W,Ho[E-7],Ho[E-16]);Ho[E]=T|0,Wo[E]=R|0}let{Ah:n,Al:s,Bh:i,Bl:o,Ch:a,Cl:c,Dh:l,Dl:u,Eh:d,El:h,Fh:p,Fl:y,Gh:g,Gl:w,Hh:S,Hl:A}=this;for(let E=0;E<80;E++){const v=oa(d,h,14)^oa(d,h,18)^sd(d,h,41),C=aa(d,h,14)^aa(d,h,18)^id(d,h,41),O=d&p^~d&g,L=h&y^~h&w,j=oj(A,C,L,$j[E],Wo[E]),D=aj(j,S,v,O,Cj[E],Ho[E]),W=j|0,P=oa(n,s,28)^sd(n,s,34)^sd(n,s,39),R=aa(n,s,28)^id(n,s,34)^id(n,s,39),T=n&i^n&a^i&a,k=s&o^s&c^o&c;S=g|0,A=w|0,g=p|0,w=y|0,p=d|0,y=h|0,{h:d,l:h}=li(l|0,u|0,D|0,W|0),l=a|0,u=c|0,a=i|0,c=o|0,i=n|0,o=s|0;const f=H1(W,R,k);n=W1(f,D,P,T),s=f|0}({h:n,l:s}=li(this.Ah|0,this.Al|0,n|0,s|0)),{h:i,l:o}=li(this.Bh|0,this.Bl|0,i|0,o|0),{h:a,l:c}=li(this.Ch|0,this.Cl|0,a|0,c|0),{h:l,l:u}=li(this.Dh|0,this.Dl|0,l|0,u|0),{h:d,l:h}=li(this.Eh|0,this.El|0,d|0,h|0),{h:p,l:y}=li(this.Fh|0,this.Fl|0,p|0,y|0),{h:g,l:w}=li(this.Gh|0,this.Gl|0,g|0,w|0),{h:S,l:A}=li(this.Hh|0,this.Hl|0,S|0,A|0),this.set(n,s,i,o,a,c,l,u,d,h,p,y,g,w,S,A)}roundClean(){Xs(Ho,Wo)}destroy(){Xs(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}},Tj=class extends K1{constructor(){super(48),this.Ah=mn[0]|0,this.Al=mn[1]|0,this.Bh=mn[2]|0,this.Bl=mn[3]|0,this.Ch=mn[4]|0,this.Cl=mn[5]|0,this.Dh=mn[6]|0,this.Dl=mn[7]|0,this.Eh=mn[8]|0,this.El=mn[9]|0,this.Fh=mn[10]|0,this.Fl=mn[11]|0,this.Gh=mn[12]|0,this.Gl=mn[13]|0,this.Hh=mn[14]|0,this.Hl=mn[15]|0}};const bn=Uint32Array.from([573645204,4230739756,2673172387,3360449730,596883563,1867755857,2520282905,1497426621,2519219938,2827943907,3193839141,1401305490,721525244,746961066,246885852,2177182882]);let Nj=class extends K1{constructor(){super(32),this.Ah=bn[0]|0,this.Al=bn[1]|0,this.Bh=bn[2]|0,this.Bl=bn[3]|0,this.Ch=bn[4]|0,this.Cl=bn[5]|0,this.Dh=bn[6]|0,this.Dl=bn[7]|0,this.Eh=bn[8]|0,this.El=bn[9]|0,this.Fh=bn[10]|0,this.Fl=bn[11]|0,this.Gh=bn[12]|0,this.Gl=bn[13]|0,this.Hh=bn[14]|0,this.Hl=bn[15]|0}};const Zg=Uh(()=>new Ij),Oj=Uh(()=>new K1),kj=Uh(()=>new Tj),Pj=Uh(()=>new Nj),Rj=Uint8Array.from([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9]),$r=Uint32Array.from([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),Se=new Uint32Array(32);function Vo(t,e,r,n,s,i){const o=s[i],a=s[i+1];let c=Se[2*t],l=Se[2*t+1],u=Se[2*e],d=Se[2*e+1],h=Se[2*r],p=Se[2*r+1],y=Se[2*n],g=Se[2*n+1],w=H1(c,u,o);l=W1(w,l,d,a),c=w|0,{Dh:g,Dl:y}={Dh:g^l,Dl:y^c},{Dh:g,Dl:y}={Dh:J7(g,y),Dl:Q7(g)},{h:p,l:h}=li(p,h,g,y),{Bh:d,Bl:u}={Bh:d^p,Bl:u^h},{Bh:d,Bl:u}={Bh:oa(d,u,24),Bl:aa(d,u,24)},Se[2*t]=c,Se[2*t+1]=l,Se[2*e]=u,Se[2*e+1]=d,Se[2*r]=h,Se[2*r+1]=p,Se[2*n]=y,Se[2*n+1]=g}function Ko(t,e,r,n,s,i){const o=s[i],a=s[i+1];let c=Se[2*t],l=Se[2*t+1],u=Se[2*e],d=Se[2*e+1],h=Se[2*r],p=Se[2*r+1],y=Se[2*n],g=Se[2*n+1],w=H1(c,u,o);l=W1(w,l,d,a),c=w|0,{Dh:g,Dl:y}={Dh:g^l,Dl:y^c},{Dh:g,Dl:y}={Dh:oa(g,y,16),Dl:aa(g,y,16)},{h:p,l:h}=li(p,h,g,y),{Bh:d,Bl:u}={Bh:d^p,Bl:u^h},{Bh:d,Bl:u}={Bh:sd(d,u,63),Bl:id(d,u,63)},Se[2*t]=c,Se[2*t+1]=l,Se[2*e]=u,Se[2*e+1]=d,Se[2*r]=h,Se[2*r+1]=p,Se[2*n]=y,Se[2*n+1]=g}function Dj(t,e={},r,n,s){if(Ro(r),t<0||t>r)throw new Error("outputLen bigger than keyLen");const{key:i,salt:o,personalization:a}=e;if(i!==void 0&&(i.length<1||i.length>r))throw new Error("key length must be undefined or 1.."+r);if(o!==void 0&&o.length!==n)throw new Error("salt must be undefined or "+n);if(a!==void 0&&a.length!==s)throw new Error("personalization must be undefined or "+s)}let Uj=class extends Xg{constructor(e,r){super(),this.finished=!1,this.destroyed=!1,this.length=0,this.pos=0,Ro(e),Ro(r),this.blockLen=e,this.outputLen=r,this.buffer=new Uint8Array(e),this.buffer32=Md(this.buffer)}update(e){Ta(this),e=yi(e),bi(e);const{blockLen:r,buffer:n,buffer32:s}=this,i=e.length,o=e.byteOffset,a=e.buffer;for(let c=0;c<i;){this.pos===r&&(ca(s),this.compress(s,0,!1),ca(s),this.pos=0);const l=Math.min(r-this.pos,i-c),u=o+c;if(l===r&&!(u%4)&&c+l<i){const d=new Uint32Array(a,u,Math.floor((i-c)/4));ca(d);for(let h=0;c+r<i;h+=s.length,c+=r)this.length+=r,this.compress(d,h,!1);ca(d);continue}n.set(e.subarray(c,c+l),this.pos),this.pos+=l,this.length+=l,c+=l}return this}digestInto(e){Ta(this),V1(e,this);const{pos:r,buffer32:n}=this;this.finished=!0,Xs(this.buffer.subarray(r)),ca(n),this.compress(n,0,!0),ca(n);const s=Md(e);this.get().forEach((i,o)=>s[o]=oo(i))}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const n=e.slice(0,r);return this.destroy(),n}_cloneInto(e){const{buffer:r,length:n,finished:s,destroyed:i,outputLen:o,pos:a}=this;return e||(e=new this.constructor({dkLen:o})),e.set(...this.get()),e.buffer.set(r),e.destroyed=i,e.finished=s,e.length=n,e.pos=a,e.outputLen=o,e}clone(){return this._cloneInto()}},Bj=class extends Uj{constructor(e={}){const r=e.dkLen===void 0?64:e.dkLen;super(128,r),this.v0l=$r[0]|0,this.v0h=$r[1]|0,this.v1l=$r[2]|0,this.v1h=$r[3]|0,this.v2l=$r[4]|0,this.v2h=$r[5]|0,this.v3l=$r[6]|0,this.v3h=$r[7]|0,this.v4l=$r[8]|0,this.v4h=$r[9]|0,this.v5l=$r[10]|0,this.v5h=$r[11]|0,this.v6l=$r[12]|0,this.v6h=$r[13]|0,this.v7l=$r[14]|0,this.v7h=$r[15]|0,Dj(r,e,64,16,16);let{key:n,personalization:s,salt:i}=e,o=0;if(n!==void 0&&(n=yi(n),o=n.length),this.v0l^=this.outputLen|o<<8|65536|1<<24,i!==void 0){i=yi(i);const a=Md(i);this.v4l^=oo(a[0]),this.v4h^=oo(a[1]),this.v5l^=oo(a[2]),this.v5h^=oo(a[3])}if(s!==void 0){s=yi(s);const a=Md(s);this.v6l^=oo(a[0]),this.v6h^=oo(a[1]),this.v7l^=oo(a[2]),this.v7h^=oo(a[3])}if(n!==void 0){const a=new Uint8Array(this.blockLen);a.set(n),this.update(a)}}get(){let{v0l:e,v0h:r,v1l:n,v1h:s,v2l:i,v2h:o,v3l:a,v3h:c,v4l:l,v4h:u,v5l:d,v5h:h,v6l:p,v6h:y,v7l:g,v7h:w}=this;return[e,r,n,s,i,o,a,c,l,u,d,h,p,y,g,w]}set(e,r,n,s,i,o,a,c,l,u,d,h,p,y,g,w){this.v0l=e|0,this.v0h=r|0,this.v1l=n|0,this.v1h=s|0,this.v2l=i|0,this.v2h=o|0,this.v3l=a|0,this.v3h=c|0,this.v4l=l|0,this.v4h=u|0,this.v5l=d|0,this.v5h=h|0,this.v6l=p|0,this.v6h=y|0,this.v7l=g|0,this.v7h=w|0}compress(e,r,n){this.get().forEach((c,l)=>Se[l]=c),Se.set($r,16);let{h:s,l:i}=V$(BigInt(this.length));Se[24]=$r[8]^i,Se[25]=$r[9]^s,n&&(Se[28]=~Se[28],Se[29]=~Se[29]);let o=0;const a=Rj;for(let c=0;c<12;c++)Vo(0,4,8,12,e,r+2*a[o++]),Ko(0,4,8,12,e,r+2*a[o++]),Vo(1,5,9,13,e,r+2*a[o++]),Ko(1,5,9,13,e,r+2*a[o++]),Vo(2,6,10,14,e,r+2*a[o++]),Ko(2,6,10,14,e,r+2*a[o++]),Vo(3,7,11,15,e,r+2*a[o++]),Ko(3,7,11,15,e,r+2*a[o++]),Vo(0,5,10,15,e,r+2*a[o++]),Ko(0,5,10,15,e,r+2*a[o++]),Vo(1,6,11,12,e,r+2*a[o++]),Ko(1,6,11,12,e,r+2*a[o++]),Vo(2,7,8,13,e,r+2*a[o++]),Ko(2,7,8,13,e,r+2*a[o++]),Vo(3,4,9,14,e,r+2*a[o++]),Ko(3,4,9,14,e,r+2*a[o++]);this.v0l^=Se[0]^Se[16],this.v0h^=Se[1]^Se[17],this.v1l^=Se[2]^Se[18],this.v1h^=Se[3]^Se[19],this.v2l^=Se[4]^Se[20],this.v2h^=Se[5]^Se[21],this.v3l^=Se[6]^Se[22],this.v3h^=Se[7]^Se[23],this.v4l^=Se[8]^Se[24],this.v4h^=Se[9]^Se[25],this.v5l^=Se[10]^Se[26],this.v5h^=Se[11]^Se[27],this.v6l^=Se[12]^Se[28],this.v6h^=Se[13]^Se[29],this.v7l^=Se[14]^Se[30],this.v7h^=Se[15]^Se[31],Xs(Se)}destroy(){this.destroyed=!0,Xs(this.buffer32),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};const Lj=uj(t=>new Bj(t)),Mj="https://rpc.walletconnect.org/v1";function iT(t){const e=`Ethereum Signed Message:
${t.length}`,r=new TextEncoder().encode(e+t);return"0x"+Buffer.from(Ej(r)).toString("hex")}async function jj(t,e,r,n,s,i){switch(r.t){case"eip191":return await Fj(t,e,r.s);case"eip1271":return await qj(t,e,r.s,n,s,i);default:throw new Error(`verifySignature failed: Attempted to verify CacaoSignature with unknown type: ${r.t}`)}}function Fj(t,e,r){const n=T9(r);return F9({payload:iT(e),signature:n}).toLowerCase()===t.toLowerCase()}async function qj(t,e,r,n,s,i){const o=lp(n);if(!o.namespace||!o.reference)throw new Error(`isValidEip1271Signature failed: chainId must be in CAIP-2 format, received: ${n}`);try{const a="0x1626ba7e",c="0000000000000000000000000000000000000000000000000000000000000040",l=r.substring(2),u=(l.length/2).toString(16).padStart(64,"0"),d=(e.startsWith("0x")?e:iT(e)).substring(2),h=a+d+c+u+l,p=await fetch(`${i||Mj}/?chainId=${n}&projectId=${s}`,{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify({id:zj(),jsonrpc:"2.0",method:"eth_call",params:[{to:t,data:h},"latest"]})}),{result:y}=await p.json();return y?y.slice(0,a.length).toLowerCase()===a.toLowerCase():!1}catch(a){return console.error("isValidEip1271Signature: ",a),!1}}function zj(){return Date.now()+Math.floor(Math.random()*1e3)}function Hj(t){const e=atob(t),r=new Uint8Array(e.length);for(let o=0;o<e.length;o++)r[o]=e.charCodeAt(o);const n=r[0];if(n===0)throw new Error("No signatures found");const s=1+n*64;if(r.length<s)throw new Error("Transaction data too short for claimed signature count");if(r.length<100)throw new Error("Transaction too short");const i=Buffer.from(t,"base64").slice(1,65);return Ph.encode(i)}function Wj(t){const e=new Uint8Array(Buffer.from(t,"base64")),r=Array.from("TransactionData::").map(i=>i.charCodeAt(0)),n=new Uint8Array(r.length+e.length);n.set(r),n.set(e,r.length);const s=Lj(n,{dkLen:32});return Ph.encode(s)}function f2(t){const e=new Uint8Array(Zg(Vj(t)));return Ph.encode(e)}function Vj(t){if(t instanceof Uint8Array)return t;if(Array.isArray(t))return new Uint8Array(t);if(typeof t=="object"&&t!=null&&t.data)return new Uint8Array(Object.values(t.data));if(typeof t=="object"&&t)return new Uint8Array(Object.values(t));throw new Error("getNearUint8ArrayFromBytes: Unexpected result type from bytes array")}function p2(t){const e=Buffer.from(t,"base64"),r=O$(e).txn;if(!r)throw new Error("Invalid signed transaction: missing 'txn' field");const n=$$(r),s=Buffer.from("TX"),i=Buffer.concat([s,Buffer.from(n)]),o=Pj(i);return x$.encode(o).replace(/=+$/,"")}function Tm(t){const e=[];let r=BigInt(t);for(;r>=BigInt(128);)e.push(Number(r&BigInt(127)|BigInt(128))),r>>=BigInt(7);return e.push(Number(r)),Buffer.from(e)}function Kj(t){const e=Buffer.from(t.signed.bodyBytes,"base64"),r=Buffer.from(t.signed.authInfoBytes,"base64"),n=Buffer.from(t.signature.signature,"base64"),s=[];s.push(Buffer.from([10])),s.push(Tm(e.length)),s.push(e),s.push(Buffer.from([18])),s.push(Tm(r.length)),s.push(r),s.push(Buffer.from([26])),s.push(Tm(n.length)),s.push(n);const i=Buffer.concat(s),o=Zg(i);return Buffer.from(o).toString("hex").toUpperCase()}function Gj(t){var e,r;const n=[];try{if(typeof t=="string")return n.push(t),n;if(typeof t!="object")return n;t!=null&&t.id&&n.push(t.id);const s=(r=(e=t?.capabilities)==null?void 0:e.caip345)==null?void 0:r.transactionHashes;s&&n.push(...s)}catch(s){console.warn("getWalletSendCallsHashes failed: ",s)}return n}var Yj=Object.defineProperty,Xj=Object.defineProperties,Zj=Object.getOwnPropertyDescriptors,g2=Object.getOwnPropertySymbols,Jj=Object.prototype.hasOwnProperty,Qj=Object.prototype.propertyIsEnumerable,y2=(t,e,r)=>e in t?Yj(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,eF=(t,e)=>{for(var r in e||(e={}))Jj.call(e,r)&&y2(t,r,e[r]);if(g2)for(var r of g2(e))Qj.call(e,r)&&y2(t,r,e[r]);return t},tF=(t,e)=>Xj(t,Zj(e));const oT="did:pkh:",rF={eip155:"Ethereum",solana:"Solana",bip122:"Bitcoin"},nF=t=>t?rF[t]||t:"",Jg=t=>t?.split(":"),sF=t=>{const e=t&&Jg(t);if(e)return t.includes(oT)?e[3]:e[1]},iF=t=>{const e=t&&Jg(t);if(e)return t.includes(oT)?e[2]:e[0]},N0=t=>{const e=t&&Jg(t);if(e)return e[2]+":"+e[3]},Xp=t=>{const e=t&&Jg(t);if(e)return e.pop()};async function m2(t){const{cacao:e,projectId:r}=t,{s:n,p:s}=e,i=aT(s,s.iss),o=Xp(s.iss);return await jj(o,i,n,N0(s.iss),r)}const aT=(t,e)=>{const r=iF(e);if(!r)throw new Error("Invalid issuer: "+e);const n=`${t.domain} wants you to sign in with your ${nF(r)} account:`,s=Xp(e);if(!t.aud&&!t.uri)throw new Error("Either `aud` or `uri` is required to construct the message");let i=t.statement||void 0;const o=`URI: ${t.aud||t.uri}`,a=`Version: ${t.version}`,c=`Chain ID: ${sF(e)}`,l=`Nonce: ${t.nonce}`,u=`Issued At: ${t.iat}`,d=t.exp?`Expiration Time: ${t.exp}`:void 0,h=t.nbf?`Not Before: ${t.nbf}`:void 0,p=t.requestId?`Request ID: ${t.requestId}`:void 0,y=t.resources?`Resources:${t.resources.map(w=>`
- ${w}`).join("")}`:void 0,g=up(t.resources);if(g){const w=jd(g);i=pF(i,w)}return[n,s,"",i,"",o,a,c,l,u,d,h,p,y].filter(w=>w!=null).join(`
`)};function oF(t){return Buffer.from(JSON.stringify(t)).toString("base64")}function aF(t){return JSON.parse(Buffer.from(t,"base64").toString("utf-8"))}function Rc(t){if(!t)throw new Error("No recap provided, value is undefined");if(!t.att)throw new Error("No `att` property found");const e=Object.keys(t.att);if(!(e!=null&&e.length))throw new Error("No resources found in `att` property");e.forEach(r=>{const n=t.att[r];if(Array.isArray(n))throw new Error(`Resource must be an object: ${r}`);if(typeof n!="object")throw new Error(`Resource must be an object: ${r}`);if(!Object.keys(n).length)throw new Error(`Resource object is empty: ${r}`);Object.keys(n).forEach(s=>{const i=n[s];if(!Array.isArray(i))throw new Error(`Ability limits ${s} must be an array of objects, found: ${i}`);if(!i.length)throw new Error(`Value of ${s} is empty array, must be an array with objects`);i.forEach(o=>{if(typeof o!="object")throw new Error(`Ability limits (${s}) must be an array of objects, found: ${o}`)})})})}function cF(t,e,r,n={}){return r?.sort((s,i)=>s.localeCompare(i)),{att:{[t]:lF(e,r,n)}}}function lF(t,e,r={}){e=e?.sort((s,i)=>s.localeCompare(i));const n=e.map(s=>({[`${t}/${s}`]:[r]}));return Object.assign({},...n)}function cT(t){return Rc(t),`urn:recap:${oF(t).replace(/=/g,"")}`}function jd(t){const e=aF(t.replace("urn:recap:",""));return Rc(e),e}function uF(t,e,r){const n=cF(t,e,r);return cT(n)}function dF(t){return t&&t.includes("urn:recap:")}function hF(t,e){const r=jd(t),n=jd(e),s=fF(r,n);return cT(s)}function fF(t,e){Rc(t),Rc(e);const r=Object.keys(t.att).concat(Object.keys(e.att)).sort((s,i)=>s.localeCompare(i)),n={att:{}};return r.forEach(s=>{var i,o;Object.keys(((i=t.att)==null?void 0:i[s])||{}).concat(Object.keys(((o=e.att)==null?void 0:o[s])||{})).sort((a,c)=>a.localeCompare(c)).forEach(a=>{var c,l;n.att[s]=tF(eF({},n.att[s]),{[a]:((c=t.att[s])==null?void 0:c[a])||((l=e.att[s])==null?void 0:l[a])})})}),n}function pF(t="",e){Rc(e);const r="I further authorize the stated URI to perform the following actions on my behalf: ";if(t.includes(r))return t;const n=[];let s=0;Object.keys(e.att).forEach(a=>{const c=Object.keys(e.att[a]).map(d=>({ability:d.split("/")[0],action:d.split("/")[1]}));c.sort((d,h)=>d.action.localeCompare(h.action));const l={};c.forEach(d=>{l[d.ability]||(l[d.ability]=[]),l[d.ability].push(d.action)});const u=Object.keys(l).map(d=>(s++,`(${s}) '${d}': '${l[d].join("', '")}' for '${a}'.`));n.push(u.join(", ").replace(".,","."))});const i=n.join(" "),o=`${r}${i}`;return`${t?t+" ":""}${o}`}function w2(t){var e;const r=jd(t);Rc(r);const n=(e=r.att)==null?void 0:e.eip155;return n?Object.keys(n).map(s=>s.split("/")[1]):[]}function b2(t){const e=jd(t);Rc(e);const r=[];return Object.values(e.att).forEach(n=>{Object.values(n).forEach(s=>{var i;(i=s?.[0])!=null&&i.chains&&r.push(s[0].chains)})}),[...new Set(r.flat())]}function up(t){if(!t)return;const e=t?.[t.length-1];return dF(e)?e:void 0}function lT(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function O0(t){if(typeof t!="boolean")throw new Error(`boolean expected, not ${t}`)}function Nm(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function Yn(t,...e){if(!lT(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function v2(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function gF(t,e){Yn(t);const r=e.outputLen;if(t.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}function Aa(t){return new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4))}function Ql(...t){for(let e=0;e<t.length;e++)t[e].fill(0)}function yF(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}const mF=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function wF(t){if(typeof t!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(t))}function k0(t){if(typeof t=="string")t=wF(t);else if(lT(t))t=P0(t);else throw new Error("Uint8Array expected, got "+typeof t);return t}function bF(t,e){if(e==null||typeof e!="object")throw new Error("options must be defined");return Object.assign(t,e)}function vF(t,e){if(t.length!==e.length)return!1;let r=0;for(let n=0;n<t.length;n++)r|=t[n]^e[n];return r===0}const EF=(t,e)=>{function r(n,...s){if(Yn(n),!mF)throw new Error("Non little-endian hardware is not yet supported");if(t.nonceLength!==void 0){const l=s[0];if(!l)throw new Error("nonce / iv required");t.varSizeNonce?Yn(l):Yn(l,t.nonceLength)}const i=t.tagLength;i&&s[1]!==void 0&&Yn(s[1]);const o=e(n,...s),a=(l,u)=>{if(u!==void 0){if(l!==2)throw new Error("cipher output not supported");Yn(u)}};let c=!1;return{encrypt(l,u){if(c)throw new Error("cannot encrypt() twice with same key + nonce");return c=!0,Yn(l),a(o.encrypt.length,u),o.encrypt(l,u)},decrypt(l,u){if(Yn(l),i&&l.length<i)throw new Error("invalid ciphertext length: smaller than tagLength="+i);return a(o.decrypt.length,u),o.decrypt(l,u)}}}return Object.assign(r,t),r};function E2(t,e,r=!0){if(e===void 0)return new Uint8Array(t);if(e.length!==t)throw new Error("invalid output length, expected "+t+", got: "+e.length);if(r&&!xF(e))throw new Error("invalid output, must be aligned");return e}function _2(t,e,r,n){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,n);const s=BigInt(32),i=BigInt(4294967295),o=Number(r>>s&i),a=Number(r&i);t.setUint32(e+4,o,n),t.setUint32(e+0,a,n)}function _F(t,e,r){O0(r);const n=new Uint8Array(16),s=yF(n);return _2(s,0,BigInt(e),r),_2(s,8,BigInt(t),r),n}function xF(t){return t.byteOffset%4===0}function P0(t){return Uint8Array.from(t)}const uT=t=>Uint8Array.from(t.split("").map(e=>e.charCodeAt(0))),SF=uT("expand 16-byte k"),AF=uT("expand 32-byte k"),IF=Aa(SF),CF=Aa(AF);function xt(t,e){return t<<e|t>>>32-e}function R0(t){return t.byteOffset%4===0}const _f=64,$F=16,dT=2**32-1,x2=new Uint32Array;function TF(t,e,r,n,s,i,o,a){const c=s.length,l=new Uint8Array(_f),u=Aa(l),d=R0(s)&&R0(i),h=d?Aa(s):x2,p=d?Aa(i):x2;for(let y=0;y<c;o++){if(t(e,r,n,u,o,a),o>=dT)throw new Error("arx: counter overflow");const g=Math.min(_f,c-y);if(d&&g===_f){const w=y/4;if(y%4!==0)throw new Error("arx: invalid block position");for(let S=0,A;S<$F;S++)A=w+S,p[A]=h[A]^u[S];y+=_f;continue}for(let w=0,S;w<g;w++)S=y+w,i[S]=s[S]^l[w];y+=g}}function NF(t,e){const{allowShortKeys:r,extendNonceFn:n,counterLength:s,counterRight:i,rounds:o}=bF({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},e);if(typeof t!="function")throw new Error("core must be a function");return Nm(s),Nm(o),O0(i),O0(r),(a,c,l,u,d=0)=>{Yn(a),Yn(c),Yn(l);const h=l.length;if(u===void 0&&(u=new Uint8Array(h)),Yn(u),Nm(d),d<0||d>=dT)throw new Error("arx: counter overflow");if(u.length<h)throw new Error(`arx: output (${u.length}) is shorter than data (${h})`);const p=[];let y=a.length,g,w;if(y===32)p.push(g=P0(a)),w=CF;else if(y===16&&r)g=new Uint8Array(32),g.set(a),g.set(a,16),w=IF,p.push(g);else throw new Error(`arx: invalid 32-byte key, got length=${y}`);R0(c)||p.push(c=P0(c));const S=Aa(g);if(n){if(c.length!==24)throw new Error("arx: extended nonce must be 24 bytes");n(w,S,Aa(c.subarray(0,16)),S),c=c.subarray(16)}const A=16-s;if(A!==c.length)throw new Error(`arx: nonce must be ${A} or 16 bytes`);if(A!==12){const v=new Uint8Array(12);v.set(c,i?0:12-c.length),c=v,p.push(c)}const E=Aa(c);return TF(t,w,S,E,l,u,d,o),Ql(...p),u}}const Zr=(t,e)=>t[e++]&255|(t[e++]&255)<<8;let OF=class{constructor(e){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,e=k0(e),Yn(e,32);const r=Zr(e,0),n=Zr(e,2),s=Zr(e,4),i=Zr(e,6),o=Zr(e,8),a=Zr(e,10),c=Zr(e,12),l=Zr(e,14);this.r[0]=r&8191,this.r[1]=(r>>>13|n<<3)&8191,this.r[2]=(n>>>10|s<<6)&7939,this.r[3]=(s>>>7|i<<9)&8191,this.r[4]=(i>>>4|o<<12)&255,this.r[5]=o>>>1&8190,this.r[6]=(o>>>14|a<<2)&8191,this.r[7]=(a>>>11|c<<5)&8065,this.r[8]=(c>>>8|l<<8)&8191,this.r[9]=l>>>5&127;for(let u=0;u<8;u++)this.pad[u]=Zr(e,16+2*u)}process(e,r,n=!1){const s=n?0:2048,{h:i,r:o}=this,a=o[0],c=o[1],l=o[2],u=o[3],d=o[4],h=o[5],p=o[6],y=o[7],g=o[8],w=o[9],S=Zr(e,r+0),A=Zr(e,r+2),E=Zr(e,r+4),v=Zr(e,r+6),C=Zr(e,r+8),O=Zr(e,r+10),L=Zr(e,r+12),j=Zr(e,r+14);let D=i[0]+(S&8191),W=i[1]+((S>>>13|A<<3)&8191),P=i[2]+((A>>>10|E<<6)&8191),R=i[3]+((E>>>7|v<<9)&8191),T=i[4]+((v>>>4|C<<12)&8191),k=i[5]+(C>>>1&8191),f=i[6]+((C>>>14|O<<2)&8191),m=i[7]+((O>>>11|L<<5)&8191),_=i[8]+((L>>>8|j<<8)&8191),$=i[9]+(j>>>5|s),x=0,N=x+D*a+W*(5*w)+P*(5*g)+R*(5*y)+T*(5*p);x=N>>>13,N&=8191,N+=k*(5*h)+f*(5*d)+m*(5*u)+_*(5*l)+$*(5*c),x+=N>>>13,N&=8191;let H=x+D*c+W*a+P*(5*w)+R*(5*g)+T*(5*y);x=H>>>13,H&=8191,H+=k*(5*p)+f*(5*h)+m*(5*d)+_*(5*u)+$*(5*l),x+=H>>>13,H&=8191;let z=x+D*l+W*c+P*a+R*(5*w)+T*(5*g);x=z>>>13,z&=8191,z+=k*(5*y)+f*(5*p)+m*(5*h)+_*(5*d)+$*(5*u),x+=z>>>13,z&=8191;let G=x+D*u+W*l+P*c+R*a+T*(5*w);x=G>>>13,G&=8191,G+=k*(5*g)+f*(5*y)+m*(5*p)+_*(5*h)+$*(5*d),x+=G>>>13,G&=8191;let M=x+D*d+W*u+P*l+R*c+T*a;x=M>>>13,M&=8191,M+=k*(5*w)+f*(5*g)+m*(5*y)+_*(5*p)+$*(5*h),x+=M>>>13,M&=8191;let V=x+D*h+W*d+P*u+R*l+T*c;x=V>>>13,V&=8191,V+=k*a+f*(5*w)+m*(5*g)+_*(5*y)+$*(5*p),x+=V>>>13,V&=8191;let J=x+D*p+W*h+P*d+R*u+T*l;x=J>>>13,J&=8191,J+=k*c+f*a+m*(5*w)+_*(5*g)+$*(5*y),x+=J>>>13,J&=8191;let re=x+D*y+W*p+P*h+R*d+T*u;x=re>>>13,re&=8191,re+=k*l+f*c+m*a+_*(5*w)+$*(5*g),x+=re>>>13,re&=8191;let ye=x+D*g+W*y+P*p+R*h+T*d;x=ye>>>13,ye&=8191,ye+=k*u+f*l+m*c+_*a+$*(5*w),x+=ye>>>13,ye&=8191;let ne=x+D*w+W*g+P*y+R*p+T*h;x=ne>>>13,ne&=8191,ne+=k*d+f*u+m*l+_*c+$*a,x+=ne>>>13,ne&=8191,x=(x<<2)+x|0,x=x+N|0,N=x&8191,x=x>>>13,H+=x,i[0]=N,i[1]=H,i[2]=z,i[3]=G,i[4]=M,i[5]=V,i[6]=J,i[7]=re,i[8]=ye,i[9]=ne}finalize(){const{h:e,pad:r}=this,n=new Uint16Array(10);let s=e[1]>>>13;e[1]&=8191;for(let a=2;a<10;a++)e[a]+=s,s=e[a]>>>13,e[a]&=8191;e[0]+=s*5,s=e[0]>>>13,e[0]&=8191,e[1]+=s,s=e[1]>>>13,e[1]&=8191,e[2]+=s,n[0]=e[0]+5,s=n[0]>>>13,n[0]&=8191;for(let a=1;a<10;a++)n[a]=e[a]+s,s=n[a]>>>13,n[a]&=8191;n[9]-=8192;let i=(s^1)-1;for(let a=0;a<10;a++)n[a]&=i;i=~i;for(let a=0;a<10;a++)e[a]=e[a]&i|n[a];e[0]=(e[0]|e[1]<<13)&65535,e[1]=(e[1]>>>3|e[2]<<10)&65535,e[2]=(e[2]>>>6|e[3]<<7)&65535,e[3]=(e[3]>>>9|e[4]<<4)&65535,e[4]=(e[4]>>>12|e[5]<<1|e[6]<<14)&65535,e[5]=(e[6]>>>2|e[7]<<11)&65535,e[6]=(e[7]>>>5|e[8]<<8)&65535,e[7]=(e[8]>>>8|e[9]<<5)&65535;let o=e[0]+r[0];e[0]=o&65535;for(let a=1;a<8;a++)o=(e[a]+r[a]|0)+(o>>>16)|0,e[a]=o&65535;Ql(n)}update(e){v2(this),e=k0(e),Yn(e);const{buffer:r,blockLen:n}=this,s=e.length;for(let i=0;i<s;){const o=Math.min(n-this.pos,s-i);if(o===n){for(;n<=s-i;i+=n)this.process(e,i);continue}r.set(e.subarray(i,i+o),this.pos),this.pos+=o,i+=o,this.pos===n&&(this.process(r,0,!1),this.pos=0)}return this}destroy(){Ql(this.h,this.r,this.buffer,this.pad)}digestInto(e){v2(this),gF(e,this),this.finished=!0;const{buffer:r,h:n}=this;let{pos:s}=this;if(s){for(r[s++]=1;s<16;s++)r[s]=0;this.process(r,0,!0)}this.finalize();let i=0;for(let o=0;o<8;o++)e[i++]=n[o]>>>0,e[i++]=n[o]>>>8;return e}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const n=e.slice(0,r);return this.destroy(),n}};function kF(t){const e=(n,s)=>t(s).update(k0(n)).digest(),r=t(new Uint8Array(32));return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=n=>t(n),e}const PF=kF(t=>new OF(t));function RF(t,e,r,n,s,i=20){let o=t[0],a=t[1],c=t[2],l=t[3],u=e[0],d=e[1],h=e[2],p=e[3],y=e[4],g=e[5],w=e[6],S=e[7],A=s,E=r[0],v=r[1],C=r[2],O=o,L=a,j=c,D=l,W=u,P=d,R=h,T=p,k=y,f=g,m=w,_=S,$=A,x=E,N=v,H=C;for(let G=0;G<i;G+=2)O=O+W|0,$=xt($^O,16),k=k+$|0,W=xt(W^k,12),O=O+W|0,$=xt($^O,8),k=k+$|0,W=xt(W^k,7),L=L+P|0,x=xt(x^L,16),f=f+x|0,P=xt(P^f,12),L=L+P|0,x=xt(x^L,8),f=f+x|0,P=xt(P^f,7),j=j+R|0,N=xt(N^j,16),m=m+N|0,R=xt(R^m,12),j=j+R|0,N=xt(N^j,8),m=m+N|0,R=xt(R^m,7),D=D+T|0,H=xt(H^D,16),_=_+H|0,T=xt(T^_,12),D=D+T|0,H=xt(H^D,8),_=_+H|0,T=xt(T^_,7),O=O+P|0,H=xt(H^O,16),m=m+H|0,P=xt(P^m,12),O=O+P|0,H=xt(H^O,8),m=m+H|0,P=xt(P^m,7),L=L+R|0,$=xt($^L,16),_=_+$|0,R=xt(R^_,12),L=L+R|0,$=xt($^L,8),_=_+$|0,R=xt(R^_,7),j=j+T|0,x=xt(x^j,16),k=k+x|0,T=xt(T^k,12),j=j+T|0,x=xt(x^j,8),k=k+x|0,T=xt(T^k,7),D=D+W|0,N=xt(N^D,16),f=f+N|0,W=xt(W^f,12),D=D+W|0,N=xt(N^D,8),f=f+N|0,W=xt(W^f,7);let z=0;n[z++]=o+O|0,n[z++]=a+L|0,n[z++]=c+j|0,n[z++]=l+D|0,n[z++]=u+W|0,n[z++]=d+P|0,n[z++]=h+R|0,n[z++]=p+T|0,n[z++]=y+k|0,n[z++]=g+f|0,n[z++]=w+m|0,n[z++]=S+_|0,n[z++]=A+$|0,n[z++]=E+x|0,n[z++]=v+N|0,n[z++]=C+H|0}const DF=NF(RF,{counterRight:!1,counterLength:4,allowShortKeys:!1}),UF=new Uint8Array(16),S2=(t,e)=>{t.update(e);const r=e.length%16;r&&t.update(UF.subarray(r))},BF=new Uint8Array(32);function A2(t,e,r,n,s){const i=t(e,r,BF),o=PF.create(i);s&&S2(o,s),S2(o,n);const a=_F(n.length,s?s.length:0,!0);o.update(a);const c=o.digest();return Ql(i,a),c}const LF=t=>(e,r,n)=>({encrypt(s,i){const o=s.length;i=E2(o+16,i,!1),i.set(s);const a=i.subarray(0,-16);t(e,r,a,a,1);const c=A2(t,e,r,a,n);return i.set(c,o),Ql(c),i},decrypt(s,i){i=E2(s.length-16,i,!1);const o=s.subarray(0,-16),a=s.subarray(-16),c=A2(t,e,r,o,n);if(!vF(a,c))throw new Error("invalid tag");return i.set(s.subarray(0,-16)),t(e,r,i,i,1),Ql(c),i}}),hT=EF({blockSize:64,nonceLength:12,tagLength:16},LF(DF));let fT=class extends Xg{constructor(e,r){super(),this.finished=!1,this.destroyed=!1,Yg(e);const n=yi(r);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const s=this.blockLen,i=new Uint8Array(s);i.set(n.length>s?e.create().update(n).digest():n);for(let o=0;o<i.length;o++)i[o]^=54;this.iHash.update(i),this.oHash=e.create();for(let o=0;o<i.length;o++)i[o]^=106;this.oHash.update(i),Xs(i)}update(e){return Ta(this),this.iHash.update(e),this}digestInto(e){Ta(this),bi(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:r,iHash:n,finished:s,destroyed:i,blockLen:o,outputLen:a}=this;return e=e,e.finished=s,e.destroyed=i,e.blockLen=o,e.outputLen=a,e.oHash=r._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};const Qg=(t,e,r)=>new fT(t,e).update(r).digest();Qg.create=(t,e)=>new fT(t,e);function MF(t,e,r){return Yg(t),r===void 0&&(r=new Uint8Array(t.outputLen)),Qg(t,yi(r),yi(e))}const Om=Uint8Array.from([0]),I2=Uint8Array.of();function jF(t,e,r,n=32){Yg(t),Ro(n);const s=t.outputLen;if(n>255*s)throw new Error("Length should be <= 255*HashLen");const i=Math.ceil(n/s);r===void 0&&(r=I2);const o=new Uint8Array(i*s),a=Qg.create(t,e),c=a._cloneInto(),l=new Uint8Array(a.outputLen);for(let u=0;u<i;u++)Om[0]=u+1,c.update(u===0?I2:l).update(r).update(Om).digestInto(l),o.set(l,s*u),a._cloneInto(c);return a.destroy(),c.destroy(),Xs(l,Om),o.slice(0,n)}const FF=(t,e,r,n,s)=>jF(t,MF(t,e,r),n,s),ey=Zg,G1=BigInt(0),D0=BigInt(1);function Zp(t,e=""){if(typeof t!="boolean"){const r=e&&`"${e}"`;throw new Error(r+"expected boolean, got type="+typeof t)}return t}function pc(t,e,r=""){const n=Gg(t),s=t?.length,i=e!==void 0;if(!n||i&&s!==e){const o=r&&`"${r}" `,a=i?` of length ${e}`:"",c=n?`length=${s}`:`type=${typeof t}`;throw new Error(o+"expected Uint8Array"+a+", got "+c)}return t}function xf(t){const e=t.toString(16);return e.length&1?"0"+e:e}function pT(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return t===""?G1:BigInt("0x"+t)}function ty(t){return pT(Ll(t))}function Jp(t){return bi(t),pT(Ll(Uint8Array.from(t).reverse()))}function Y1(t,e){return Yp(t.toString(16).padStart(e*2,"0"))}function X1(t,e){return Y1(t,e).reverse()}function Cn(t,e,r){let n;if(typeof e=="string")try{n=Yp(e)}catch(i){throw new Error(t+" must be hex string or Uint8Array, cause: "+i)}else if(Gg(e))n=Uint8Array.from(e);else throw new Error(t+" must be hex string or Uint8Array");const s=n.length;if(typeof r=="number"&&s!==r)throw new Error(t+" of length "+r+" expected, got "+s);return n}const km=t=>typeof t=="bigint"&&G1<=t;function qF(t,e,r){return km(t)&&km(e)&&km(r)&&e<=t&&t<r}function U0(t,e,r,n){if(!qF(e,r,n))throw new Error("expected valid "+t+": "+r+" <= n < "+n+", got "+e)}function gT(t){let e;for(e=0;t>G1;t>>=D0,e+=1);return e}const Bh=t=>(D0<<BigInt(t))-D0;function zF(t,e,r){if(typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof r!="function")throw new Error("hmacFn must be a function");const n=h=>new Uint8Array(h),s=h=>Uint8Array.of(h);let i=n(t),o=n(t),a=0;const c=()=>{i.fill(1),o.fill(0),a=0},l=(...h)=>r(o,i,...h),u=(h=n(0))=>{o=l(s(0),h),i=l(),h.length!==0&&(o=l(s(1),h),i=l())},d=()=>{if(a++>=1e3)throw new Error("drbg: tried 1000 values");let h=0;const p=[];for(;h<e;){i=l();const y=i.slice();p.push(y),h+=i.length}return fa(...p)};return(h,p)=>{c(),u(h);let y;for(;!(y=p(d()));)u();return c(),y}}function ry(t,e,r={}){if(!t||typeof t!="object")throw new Error("expected valid options object");function n(s,i,o){const a=t[s];if(o&&a===void 0)return;const c=typeof a;if(c!==i||a===null)throw new Error(`param "${s}" is invalid: expected ${i}, got ${c}`)}Object.entries(e).forEach(([s,i])=>n(s,i,!1)),Object.entries(r).forEach(([s,i])=>n(s,i,!0))}function C2(t){const e=new WeakMap;return(r,...n)=>{const s=e.get(r);if(s!==void 0)return s;const i=t(r,...n);return e.set(r,i),i}}const ts=BigInt(0),kn=BigInt(1),gc=BigInt(2),yT=BigInt(3),mT=BigInt(4),wT=BigInt(5),HF=BigInt(7),bT=BigInt(8),WF=BigInt(9),vT=BigInt(16);function vs(t,e){const r=t%e;return r>=ts?r:e+r}function ai(t,e,r){let n=t;for(;e-- >ts;)n*=n,n%=r;return n}function $2(t,e){if(t===ts)throw new Error("invert: expected non-zero number");if(e<=ts)throw new Error("invert: expected positive modulus, got "+e);let r=vs(t,e),n=e,s=ts,i=kn;for(;r!==ts;){const o=n/r,a=n%r,c=s-i*o;n=r,r=a,s=i,i=c}if(n!==kn)throw new Error("invert: does not exist");return vs(s,e)}function Z1(t,e,r){if(!t.eql(t.sqr(e),r))throw new Error("Cannot find square root")}function ET(t,e){const r=(t.ORDER+kn)/mT,n=t.pow(e,r);return Z1(t,n,e),n}function VF(t,e){const r=(t.ORDER-wT)/bT,n=t.mul(e,gc),s=t.pow(n,r),i=t.mul(e,s),o=t.mul(t.mul(i,gc),s),a=t.mul(i,t.sub(o,t.ONE));return Z1(t,a,e),a}function KF(t){const e=Da(t),r=_T(t),n=r(e,e.neg(e.ONE)),s=r(e,n),i=r(e,e.neg(n)),o=(t+HF)/vT;return(a,c)=>{let l=a.pow(c,o),u=a.mul(l,n);const d=a.mul(l,s),h=a.mul(l,i),p=a.eql(a.sqr(u),c),y=a.eql(a.sqr(d),c);l=a.cmov(l,u,p),u=a.cmov(h,d,y);const g=a.eql(a.sqr(u),c),w=a.cmov(l,u,g);return Z1(a,w,c),w}}function _T(t){if(t<yT)throw new Error("sqrt is not defined for small field");let e=t-kn,r=0;for(;e%gc===ts;)e/=gc,r++;let n=gc;const s=Da(t);for(;T2(s,n)===1;)if(n++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(r===1)return ET;let i=s.pow(n,e);const o=(e+kn)/gc;return function(a,c){if(a.is0(c))return c;if(T2(a,c)!==1)throw new Error("Cannot find square root");let l=r,u=a.mul(a.ONE,i),d=a.pow(c,e),h=a.pow(c,o);for(;!a.eql(d,a.ONE);){if(a.is0(d))return a.ZERO;let p=1,y=a.sqr(d);for(;!a.eql(y,a.ONE);)if(p++,y=a.sqr(y),p===l)throw new Error("Cannot find square root");const g=kn<<BigInt(l-p-1),w=a.pow(u,g);l=p,u=a.sqr(w),d=a.mul(d,u),h=a.mul(h,w)}return h}}function GF(t){return t%mT===yT?ET:t%bT===wT?VF:t%vT===WF?KF(t):_T(t)}const YF=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function XF(t){const e={ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"},r=YF.reduce((n,s)=>(n[s]="function",n),e);return ry(t,r),t}function ZF(t,e,r){if(r<ts)throw new Error("invalid exponent, negatives unsupported");if(r===ts)return t.ONE;if(r===kn)return e;let n=t.ONE,s=e;for(;r>ts;)r&kn&&(n=t.mul(n,s)),s=t.sqr(s),r>>=kn;return n}function xT(t,e,r=!1){const n=new Array(e.length).fill(r?t.ZERO:void 0),s=e.reduce((o,a,c)=>t.is0(a)?o:(n[c]=o,t.mul(o,a)),t.ONE),i=t.inv(s);return e.reduceRight((o,a,c)=>t.is0(a)?o:(n[c]=t.mul(o,n[c]),t.mul(o,a)),i),n}function T2(t,e){const r=(t.ORDER-kn)/gc,n=t.pow(e,r),s=t.eql(n,t.ONE),i=t.eql(n,t.ZERO),o=t.eql(n,t.neg(t.ONE));if(!s&&!i&&!o)throw new Error("invalid Legendre symbol result");return s?1:i?0:-1}function ST(t,e){e!==void 0&&Ro(e);const r=e!==void 0?e:t.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}function Da(t,e,r=!1,n={}){if(t<=ts)throw new Error("invalid field: expected ORDER > 0, got "+t);let s,i,o=!1,a;if(typeof e=="object"&&e!=null){if(n.sqrt||r)throw new Error("cannot specify opts in two arguments");const h=e;h.BITS&&(s=h.BITS),h.sqrt&&(i=h.sqrt),typeof h.isLE=="boolean"&&(r=h.isLE),typeof h.modFromBytes=="boolean"&&(o=h.modFromBytes),a=h.allowedLengths}else typeof e=="number"&&(s=e),n.sqrt&&(i=n.sqrt);const{nBitLength:c,nByteLength:l}=ST(t,s);if(l>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let u;const d=Object.freeze({ORDER:t,isLE:r,BITS:c,BYTES:l,MASK:Bh(c),ZERO:ts,ONE:kn,allowedLengths:a,create:h=>vs(h,t),isValid:h=>{if(typeof h!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof h);return ts<=h&&h<t},is0:h=>h===ts,isValidNot0:h=>!d.is0(h)&&d.isValid(h),isOdd:h=>(h&kn)===kn,neg:h=>vs(-h,t),eql:(h,p)=>h===p,sqr:h=>vs(h*h,t),add:(h,p)=>vs(h+p,t),sub:(h,p)=>vs(h-p,t),mul:(h,p)=>vs(h*p,t),pow:(h,p)=>ZF(d,h,p),div:(h,p)=>vs(h*$2(p,t),t),sqrN:h=>h*h,addN:(h,p)=>h+p,subN:(h,p)=>h-p,mulN:(h,p)=>h*p,inv:h=>$2(h,t),sqrt:i||(h=>(u||(u=GF(t)),u(d,h))),toBytes:h=>r?X1(h,l):Y1(h,l),fromBytes:(h,p=!0)=>{if(a){if(!a.includes(h.length)||h.length>l)throw new Error("Field.fromBytes: expected "+a+" bytes, got "+h.length);const g=new Uint8Array(l);g.set(h,r?0:g.length-h.length),h=g}if(h.length!==l)throw new Error("Field.fromBytes: expected "+l+" bytes, got "+h.length);let y=r?Jp(h):ty(h);if(o&&(y=vs(y,t)),!p&&!d.isValid(y))throw new Error("invalid field element: outside of range 0..ORDER");return y},invertBatch:h=>xT(d,h),cmov:(h,p,y)=>y?p:h});return Object.freeze(d)}function AT(t){if(typeof t!="bigint")throw new Error("field order must be bigint");const e=t.toString(2).length;return Math.ceil(e/8)}function IT(t){const e=AT(t);return e+Math.ceil(e/2)}function JF(t,e,r=!1){const n=t.length,s=AT(e),i=IT(e);if(n<16||n<i||n>1024)throw new Error("expected "+i+"-1024 bytes of input, got "+n);const o=r?Jp(t):ty(t),a=vs(o,e-kn)+kn;return r?X1(a,s):Y1(a,s)}const eu=BigInt(0),yc=BigInt(1);function Qp(t,e){const r=e.negate();return t?r:e}function Pm(t,e){const r=xT(t.Fp,e.map(n=>n.Z));return e.map((n,s)=>t.fromAffine(n.toAffine(r[s])))}function CT(t,e){if(!Number.isSafeInteger(t)||t<=0||t>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+t)}function Rm(t,e){CT(t,e);const r=Math.ceil(e/t)+1,n=2**(t-1),s=2**t,i=Bh(t),o=BigInt(t);return{windows:r,windowSize:n,mask:i,maxNumber:s,shiftBy:o}}function N2(t,e,r){const{windowSize:n,mask:s,maxNumber:i,shiftBy:o}=r;let a=Number(t&s),c=t>>o;a>n&&(a-=i,c+=yc);const l=e*n,u=l+Math.abs(a)-1,d=a===0,h=a<0,p=e%2!==0;return{nextN:c,offset:u,isZero:d,isNeg:h,isNegF:p,offsetF:l}}function QF(t,e){if(!Array.isArray(t))throw new Error("array expected");t.forEach((r,n)=>{if(!(r instanceof e))throw new Error("invalid point at index "+n)})}function eq(t,e){if(!Array.isArray(t))throw new Error("array of scalars expected");t.forEach((r,n)=>{if(!e.isValid(r))throw new Error("invalid scalar at index "+n)})}const Dm=new WeakMap,$T=new WeakMap;function Um(t){return $T.get(t)||1}function O2(t){if(t!==eu)throw new Error("invalid wNAF")}let tq=class{constructor(e,r){this.BASE=e.BASE,this.ZERO=e.ZERO,this.Fn=e.Fn,this.bits=r}_unsafeLadder(e,r,n=this.ZERO){let s=e;for(;r>eu;)r&yc&&(n=n.add(s)),s=s.double(),r>>=yc;return n}precomputeWindow(e,r){const{windows:n,windowSize:s}=Rm(r,this.bits),i=[];let o=e,a=o;for(let c=0;c<n;c++){a=o,i.push(a);for(let l=1;l<s;l++)a=a.add(o),i.push(a);o=a.double()}return i}wNAF(e,r,n){if(!this.Fn.isValid(n))throw new Error("invalid scalar");let s=this.ZERO,i=this.BASE;const o=Rm(e,this.bits);for(let a=0;a<o.windows;a++){const{nextN:c,offset:l,isZero:u,isNeg:d,isNegF:h,offsetF:p}=N2(n,a,o);n=c,u?i=i.add(Qp(h,r[p])):s=s.add(Qp(d,r[l]))}return O2(n),{p:s,f:i}}wNAFUnsafe(e,r,n,s=this.ZERO){const i=Rm(e,this.bits);for(let o=0;o<i.windows&&n!==eu;o++){const{nextN:a,offset:c,isZero:l,isNeg:u}=N2(n,o,i);if(n=a,!l){const d=r[c];s=s.add(u?d.negate():d)}}return O2(n),s}getPrecomputes(e,r,n){let s=Dm.get(r);return s||(s=this.precomputeWindow(r,e),e!==1&&(typeof n=="function"&&(s=n(s)),Dm.set(r,s))),s}cached(e,r,n){const s=Um(e);return this.wNAF(s,this.getPrecomputes(s,e,n),r)}unsafe(e,r,n,s){const i=Um(e);return i===1?this._unsafeLadder(e,r,s):this.wNAFUnsafe(i,this.getPrecomputes(i,e,n),r,s)}createCache(e,r){CT(r,this.bits),$T.set(e,r),Dm.delete(e)}hasCache(e){return Um(e)!==1}};function rq(t,e,r,n){let s=e,i=t.ZERO,o=t.ZERO;for(;r>eu||n>eu;)r&yc&&(i=i.add(s)),n&yc&&(o=o.add(s)),s=s.double(),r>>=yc,n>>=yc;return{p1:i,p2:o}}function nq(t,e,r,n){QF(r,t),eq(n,e);const s=r.length,i=n.length;if(s!==i)throw new Error("arrays of points and scalars must have equal length");const o=t.ZERO,a=gT(BigInt(s));let c=1;a>12?c=a-3:a>4?c=a-2:a>0&&(c=2);const l=Bh(c),u=new Array(Number(l)+1).fill(o),d=Math.floor((e.BITS-1)/c)*c;let h=o;for(let p=d;p>=0;p-=c){u.fill(o);for(let g=0;g<i;g++){const w=n[g],S=Number(w>>BigInt(p)&l);u[S]=u[S].add(r[g])}let y=o;for(let g=u.length-1,w=o;g>0;g--)w=w.add(u[g]),y=y.add(w);if(h=h.add(y),p!==0)for(let g=0;g<c;g++)h=h.double()}return h}function k2(t,e,r){if(e){if(e.ORDER!==t)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return XF(e),e}else return Da(t,{isLE:r})}function sq(t,e,r={},n){if(n===void 0&&(n=t==="edwards"),!e||typeof e!="object")throw new Error(`expected valid ${t} CURVE object`);for(const a of["p","n","h"]){const c=e[a];if(!(typeof c=="bigint"&&c>eu))throw new Error(`CURVE.${a} must be positive bigint`)}const s=k2(e.p,r.Fp,n),i=k2(e.n,r.Fn,n),o=["Gx","Gy","a","b"];for(const a of o)if(!s.isValid(e[a]))throw new Error(`CURVE.${a} must be valid field element of CURVE.Fp`);return e=Object.freeze(Object.assign({},e)),{CURVE:e,Fp:s,Fn:i}}BigInt(0),BigInt(1),BigInt(2),BigInt(8),Z$("HashToScalar-");const Lu=BigInt(0),hl=BigInt(1),Sf=BigInt(2);function iq(t){return ry(t,{adjustScalarBytes:"function",powPminus2:"function"}),Object.freeze({...t})}function oq(t){const e=iq(t),{P:r,type:n,adjustScalarBytes:s,powPminus2:i,randomBytes:o}=e,a=n==="x25519";if(!a&&n!=="x448")throw new Error("invalid type");const c=o||Wc,l=a?255:448,u=a?32:56,d=BigInt(a?9:5),h=BigInt(a?121665:39081),p=a?Sf**BigInt(254):Sf**BigInt(447),y=a?BigInt(8)*Sf**BigInt(251)-hl:BigInt(4)*Sf**BigInt(445)-hl,g=p+y+hl,w=R=>vs(R,r),S=A(d);function A(R){return X1(w(R),u)}function E(R){const T=Cn("u coordinate",R,u);return a&&(T[31]&=127),w(Jp(T))}function v(R){return Jp(s(Cn("scalar",R,u)))}function C(R,T){const k=j(E(T),v(R));if(k===Lu)throw new Error("invalid private or public key received");return A(k)}function O(R){return C(R,S)}function L(R,T,k){const f=w(R*(T-k));return T=w(T-f),k=w(k+f),{x_2:T,x_3:k}}function j(R,T){U0("u",R,Lu,r),U0("scalar",T,p,g);const k=T,f=R;let m=hl,_=Lu,$=R,x=hl,N=Lu;for(let z=BigInt(l-1);z>=Lu;z--){const G=k>>z&hl;N^=G,{x_2:m,x_3:$}=L(N,m,$),{x_2:_,x_3:x}=L(N,_,x),N=G;const M=m+_,V=w(M*M),J=m-_,re=w(J*J),ye=V-re,ne=$+x,se=$-x,Ie=w(se*M),Me=w(ne*J),Ve=Ie+Me,Ze=Ie-Me;$=w(Ve*Ve),x=w(f*w(Ze*Ze)),m=w(V*re),_=w(ye*(V+w(h*ye)))}({x_2:m,x_3:$}=L(N,m,$)),{x_2:_,x_3:x}=L(N,_,x);const H=i(_);return w(m*H)}const D={secretKey:u,publicKey:u,seed:u},W=(R=c(u))=>(bi(R,D.seed),R);function P(R){const T=W(R);return{secretKey:T,publicKey:O(T)}}return{keygen:P,getSharedSecret:(R,T)=>C(R,T),getPublicKey:R=>O(R),scalarMult:C,scalarMultBase:O,utils:{randomSecretKey:W,randomPrivateKey:W},GuBytes:S.slice(),lengths:D}}const aq=BigInt(1),P2=BigInt(2),cq=BigInt(3),lq=BigInt(5);BigInt(8);const TT=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffed"),uq={p:TT,n:BigInt("0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3ed"),a:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffec"),d:BigInt("0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3"),Gx:BigInt("0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a"),Gy:BigInt("0x6666666666666666666666666666666666666666666666666666666666666658")};function dq(t){const e=BigInt(10),r=BigInt(20),n=BigInt(40),s=BigInt(80),i=TT,o=t*t%i*t%i,a=ai(o,P2,i)*o%i,c=ai(a,aq,i)*t%i,l=ai(c,lq,i)*c%i,u=ai(l,e,i)*l%i,d=ai(u,r,i)*u%i,h=ai(d,n,i)*d%i,p=ai(h,s,i)*h%i,y=ai(p,s,i)*h%i,g=ai(y,e,i)*l%i;return{pow_p_5_8:ai(g,P2,i)*t%i,b2:o}}function hq(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}const fq=Da(uq.p,{isLE:!0}),B0=(()=>{const t=fq.ORDER;return oq({P:t,type:"x25519",powPminus2:e=>{const{pow_p_5_8:r,b2:n}=dq(e);return vs(ai(r,cq,t)*n,t)},adjustScalarBytes:hq})})(),R2=(t,e)=>(t+(t>=0?e:-e)/NT)/e;function pq(t,e,r){const[[n,s],[i,o]]=e,a=R2(o*t,r),c=R2(-s*t,r);let l=t-a*n-c*i,u=-a*s-c*o;const d=l<Co,h=u<Co;d&&(l=-l),h&&(u=-u);const p=Bh(Math.ceil(gT(r)/2))+Ml;if(l<Co||l>=p||u<Co||u>=p)throw new Error("splitScalar (endomorphism): failed, k="+t);return{k1neg:d,k1:l,k2neg:h,k2:u}}function L0(t){if(!["compact","recovered","der"].includes(t))throw new Error('Signature format must be "compact", "recovered", or "der"');return t}function Bm(t,e){const r={};for(let n of Object.keys(e))r[n]=t[n]===void 0?e[n]:t[n];return Zp(r.lowS,"lowS"),Zp(r.prehash,"prehash"),r.format!==void 0&&L0(r.format),r}let gq=class extends Error{constructor(e=""){super(e)}};const wo={Err:gq,_tlv:{encode:(t,e)=>{const{Err:r}=wo;if(t<0||t>256)throw new r("tlv.encode: wrong tag");if(e.length&1)throw new r("tlv.encode: unpadded data");const n=e.length/2,s=xf(n);if(s.length/2&128)throw new r("tlv.encode: long form length too big");const i=n>127?xf(s.length/2|128):"";return xf(t)+i+s+e},decode(t,e){const{Err:r}=wo;let n=0;if(t<0||t>256)throw new r("tlv.encode: wrong tag");if(e.length<2||e[n++]!==t)throw new r("tlv.decode: wrong tlv");const s=e[n++],i=!!(s&128);let o=0;if(!i)o=s;else{const c=s&127;if(!c)throw new r("tlv.decode(long): indefinite length not supported");if(c>4)throw new r("tlv.decode(long): byte length is too big");const l=e.subarray(n,n+c);if(l.length!==c)throw new r("tlv.decode: length bytes not complete");if(l[0]===0)throw new r("tlv.decode(long): zero leftmost byte");for(const u of l)o=o<<8|u;if(n+=c,o<128)throw new r("tlv.decode(long): not minimal encoding")}const a=e.subarray(n,n+o);if(a.length!==o)throw new r("tlv.decode: wrong value length");return{v:a,l:e.subarray(n+o)}}},_int:{encode(t){const{Err:e}=wo;if(t<Co)throw new e("integer: negative integers are not allowed");let r=xf(t);if(Number.parseInt(r[0],16)&8&&(r="00"+r),r.length&1)throw new e("unexpected DER parsing assertion: unpadded hex");return r},decode(t){const{Err:e}=wo;if(t[0]&128)throw new e("invalid signature integer: negative");if(t[0]===0&&!(t[1]&128))throw new e("invalid signature integer: unnecessary leading zero");return ty(t)}},toSig(t){const{Err:e,_int:r,_tlv:n}=wo,s=Cn("signature",t),{v:i,l:o}=n.decode(48,s);if(o.length)throw new e("invalid signature: left bytes after parsing");const{v:a,l:c}=n.decode(2,i),{v:l,l:u}=n.decode(2,c);if(u.length)throw new e("invalid signature: left bytes after parsing");return{r:r.decode(a),s:r.decode(l)}},hexFromSig(t){const{_tlv:e,_int:r}=wo,n=e.encode(2,r.encode(t.r)),s=e.encode(2,r.encode(t.s)),i=n+s;return e.encode(48,i)}},Co=BigInt(0),Ml=BigInt(1),NT=BigInt(2),Af=BigInt(3),yq=BigInt(4);function Tl(t,e){const{BYTES:r}=t;let n;if(typeof e=="bigint")n=e;else{let s=Cn("private key",e);try{n=t.fromBytes(s)}catch{throw new Error(`invalid private key: expected ui8a of size ${r}, got ${typeof e}`)}}if(!t.isValidNot0(n))throw new Error("invalid private key: out of range [1..N-1]");return n}function mq(t,e={}){const r=sq("weierstrass",t,e),{Fp:n,Fn:s}=r;let i=r.CURVE;const{h:o,n:a}=i;ry(e,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});const{endo:c}=e;if(c&&(!n.is0(i.a)||typeof c.beta!="bigint"||!Array.isArray(c.basises)))throw new Error('invalid endo: expected "beta": bigint and "basises": array');const l=kT(n,s);function u(){if(!n.isOdd)throw new Error("compression is not supported: Field does not have .isOdd()")}function d(R,T,k){const{x:f,y:m}=T.toAffine(),_=n.toBytes(f);if(Zp(k,"isCompressed"),k){u();const $=!n.isOdd(m);return fa(OT($),_)}else return fa(Uint8Array.of(4),_,n.toBytes(m))}function h(R){pc(R,void 0,"Point");const{publicKey:T,publicKeyUncompressed:k}=l,f=R.length,m=R[0],_=R.subarray(1);if(f===T&&(m===2||m===3)){const $=n.fromBytes(_);if(!n.isValid($))throw new Error("bad point: is not on curve, wrong x");const x=g($);let N;try{N=n.sqrt(x)}catch(z){const G=z instanceof Error?": "+z.message:"";throw new Error("bad point: is not on curve, sqrt error"+G)}u();const H=n.isOdd(N);return(m&1)===1!==H&&(N=n.neg(N)),{x:$,y:N}}else if(f===k&&m===4){const $=n.BYTES,x=n.fromBytes(_.subarray(0,$)),N=n.fromBytes(_.subarray($,$*2));if(!w(x,N))throw new Error("bad point: is not on curve");return{x,y:N}}else throw new Error(`bad point: got length ${f}, expected compressed=${T} or uncompressed=${k}`)}const p=e.toBytes||d,y=e.fromBytes||h;function g(R){const T=n.sqr(R),k=n.mul(T,R);return n.add(n.add(k,n.mul(R,i.a)),i.b)}function w(R,T){const k=n.sqr(T),f=g(R);return n.eql(k,f)}if(!w(i.Gx,i.Gy))throw new Error("bad curve params: generator point");const S=n.mul(n.pow(i.a,Af),yq),A=n.mul(n.sqr(i.b),BigInt(27));if(n.is0(n.add(S,A)))throw new Error("bad curve params: a or b");function E(R,T,k=!1){if(!n.isValid(T)||k&&n.is0(T))throw new Error(`bad point coordinate ${R}`);return T}function v(R){if(!(R instanceof D))throw new Error("ProjectivePoint expected")}function C(R){if(!c||!c.basises)throw new Error("no endo");return pq(R,c.basises,s.ORDER)}const O=C2((R,T)=>{const{X:k,Y:f,Z:m}=R;if(n.eql(m,n.ONE))return{x:k,y:f};const _=R.is0();T==null&&(T=_?n.ONE:n.inv(m));const $=n.mul(k,T),x=n.mul(f,T),N=n.mul(m,T);if(_)return{x:n.ZERO,y:n.ZERO};if(!n.eql(N,n.ONE))throw new Error("invZ was invalid");return{x:$,y:x}}),L=C2(R=>{if(R.is0()){if(e.allowInfinityPoint&&!n.is0(R.Y))return;throw new Error("bad point: ZERO")}const{x:T,y:k}=R.toAffine();if(!n.isValid(T)||!n.isValid(k))throw new Error("bad point: x or y not field elements");if(!w(T,k))throw new Error("bad point: equation left != right");if(!R.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});function j(R,T,k,f,m){return k=new D(n.mul(k.X,R),k.Y,k.Z),T=Qp(f,T),k=Qp(m,k),T.add(k)}class D{constructor(T,k,f){this.X=E("x",T),this.Y=E("y",k,!0),this.Z=E("z",f),Object.freeze(this)}static CURVE(){return i}static fromAffine(T){const{x:k,y:f}=T||{};if(!T||!n.isValid(k)||!n.isValid(f))throw new Error("invalid affine point");if(T instanceof D)throw new Error("projective point not allowed");return n.is0(k)&&n.is0(f)?D.ZERO:new D(k,f,n.ONE)}static fromBytes(T){const k=D.fromAffine(y(pc(T,void 0,"point")));return k.assertValidity(),k}static fromHex(T){return D.fromBytes(Cn("pointHex",T))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(T=8,k=!0){return P.createCache(this,T),k||this.multiply(Af),this}assertValidity(){L(this)}hasEvenY(){const{y:T}=this.toAffine();if(!n.isOdd)throw new Error("Field doesn't support isOdd");return!n.isOdd(T)}equals(T){v(T);const{X:k,Y:f,Z:m}=this,{X:_,Y:$,Z:x}=T,N=n.eql(n.mul(k,x),n.mul(_,m)),H=n.eql(n.mul(f,x),n.mul($,m));return N&&H}negate(){return new D(this.X,n.neg(this.Y),this.Z)}double(){const{a:T,b:k}=i,f=n.mul(k,Af),{X:m,Y:_,Z:$}=this;let x=n.ZERO,N=n.ZERO,H=n.ZERO,z=n.mul(m,m),G=n.mul(_,_),M=n.mul($,$),V=n.mul(m,_);return V=n.add(V,V),H=n.mul(m,$),H=n.add(H,H),x=n.mul(T,H),N=n.mul(f,M),N=n.add(x,N),x=n.sub(G,N),N=n.add(G,N),N=n.mul(x,N),x=n.mul(V,x),H=n.mul(f,H),M=n.mul(T,M),V=n.sub(z,M),V=n.mul(T,V),V=n.add(V,H),H=n.add(z,z),z=n.add(H,z),z=n.add(z,M),z=n.mul(z,V),N=n.add(N,z),M=n.mul(_,$),M=n.add(M,M),z=n.mul(M,V),x=n.sub(x,z),H=n.mul(M,G),H=n.add(H,H),H=n.add(H,H),new D(x,N,H)}add(T){v(T);const{X:k,Y:f,Z:m}=this,{X:_,Y:$,Z:x}=T;let N=n.ZERO,H=n.ZERO,z=n.ZERO;const G=i.a,M=n.mul(i.b,Af);let V=n.mul(k,_),J=n.mul(f,$),re=n.mul(m,x),ye=n.add(k,f),ne=n.add(_,$);ye=n.mul(ye,ne),ne=n.add(V,J),ye=n.sub(ye,ne),ne=n.add(k,m);let se=n.add(_,x);return ne=n.mul(ne,se),se=n.add(V,re),ne=n.sub(ne,se),se=n.add(f,m),N=n.add($,x),se=n.mul(se,N),N=n.add(J,re),se=n.sub(se,N),z=n.mul(G,ne),N=n.mul(M,re),z=n.add(N,z),N=n.sub(J,z),z=n.add(J,z),H=n.mul(N,z),J=n.add(V,V),J=n.add(J,V),re=n.mul(G,re),ne=n.mul(M,ne),J=n.add(J,re),re=n.sub(V,re),re=n.mul(G,re),ne=n.add(ne,re),V=n.mul(J,ne),H=n.add(H,V),V=n.mul(se,ne),N=n.mul(ye,N),N=n.sub(N,V),V=n.mul(ye,J),z=n.mul(se,z),z=n.add(z,V),new D(N,H,z)}subtract(T){return this.add(T.negate())}is0(){return this.equals(D.ZERO)}multiply(T){const{endo:k}=e;if(!s.isValidNot0(T))throw new Error("invalid scalar: out of range");let f,m;const _=$=>P.cached(this,$,x=>Pm(D,x));if(k){const{k1neg:$,k1:x,k2neg:N,k2:H}=C(T),{p:z,f:G}=_(x),{p:M,f:V}=_(H);m=G.add(V),f=j(k.beta,z,M,$,N)}else{const{p:$,f:x}=_(T);f=$,m=x}return Pm(D,[f,m])[0]}multiplyUnsafe(T){const{endo:k}=e,f=this;if(!s.isValid(T))throw new Error("invalid scalar: out of range");if(T===Co||f.is0())return D.ZERO;if(T===Ml)return f;if(P.hasCache(this))return this.multiply(T);if(k){const{k1neg:m,k1:_,k2neg:$,k2:x}=C(T),{p1:N,p2:H}=rq(D,f,_,x);return j(k.beta,N,H,m,$)}else return P.unsafe(f,T)}multiplyAndAddUnsafe(T,k,f){const m=this.multiplyUnsafe(k).add(T.multiplyUnsafe(f));return m.is0()?void 0:m}toAffine(T){return O(this,T)}isTorsionFree(){const{isTorsionFree:T}=e;return o===Ml?!0:T?T(D,this):P.unsafe(this,a).is0()}clearCofactor(){const{clearCofactor:T}=e;return o===Ml?this:T?T(D,this):this.multiplyUnsafe(o)}isSmallOrder(){return this.multiplyUnsafe(o).is0()}toBytes(T=!0){return Zp(T,"isCompressed"),this.assertValidity(),p(D,this,T)}toHex(T=!0){return Ll(this.toBytes(T))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}get px(){return this.X}get py(){return this.X}get pz(){return this.Z}toRawBytes(T=!0){return this.toBytes(T)}_setWindowSize(T){this.precompute(T)}static normalizeZ(T){return Pm(D,T)}static msm(T,k){return nq(D,s,T,k)}static fromPrivateKey(T){return D.BASE.multiply(Tl(s,T))}}D.BASE=new D(i.Gx,i.Gy,n.ONE),D.ZERO=new D(n.ZERO,n.ONE,n.ZERO),D.Fp=n,D.Fn=s;const W=s.BITS,P=new tq(D,e.endo?Math.ceil(W/2):W);return D.BASE.precompute(8),D}function OT(t){return Uint8Array.of(t?2:3)}function kT(t,e){return{secretKey:e.BYTES,publicKey:1+t.BYTES,publicKeyUncompressed:1+2*t.BYTES,publicKeyHasPrefix:!0,signature:2*e.BYTES}}function wq(t,e={}){const{Fn:r}=t,n=e.randomBytes||Wc,s=Object.assign(kT(t.Fp,r),{seed:IT(r.ORDER)});function i(h){try{return!!Tl(r,h)}catch{return!1}}function o(h,p){const{publicKey:y,publicKeyUncompressed:g}=s;try{const w=h.length;return p===!0&&w!==y||p===!1&&w!==g?!1:!!t.fromBytes(h)}catch{return!1}}function a(h=n(s.seed)){return JF(pc(h,s.seed,"seed"),r.ORDER)}function c(h,p=!0){return t.BASE.multiply(Tl(r,h)).toBytes(p)}function l(h){const p=a(h);return{secretKey:p,publicKey:c(p)}}function u(h){if(typeof h=="bigint")return!1;if(h instanceof t)return!0;const{secretKey:p,publicKey:y,publicKeyUncompressed:g}=s;if(r.allowedLengths||p===y)return;const w=Cn("key",h).length;return w===y||w===g}function d(h,p,y=!0){if(u(h)===!0)throw new Error("first arg must be private key");if(u(p)===!1)throw new Error("second arg must be public key");const g=Tl(r,h);return t.fromHex(p).multiply(g).toBytes(y)}return Object.freeze({getPublicKey:c,getSharedSecret:d,keygen:l,Point:t,utils:{isValidSecretKey:i,isValidPublicKey:o,randomSecretKey:a,isValidPrivateKey:i,randomPrivateKey:a,normPrivateKeyToScalar:h=>Tl(r,h),precompute(h=8,p=t.BASE){return p.precompute(h,!1)}},lengths:s})}function bq(t,e,r={}){Yg(e),ry(r,{},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"});const n=r.randomBytes||Wc,s=r.hmac||((k,...f)=>Qg(e,k,fa(...f))),{Fp:i,Fn:o}=t,{ORDER:a,BITS:c}=o,{keygen:l,getPublicKey:u,getSharedSecret:d,utils:h,lengths:p}=wq(t,r),y={prehash:!1,lowS:typeof r.lowS=="boolean"?r.lowS:!1,format:void 0,extraEntropy:!1},g="compact";function w(k){const f=a>>Ml;return k>f}function S(k,f){if(!o.isValidNot0(f))throw new Error(`invalid signature ${k}: out of range 1..Point.Fn.ORDER`);return f}function A(k,f){L0(f);const m=p.signature,_=f==="compact"?m:f==="recovered"?m+1:void 0;return pc(k,_,`${f} signature`)}class E{constructor(f,m,_){this.r=S("r",f),this.s=S("s",m),_!=null&&(this.recovery=_),Object.freeze(this)}static fromBytes(f,m=g){A(f,m);let _;if(m==="der"){const{r:H,s:z}=wo.toSig(pc(f));return new E(H,z)}m==="recovered"&&(_=f[0],m="compact",f=f.subarray(1));const $=o.BYTES,x=f.subarray(0,$),N=f.subarray($,$*2);return new E(o.fromBytes(x),o.fromBytes(N),_)}static fromHex(f,m){return this.fromBytes(Yp(f),m)}addRecoveryBit(f){return new E(this.r,this.s,f)}recoverPublicKey(f){const m=i.ORDER,{r:_,s:$,recovery:x}=this;if(x==null||![0,1,2,3].includes(x))throw new Error("recovery id invalid");if(a*NT<m&&x>1)throw new Error("recovery id is ambiguous for h>1 curve");const N=x===2||x===3?_+a:_;if(!i.isValid(N))throw new Error("recovery id 2 or 3 invalid");const H=i.toBytes(N),z=t.fromBytes(fa(OT((x&1)===0),H)),G=o.inv(N),M=C(Cn("msgHash",f)),V=o.create(-M*G),J=o.create($*G),re=t.BASE.multiplyUnsafe(V).add(z.multiplyUnsafe(J));if(re.is0())throw new Error("point at infinify");return re.assertValidity(),re}hasHighS(){return w(this.s)}toBytes(f=g){if(L0(f),f==="der")return Yp(wo.hexFromSig(this));const m=o.toBytes(this.r),_=o.toBytes(this.s);if(f==="recovered"){if(this.recovery==null)throw new Error("recovery bit must be present");return fa(Uint8Array.of(this.recovery),m,_)}return fa(m,_)}toHex(f){return Ll(this.toBytes(f))}assertValidity(){}static fromCompact(f){return E.fromBytes(Cn("sig",f),"compact")}static fromDER(f){return E.fromBytes(Cn("sig",f),"der")}normalizeS(){return this.hasHighS()?new E(this.r,o.neg(this.s),this.recovery):this}toDERRawBytes(){return this.toBytes("der")}toDERHex(){return Ll(this.toBytes("der"))}toCompactRawBytes(){return this.toBytes("compact")}toCompactHex(){return Ll(this.toBytes("compact"))}}const v=r.bits2int||function(k){if(k.length>8192)throw new Error("input is too large");const f=ty(k),m=k.length*8-c;return m>0?f>>BigInt(m):f},C=r.bits2int_modN||function(k){return o.create(v(k))},O=Bh(c);function L(k){return U0("num < 2^"+c,k,Co,O),o.toBytes(k)}function j(k,f){return pc(k,void 0,"message"),f?pc(e(k),void 0,"prehashed message"):k}function D(k,f,m){if(["recovered","canonical"].some(J=>J in m))throw new Error("sign() legacy options not supported");const{lowS:_,prehash:$,extraEntropy:x}=Bm(m,y);k=j(k,$);const N=C(k),H=Tl(o,f),z=[L(H),L(N)];if(x!=null&&x!==!1){const J=x===!0?n(p.secretKey):x;z.push(Cn("extraEntropy",J))}const G=fa(...z),M=N;function V(J){const re=v(J);if(!o.isValidNot0(re))return;const ye=o.inv(re),ne=t.BASE.multiply(re).toAffine(),se=o.create(ne.x);if(se===Co)return;const Ie=o.create(ye*o.create(M+se*H));if(Ie===Co)return;let Me=(ne.x===se?0:2)|Number(ne.y&Ml),Ve=Ie;return _&&w(Ie)&&(Ve=o.neg(Ie),Me^=1),new E(se,Ve,Me)}return{seed:G,k2sig:V}}function W(k,f,m={}){k=Cn("message",k);const{seed:_,k2sig:$}=D(k,f,m);return zF(e.outputLen,o.BYTES,s)(_,$)}function P(k){let f;const m=typeof k=="string"||Gg(k),_=!m&&k!==null&&typeof k=="object"&&typeof k.r=="bigint"&&typeof k.s=="bigint";if(!m&&!_)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");if(_)f=new E(k.r,k.s);else if(m){try{f=E.fromBytes(Cn("sig",k),"der")}catch($){if(!($ instanceof wo.Err))throw $}if(!f)try{f=E.fromBytes(Cn("sig",k),"compact")}catch{return!1}}return f||!1}function R(k,f,m,_={}){const{lowS:$,prehash:x,format:N}=Bm(_,y);if(m=Cn("publicKey",m),f=j(Cn("message",f),x),"strict"in _)throw new Error("options.strict was renamed to lowS");const H=N===void 0?P(k):E.fromBytes(Cn("sig",k),N);if(H===!1)return!1;try{const z=t.fromBytes(m);if($&&H.hasHighS())return!1;const{r:G,s:M}=H,V=C(f),J=o.inv(M),re=o.create(V*J),ye=o.create(G*J),ne=t.BASE.multiplyUnsafe(re).add(z.multiplyUnsafe(ye));return ne.is0()?!1:o.create(ne.x)===G}catch{return!1}}function T(k,f,m={}){const{prehash:_}=Bm(m,y);return f=j(f,_),E.fromBytes(k,"recovered").recoverPublicKey(f).toBytes()}return Object.freeze({keygen:l,getPublicKey:u,getSharedSecret:d,utils:h,lengths:p,Point:t,sign:W,verify:R,recoverPublicKey:T,Signature:E,hash:e})}function vq(t){const e={a:t.a,b:t.b,p:t.Fp.ORDER,n:t.n,h:t.h,Gx:t.Gx,Gy:t.Gy},r=t.Fp;let n=t.allowedPrivateKeyLengths?Array.from(new Set(t.allowedPrivateKeyLengths.map(o=>Math.ceil(o/2)))):void 0;const s=Da(e.n,{BITS:t.nBitLength,allowedLengths:n,modFromBytes:t.wrapPrivateKey}),i={Fp:r,Fn:s,allowInfinityPoint:t.allowInfinityPoint,endo:t.endo,isTorsionFree:t.isTorsionFree,clearCofactor:t.clearCofactor,fromBytes:t.fromBytes,toBytes:t.toBytes};return{CURVE:e,curveOpts:i}}function Eq(t){const{CURVE:e,curveOpts:r}=vq(t),n={hmac:t.hmac,randomBytes:t.randomBytes,lowS:t.lowS,bits2int:t.bits2int,bits2int_modN:t.bits2int_modN};return{CURVE:e,curveOpts:r,hash:t.hash,ecdsaOpts:n}}function _q(t,e){const r=e.Point;return Object.assign({},e,{ProjectivePoint:r,CURVE:Object.assign({},t,ST(r.Fn.ORDER,r.Fn.BITS))})}function xq(t){const{CURVE:e,curveOpts:r,hash:n,ecdsaOpts:s}=Eq(t),i=mq(e,r),o=bq(i,n,s);return _q(t,o)}function M0(t,e){const r=n=>xq({...t,hash:n});return{...r(e),create:r}}const PT={p:BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff"),n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),h:BigInt(1),a:BigInt("0xffffffff00000001000000000000000000000000fffffffffffffffffffffffc"),b:BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5")},RT={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000ffffffff"),n:BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973"),h:BigInt(1),a:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000fffffffc"),b:BigInt("0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef"),Gx:BigInt("0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7"),Gy:BigInt("0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f")},DT={p:BigInt("0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),n:BigInt("0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa51868783bf2f966b7fcc0148f709a5d03bb5c9b8899c47aebb6fb71e91386409"),h:BigInt(1),a:BigInt("0x1fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc"),b:BigInt("0x0051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00"),Gx:BigInt("0x00c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66"),Gy:BigInt("0x011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650")},Sq=Da(PT.p),Aq=Da(RT.p),Iq=Da(DT.p),Cq=M0({...PT,Fp:Sq,lowS:!1},Zg);M0({...RT,Fp:Aq,lowS:!1},kj),M0({...DT,Fp:Iq,lowS:!1,allowedPrivateKeyLengths:[130,131,132]},Oj);const $q=Cq,UT="base10",Pn="base16",Xn="base64pad",pa="base64url",Lh="utf8",BT=0,No=1,Mh=2,Tq=0,D2=1,yd=12,J1=32;function Nq(){const t=B0.utils.randomPrivateKey(),e=B0.getPublicKey(t);return{privateKey:jt(t,Pn),publicKey:jt(e,Pn)}}function j0(){const t=Wc(J1);return jt(t,Pn)}function Oq(t,e){const r=B0.getSharedSecret(tr(t,Pn),tr(e,Pn)),n=FF(ey,r,void 0,void 0,J1);return jt(n,Pn)}function dp(t){const e=ey(tr(t,Pn));return jt(e,Pn)}function Vs(t){const e=ey(tr(t,Lh));return jt(e,Pn)}function LT(t){return tr(`${t}`,UT)}function Dc(t){return Number(jt(t,UT))}function MT(t){return t.replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function jT(t){const e=t.replace(/-/g,"+").replace(/_/g,"/"),r=(4-e.length%4)%4;return e+"=".repeat(r)}function kq(t){const e=LT(typeof t.type<"u"?t.type:BT);if(Dc(e)===No&&typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const r=typeof t.senderPublicKey<"u"?tr(t.senderPublicKey,Pn):void 0,n=typeof t.iv<"u"?tr(t.iv,Pn):Wc(yd),s=tr(t.symKey,Pn),i=hT(s,n).encrypt(tr(t.message,Lh)),o=FT({type:e,sealed:i,iv:n,senderPublicKey:r});return t.encoding===pa?MT(o):o}function Pq(t){const e=tr(t.symKey,Pn),{sealed:r,iv:n}=Fd({encoded:t.encoded,encoding:t.encoding}),s=hT(e,n).decrypt(r);if(s===null)throw new Error("Failed to decrypt");return jt(s,Lh)}function Rq(t,e){const r=LT(Mh),n=Wc(yd),s=tr(t,Lh),i=FT({type:r,sealed:s,iv:n});return e===pa?MT(i):i}function Dq(t,e){const{sealed:r}=Fd({encoded:t,encoding:e});return jt(r,Lh)}function FT(t){if(Dc(t.type)===Mh)return jt(Fi([t.type,t.sealed]),Xn);if(Dc(t.type)===No){if(typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return jt(Fi([t.type,t.senderPublicKey,t.iv,t.sealed]),Xn)}return jt(Fi([t.type,t.iv,t.sealed]),Xn)}function Fd(t){const e=(t.encoding||Xn)===pa?jT(t.encoded):t.encoded,r=tr(e,Xn),n=r.slice(Tq,D2),s=D2;if(Dc(n)===No){const c=s+J1,l=c+yd,u=r.slice(s,c),d=r.slice(c,l),h=r.slice(l);return{type:n,sealed:h,iv:d,senderPublicKey:u}}if(Dc(n)===Mh){const c=r.slice(s),l=Wc(yd);return{type:n,sealed:c,iv:l}}const i=s+yd,o=r.slice(s,i),a=r.slice(i);return{type:n,sealed:a,iv:o}}function Uq(t,e){const r=Fd({encoded:t,encoding:e?.encoding});return qT({type:Dc(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?jt(r.senderPublicKey,Pn):void 0,receiverPublicKey:e?.receiverPublicKey})}function qT(t){const e=t?.type||BT;if(e===No){if(typeof t?.senderPublicKey>"u")throw new Error("missing sender public key");if(typeof t?.receiverPublicKey>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:t?.senderPublicKey,receiverPublicKey:t?.receiverPublicKey}}function U2(t){return t.type===No&&typeof t.senderPublicKey=="string"&&typeof t.receiverPublicKey=="string"}function B2(t){return t.type===Mh}function Bq(t){const e=Buffer.from(t.x,"base64"),r=Buffer.from(t.y,"base64");return Fi([new Uint8Array([4]),e,r])}function Lq(t,e){const[r,n,s]=t.split("."),i=Buffer.from(jT(s),"base64");if(i.length!==64)throw new Error("Invalid signature length");const o=i.slice(0,32),a=i.slice(32,64),c=`${r}.${n}`,l=ey(c),u=Bq(e);if(!$q.verify(Fi([o,a]),l,u))throw new Error("Invalid signature");return Xl(t).payload}const Mq="irn";function eg(t){return t?.relay||{protocol:Mq}}function Nl(t){const e=B$[t];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${t}`);return e}var jq=Object.defineProperty,Fq=Object.defineProperties,qq=Object.getOwnPropertyDescriptors,L2=Object.getOwnPropertySymbols,zq=Object.prototype.hasOwnProperty,Hq=Object.prototype.propertyIsEnumerable,M2=(t,e,r)=>e in t?jq(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Lm=(t,e)=>{for(var r in e||(e={}))zq.call(e,r)&&M2(t,r,e[r]);if(L2)for(var r of L2(e))Hq.call(e,r)&&M2(t,r,e[r]);return t},Wq=(t,e)=>Fq(t,qq(e));function Vq(t,e="-"){const r={},n="relay"+e;return Object.keys(t).forEach(s=>{if(s.startsWith(n)){const i=s.replace(n,""),o=t[s];r[i]=o}}),r}function j2(t){if(!t.includes("wc:")){const l=W$(t);l!=null&&l.includes("wc:")&&(t=l)}t=t.includes("wc://")?t.replace("wc://",""):t,t=t.includes("wc:")?t.replace("wc:",""):t;const e=t.indexOf(":"),r=t.indexOf("?")!==-1?t.indexOf("?"):void 0,n=t.substring(0,e),s=t.substring(e+1,r).split("@"),i=typeof r<"u"?t.substring(r):"",o=new URLSearchParams(i),a=Object.fromEntries(o.entries()),c=typeof a.methods=="string"?a.methods.split(","):void 0;return{protocol:n,topic:Kq(s[0]),version:parseInt(s[1],10),symKey:a.symKey,relay:Vq(a),methods:c,expiryTimestamp:a.expiryTimestamp?parseInt(a.expiryTimestamp,10):void 0}}function Kq(t){return t.startsWith("//")?t.substring(2):t}function Gq(t,e="-"){const r="relay",n={};return Object.keys(t).forEach(s=>{const i=s,o=r+e+i;t[i]&&(n[o]=t[i])}),n}function F2(t){const e=new URLSearchParams,r=Lm(Lm(Wq(Lm({},Gq(t.relay)),{symKey:t.symKey}),t.expiryTimestamp&&{expiryTimestamp:t.expiryTimestamp.toString()}),t.methods&&{methods:t.methods.join(",")});return Object.entries(r).sort(([n],[s])=>n.localeCompare(s)).forEach(([n,s])=>{s!==void 0&&e.append(n,String(s))}),`${t.protocol}:${t.topic}@${t.version}?${e}`}function If(t,e,r){return`${t}?wc_ev=${r}&topic=${e}`}var Yq=Object.defineProperty,Xq=Object.defineProperties,Zq=Object.getOwnPropertyDescriptors,q2=Object.getOwnPropertySymbols,Jq=Object.prototype.hasOwnProperty,Qq=Object.prototype.propertyIsEnumerable,z2=(t,e,r)=>e in t?Yq(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ez=(t,e)=>{for(var r in e||(e={}))Jq.call(e,r)&&z2(t,r,e[r]);if(q2)for(var r of q2(e))Qq.call(e,r)&&z2(t,r,e[r]);return t},tz=(t,e)=>Xq(t,Zq(e));function gu(t){const e=[];return t.forEach(r=>{const[n,s]=r.split(":");e.push(`${n}:${s}`)}),e}function zT(t){const e=[];return Object.values(t).forEach(r=>{e.push(...gu(r.accounts))}),[...new Set(e)]}function rz(t){const e=[];return Object.values(t).forEach(r=>{e.push(...r.methods)}),[...new Set(e)]}function nz(t){const e=[];return Object.values(t).forEach(r=>{e.push(...r.events)}),[...new Set(e)]}function sz(t,e){const r=[];return Object.values(t).forEach(n=>{gu(n.accounts).includes(e)&&r.push(...n.methods)}),r}function iz(t,e){const r=[];return Object.values(t).forEach(n=>{gu(n.accounts).includes(e)&&r.push(...n.events)}),r}function HT(t){return t.includes(":")}function oz(t){return HT(t)?t.split(":")[0]:t}function H2(t){var e,r,n;const s={};if(!qd(t))return s;for(const[i,o]of Object.entries(t)){const a=HT(i)?[i]:o.chains,c=o.methods||[],l=o.events||[],u=oz(i);s[u]=tz(ez({},s[u]),{chains:Cc(a,(e=s[u])==null?void 0:e.chains),methods:Cc(c,(r=s[u])==null?void 0:r.methods),events:Cc(l,(n=s[u])==null?void 0:n.events)})}return s}function az(t){const e={};return t?.forEach(r=>{var n;const[s,i]=r.split(":");e[s]||(e[s]={accounts:[],chains:[],events:[],methods:[]}),e[s].accounts.push(r),(n=e[s].chains)==null||n.push(`${s}:${i}`)}),e}function W2(t,e){e=e.map(n=>n.replace("did:pkh:",""));const r=az(e);for(const[n,s]of Object.entries(r))s.methods?s.methods=Cc(s.methods,t):s.methods=t,s.events=["chainChanged","accountsChanged"];return r}function cz(t,e){var r,n,s,i,o,a;const c=H2(t),l=H2(e),u={},d=Object.keys(c).concat(Object.keys(l));for(const h of d)u[h]={chains:Cc((r=c[h])==null?void 0:r.chains,(n=l[h])==null?void 0:n.chains),methods:Cc((s=c[h])==null?void 0:s.methods,(i=l[h])==null?void 0:i.methods),events:Cc((o=c[h])==null?void 0:o.events,(a=l[h])==null?void 0:a.events)};return u}const lz={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},uz={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function we(t,e){const{message:r,code:n}=uz[t];return{message:e?`${r} ${e}`:r,code:n}}function lr(t,e){const{message:r,code:n}=lz[t];return{message:e?`${r} ${e}`:r,code:n}}function tu(t,e){return Array.isArray(t)?typeof e<"u"&&t.length?t.every(e):!0:!1}function qd(t){return Object.getPrototypeOf(t)===Object.prototype&&Object.keys(t).length}function Kr(t){return typeof t>"u"}function xr(t,e){return e&&Kr(t)?!0:typeof t=="string"&&!!t.trim().length}function Q1(t,e){return typeof t=="number"&&!isNaN(t)}function dz(t,e){const{requiredNamespaces:r}=e,n=Object.keys(t.namespaces),s=Object.keys(r);let i=!0;return fc(s,n)?(n.forEach(o=>{const{accounts:a,methods:c,events:l}=t.namespaces[o],u=gu(a),d=r[o];(!fc(j$(o,d),u)||!fc(d.methods,c)||!fc(d.events,l))&&(i=!1)}),i):!1}function tg(t){return xr(t,!1)&&t.includes(":")?t.split(":").length===2:!1}function hz(t){if(xr(t,!1)&&t.includes(":")){const e=t.split(":");if(e.length===3){const r=e[0]+":"+e[1];return!!e[2]&&tg(r)}}return!1}function fz(t){function e(r){try{return typeof new URL(r)<"u"}catch{return!1}}try{if(xr(t,!1)){if(e(t))return!0;const r=W$(t);return e(r)}}catch{}return!1}function pz(t){var e;return(e=t?.proposer)==null?void 0:e.publicKey}function gz(t){return t?.topic}function yz(t,e){let r=null;return xr(t?.publicKey,!1)||(r=we("MISSING_OR_INVALID",`${e} controller public key should be a string`)),r}function V2(t){let e=!0;return tu(t)?t.length&&(e=t.every(r=>xr(r,!1))):e=!1,e}function mz(t,e,r){let n=null;return tu(e)&&e.length?e.forEach(s=>{n||tg(s)||(n=lr("UNSUPPORTED_CHAINS",`${r}, chain ${s} should be a string and conform to "namespace:chainId" format`))}):tg(t)||(n=lr("UNSUPPORTED_CHAINS",`${r}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),n}function wz(t,e,r){let n=null;return Object.entries(t).forEach(([s,i])=>{if(n)return;const o=mz(s,j$(s,i),`${e} ${r}`);o&&(n=o)}),n}function bz(t,e){let r=null;return tu(t)?t.forEach(n=>{r||hz(n)||(r=lr("UNSUPPORTED_ACCOUNTS",`${e}, account ${n} should be a string and conform to "namespace:chainId:address" format`))}):r=lr("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),r}function vz(t,e){let r=null;return Object.values(t).forEach(n=>{if(r)return;const s=bz(n?.accounts,`${e} namespace`);s&&(r=s)}),r}function Ez(t,e){let r=null;return V2(t?.methods)?V2(t?.events)||(r=lr("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):r=lr("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),r}function WT(t,e){let r=null;return Object.values(t).forEach(n=>{if(r)return;const s=Ez(n,`${e}, namespace`);s&&(r=s)}),r}function _z(t,e,r){let n=null;if(t&&qd(t)){const s=WT(t,e);s&&(n=s);const i=wz(t,e,r);i&&(n=i)}else n=we("MISSING_OR_INVALID",`${e}, ${r} should be an object with data`);return n}function Mm(t,e){let r=null;if(t&&qd(t)){const n=WT(t,e);n&&(r=n);const s=vz(t,e);s&&(r=s)}else r=we("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return r}function VT(t){return xr(t.protocol,!0)}function xz(t,e){let r=!1;return t?t&&tu(t)&&t.length&&t.forEach(n=>{r=VT(n)}):r=!0,r}function Sz(t){return typeof t=="number"}function Wn(t){return typeof t<"u"&&typeof t!==null}function Az(t){return!(!t||typeof t!="object"||!t.code||!Q1(t.code)||!t.message||!xr(t.message,!1))}function Iz(t){return!(Kr(t)||!xr(t.method,!1))}function Cz(t){return!(Kr(t)||Kr(t.result)&&Kr(t.error)||!Q1(t.id)||!xr(t.jsonrpc,!1))}function $z(t){return!(Kr(t)||!xr(t.name,!1))}function K2(t,e){return!(!tg(e)||!zT(t).includes(e))}function Tz(t,e,r){return xr(r,!1)?sz(t,e).includes(r):!1}function Nz(t,e,r){return xr(r,!1)?iz(t,e).includes(r):!1}function G2(t,e,r){let n=null;const s=Oz(t),i=kz(e),o=Object.keys(s),a=Object.keys(i),c=Y2(Object.keys(t)),l=Y2(Object.keys(e)),u=c.filter(d=>!l.includes(d));return u.length&&(n=we("NON_CONFORMING_NAMESPACES",`${r} namespaces keys don't satisfy requiredNamespaces.
      Required: ${u.toString()}
      Received: ${Object.keys(e).toString()}`)),fc(o,a)||(n=we("NON_CONFORMING_NAMESPACES",`${r} namespaces chains don't satisfy required namespaces.
      Required: ${o.toString()}
      Approved: ${a.toString()}`)),Object.keys(e).forEach(d=>{if(!d.includes(":")||n)return;const h=gu(e[d].accounts);h.includes(d)||(n=we("NON_CONFORMING_NAMESPACES",`${r} namespaces accounts don't satisfy namespace accounts for ${d}
        Required: ${d}
        Approved: ${h.toString()}`))}),o.forEach(d=>{n||(fc(s[d].methods,i[d].methods)?fc(s[d].events,i[d].events)||(n=we("NON_CONFORMING_NAMESPACES",`${r} namespaces events don't satisfy namespace events for ${d}`)):n=we("NON_CONFORMING_NAMESPACES",`${r} namespaces methods don't satisfy namespace methods for ${d}`))}),n}function Oz(t){const e={};return Object.keys(t).forEach(r=>{var n;r.includes(":")?e[r]=t[r]:(n=t[r].chains)==null||n.forEach(s=>{e[s]={methods:t[r].methods,events:t[r].events}})}),e}function Y2(t){return[...new Set(t.map(e=>e.includes(":")?e.split(":")[0]:e))]}function kz(t){const e={};return Object.keys(t).forEach(r=>{r.includes(":")?e[r]=t[r]:gu(t[r].accounts)?.forEach(s=>{e[s]={accounts:t[r].accounts.filter(i=>i.includes(`${s}:`)),methods:t[r].methods,events:t[r].events}})}),e}function Pz(t,e){return Q1(t)&&t<=e.max&&t>=e.min}function X2(){const t=Dh();return new Promise(e=>{switch(t){case As.browser:e(Rz());break;case As.reactNative:e(Dz());break;case As.node:e(Uz());break;default:e(!0)}})}function Rz(){return pu()&&navigator?.onLine}async function Dz(){return Ra()&&typeof global<"u"&&global!=null&&global.NetInfo?(await(global==null?void 0:global.NetInfo.fetch()))?.isConnected:!0}function Uz(){return!0}function Bz(t){switch(Dh()){case As.browser:Lz(t);break;case As.reactNative:Mz(t);break}}function Lz(t){!Ra()&&pu()&&(window.addEventListener("online",()=>t(!0)),window.addEventListener("offline",()=>t(!1)))}function Mz(t){Ra()&&typeof global<"u"&&global!=null&&global.NetInfo&&global?.NetInfo.addEventListener(e=>t(e?.isConnected))}function jz(){var t;return pu()&&Xr.getDocument()?((t=Xr.getDocument())==null?void 0:t.visibilityState)==="visible":!0}const jm={};let Mu=class{static get(e){return jm[e]}static set(e,r){jm[e]=r}static delete(e){delete jm[e]}};function Fz(t){const e=Ph.decode(t);if(e.length<33)throw new Error("Too short to contain a public key");return e.slice(1,33)}function qz({publicKey:t,signature:e,payload:r}){var n;const s=F0(r.method),i=128|parseInt(((n=r.version)==null?void 0:n.toString())||"4"),o=Wz(r.address),a=r.era==="00"?new Uint8Array([0]):F0(r.era);if(a.length!==1&&a.length!==2)throw new Error("Invalid era length");const c=parseInt(r.nonce,16),l=new Uint8Array([c&255,c>>8&255]),u=BigInt(`0x${Hz(r.tip)}`),d=Kz(u),h=new Uint8Array([0,...t,o,...e,...a,...l,...d,...s]),p=Vz(h.length+1);return new Uint8Array([...p,i,...h])}function zz(t){const e=F0(t),r=M$.blake2b(e,void 0,32);return"0x"+Buffer.from(r).toString("hex")}function F0(t){return new Uint8Array(t.replace(/^0x/,"").match(/.{1,2}/g).map(e=>parseInt(e,16)))}function Hz(t){return t.startsWith("0x")?t.slice(2):t}function Wz(t){const e=Ph.decode(t)[0];return e===42?0:e===60?2:1}function Vz(t){if(t<64)return new Uint8Array([t<<2]);if(t<16384){const e=t<<2|1;return new Uint8Array([e&255,e>>8&255])}else if(t<1<<30){const e=t<<2|2;return new Uint8Array([e&255,e>>8&255,e>>16&255,e>>24&255])}else throw new Error("Compact encoding > 2^30 not supported")}function Kz(t){if(t<BigInt(1)<<BigInt(6))return new Uint8Array([Number(t<<BigInt(2))]);if(t<BigInt(1)<<BigInt(14)){const e=t<<BigInt(2)|BigInt(1);return new Uint8Array([Number(e&BigInt(255)),Number(e>>BigInt(8)&BigInt(255))])}else if(t<BigInt(1)<<BigInt(30)){const e=t<<BigInt(2)|BigInt(2);return new Uint8Array([Number(e&BigInt(255)),Number(e>>BigInt(8)&BigInt(255)),Number(e>>BigInt(16)&BigInt(255)),Number(e>>BigInt(24)&BigInt(255))])}else throw new Error("BigInt compact encoding not supported > 2^30")}function Gz(t){const e=Uint8Array.from(Buffer.from(t.signature,"hex")),r=Fz(t.transaction.address),n=qz({publicKey:r,signature:e,payload:t.transaction}),s=Buffer.from(n).toString("hex");return zz(s)}function KT({logger:t,name:e}){const r=typeof t=="string"?a3({opts:{level:t,name:e}}).logger:t;return r.level=typeof t=="string"?t:t.level,r}const Yz="PARSE_ERROR",Xz="INVALID_REQUEST",Zz="METHOD_NOT_FOUND",Jz="INVALID_PARAMS",GT="INTERNAL_ERROR",ev="SERVER_ERROR",Qz=[-32700,-32600,-32601,-32602,-32603],md={[Yz]:{code:-32700,message:"Parse error"},[Xz]:{code:-32600,message:"Invalid Request"},[Zz]:{code:-32601,message:"Method not found"},[Jz]:{code:-32602,message:"Invalid params"},[GT]:{code:-32603,message:"Internal error"},[ev]:{code:-32e3,message:"Server error"}},YT=ev;function eH(t){return Qz.includes(t)}function Z2(t){return Object.keys(md).includes(t)?md[t]:md[YT]}function tH(t){const e=Object.values(md).find(r=>r.code===t);return e||md[YT]}function tv(t,e,r){return t.message.includes("getaddrinfo ENOTFOUND")||t.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${e}`):t}var Fm={};var q0=function(t,e){return q0=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var s in n)n.hasOwnProperty(s)&&(r[s]=n[s])},q0(t,e)};function rH(t,e){q0(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var z0=function(){return z0=Object.assign||function(e){for(var r,n=1,s=arguments.length;n<s;n++){r=arguments[n];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},z0.apply(this,arguments)};function nH(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r}function sH(t,e,r,n){var s=arguments.length,i=s<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,r):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(t,e,r,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(i=(s<3?o(i):s>3?o(e,r,i):o(e,r))||i);return s>3&&i&&Object.defineProperty(e,r,i),i}function iH(t,e){return function(r,n){e(r,n,t)}}function oH(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function aH(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})}function cH(t,e){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(l){return function(u){return c([l,u])}}function c(l){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,s&&(i=l[0]&2?s.return:l[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,l[1])).done)return i;switch(s=0,i&&(l=[l[0]&2,i.value]),l[0]){case 0:case 1:i=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,s=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!i||l[1]>i[0]&&l[1]<i[3])){r.label=l[1];break}if(l[0]===6&&r.label<i[1]){r.label=i[1],i=l;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(l);break}i[2]&&r.ops.pop(),r.trys.pop();continue}l=e.call(t,r)}catch(u){l=[6,u],s=0}finally{n=i=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function lH(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}function uH(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function H0(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function XT(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),s,i=[],o;try{for(;(e===void 0||e-- >0)&&!(s=n.next()).done;)i.push(s.value)}catch(a){o={error:a}}finally{try{s&&!s.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return i}function dH(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(XT(arguments[e]));return t}function hH(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),s=0,e=0;e<r;e++)for(var i=arguments[e],o=0,a=i.length;o<a;o++,s++)n[s]=i[o];return n}function zd(t){return this instanceof zd?(this.v=t,this):new zd(t)}function fH(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(t,e||[]),s,i=[];return s={},o("next"),o("throw"),o("return"),s[Symbol.asyncIterator]=function(){return this},s;function o(h){n[h]&&(s[h]=function(p){return new Promise(function(y,g){i.push([h,p,y,g])>1||a(h,p)})})}function a(h,p){try{c(n[h](p))}catch(y){d(i[0][3],y)}}function c(h){h.value instanceof zd?Promise.resolve(h.value.v).then(l,u):d(i[0][2],h)}function l(h){a("next",h)}function u(h){a("throw",h)}function d(h,p){h(p),i.shift(),i.length&&a(i[0][0],i[0][1])}}function pH(t){var e,r;return e={},n("next"),n("throw",function(s){throw s}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(s,i){e[s]=t[s]?function(o){return(r=!r)?{value:zd(t[s](o)),done:s==="return"}:i?i(o):o}:i}}function gH(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof H0=="function"?H0(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(i){r[i]=t[i]&&function(o){return new Promise(function(a,c){o=t[i](o),s(a,c,o.done,o.value)})}}function s(i,o,a,c){Promise.resolve(c).then(function(l){i({value:l,done:a})},o)}}function yH(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function mH(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function wH(t){return t&&t.__esModule?t:{default:t}}function bH(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function vH(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}const EH=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return z0},__asyncDelegator:pH,__asyncGenerator:fH,__asyncValues:gH,__await:zd,__awaiter:aH,__classPrivateFieldGet:bH,__classPrivateFieldSet:vH,__createBinding:lH,__decorate:sH,__exportStar:uH,__extends:rH,__generator:cH,__importDefault:wH,__importStar:mH,__makeTemplateObject:yH,__metadata:oH,__param:iH,__read:XT,__rest:nH,__spread:dH,__spreadArrays:hH,__values:H0},Symbol.toStringTag,{value:"Module"})),_H=m1(EH);var eo={},J2;function xH(){if(J2)return eo;J2=1,Object.defineProperty(eo,"__esModule",{value:!0}),eo.isBrowserCryptoAvailable=eo.getSubtleCrypto=eo.getBrowerCrypto=void 0;function t(){return Di?.crypto||Di?.msCrypto||{}}eo.getBrowerCrypto=t;function e(){const n=t();return n.subtle||n.webkitSubtle}eo.getSubtleCrypto=e;function r(){return!!t()&&!!e()}return eo.isBrowserCryptoAvailable=r,eo}var to={},Q2;function SH(){if(Q2)return to;Q2=1,Object.defineProperty(to,"__esModule",{value:!0}),to.isBrowser=to.isNode=to.isReactNative=void 0;function t(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}to.isReactNative=t;function e(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}to.isNode=e;function r(){return!t()&&!e()}return to.isBrowser=r,to}var ex;function AH(){return ex||(ex=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=_H;e.__exportStar(xH(),t),e.__exportStar(SH(),t)})(Fm)),Fm}var ZT=AH();function Vr(t=3){const e=Date.now()*Math.pow(10,t),r=Math.floor(Math.random()*Math.pow(10,t));return e+r}function Tn(t=6){return BigInt(Vr(t))}function Ar(t,e,r){return{id:r||Vr(),jsonrpc:"2.0",method:t,params:e}}function Do(t,e){return{id:t,jsonrpc:"2.0",result:e}}function Vc(t,e,r){return{id:t,jsonrpc:"2.0",error:IH(e)}}function IH(t,e){return typeof t>"u"?Z2(GT):(typeof t=="string"&&(t=Object.assign(Object.assign({},Z2(ev)),{message:t})),eH(t.code)&&(t=tH(t.code)),t)}class CH{}class $H extends CH{constructor(){super()}}class JT extends $H{constructor(e){super()}}const TH="^https?:",NH="^wss?:";function OH(t){const e=t.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function QT(t,e){const r=OH(t);return typeof r>"u"?!1:new RegExp(e).test(r)}function tx(t){return QT(t,TH)}function rg(t){return QT(t,NH)}function eN(t){return new RegExp("wss?://localhost(:d{2,5})?").test(t)}function tN(t){return typeof t=="object"&&"id"in t&&"jsonrpc"in t&&t.jsonrpc==="2.0"}function yu(t){return tN(t)&&"method"in t}function Ua(t){return tN(t)&&(Rr(t)||nr(t))}function Rr(t){return"result"in t}function nr(t){return"error"in t}let kH=class extends JT{constructor(e){super(e),this.events=new dr.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async request(e,r){return this.requestStrict(Ar(e.method,e.params||[],e.id||Tn().toString()),r)}async requestStrict(e,r){return new Promise(async(n,s)=>{if(!this.connection.connected)try{await this.open()}catch(i){s(i)}this.events.on(`${e.id}`,i=>{nr(i)?s(i.error):n(i.result)});try{await this.connection.send(e,r)}catch(i){s(i)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),Ua(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&e.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",e=>this.onClose(e)),this.connection.on("error",e=>this.events.emit("error",e)),this.connection.on("register_error",e=>this.onClose()),this.hasRegisteredEventListeners=!0)}};const PH=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),RH=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",rx=t=>t.split("?")[0],nx=10,DH=PH();let UH=class{constructor(e){if(this.url=e,this.events=new dr.EventEmitter,this.registering=!1,!rg(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async open(e=this.url){await this.register(e)}async close(){return new Promise((e,r)=>{if(typeof this.socket>"u"){r(new Error("Connection already closed"));return}this.socket.onclose=n=>{this.onClose(n),e()},this.socket.close()})}async send(e){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(Bn(e))}catch(r){this.onError(e.id,r)}}register(e=this.url){if(!rg(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((n,s)=>{this.events.once("register_error",i=>{this.resetMaxListeners(),s(i)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return s(new Error("WebSocket connection is missing or invalid"));n(this.socket)})})}return this.url=e,this.registering=!0,new Promise((r,n)=>{const s=ZT.isReactNative()?void 0:{rejectUnauthorized:!eN(e)},i=new DH(e,[],s);RH()?i.onerror=o=>{const a=o;n(this.emitError(a.error))}:i.on("error",o=>{n(this.emitError(o))}),i.onopen=()=>{this.onOpen(i),r(i)}})}onOpen(e){e.onmessage=r=>this.onPayload(r),e.onclose=r=>this.onClose(r),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(typeof e.data>"u")return;const r=typeof e.data=="string"?Wi(e.data):e.data;this.events.emit("payload",r)}onError(e,r){const n=this.parseError(r),s=n.message||n.toString(),i=Vc(e,s);this.events.emit("payload",i)}parseError(e,r=this.url){return tv(e,rx(r),"WS")}resetMaxListeners(){this.events.getMaxListeners()>nx&&this.events.setMaxListeners(nx)}emitError(e){const r=this.parseError(new Error(e?.message||`WebSocket connection failed for host: ${rx(this.url)}`));return this.events.emit("register_error",r),r}};var BH={};const rN="wc",nN=2,W0="core",Vi=`${rN}@2:${W0}:`,LH={logger:"error"},MH={database:":memory:"},jH="crypto",sx="client_ed25519_seed",FH=X.ONE_DAY,qH="keychain",zH="0.3",HH="messages",WH="0.3",VH=X.SIX_HOURS,KH="publisher",sN="irn",GH="error",iN="wss://relay.walletconnect.org",YH="relayer",_r={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},XH="_subscription",Ps={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},ZH=.1,V0="2.23.0",Kt={link_mode:"link_mode",relay:"relay"},hp={inbound:"inbound",outbound:"outbound"},JH="0.3",QH="WALLETCONNECT_CLIENT_ID",ix="WALLETCONNECT_LINK_MODE_APPS",ys={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},eW="subscription",tW="0.3",rW="pairing",nW="0.3",ju={wc_pairingDelete:{req:{ttl:X.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:X.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:X.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:X.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:X.ONE_DAY,prompt:!1,tag:0},res:{ttl:X.ONE_DAY,prompt:!1,tag:0}}},ac={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},ti={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},sW="history",iW="0.3",oW="expirer",Fs={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},aW="0.3",cW="verify-api",lW="https://verify.walletconnect.com",oN="https://verify.walletconnect.org",wd=oN,uW=`${wd}/v3`,dW=[lW,oN],hW="echo",fW="https://echo.walletconnect.com",Oi={pairing_started:"pairing_started",pairing_uri_validation_success:"pairing_uri_validation_success",pairing_uri_not_expired:"pairing_uri_not_expired",store_new_pairing:"store_new_pairing",subscribing_pairing_topic:"subscribing_pairing_topic",subscribe_pairing_topic_success:"subscribe_pairing_topic_success",existing_pairing:"existing_pairing",pairing_not_expired:"pairing_not_expired",emit_inactive_pairing:"emit_inactive_pairing",emit_session_proposal:"emit_session_proposal",subscribing_to_pairing_topic:"subscribing_to_pairing_topic"},ao={no_wss_connection:"no_wss_connection",no_internet_connection:"no_internet_connection",malformed_pairing_uri:"malformed_pairing_uri",active_pairing_already_exists:"active_pairing_already_exists",subscribe_pairing_topic_failure:"subscribe_pairing_topic_failure",pairing_expired:"pairing_expired",proposal_expired:"proposal_expired",proposal_listener_not_found:"proposal_listener_not_found"},ri={session_approve_started:"session_approve_started",proposal_not_expired:"proposal_not_expired",session_namespaces_validation_success:"session_namespaces_validation_success",create_session_topic:"create_session_topic",subscribing_session_topic:"subscribing_session_topic",subscribe_session_topic_success:"subscribe_session_topic_success",publishing_session_approve:"publishing_session_approve",session_approve_publish_success:"session_approve_publish_success",store_session:"store_session",publishing_session_settle:"publishing_session_settle",session_settle_publish_success:"session_settle_publish_success",session_request_response_started:"session_request_response_started",session_request_response_validation_success:"session_request_response_validation_success",session_request_response_publish_started:"session_request_response_publish_started"},Va={no_internet_connection:"no_internet_connection",no_wss_connection:"no_wss_connection",proposal_expired:"proposal_expired",subscribe_session_topic_failure:"subscribe_session_topic_failure",session_approve_publish_failure:"session_approve_publish_failure",session_settle_publish_failure:"session_settle_publish_failure",session_approve_namespace_validation_failure:"session_approve_namespace_validation_failure",proposal_not_found:"proposal_not_found",session_request_response_validation_failure:"session_request_response_validation_failure",session_request_response_publish_failure:"session_request_response_publish_failure"},Ka={authenticated_session_approve_started:"authenticated_session_approve_started",create_authenticated_session_topic:"create_authenticated_session_topic",cacaos_verified:"cacaos_verified",store_authenticated_session:"store_authenticated_session",subscribing_authenticated_session_topic:"subscribing_authenticated_session_topic",subscribe_authenticated_session_topic_success:"subscribe_authenticated_session_topic_success",publishing_authenticated_session_approve:"publishing_authenticated_session_approve"},Fu={no_internet_connection:"no_internet_connection",invalid_cacao:"invalid_cacao",subscribe_authenticated_session_topic_failure:"subscribe_authenticated_session_topic_failure",authenticated_session_approve_publish_failure:"authenticated_session_approve_publish_failure",authenticated_session_pending_request_not_found:"authenticated_session_pending_request_not_found"},pW=.1,gW="event-client",yW=86400,mW="https://pulse.walletconnect.org/batch";function wW(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var s=0;s<t.length;s++){var i=t.charAt(s),o=i.charCodeAt(0);if(r[o]!==255)throw new TypeError(i+" is ambiguous");r[o]=s}var a=t.length,c=t.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function d(y){if(y instanceof Uint8Array||(ArrayBuffer.isView(y)?y=new Uint8Array(y.buffer,y.byteOffset,y.byteLength):Array.isArray(y)&&(y=Uint8Array.from(y))),!(y instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(y.length===0)return"";for(var g=0,w=0,S=0,A=y.length;S!==A&&y[S]===0;)S++,g++;for(var E=(A-S)*u+1>>>0,v=new Uint8Array(E);S!==A;){for(var C=y[S],O=0,L=E-1;(C!==0||O<w)&&L!==-1;L--,O++)C+=256*v[L]>>>0,v[L]=C%a>>>0,C=C/a>>>0;if(C!==0)throw new Error("Non-zero carry");w=O,S++}for(var j=E-w;j!==E&&v[j]===0;)j++;for(var D=c.repeat(g);j<E;++j)D+=t.charAt(v[j]);return D}function h(y){if(typeof y!="string")throw new TypeError("Expected String");if(y.length===0)return new Uint8Array;var g=0;if(y[g]!==" "){for(var w=0,S=0;y[g]===c;)w++,g++;for(var A=(y.length-g)*l+1>>>0,E=new Uint8Array(A);y[g];){var v=r[y.charCodeAt(g)];if(v===255)return;for(var C=0,O=A-1;(v!==0||C<S)&&O!==-1;O--,C++)v+=a*E[O]>>>0,E[O]=v%256>>>0,v=v/256>>>0;if(v!==0)throw new Error("Non-zero carry");S=C,g++}if(y[g]!==" "){for(var L=A-S;L!==A&&E[L]===0;)L++;for(var j=new Uint8Array(w+(A-L)),D=w;L!==A;)j[D++]=E[L++];return j}}}function p(y){var g=h(y);if(g)return g;throw new Error(`Non-${e} character`)}return{encode:d,decodeUnsafe:h,decode:p}}var bW=wW,vW=bW;const aN=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},EW=t=>new TextEncoder().encode(t),_W=t=>new TextDecoder().decode(t);let xW=class{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},SW=class{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return cN(this,e)}},AW=class{constructor(e){this.decoders=e}or(e){return cN(this,e)}decode(e){const r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};const cN=(t,e)=>new AW({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});let IW=class{constructor(e,r,n,s){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=s,this.encoder=new xW(e,r,n),this.decoder=new SW(e,r,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}};const ny=({name:t,prefix:e,encode:r,decode:n})=>new IW(t,e,r,n),jh=({prefix:t,name:e,alphabet:r})=>{const{encode:n,decode:s}=vW(r,e);return ny({prefix:t,name:e,encode:n,decode:i=>aN(s(i))})},CW=(t,e,r,n)=>{const s={};for(let u=0;u<e.length;++u)s[e[u]]=u;let i=t.length;for(;t[i-1]==="=";)--i;const o=new Uint8Array(i*r/8|0);let a=0,c=0,l=0;for(let u=0;u<i;++u){const d=s[t[u]];if(d===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<r|d,a+=r,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},$W=(t,e,r)=>{const n=e[e.length-1]==="=",s=(1<<r)-1;let i="",o=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],o+=8;o>r;)o-=r,i+=e[s&a>>o];if(o&&(i+=e[s&a<<r-o]),n)for(;i.length*r&7;)i+="=";return i},hn=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>ny({prefix:e,name:t,encode(s){return $W(s,n,r)},decode(s){return CW(s,n,r,t)}}),TW=ny({prefix:"\0",name:"identity",encode:t=>_W(t),decode:t=>EW(t)});var NW=Object.freeze({__proto__:null,identity:TW});const OW=hn({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var kW=Object.freeze({__proto__:null,base2:OW});const PW=hn({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var RW=Object.freeze({__proto__:null,base8:PW});const DW=jh({prefix:"9",name:"base10",alphabet:"0123456789"});var UW=Object.freeze({__proto__:null,base10:DW});const BW=hn({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),LW=hn({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var MW=Object.freeze({__proto__:null,base16:BW,base16upper:LW});const jW=hn({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),FW=hn({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),qW=hn({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),zW=hn({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),HW=hn({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),WW=hn({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),VW=hn({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),KW=hn({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),GW=hn({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var YW=Object.freeze({__proto__:null,base32:jW,base32upper:FW,base32pad:qW,base32padupper:zW,base32hex:HW,base32hexupper:WW,base32hexpad:VW,base32hexpadupper:KW,base32z:GW});const XW=jh({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),ZW=jh({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var JW=Object.freeze({__proto__:null,base36:XW,base36upper:ZW});const QW=jh({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),eV=jh({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var tV=Object.freeze({__proto__:null,base58btc:QW,base58flickr:eV});const rV=hn({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),nV=hn({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),sV=hn({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),iV=hn({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var oV=Object.freeze({__proto__:null,base64:rV,base64pad:nV,base64url:sV,base64urlpad:iV});const lN=Array.from(""),aV=lN.reduce((t,e,r)=>(t[r]=e,t),[]),cV=lN.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function lV(t){return t.reduce((e,r)=>(e+=aV[r],e),"")}function uV(t){const e=[];for(const r of t){const n=cV[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}const dV=ny({prefix:"",name:"base256emoji",encode:lV,decode:uV});var hV=Object.freeze({__proto__:null,base256emoji:dV}),fV=uN,ox=128,pV=-128,gV=Math.pow(2,31);function uN(t,e,r){e=e||[],r=r||0;for(var n=r;t>=gV;)e[r++]=t&255|ox,t/=128;for(;t&pV;)e[r++]=t&255|ox,t>>>=7;return e[r]=t|0,uN.bytes=r-n+1,e}var yV=K0,mV=128,ax=127;function K0(t,n){var r=0,n=n||0,s=0,i=n,o,a=t.length;do{if(i>=a)throw K0.bytes=0,new RangeError("Could not decode varint");o=t[i++],r+=s<28?(o&ax)<<s:(o&ax)*Math.pow(2,s),s+=7}while(o>=mV);return K0.bytes=i-n,r}var wV=Math.pow(2,7),bV=Math.pow(2,14),vV=Math.pow(2,21),EV=Math.pow(2,28),_V=Math.pow(2,35),xV=Math.pow(2,42),SV=Math.pow(2,49),AV=Math.pow(2,56),IV=Math.pow(2,63),CV=function(t){return t<wV?1:t<bV?2:t<vV?3:t<EV?4:t<_V?5:t<xV?6:t<SV?7:t<AV?8:t<IV?9:10},$V={encode:fV,decode:yV,encodingLength:CV},dN=$V;const cx=(t,e,r=0)=>(dN.encode(t,e,r),e),lx=t=>dN.encodingLength(t),G0=(t,e)=>{const r=e.byteLength,n=lx(t),s=n+lx(r),i=new Uint8Array(s+r);return cx(t,i,0),cx(r,i,n),i.set(e,s),new TV(t,r,e,i)};let TV=class{constructor(e,r,n,s){this.code=e,this.size=r,this.digest=n,this.bytes=s}};const hN=({name:t,code:e,encode:r})=>new NV(t,e,r);let NV=class{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){const r=this.encode(e);return r instanceof Uint8Array?G0(this.code,r):r.then(n=>G0(this.code,n))}else throw Error("Unknown type, must be binary type")}};const fN=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),OV=hN({name:"sha2-256",code:18,encode:fN("SHA-256")}),kV=hN({name:"sha2-512",code:19,encode:fN("SHA-512")});var PV=Object.freeze({__proto__:null,sha256:OV,sha512:kV});const pN=0,RV="identity",gN=aN,DV=t=>G0(pN,gN(t)),UV={code:pN,name:RV,encode:gN,digest:DV};var BV=Object.freeze({__proto__:null,identity:UV});new TextEncoder,new TextDecoder;const ux={...NW,...kW,...RW,...UW,...MW,...YW,...JW,...tV,...oV,...hV};({...PV,...BV});function yN(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function LV(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?yN(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function mN(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}const dx=mN("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),qm=mN("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);const e=LV(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),MV={utf8:dx,"utf-8":dx,hex:ux.base16,latin1:qm,ascii:qm,binary:qm,...ux};function jV(t,e="utf8"){const r=MV[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?yN(globalThis.Buffer.from(t,"utf-8")):r.decoder.decode(`${r.prefix}${t}`)}var FV=Object.defineProperty,qV=(t,e,r)=>e in t?FV(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Ai=(t,e,r)=>qV(t,typeof e!="symbol"?e+"":e,r);let zV=class{constructor(e,r){this.core=e,this.logger=r,Ai(this,"keychain",new Map),Ai(this,"name",qH),Ai(this,"version",zH),Ai(this,"initialized",!1),Ai(this,"storagePrefix",Vi),Ai(this,"init",async()=>{if(!this.initialized){const n=await this.getKeyChain();typeof n<"u"&&(this.keychain=n),this.initialized=!0}}),Ai(this,"has",n=>(this.isInitialized(),this.keychain.has(n))),Ai(this,"set",async(n,s)=>{this.isInitialized(),this.keychain.set(n,s),await this.persist()}),Ai(this,"get",n=>{this.isInitialized();const s=this.keychain.get(n);if(typeof s>"u"){const{message:i}=we("NO_MATCHING_KEY",`${this.name}: ${n}`);throw new Error(i)}return s}),Ai(this,"del",async n=>{this.isInitialized(),this.keychain.delete(n),await this.persist()}),this.core=e,this.logger=Cs(r,this.name)}get context(){return os(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,$0(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?T0(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=we("NOT_INITIALIZED",this.name);throw new Error(e)}}};var HV=Object.defineProperty,WV=(t,e,r)=>e in t?HV(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Mr=(t,e,r)=>WV(t,typeof e!="symbol"?e+"":e,r);let VV=class{constructor(e,r,n){this.core=e,this.logger=r,Mr(this,"name",jH),Mr(this,"keychain"),Mr(this,"randomSessionIdentifier",j0()),Mr(this,"initialized",!1),Mr(this,"clientId"),Mr(this,"init",async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)}),Mr(this,"hasKeys",s=>(this.isInitialized(),this.keychain.has(s))),Mr(this,"getClientId",async()=>{if(this.isInitialized(),this.clientId)return this.clientId;const s=await this.getClientSeed(),i=jp(s),o=k1(i.publicKey);return this.clientId=o,o}),Mr(this,"generateKeyPair",()=>{this.isInitialized();const s=Nq();return this.setPrivateKey(s.publicKey,s.privateKey)}),Mr(this,"signJWT",async s=>{this.isInitialized();const i=await this.getClientSeed(),o=jp(i),a=this.randomSessionIdentifier;return await U3(a,s,FH,o)}),Mr(this,"generateSharedKey",(s,i,o)=>{this.isInitialized();const a=this.getPrivateKey(s),c=Oq(a,i);return this.setSymKey(c,o)}),Mr(this,"setSymKey",async(s,i)=>{this.isInitialized();const o=i||dp(s);return await this.keychain.set(o,s),o}),Mr(this,"deleteKeyPair",async s=>{this.isInitialized(),await this.keychain.del(s)}),Mr(this,"deleteSymKey",async s=>{this.isInitialized(),await this.keychain.del(s)}),Mr(this,"encode",async(s,i,o)=>{this.isInitialized();const a=qT(o),c=Bn(i);if(B2(a))return Rq(c,o?.encoding);if(U2(a)){const h=a.senderPublicKey,p=a.receiverPublicKey;s=await this.generateSharedKey(h,p)}const l=this.getSymKey(s),{type:u,senderPublicKey:d}=a;return kq({type:u,symKey:l,message:c,senderPublicKey:d,encoding:o?.encoding})}),Mr(this,"decode",async(s,i,o)=>{this.isInitialized();const a=Uq(i,o);if(B2(a)){const c=Dq(i,o?.encoding);return Wi(c)}if(U2(a)){const c=a.receiverPublicKey,l=a.senderPublicKey;s=await this.generateSharedKey(c,l)}try{const c=this.getSymKey(s),l=Pq({symKey:c,encoded:i,encoding:o?.encoding});return Wi(l)}catch(c){this.logger.error(`Failed to decode message from topic: '${s}', clientId: '${await this.getClientId()}'`),this.logger.error(c)}}),Mr(this,"getPayloadType",(s,i=Xn)=>{const o=Fd({encoded:s,encoding:i});return Dc(o.type)}),Mr(this,"getPayloadSenderPublicKey",(s,i=Xn)=>{const o=Fd({encoded:s,encoding:i});return o.senderPublicKey?jt(o.senderPublicKey,Pn):void 0}),this.core=e,this.logger=Cs(r,this.name),this.keychain=n||new zV(this.core,this.logger)}get context(){return os(this.logger)}async setPrivateKey(e,r){return await this.keychain.set(e,r),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(sx)}catch{e=j0(),await this.keychain.set(sx,e)}return jV(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=we("NOT_INITIALIZED",this.name);throw new Error(e)}}};var KV=Object.defineProperty,GV=Object.defineProperties,YV=Object.getOwnPropertyDescriptors,hx=Object.getOwnPropertySymbols,XV=Object.prototype.hasOwnProperty,ZV=Object.prototype.propertyIsEnumerable,Y0=(t,e,r)=>e in t?KV(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,JV=(t,e)=>{for(var r in e||(e={}))XV.call(e,r)&&Y0(t,r,e[r]);if(hx)for(var r of hx(e))ZV.call(e,r)&&Y0(t,r,e[r]);return t},QV=(t,e)=>GV(t,YV(e)),hs=(t,e,r)=>Y0(t,typeof e!="symbol"?e+"":e,r);let eK=class extends ER{constructor(e,r){super(e,r),this.logger=e,this.core=r,hs(this,"messages",new Map),hs(this,"messagesWithoutClientAck",new Map),hs(this,"name",HH),hs(this,"version",WH),hs(this,"initialized",!1),hs(this,"storagePrefix",Vi),hs(this,"init",async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const n=await this.getRelayerMessages();typeof n<"u"&&(this.messages=n);const s=await this.getRelayerMessagesWithoutClientAck();typeof s<"u"&&(this.messagesWithoutClientAck=s),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(n){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(n)}finally{this.initialized=!0}}}),hs(this,"set",async(n,s,i)=>{this.isInitialized();const o=Vs(s);let a=this.messages.get(n);if(typeof a>"u"&&(a={}),typeof a[o]<"u")return o;if(a[o]=s,this.messages.set(n,a),i===hp.inbound){const c=this.messagesWithoutClientAck.get(n)||{};this.messagesWithoutClientAck.set(n,QV(JV({},c),{[o]:s}))}return await this.persist(),o}),hs(this,"get",n=>{this.isInitialized();let s=this.messages.get(n);return typeof s>"u"&&(s={}),s}),hs(this,"getWithoutAck",n=>{this.isInitialized();const s={};for(const i of n){const o=this.messagesWithoutClientAck.get(i)||{};s[i]=Object.values(o)}return s}),hs(this,"has",(n,s)=>{this.isInitialized();const i=this.get(n),o=Vs(s);return typeof i[o]<"u"}),hs(this,"ack",async(n,s)=>{this.isInitialized();const i=this.messagesWithoutClientAck.get(n);if(typeof i>"u")return;const o=Vs(s);delete i[o],Object.keys(i).length===0?this.messagesWithoutClientAck.delete(n):this.messagesWithoutClientAck.set(n,i),await this.persist()}),hs(this,"del",async n=>{this.isInitialized(),this.messages.delete(n),this.messagesWithoutClientAck.delete(n),await this.persist()}),this.logger=Cs(e,this.name),this.core=r}get context(){return os(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get storageKeyWithoutClientAck(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name+"_withoutClientAck"}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,$0(e))}async setRelayerMessagesWithoutClientAck(e){await this.core.storage.setItem(this.storageKeyWithoutClientAck,$0(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?T0(e):void 0}async getRelayerMessagesWithoutClientAck(){const e=await this.core.storage.getItem(this.storageKeyWithoutClientAck);return typeof e<"u"?T0(e):void 0}async persist(){await this.setRelayerMessages(this.messages),await this.setRelayerMessagesWithoutClientAck(this.messagesWithoutClientAck)}isInitialized(){if(!this.initialized){const{message:e}=we("NOT_INITIALIZED",this.name);throw new Error(e)}}};var tK=Object.defineProperty,rK=Object.defineProperties,nK=Object.getOwnPropertyDescriptors,fx=Object.getOwnPropertySymbols,sK=Object.prototype.hasOwnProperty,iK=Object.prototype.propertyIsEnumerable,X0=(t,e,r)=>e in t?tK(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,fl=(t,e)=>{for(var r in e||(e={}))sK.call(e,r)&&X0(t,r,e[r]);if(fx)for(var r of fx(e))iK.call(e,r)&&X0(t,r,e[r]);return t},px=(t,e)=>rK(t,nK(e)),Rs=(t,e,r)=>X0(t,typeof e!="symbol"?e+"":e,r);let oK=class extends _R{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,Rs(this,"events",new dr.EventEmitter),Rs(this,"name",KH),Rs(this,"queue",new Map),Rs(this,"publishTimeout",X.toMiliseconds(X.ONE_MINUTE)),Rs(this,"initialPublishTimeout",X.toMiliseconds(X.ONE_SECOND*15)),Rs(this,"needsTransportRestart",!1),Rs(this,"publish",async(n,s,i)=>{var o,a,c,l,u;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:s,opts:i}});const d=i?.ttl||VH,h=i?.prompt||!1,p=i?.tag||0,y=i?.id||Tn().toString(),g=Nl(eg().protocol),w={id:y,method:i?.publishMethod||g.publish,params:fl({topic:n,message:s,ttl:d,prompt:h,tag:p,attestation:i?.attestation},i?.tvf)},S=`Failed to publish payload, please try again. id:${y} tag:${p}`;try{Kr((o=w.params)==null?void 0:o.prompt)&&((a=w.params)==null||delete a.prompt),Kr((c=w.params)==null?void 0:c.tag)&&((l=w.params)==null||delete l.tag);const A=new Promise(async E=>{const v=({id:O})=>{var L;((L=w.id)==null?void 0:L.toString())===O.toString()&&(this.removeRequestFromQueue(O),this.relayer.events.removeListener(_r.publish,v),E())};this.relayer.events.on(_r.publish,v);const C=Bi(new Promise((O,L)=>{this.rpcPublish(w,i).then(O).catch(j=>{this.logger.warn(j,j?.message),L(j)})}),this.initialPublishTimeout,`Failed initial publish, retrying.... id:${y} tag:${p}`);try{await C,this.events.removeListener(_r.publish,v)}catch(O){this.queue.set(y,{request:w,opts:i,attempt:1}),this.logger.warn(O,O?.message)}});this.logger.trace({type:"method",method:"publish",params:{id:y,topic:n,message:s,opts:i}}),await Bi(A,this.publishTimeout,S)}catch(A){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(A),(u=i?.internal)!=null&&u.throwOnFailedPublish)throw A}finally{this.queue.delete(y)}}),Rs(this,"publishCustom",async n=>{var s,i,o,a,c;this.logger.debug("Publishing custom payload"),this.logger.trace({type:"method",method:"publishCustom",params:n});const{payload:l,opts:u={}}=n,{attestation:d,tvf:h,publishMethod:p,prompt:y,tag:g,ttl:w=X.FIVE_MINUTES}=u,S=u.id||Tn().toString(),A=Nl(eg().protocol),E=p||A.publish,v={id:S,method:E,params:fl(px(fl({},l),{ttl:w,prompt:y,tag:g,attestation:d}),h)},C=`Failed to publish custom payload, please try again. id:${S} tag:${g}`;try{Kr((s=v.params)==null?void 0:s.prompt)&&((i=v.params)==null||delete i.prompt),Kr((o=v.params)==null?void 0:o.tag)&&((a=v.params)==null||delete a.tag);const O=new Promise(async L=>{const j=({id:W})=>{var P;((P=v.id)==null?void 0:P.toString())===W.toString()&&(this.removeRequestFromQueue(W),this.relayer.events.removeListener(_r.publish,j),L())};this.relayer.events.on(_r.publish,j);const D=Bi(new Promise((W,P)=>{this.rpcPublish(v,u).then(W).catch(R=>{this.logger.warn(R,R?.message),P(R)})}),this.initialPublishTimeout,`Failed initial custom payload publish, retrying.... method:${E} id:${S} tag:${g}`);try{await D,this.events.removeListener(_r.publish,j)}catch(W){this.queue.set(S,{request:v,opts:u,attempt:1}),this.logger.warn(W,W?.message)}});this.logger.trace({type:"method",method:"publish",params:{id:S,payload:l,opts:u}}),await Bi(O,this.publishTimeout,C)}catch(O){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(O),(c=u?.internal)!=null&&c.throwOnFailedPublish)throw O}finally{this.queue.delete(S)}}),Rs(this,"on",(n,s)=>{this.events.on(n,s)}),Rs(this,"once",(n,s)=>{this.events.once(n,s)}),Rs(this,"off",(n,s)=>{this.events.off(n,s)}),Rs(this,"removeListener",(n,s)=>{this.events.removeListener(n,s)}),this.relayer=e,this.logger=Cs(r,this.name),this.registerEventListeners()}get context(){return os(this.logger)}async rpcPublish(e,r){this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:e});const n=await this.relayer.request(e);return this.relayer.events.emit(_r.publish,fl(fl({},e),r)),this.logger.debug("Successfully Published Payload"),n}removeRequestFromQueue(e){this.queue.delete(e)}checkQueue(){this.queue.forEach(async(e,r)=>{var n;const s=e.attempt+1;this.queue.set(r,px(fl({},e),{attempt:s})),this.logger.warn({},`Publisher: queue->publishing: ${e.request.id}, tag: ${(n=e.request.params)==null?void 0:n.tag}, attempt: ${s}`),await this.rpcPublish(e.request,e.opts),this.logger.warn({},`Publisher: queue->published: ${e.request.id}`)})}registerEventListeners(){this.relayer.core.heartbeat.on(zc.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(_r.connection_stalled);return}this.checkQueue()}),this.relayer.on(_r.message_ack,e=>{this.removeRequestFromQueue(e.id.toString())})}};var aK=Object.defineProperty,cK=(t,e,r)=>e in t?aK(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,pl=(t,e,r)=>cK(t,typeof e!="symbol"?e+"":e,r);let lK=class{constructor(){pl(this,"map",new Map),pl(this,"set",(e,r)=>{const n=this.get(e);this.exists(e,r)||this.map.set(e,[...n,r])}),pl(this,"get",e=>this.map.get(e)||[]),pl(this,"exists",(e,r)=>this.get(e).includes(r)),pl(this,"delete",(e,r)=>{if(typeof r>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const n=this.get(e);if(!this.exists(e,r))return;const s=n.filter(i=>i!==r);if(!s.length){this.map.delete(e);return}this.map.set(e,s)}),pl(this,"clear",()=>{this.map.clear()})}get topics(){return Array.from(this.map.keys())}};var uK=Object.defineProperty,dK=Object.defineProperties,hK=Object.getOwnPropertyDescriptors,gx=Object.getOwnPropertySymbols,fK=Object.prototype.hasOwnProperty,pK=Object.prototype.propertyIsEnumerable,Z0=(t,e,r)=>e in t?uK(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,qu=(t,e)=>{for(var r in e||(e={}))fK.call(e,r)&&Z0(t,r,e[r]);if(gx)for(var r of gx(e))pK.call(e,r)&&Z0(t,r,e[r]);return t},zm=(t,e)=>dK(t,hK(e)),qt=(t,e,r)=>Z0(t,typeof e!="symbol"?e+"":e,r);let gK=class extends AR{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,qt(this,"subscriptions",new Map),qt(this,"topicMap",new lK),qt(this,"events",new dr.EventEmitter),qt(this,"name",eW),qt(this,"version",tW),qt(this,"pending",new Map),qt(this,"cached",[]),qt(this,"initialized",!1),qt(this,"storagePrefix",Vi),qt(this,"subscribeTimeout",X.toMiliseconds(X.ONE_MINUTE)),qt(this,"initialSubscribeTimeout",X.toMiliseconds(X.ONE_SECOND*15)),qt(this,"clientId"),qt(this,"batchSubscribeTopicsLimit",500),qt(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),await this.restore()),this.initialized=!0}),qt(this,"subscribe",async(n,s)=>{var i;this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:s}});try{const o=eg(s),a={topic:n,relay:o,transportType:s?.transportType};(i=s?.internal)!=null&&i.skipSubscribe||this.pending.set(n,a);const c=await this.rpcSubscribe(n,o,s);return typeof c=="string"&&(this.onSubscribe(c,a),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:s}})),c}catch(o){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(o),o}}),qt(this,"unsubscribe",async(n,s)=>{this.isInitialized(),typeof s?.id<"u"?await this.unsubscribeById(n,s.id,s):await this.unsubscribeByTopic(n,s)}),qt(this,"isSubscribed",n=>new Promise(s=>{s(this.topicMap.topics.includes(n))})),qt(this,"isKnownTopic",n=>new Promise(s=>{s(this.topicMap.topics.includes(n)||this.pending.has(n)||this.cached.some(i=>i.topic===n))})),qt(this,"on",(n,s)=>{this.events.on(n,s)}),qt(this,"once",(n,s)=>{this.events.once(n,s)}),qt(this,"off",(n,s)=>{this.events.off(n,s)}),qt(this,"removeListener",(n,s)=>{this.events.removeListener(n,s)}),qt(this,"start",async()=>{await this.onConnect()}),qt(this,"stop",async()=>{await this.onDisconnect()}),qt(this,"restart",async()=>{await this.restore(),await this.onRestart()}),qt(this,"checkPending",async()=>{if(this.pending.size===0&&(!this.initialized||!this.relayer.connected))return;const n=[];this.pending.forEach(s=>{n.push(s)}),await this.batchSubscribe(n)}),qt(this,"registerEventListeners",()=>{this.relayer.core.heartbeat.on(zc.pulse,async()=>{await this.checkPending()}),this.events.on(ys.created,async n=>{const s=ys.created;this.logger.info(`Emitting ${s}`),this.logger.debug({type:"event",event:s,data:n}),await this.persist()}),this.events.on(ys.deleted,async n=>{const s=ys.deleted;this.logger.info(`Emitting ${s}`),this.logger.debug({type:"event",event:s,data:n}),await this.persist()})}),this.relayer=e,this.logger=Cs(r,this.name),this.clientId=""}get context(){return os(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}get hasAnyTopics(){return this.topicMap.topics.length>0||this.pending.size>0||this.cached.length>0||this.subscriptions.size>0}hasSubscription(e,r){let n=!1;try{n=this.getSubscription(e).topic===r}catch{}return n}reset(){this.cached=[],this.initialized=!0}onDisable(){this.values.length>0&&(this.cached=this.values),this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,r){const n=this.topicMap.get(e);await Promise.all(n.map(async s=>await this.unsubscribeById(e,s,r)))}async unsubscribeById(e,r,n){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:n}});try{const s=eg(n);await this.restartToComplete({topic:e,id:r,relay:s}),await this.rpcUnsubscribe(e,r,s);const i=lr("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,r,i),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:n}})}catch(s){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(s),s}}async rpcSubscribe(e,r,n){var s,i;const o=await this.getSubscriptionId(e);if((s=n?.internal)!=null&&s.skipSubscribe)return o;(!n||n?.transportType===Kt.relay)&&await this.restartToComplete({topic:e,id:e,relay:r});const a={method:Nl(r.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:a});const c=(i=n?.internal)==null?void 0:i.throwOnFailedPublish;try{if(n?.transportType===Kt.link_mode)return setTimeout(()=>{(this.relayer.connected||this.relayer.connecting)&&this.relayer.request(a).catch(d=>this.logger.warn(d))},X.toMiliseconds(X.ONE_SECOND)),o;const l=new Promise(async d=>{const h=p=>{p.topic===e&&(this.events.removeListener(ys.created,h),d(p.id))};this.events.on(ys.created,h);try{const p=await Bi(new Promise((y,g)=>{this.relayer.request(a).catch(w=>{this.logger.warn(w,w?.message),g(w)}).then(y)}),this.initialSubscribeTimeout,`Subscribing to ${e} failed, please try again`);this.events.removeListener(ys.created,h),d(p)}catch{}}),u=await Bi(l,this.subscribeTimeout,`Subscribing to ${e} failed, please try again`);if(!u&&c)throw new Error(`Subscribing to ${e} failed, please try again`);return u?o:null}catch(l){if(this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(_r.connection_stalled),c)throw l}return null}async rpcBatchSubscribe(e){if(!e.length)return;const r=e[0].relay,n={method:Nl(r.protocol).batchSubscribe,params:{topics:e.map(s=>s.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{await await Bi(new Promise(s=>{this.relayer.request(n).catch(i=>this.logger.warn(i)).then(s)}),this.subscribeTimeout,"rpcBatchSubscribe failed, please try again")}catch{this.relayer.events.emit(_r.connection_stalled)}}async rpcBatchFetchMessages(e){if(!e.length)return;const r=e[0].relay,n={method:Nl(r.protocol).batchFetchMessages,params:{topics:e.map(i=>i.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});let s;try{s=await await Bi(new Promise((i,o)=>{this.relayer.request(n).catch(a=>{this.logger.warn(a),o(a)}).then(i)}),this.subscribeTimeout,"rpcBatchFetchMessages failed, please try again")}catch{this.relayer.events.emit(_r.connection_stalled)}return s}rpcUnsubscribe(e,r,n){const s={method:Nl(n.protocol).unsubscribe,params:{topic:e,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s}),this.relayer.request(s)}onSubscribe(e,r){this.setSubscription(e,zm(qu({},r),{id:e})),this.pending.delete(r.topic)}onBatchSubscribe(e){e.length&&e.forEach(r=>{this.setSubscription(r.id,qu({},r)),this.pending.delete(r.topic)})}async onUnsubscribe(e,r,n){this.events.removeAllListeners(r),this.hasSubscription(r,e)&&this.deleteSubscription(r,n),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,r){this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:r}),this.addSubscription(e,r)}addSubscription(e,r){this.subscriptions.set(e,qu({},r)),this.topicMap.set(r.topic,e),this.events.emit(ys.created,r)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const r=this.subscriptions.get(e);if(!r){const{message:n}=we("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(n)}return r}deleteSubscription(e,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:r});const n=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(n.topic,e),this.events.emit(ys.deleted,zm(qu({},n),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(ys.sync)}async onRestart(){if(this.cached.length){const e=[...this.cached],r=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let n=0;n<r;n++){const s=e.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(s)}}this.events.emit(ys.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size&&!e.every(r=>{var n;return r.topic===((n=this.subscriptions.get(r.id))==null?void 0:n.topic)})){const{message:r}=we("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){e.length&&(await this.rpcBatchSubscribe(e),this.onBatchSubscribe(await Promise.all(e.map(async r=>zm(qu({},r),{id:await this.getSubscriptionId(r.topic)})))))}async batchFetchMessages(e){if(!e.length)return;this.logger.trace(`Fetching batch messages for ${e.length} subscriptions`);const r=await this.rpcBatchFetchMessages(e);r&&r.messages&&(await X7(X.toMiliseconds(X.ONE_SECOND)),await this.relayer.handleBatchMessageEvents(r.messages))}async onConnect(){await this.restart(),this.reset()}onDisconnect(){this.onDisable()}isInitialized(){if(!this.initialized){const{message:e}=we("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(e){!this.relayer.connected&&!this.relayer.connecting&&(this.cached.push(e),await this.relayer.transportOpen())}async getClientId(){return this.clientId||(this.clientId=await this.relayer.core.crypto.getClientId()),this.clientId}async getSubscriptionId(e){return Vs(e+await this.getClientId())}};var yK=Object.defineProperty,yx=Object.getOwnPropertySymbols,mK=Object.prototype.hasOwnProperty,wK=Object.prototype.propertyIsEnumerable,J0=(t,e,r)=>e in t?yK(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,mx=(t,e)=>{for(var r in e||(e={}))mK.call(e,r)&&J0(t,r,e[r]);if(yx)for(var r of yx(e))wK.call(e,r)&&J0(t,r,e[r]);return t},St=(t,e,r)=>J0(t,typeof e!="symbol"?e+"":e,r);let bK=class extends xR{constructor(e){var r;super(e),St(this,"protocol","wc"),St(this,"version",2),St(this,"core"),St(this,"logger"),St(this,"events",new dr.EventEmitter),St(this,"provider"),St(this,"messages"),St(this,"subscriber"),St(this,"publisher"),St(this,"name",YH),St(this,"transportExplicitlyClosed",!1),St(this,"initialized",!1),St(this,"connectionAttemptInProgress",!1),St(this,"relayUrl"),St(this,"projectId"),St(this,"packageName"),St(this,"bundleId"),St(this,"hasExperiencedNetworkDisruption",!1),St(this,"pingTimeout"),St(this,"heartBeatTimeout",X.toMiliseconds(X.THIRTY_SECONDS+X.FIVE_SECONDS)),St(this,"reconnectTimeout"),St(this,"connectPromise"),St(this,"reconnectInProgress",!1),St(this,"requestsInFlight",[]),St(this,"connectTimeout",X.toMiliseconds(X.ONE_SECOND*15)),St(this,"request",async n=>{var s,i;this.logger.debug("Publishing Request Payload");const o=n.id||Tn().toString();await this.toEstablishConnection();try{this.logger.trace({id:o,method:n.method,topic:(s=n.params)==null?void 0:s.topic},"relayer.request - publishing...");const a=`${o}:${((i=n.params)==null?void 0:i.tag)||""}`;this.requestsInFlight.push(a);const c=await this.provider.request(n);return this.requestsInFlight=this.requestsInFlight.filter(l=>l!==a),c}catch(a){throw this.logger.debug(`Failed to Publish Request: ${o}`),a}}),St(this,"resetPingTimeout",()=>{Gp()&&(clearTimeout(this.pingTimeout),this.pingTimeout=setTimeout(()=>{var n,s,i,o;try{this.logger.debug({},"pingTimeout: Connection stalled, terminating..."),(o=(i=(s=(n=this.provider)==null?void 0:n.connection)==null?void 0:s.socket)==null?void 0:i.terminate)==null||o.call(i)}catch(a){this.logger.warn(a,a?.message)}},this.heartBeatTimeout))}),St(this,"onPayloadHandler",n=>{this.onProviderPayload(n),this.resetPingTimeout()}),St(this,"onConnectHandler",()=>{this.logger.warn({},"Relayer connected "),this.startPingTimeout(),this.events.emit(_r.connect)}),St(this,"onDisconnectHandler",()=>{this.logger.warn({},"Relayer disconnected "),this.requestsInFlight=[],this.onProviderDisconnect()}),St(this,"onProviderErrorHandler",n=>{this.logger.fatal(`Fatal socket error: ${n.message}`),this.events.emit(_r.error,n),this.logger.fatal("Fatal socket error received, closing transport"),this.transportClose()}),St(this,"registerProviderListeners",()=>{this.provider.on(Ps.payload,this.onPayloadHandler),this.provider.on(Ps.connect,this.onConnectHandler),this.provider.on(Ps.disconnect,this.onDisconnectHandler),this.provider.on(Ps.error,this.onProviderErrorHandler)}),this.core=e.core,this.logger=KT({logger:(r=e.logger)!=null?r:GH,name:this.name}),this.messages=new eK(this.logger,e.core),this.subscriber=new gK(this,this.logger),this.publisher=new oK(this,this.logger),this.projectId=e?.projectId,this.relayUrl=e?.relayUrl||iN,R7()?this.packageName=s2():D7()&&(this.bundleId=s2()),this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await Promise.all([this.messages.init(),this.subscriber.init()]),this.initialized=!0,this.transportOpen().catch(e=>this.logger.warn(e,e?.message))}get context(){return os(this.logger)}get connected(){var e,r,n;return((n=(r=(e=this.provider)==null?void 0:e.connection)==null?void 0:r.socket)==null?void 0:n.readyState)===1||!1}get connecting(){var e,r,n;return((n=(r=(e=this.provider)==null?void 0:e.connection)==null?void 0:r.socket)==null?void 0:n.readyState)===0||this.connectPromise!==void 0||!1}async publish(e,r,n){this.isInitialized(),await this.publisher.publish(e,r,n),await this.recordMessageEvent({topic:e,message:r,publishedAt:Date.now(),transportType:Kt.relay},hp.outbound)}async publishCustom(e){this.isInitialized(),await this.publisher.publishCustom(e)}async subscribe(e,r){var n,s,i;this.isInitialized(),(!(r!=null&&r.transportType)||r?.transportType==="relay")&&await this.toEstablishConnection();const o=typeof((n=r?.internal)==null?void 0:n.throwOnFailedPublish)>"u"?!0:(s=r?.internal)==null?void 0:s.throwOnFailedPublish;let a=((i=this.subscriber.topicMap.get(e))==null?void 0:i[0])||"",c;const l=u=>{u.topic===e&&(this.subscriber.off(ys.created,l),c())};return await Promise.all([new Promise(u=>{c=u,this.subscriber.on(ys.created,l)}),new Promise(async(u,d)=>{a=await this.subscriber.subscribe(e,mx({internal:{throwOnFailedPublish:o}},r)).catch(h=>{o&&d(h)})||a,u()})]),a}async unsubscribe(e,r){this.isInitialized(),await this.subscriber.unsubscribe(e,r)}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async transportDisconnect(){this.provider.disconnect&&(this.hasExperiencedNetworkDisruption||this.connected)?await Bi(this.provider.disconnect(),2e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.onProviderDisconnect()}async transportClose(){this.transportExplicitlyClosed=!0,await this.transportDisconnect()}async transportOpen(e){if(!this.subscriber.hasAnyTopics){this.logger.info("Starting WS connection skipped because the client has no topics to work with.");return}if(this.connectPromise?(this.logger.debug({},"Waiting for existing connection attempt to resolve..."),await this.connectPromise,this.logger.debug({},"Existing connection attempt resolved")):(this.connectPromise=new Promise(async(r,n)=>{await this.connect(e).then(r).catch(n).finally(()=>{this.connectPromise=void 0})}),await this.connectPromise),!this.connected)throw new Error(`Couldn't establish socket connection to the relay server: ${this.relayUrl}`)}async restartTransport(e){this.logger.debug({},"Restarting transport..."),!this.connectionAttemptInProgress&&(this.relayUrl=e||this.relayUrl,await this.confirmOnlineStateOrThrow(),await this.transportClose(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await X2())throw new Error("No internet connection detected. Please restart your network and try again.")}async handleBatchMessageEvents(e){if(e?.length===0){this.logger.trace("Batch message events is empty. Ignoring...");return}const r=e.sort((n,s)=>n.publishedAt-s.publishedAt);this.logger.debug(`Batch of ${r.length} message events sorted`);for(const n of r)try{await this.onMessageEvent(n)}catch(s){this.logger.warn(s,"Error while processing batch message event: "+s?.message)}this.logger.trace(`Batch of ${r.length} message events processed`)}async onLinkMessageEvent(e,r){const{topic:n}=e;if(!r.sessionExists){const s=Or(X.FIVE_MINUTES),i={topic:n,expiry:s,relay:{protocol:"irn"},active:!1};await this.core.pairing.pairings.set(n,i)}this.events.emit(_r.message,e),await this.recordMessageEvent(e,hp.inbound)}async connect(e){await this.confirmOnlineStateOrThrow(),e&&e!==this.relayUrl&&(this.relayUrl=e,await this.transportDisconnect()),this.connectionAttemptInProgress=!0,this.transportExplicitlyClosed=!1;let r=1;for(;r<6;){try{if(this.transportExplicitlyClosed)break;this.logger.debug({},`Connecting to ${this.relayUrl}, attempt: ${r}...`),await this.createProvider(),await new Promise(async(n,s)=>{const i=()=>{s(new Error("Connection interrupted while trying to connect"))};this.provider.once(Ps.disconnect,i),await Bi(new Promise((o,a)=>{this.provider.connect().then(o).catch(a)}),this.connectTimeout,`Socket stalled when trying to connect to ${this.relayUrl}`).catch(o=>{s(o)}).finally(()=>{this.provider.off(Ps.disconnect,i),clearTimeout(this.reconnectTimeout)}),await new Promise(async(o,a)=>{const c=()=>{s(new Error("Connection interrupted while trying to subscribe"))};this.provider.once(Ps.disconnect,c),await this.subscriber.start().then(o).catch(a).finally(()=>{this.provider.off(Ps.disconnect,c)})}),this.hasExperiencedNetworkDisruption=!1,n()})}catch(n){await this.subscriber.stop();const s=n;this.logger.warn({},s.message),this.hasExperiencedNetworkDisruption=!0}finally{this.connectionAttemptInProgress=!1}if(this.connected){this.logger.debug({},`Connected to ${this.relayUrl} successfully on attempt: ${r}`);break}await new Promise(n=>setTimeout(n,X.toMiliseconds(r*1))),r++}}startPingTimeout(){var e,r,n,s,i;if(Gp())try{(r=(e=this.provider)==null?void 0:e.connection)!=null&&r.socket&&((i=(s=(n=this.provider)==null?void 0:n.connection)==null?void 0:s.socket)==null||i.on("ping",()=>{this.resetPingTimeout()})),this.resetPingTimeout()}catch(o){this.logger.warn(o,o?.message)}}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new kH(new UH(j7({sdkVersion:V0,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0,bundleId:this.bundleId,packageName:this.packageName}))),this.registerProviderListeners()}async recordMessageEvent(e,r){const{topic:n,message:s}=e;await this.messages.set(n,s,r)}async shouldIgnoreMessageEvent(e){const{topic:r,message:n}=e;if(!n||n.length===0)return this.logger.warn(`Ignoring invalid/empty message: ${n}`),!0;if(!await this.subscriber.isKnownTopic(r))return this.logger.warn(`Ignoring message for unknown topic ${r}`),!0;const s=this.messages.has(r,n);return s&&this.logger.warn(`Ignoring duplicate message: ${n}`),s}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),yu(e)){if(!e.method.endsWith(XH))return;const r=e.params,{topic:n,message:s,publishedAt:i,attestation:o}=r.data,a={topic:n,message:s,publishedAt:i,transportType:Kt.relay,attestation:o};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(mx({type:"event",event:r.id},a)),this.events.emit(r.id,a),await this.acknowledgePayload(e),await this.onMessageEvent(a)}else Ua(e)&&this.events.emit(_r.message_ack,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(await this.recordMessageEvent(e,hp.inbound),this.events.emit(_r.message,e))}async acknowledgePayload(e){const r=Do(e.id,!0);await this.provider.connection.send(r)}unregisterProviderListeners(){this.provider.off(Ps.payload,this.onPayloadHandler),this.provider.off(Ps.connect,this.onConnectHandler),this.provider.off(Ps.disconnect,this.onDisconnectHandler),this.provider.off(Ps.error,this.onProviderErrorHandler),clearTimeout(this.pingTimeout)}async registerEventListeners(){let e=await X2();Bz(async r=>{e!==r&&(e=r,r?await this.transportOpen().catch(n=>this.logger.error(n,n?.message)):(this.hasExperiencedNetworkDisruption=!0,await this.transportDisconnect(),this.transportExplicitlyClosed=!1))}),this.core.heartbeat.on(zc.pulse,async()=>{if(!this.transportExplicitlyClosed&&!this.connected&&jz())try{await this.confirmOnlineStateOrThrow(),await this.transportOpen()}catch(r){this.logger.warn(r,r?.message)}})}async onProviderDisconnect(){clearTimeout(this.pingTimeout),this.events.emit(_r.disconnect),this.connectionAttemptInProgress=!1,!this.reconnectInProgress&&(this.reconnectInProgress=!0,await this.subscriber.stop(),this.subscriber.hasAnyTopics&&(this.transportExplicitlyClosed||(this.reconnectTimeout=setTimeout(async()=>{await this.transportOpen().catch(e=>this.logger.error(e,e?.message)),this.reconnectTimeout=void 0,this.reconnectInProgress=!1},X.toMiliseconds(ZH)))))}isInitialized(){if(!this.initialized){const{message:e}=we("NOT_INITIALIZED",this.name);throw new Error(e)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectPromise){await this.connectPromise;return}await this.connect()}}};function vK(t,e){return t===e||Number.isNaN(t)&&Number.isNaN(e)}function wx(t){return Object.getOwnPropertySymbols(t).filter(e=>Object.prototype.propertyIsEnumerable.call(t,e))}function bx(t){return t==null?t===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(t)}const EK="[object RegExp]",_K="[object String]",xK="[object Number]",SK="[object Boolean]",vx="[object Arguments]",AK="[object Symbol]",IK="[object Date]",CK="[object Map]",$K="[object Set]",TK="[object Array]",NK="[object Function]",OK="[object ArrayBuffer]",Hm="[object Object]",kK="[object Error]",PK="[object DataView]",RK="[object Uint8Array]",DK="[object Uint8ClampedArray]",UK="[object Uint16Array]",BK="[object Uint32Array]",LK="[object BigUint64Array]",MK="[object Int8Array]",jK="[object Int16Array]",FK="[object Int32Array]",qK="[object BigInt64Array]",zK="[object Float32Array]",HK="[object Float64Array]";function WK(){}function Ex(t){if(!t||typeof t!="object")return!1;const e=Object.getPrototypeOf(t);return e===null||e===Object.prototype||Object.getPrototypeOf(e)===null?Object.prototype.toString.call(t)==="[object Object]":!1}function VK(t,e,r){return od(t,e,void 0,void 0,void 0,void 0,r)}function od(t,e,r,n,s,i,o){const a=o(t,e,r,n,s,i);if(a!==void 0)return a;if(typeof t==typeof e)switch(typeof t){case"bigint":case"string":case"boolean":case"symbol":case"undefined":return t===e;case"number":return t===e||Object.is(t,e);case"function":return t===e;case"object":return bd(t,e,i,o)}return bd(t,e,i,o)}function bd(t,e,r,n){if(Object.is(t,e))return!0;let s=bx(t),i=bx(e);if(s===vx&&(s=Hm),i===vx&&(i=Hm),s!==i)return!1;switch(s){case _K:return t.toString()===e.toString();case xK:{const c=t.valueOf(),l=e.valueOf();return vK(c,l)}case SK:case IK:case AK:return Object.is(t.valueOf(),e.valueOf());case EK:return t.source===e.source&&t.flags===e.flags;case NK:return t===e}r=r??new Map;const o=r.get(t),a=r.get(e);if(o!=null&&a!=null)return o===e;r.set(t,e),r.set(e,t);try{switch(s){case CK:{if(t.size!==e.size)return!1;for(const[c,l]of t.entries())if(!e.has(c)||!od(l,e.get(c),c,t,e,r,n))return!1;return!0}case $K:{if(t.size!==e.size)return!1;const c=Array.from(t.values()),l=Array.from(e.values());for(let u=0;u<c.length;u++){const d=c[u],h=l.findIndex(p=>od(d,p,void 0,t,e,r,n));if(h===-1)return!1;l.splice(h,1)}return!0}case TK:case RK:case DK:case UK:case BK:case LK:case MK:case jK:case FK:case qK:case zK:case HK:{if(typeof Buffer<"u"&&Buffer.isBuffer(t)!==Buffer.isBuffer(e)||t.length!==e.length)return!1;for(let c=0;c<t.length;c++)if(!od(t[c],e[c],c,t,e,r,n))return!1;return!0}case OK:return t.byteLength!==e.byteLength?!1:bd(new Uint8Array(t),new Uint8Array(e),r,n);case PK:return t.byteLength!==e.byteLength||t.byteOffset!==e.byteOffset?!1:bd(new Uint8Array(t),new Uint8Array(e),r,n);case kK:return t.name===e.name&&t.message===e.message;case Hm:{if(!(bd(t.constructor,e.constructor,r,n)||Ex(t)&&Ex(e)))return!1;const c=[...Object.keys(t),...wx(t)],l=[...Object.keys(e),...wx(e)];if(c.length!==l.length)return!1;for(let u=0;u<c.length;u++){const d=c[u],h=t[d];if(!Object.hasOwn(e,d))return!1;const p=e[d];if(!od(h,p,d,t,e,r,n))return!1}return!0}default:return!1}}finally{r.delete(t),r.delete(e)}}function KK(t,e){return VK(t,e,WK)}var GK=Object.defineProperty,_x=Object.getOwnPropertySymbols,YK=Object.prototype.hasOwnProperty,XK=Object.prototype.propertyIsEnumerable,Q0=(t,e,r)=>e in t?GK(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,xx=(t,e)=>{for(var r in e||(e={}))YK.call(e,r)&&Q0(t,r,e[r]);if(_x)for(var r of _x(e))XK.call(e,r)&&Q0(t,r,e[r]);return t},Mn=(t,e,r)=>Q0(t,typeof e!="symbol"?e+"":e,r);let Kc=class extends SR{constructor(e,r,n,s=Vi,i=void 0){super(e,r,n,s),this.core=e,this.logger=r,this.name=n,Mn(this,"map",new Map),Mn(this,"version",JH),Mn(this,"cached",[]),Mn(this,"initialized",!1),Mn(this,"getKey"),Mn(this,"storagePrefix",Vi),Mn(this,"recentlyDeleted",[]),Mn(this,"recentlyDeletedLimit",200),Mn(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(o=>{this.getKey&&o!==null&&!Kr(o)?this.map.set(this.getKey(o),o):pz(o)?this.map.set(o.id,o):gz(o)&&this.map.set(o.topic,o)}),this.cached=[],this.initialized=!0)}),Mn(this,"set",async(o,a)=>{this.isInitialized(),this.map.has(o)?await this.update(o,a):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:o,value:a}),this.map.set(o,a),await this.persist())}),Mn(this,"get",o=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:o}),this.getData(o))),Mn(this,"getAll",o=>(this.isInitialized(),o?this.values.filter(a=>Object.keys(o).every(c=>KK(a[c],o[c]))):this.values)),Mn(this,"update",async(o,a)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:o,update:a});const c=xx(xx({},this.getData(o)),a);this.map.set(o,c),await this.persist()}),Mn(this,"delete",async(o,a)=>{this.isInitialized(),this.map.has(o)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:o,reason:a}),this.map.delete(o),this.addToRecentlyDeleted(o),await this.persist())}),this.logger=Cs(r,this.name),this.storagePrefix=s,this.getKey=i}get context(){return os(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}addToRecentlyDeleted(e){this.recentlyDeleted.push(e),this.recentlyDeleted.length>=this.recentlyDeletedLimit&&this.recentlyDeleted.splice(0,this.recentlyDeletedLimit/2)}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const r=this.map.get(e);if(!r){if(this.recentlyDeleted.includes(e)){const{message:s}=we("MISSING_OR_INVALID",`Record was recently deleted - ${this.name}: ${e}`);throw this.logger.error(s),new Error(s)}const{message:n}=we("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(n),new Error(n)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:r}=we("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=we("NOT_INITIALIZED",this.name);throw new Error(e)}}};var ZK=Object.defineProperty,JK=(t,e,r)=>e in t?ZK(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ut=(t,e,r)=>JK(t,typeof e!="symbol"?e+"":e,r);let QK=class{constructor(e,r){this.core=e,this.logger=r,ut(this,"name",rW),ut(this,"version",nW),ut(this,"events",new $h),ut(this,"pairings"),ut(this,"initialized",!1),ut(this,"storagePrefix",Vi),ut(this,"ignoredPayloadTypes",[No]),ut(this,"registeredMethods",[]),ut(this,"init",async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))}),ut(this,"register",({methods:n})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...n])]}),ut(this,"create",async n=>{this.isInitialized();const s=j0(),i=await this.core.crypto.setSymKey(s),o=Or(X.FIVE_MINUTES),a={protocol:sN},c={topic:i,expiry:o,relay:a,active:!1,methods:n?.methods},l=F2({protocol:this.core.protocol,version:this.core.version,topic:i,symKey:s,relay:a,expiryTimestamp:o,methods:n?.methods});return this.events.emit(ac.create,c),this.core.expirer.set(i,o),await this.pairings.set(i,c),await this.core.relayer.subscribe(i,{transportType:n?.transportType,internal:n?.internal}),{topic:i,uri:l}}),ut(this,"pair",async n=>{this.isInitialized();const s=this.core.eventClient.createEvent({properties:{topic:n?.uri,trace:[Oi.pairing_started]}});this.isValidPair(n,s);const{topic:i,symKey:o,relay:a,expiryTimestamp:c,methods:l}=j2(n.uri);s.props.properties.topic=i,s.addTrace(Oi.pairing_uri_validation_success),s.addTrace(Oi.pairing_uri_not_expired);let u;if(this.pairings.keys.includes(i)){if(u=this.pairings.get(i),s.addTrace(Oi.existing_pairing),u.active)throw s.setError(ao.active_pairing_already_exists),new Error(`Pairing already exists: ${i}. Please try again with a new connection URI.`);s.addTrace(Oi.pairing_not_expired)}const d=c||Or(X.FIVE_MINUTES),h={topic:i,relay:a,expiry:d,active:!1,methods:l};this.core.expirer.set(i,d),await this.pairings.set(i,h),s.addTrace(Oi.store_new_pairing),n.activatePairing&&await this.activate({topic:i}),this.events.emit(ac.create,h),s.addTrace(Oi.emit_inactive_pairing),this.core.crypto.keychain.has(i)||await this.core.crypto.setSymKey(o,i),s.addTrace(Oi.subscribing_pairing_topic);try{await this.core.relayer.confirmOnlineStateOrThrow()}catch{s.setError(ao.no_internet_connection)}try{await this.core.relayer.subscribe(i,{relay:a})}catch(p){throw s.setError(ao.subscribe_pairing_topic_failure),p}return s.addTrace(Oi.subscribe_pairing_topic_success),h}),ut(this,"activate",async({topic:n})=>{this.isInitialized();const s=Or(X.FIVE_MINUTES);this.core.expirer.set(n,s),await this.pairings.update(n,{active:!0,expiry:s})}),ut(this,"ping",async n=>{this.isInitialized(),await this.isValidPing(n),this.logger.warn("ping() is deprecated and will be removed in the next major release.");const{topic:s}=n;if(this.pairings.keys.includes(s)){const i=await this.sendRequest(s,"wc_pairingPing",{}),{done:o,resolve:a,reject:c}=ec();this.events.once(Ut("pairing_ping",i),({error:l})=>{l?c(l):a()}),await o()}}),ut(this,"updateExpiry",async({topic:n,expiry:s})=>{this.isInitialized(),await this.pairings.update(n,{expiry:s})}),ut(this,"updateMetadata",async({topic:n,metadata:s})=>{this.isInitialized(),await this.pairings.update(n,{peerMetadata:s})}),ut(this,"getPairings",()=>(this.isInitialized(),this.pairings.values)),ut(this,"disconnect",async n=>{this.isInitialized(),await this.isValidDisconnect(n);const{topic:s}=n;this.pairings.keys.includes(s)&&(await this.sendRequest(s,"wc_pairingDelete",lr("USER_DISCONNECTED")),await this.deletePairing(s))}),ut(this,"formatUriFromPairing",n=>{this.isInitialized();const{topic:s,relay:i,expiry:o,methods:a}=n,c=this.core.crypto.keychain.get(s);return F2({protocol:this.core.protocol,version:this.core.version,topic:s,symKey:c,relay:i,expiryTimestamp:o,methods:a})}),ut(this,"sendRequest",async(n,s,i)=>{const o=Ar(s,i),a=await this.core.crypto.encode(n,o),c=ju[s].req;return this.core.history.set(n,o),this.core.relayer.publish(n,a,c),o.id}),ut(this,"sendResult",async(n,s,i)=>{const o=Do(n,i),a=await this.core.crypto.encode(s,o),c=(await this.core.history.get(s,n)).request.method,l=ju[c].res;await this.core.relayer.publish(s,a,l),await this.core.history.resolve(o)}),ut(this,"sendError",async(n,s,i)=>{const o=Vc(n,i),a=await this.core.crypto.encode(s,o),c=(await this.core.history.get(s,n)).request.method,l=ju[c]?ju[c].res:ju.unregistered_method.res;await this.core.relayer.publish(s,a,l),await this.core.history.resolve(o)}),ut(this,"deletePairing",async(n,s)=>{await this.core.relayer.unsubscribe(n),await Promise.all([this.pairings.delete(n,lr("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(n),s?Promise.resolve():this.core.expirer.del(n)])}),ut(this,"cleanup",async()=>{const n=this.pairings.getAll().filter(s=>ia(s.expiry));await Promise.all(n.map(s=>this.deletePairing(s.topic)))}),ut(this,"onRelayEventRequest",async n=>{const{topic:s,payload:i}=n;switch(i.method){case"wc_pairingPing":return await this.onPairingPingRequest(s,i);case"wc_pairingDelete":return await this.onPairingDeleteRequest(s,i);default:return await this.onUnknownRpcMethodRequest(s,i)}}),ut(this,"onRelayEventResponse",async n=>{const{topic:s,payload:i}=n,o=(await this.core.history.get(s,i.id)).request.method;switch(o){case"wc_pairingPing":return this.onPairingPingResponse(s,i);default:return this.onUnknownRpcMethodResponse(o)}}),ut(this,"onPairingPingRequest",async(n,s)=>{const{id:i}=s;try{this.isValidPing({topic:n}),await this.sendResult(i,n,!0),this.events.emit(ac.ping,{id:i,topic:n})}catch(o){await this.sendError(i,n,o),this.logger.error(o)}}),ut(this,"onPairingPingResponse",(n,s)=>{const{id:i}=s;setTimeout(()=>{Rr(s)?this.events.emit(Ut("pairing_ping",i),{}):nr(s)&&this.events.emit(Ut("pairing_ping",i),{error:s.error})},500)}),ut(this,"onPairingDeleteRequest",async(n,s)=>{const{id:i}=s;try{this.isValidDisconnect({topic:n}),await this.deletePairing(n),this.events.emit(ac.delete,{id:i,topic:n})}catch(o){await this.sendError(i,n,o),this.logger.error(o)}}),ut(this,"onUnknownRpcMethodRequest",async(n,s)=>{const{id:i,method:o}=s;try{if(this.registeredMethods.includes(o))return;const a=lr("WC_METHOD_UNSUPPORTED",o);await this.sendError(i,n,a),this.logger.error(a)}catch(a){await this.sendError(i,n,a),this.logger.error(a)}}),ut(this,"onUnknownRpcMethodResponse",n=>{this.registeredMethods.includes(n)||this.logger.error(lr("WC_METHOD_UNSUPPORTED",n))}),ut(this,"isValidPair",(n,s)=>{var i;if(!Wn(n)){const{message:a}=we("MISSING_OR_INVALID",`pair() params: ${n}`);throw s.setError(ao.malformed_pairing_uri),new Error(a)}if(!fz(n.uri)){const{message:a}=we("MISSING_OR_INVALID",`pair() uri: ${n.uri}`);throw s.setError(ao.malformed_pairing_uri),new Error(a)}const o=j2(n?.uri);if(!((i=o?.relay)!=null&&i.protocol)){const{message:a}=we("MISSING_OR_INVALID","pair() uri#relay-protocol");throw s.setError(ao.malformed_pairing_uri),new Error(a)}if(!(o!=null&&o.symKey)){const{message:a}=we("MISSING_OR_INVALID","pair() uri#symKey");throw s.setError(ao.malformed_pairing_uri),new Error(a)}if(o!=null&&o.expiryTimestamp&&X.toMiliseconds(o?.expiryTimestamp)<Date.now()){s.setError(ao.pairing_expired);const{message:a}=we("EXPIRED","pair() URI has expired. Please try again with a new connection URI.");throw new Error(a)}}),ut(this,"isValidPing",async n=>{if(!Wn(n)){const{message:i}=we("MISSING_OR_INVALID",`ping() params: ${n}`);throw new Error(i)}const{topic:s}=n;await this.isValidPairingTopic(s)}),ut(this,"isValidDisconnect",async n=>{if(!Wn(n)){const{message:i}=we("MISSING_OR_INVALID",`disconnect() params: ${n}`);throw new Error(i)}const{topic:s}=n;await this.isValidPairingTopic(s)}),ut(this,"isValidPairingTopic",async n=>{if(!xr(n,!1)){const{message:s}=we("MISSING_OR_INVALID",`pairing topic should be a string: ${n}`);throw new Error(s)}if(!this.pairings.keys.includes(n)){const{message:s}=we("NO_MATCHING_KEY",`pairing topic doesn't exist: ${n}`);throw new Error(s)}if(ia(this.pairings.get(n).expiry)){await this.deletePairing(n);const{message:s}=we("EXPIRED",`pairing topic: ${n}`);throw new Error(s)}}),this.core=e,this.logger=Cs(r,this.name),this.pairings=new Kc(this.core,this.logger,this.name,this.storagePrefix)}get context(){return os(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=we("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(_r.message,async e=>{const{topic:r,message:n,transportType:s}=e;if(this.pairings.keys.includes(r)&&s!==Kt.link_mode&&!this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(n)))try{const i=await this.core.crypto.decode(r,n);yu(i)?(this.core.history.set(r,i),await this.onRelayEventRequest({topic:r,payload:i})):Ua(i)&&(await this.core.history.resolve(i),await this.onRelayEventResponse({topic:r,payload:i}),this.core.history.delete(r,i.id)),await this.core.relayer.messages.ack(r,n)}catch(i){this.logger.error(i)}})}registerExpirerEvents(){this.core.expirer.on(Fs.expired,async e=>{const{topic:r}=H$(e.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit(ac.expire,{topic:r}))})}};var eG=Object.defineProperty,tG=(t,e,r)=>e in t?eG(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Jr=(t,e,r)=>tG(t,typeof e!="symbol"?e+"":e,r);let rG=class extends vR{constructor(e,r){super(e,r),this.core=e,this.logger=r,Jr(this,"records",new Map),Jr(this,"events",new dr.EventEmitter),Jr(this,"name",sW),Jr(this,"version",iW),Jr(this,"cached",[]),Jr(this,"initialized",!1),Jr(this,"storagePrefix",Vi),Jr(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.records.set(n.id,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),Jr(this,"set",(n,s,i)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:n,request:s,chainId:i}),this.records.has(s.id))return;const o={id:s.id,topic:n,request:{method:s.method,params:s.params||null},chainId:i,expiry:Or(X.THIRTY_DAYS)};this.records.set(o.id,o),this.persist(),this.events.emit(ti.created,o)}),Jr(this,"resolve",async n=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:n}),!this.records.has(n.id))return;const s=await this.getRecord(n.id);typeof s.response>"u"&&(s.response=nr(n)?{error:n.error}:{result:n.result},this.records.set(s.id,s),this.persist(),this.events.emit(ti.updated,s))}),Jr(this,"get",async(n,s)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:n,id:s}),await this.getRecord(s))),Jr(this,"delete",(n,s)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:s}),this.values.forEach(i=>{if(i.topic===n){if(typeof s<"u"&&i.id!==s)return;this.records.delete(i.id),this.events.emit(ti.deleted,i)}}),this.persist()}),Jr(this,"exists",async(n,s)=>(this.isInitialized(),this.records.has(s)?(await this.getRecord(s)).topic===n:!1)),Jr(this,"on",(n,s)=>{this.events.on(n,s)}),Jr(this,"once",(n,s)=>{this.events.once(n,s)}),Jr(this,"off",(n,s)=>{this.events.off(n,s)}),Jr(this,"removeListener",(n,s)=>{this.events.removeListener(n,s)}),this.logger=Cs(r,this.name)}get context(){return os(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const n={topic:r.topic,request:Ar(r.request.method,r.request.params,r.id),chainId:r.chainId};return e.push(n)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const r=this.records.get(e);if(!r){const{message:n}=we("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(n)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(ti.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:r}=we("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(ti.created,e=>{const r=ti.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e})}),this.events.on(ti.updated,e=>{const r=ti.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e})}),this.events.on(ti.deleted,e=>{const r=ti.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e})}),this.core.heartbeat.on(zc.pulse,()=>{this.cleanup()})}cleanup(){try{this.isInitialized();let e=!1;this.records.forEach(r=>{X.toMiliseconds(r.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${r.id}`),this.records.delete(r.id),this.events.emit(ti.deleted,r,!1),e=!0)}),e&&this.persist()}catch(e){this.logger.warn(e)}}isInitialized(){if(!this.initialized){const{message:e}=we("NOT_INITIALIZED",this.name);throw new Error(e)}}};var nG=Object.defineProperty,sG=(t,e,r)=>e in t?nG(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,vn=(t,e,r)=>sG(t,typeof e!="symbol"?e+"":e,r);let iG=class extends IR{constructor(e,r){super(e,r),this.core=e,this.logger=r,vn(this,"expirations",new Map),vn(this,"events",new dr.EventEmitter),vn(this,"name",oW),vn(this,"version",aW),vn(this,"cached",[]),vn(this,"initialized",!1),vn(this,"storagePrefix",Vi),vn(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.expirations.set(n.target,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),vn(this,"has",n=>{try{const s=this.formatTarget(n);return typeof this.getExpiration(s)<"u"}catch{return!1}}),vn(this,"set",(n,s)=>{this.isInitialized();const i=this.formatTarget(n),o={target:i,expiry:s};this.expirations.set(i,o),this.checkExpiry(i,o),this.events.emit(Fs.created,{target:i,expiration:o})}),vn(this,"get",n=>{this.isInitialized();const s=this.formatTarget(n);return this.getExpiration(s)}),vn(this,"del",n=>{if(this.isInitialized(),this.has(n)){const s=this.formatTarget(n),i=this.getExpiration(s);this.expirations.delete(s),this.events.emit(Fs.deleted,{target:s,expiration:i})}}),vn(this,"on",(n,s)=>{this.events.on(n,s)}),vn(this,"once",(n,s)=>{this.events.once(n,s)}),vn(this,"off",(n,s)=>{this.events.off(n,s)}),vn(this,"removeListener",(n,s)=>{this.events.removeListener(n,s)}),this.logger=Cs(r,this.name)}get context(){return os(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return F7(e);if(typeof e=="number")return q7(e);const{message:r}=we("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(r)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Fs.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:r}=we("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const r=this.expirations.get(e);if(!r){const{message:n}=we("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.warn(n),new Error(n)}return r}checkExpiry(e,r){const{expiry:n}=r;X.toMiliseconds(n)-Date.now()<=0&&this.expire(e,r)}expire(e,r){this.expirations.delete(e),this.events.emit(Fs.expired,{target:e,expiration:r})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,r)=>this.checkExpiry(r,e))}registerEventListeners(){this.core.heartbeat.on(zc.pulse,()=>this.checkExpirations()),this.events.on(Fs.created,e=>{const r=Fs.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(Fs.expired,e=>{const r=Fs.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(Fs.deleted,e=>{const r=Fs.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=we("NOT_INITIALIZED",this.name);throw new Error(e)}}};var oG=Object.defineProperty,aG=(t,e,r)=>e in t?oG(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,wr=(t,e,r)=>aG(t,typeof e!="symbol"?e+"":e,r);let cG=class extends CR{constructor(e,r,n){super(e,r,n),this.core=e,this.logger=r,this.store=n,wr(this,"name",cW),wr(this,"abortController"),wr(this,"isDevEnv"),wr(this,"verifyUrlV3",uW),wr(this,"storagePrefix",Vi),wr(this,"version",nN),wr(this,"publicKey"),wr(this,"fetchPromise"),wr(this,"init",async()=>{var s;this.isDevEnv||(this.publicKey=await this.store.getItem(this.storeKey),this.publicKey&&X.toMiliseconds((s=this.publicKey)==null?void 0:s.expiresAt)<Date.now()&&(this.logger.debug("verify v2 public key expired"),await this.removePublicKey()))}),wr(this,"register",async s=>{if(!pu()||this.isDevEnv)return;const i=window.location.origin,{id:o,decryptedId:a}=s,c=`${this.verifyUrlV3}/attestation?projectId=${this.core.projectId}&origin=${i}&id=${o}&decryptedId=${a}`;try{const l=Xr.getDocument(),u=this.startAbortTimer(X.ONE_SECOND*5),d=await new Promise((h,p)=>{const y=()=>{window.removeEventListener("message",w),l.body.removeChild(g),p("attestation aborted")};this.abortController.signal.addEventListener("abort",y);const g=l.createElement("iframe");g.src=c,g.style.display="none",g.addEventListener("error",y,{signal:this.abortController.signal});const w=S=>{if(S.data&&typeof S.data=="string")try{const A=JSON.parse(S.data);if(A.type==="verify_attestation"){if(Xl(A.attestation).payload.id!==o)return;clearInterval(u),l.body.removeChild(g),this.abortController.signal.removeEventListener("abort",y),window.removeEventListener("message",w),h(A.attestation===null?"":A.attestation)}}catch(A){this.logger.warn(A)}};l.body.appendChild(g),window.addEventListener("message",w,{signal:this.abortController.signal})});return this.logger.debug(d,"jwt attestation"),d}catch(l){this.logger.warn(l)}return""}),wr(this,"resolve",async s=>{if(this.isDevEnv)return"";const{attestationId:i,hash:o,encryptedId:a}=s;if(i===""){this.logger.debug("resolve: attestationId is empty, skipping");return}if(i){if(Xl(i).payload.id!==a)return;const l=await this.isValidJwtAttestation(i);if(l){if(!l.isVerified){this.logger.warn("resolve: jwt attestation: origin url not verified");return}return l}}if(!o)return;const c=this.getVerifyUrl(s?.verifyUrl);return this.fetchAttestation(o,c)}),wr(this,"fetchAttestation",async(s,i)=>{this.logger.debug(`resolving attestation: ${s} from url: ${i}`);const o=this.startAbortTimer(X.ONE_SECOND*5),a=await fetch(`${i}/attestation/${s}?v2Supported=true`,{signal:this.abortController.signal});return clearTimeout(o),a.status===200?await a.json():void 0}),wr(this,"getVerifyUrl",s=>{let i=s||wd;return dW.includes(i)||(this.logger.info(`verify url: ${i}, not included in trusted list, assigning default: ${wd}`),i=wd),i}),wr(this,"fetchPublicKey",async()=>{try{this.logger.debug(`fetching public key from: ${this.verifyUrlV3}`);const s=this.startAbortTimer(X.FIVE_SECONDS),i=await fetch(`${this.verifyUrlV3}/public-key`,{signal:this.abortController.signal});return clearTimeout(s),await i.json()}catch(s){this.logger.warn(s)}}),wr(this,"persistPublicKey",async s=>{this.logger.debug(s,"persisting public key to local storage"),await this.store.setItem(this.storeKey,s),this.publicKey=s}),wr(this,"removePublicKey",async()=>{this.logger.debug("removing verify v2 public key from storage"),await this.store.removeItem(this.storeKey),this.publicKey=void 0}),wr(this,"isValidJwtAttestation",async s=>{const i=await this.getPublicKey();try{if(i)return this.validateAttestation(s,i)}catch(a){this.logger.error(a),this.logger.warn("error validating attestation")}const o=await this.fetchAndPersistPublicKey();try{if(o)return this.validateAttestation(s,o)}catch(a){this.logger.error(a),this.logger.warn("error validating attestation")}}),wr(this,"getPublicKey",async()=>this.publicKey?this.publicKey:await this.fetchAndPersistPublicKey()),wr(this,"fetchAndPersistPublicKey",async()=>{if(this.fetchPromise)return await this.fetchPromise,this.publicKey;this.fetchPromise=new Promise(async i=>{const o=await this.fetchPublicKey();o&&(await this.persistPublicKey(o),i(o))});const s=await this.fetchPromise;return this.fetchPromise=void 0,s}),wr(this,"validateAttestation",(s,i)=>{const o=Lq(s,i.publicKey),a={hasExpired:X.toMiliseconds(o.exp)<Date.now(),payload:o};if(a.hasExpired)throw this.logger.warn("resolve: jwt attestation expired"),new Error("JWT attestation expired");return{origin:a.payload.origin,isScam:a.payload.isScam,isVerified:a.payload.isVerified}}),this.logger=Cs(r,this.name),this.abortController=new AbortController,this.isDevEnv=z1(),this.init()}get storeKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//verify:public:key"}get context(){return os(this.logger)}startAbortTimer(e){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),X.toMiliseconds(e))}};var lG=Object.defineProperty,uG=(t,e,r)=>e in t?lG(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Sx=(t,e,r)=>uG(t,typeof e!="symbol"?e+"":e,r);let dG=class extends $R{constructor(e,r){super(e,r),this.projectId=e,this.logger=r,Sx(this,"context",hW),Sx(this,"registerDeviceToken",async n=>{const{clientId:s,token:i,notificationType:o,enableEncrypted:a=!1}=n,c=`${fW}/${this.projectId}/clients`;await fetch(c,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:s,type:o,token:i,always_raw:a})})}),this.logger=Cs(r,this.context)}};var hG=Object.defineProperty,Ax=Object.getOwnPropertySymbols,fG=Object.prototype.hasOwnProperty,pG=Object.prototype.propertyIsEnumerable,eb=(t,e,r)=>e in t?hG(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,zu=(t,e)=>{for(var r in e||(e={}))fG.call(e,r)&&eb(t,r,e[r]);if(Ax)for(var r of Ax(e))pG.call(e,r)&&eb(t,r,e[r]);return t},jr=(t,e,r)=>eb(t,typeof e!="symbol"?e+"":e,r);let gG=class extends TR{constructor(e,r,n=!0){super(e,r,n),this.core=e,this.logger=r,jr(this,"context",gW),jr(this,"storagePrefix",Vi),jr(this,"storageVersion",pW),jr(this,"events",new Map),jr(this,"shouldPersist",!1),jr(this,"init",async()=>{if(!z1())try{const s={eventId:o2(),timestamp:Date.now(),domain:this.getAppDomain(),props:{event:"INIT",type:"",properties:{client_id:await this.core.crypto.getClientId(),user_agent:q$(this.core.relayer.protocol,this.core.relayer.version,V0)}}};await this.sendEvent([s])}catch(s){this.logger.warn(s)}}),jr(this,"createEvent",s=>{const{event:i="ERROR",type:o="",properties:{topic:a,trace:c}}=s,l=o2(),u=this.core.projectId||"",d=Date.now(),h=zu({eventId:l,timestamp:d,props:{event:i,type:o,properties:{topic:a,trace:c}},bundleId:u,domain:this.getAppDomain()},this.setMethods(l));return this.telemetryEnabled&&(this.events.set(l,h),this.shouldPersist=!0),h}),jr(this,"getEvent",s=>{const{eventId:i,topic:o}=s;if(i)return this.events.get(i);const a=Array.from(this.events.values()).find(c=>c.props.properties.topic===o);if(a)return zu(zu({},a),this.setMethods(a.eventId))}),jr(this,"deleteEvent",s=>{const{eventId:i}=s;this.events.delete(i),this.shouldPersist=!0}),jr(this,"setEventListeners",()=>{this.core.heartbeat.on(zc.pulse,async()=>{this.shouldPersist&&await this.persist(),this.events.forEach(s=>{X.fromMiliseconds(Date.now())-X.fromMiliseconds(s.timestamp)>yW&&(this.events.delete(s.eventId),this.shouldPersist=!0)})})}),jr(this,"setMethods",s=>({addTrace:i=>this.addTrace(s,i),setError:i=>this.setError(s,i)})),jr(this,"addTrace",(s,i)=>{const o=this.events.get(s);o&&(o.props.properties.trace.push(i),this.events.set(s,o),this.shouldPersist=!0)}),jr(this,"setError",(s,i)=>{const o=this.events.get(s);o&&(o.props.type=i,o.timestamp=Date.now(),this.events.set(s,o),this.shouldPersist=!0)}),jr(this,"persist",async()=>{await this.core.storage.setItem(this.storageKey,Array.from(this.events.values())),this.shouldPersist=!1}),jr(this,"restore",async()=>{try{const s=await this.core.storage.getItem(this.storageKey)||[];if(!s.length)return;s.forEach(i=>{this.events.set(i.eventId,zu(zu({},i),this.setMethods(i.eventId)))})}catch(s){this.logger.warn(s)}}),jr(this,"submit",async()=>{if(!this.telemetryEnabled||this.events.size===0)return;const s=[];for(const[i,o]of this.events)o.props.type&&s.push(o);if(s.length!==0)try{if((await this.sendEvent(s)).ok)for(const i of s)this.events.delete(i.eventId),this.shouldPersist=!0}catch(i){this.logger.warn(i)}}),jr(this,"sendEvent",async s=>{const i=this.getAppDomain()?"":"&sp=desktop";return await fetch(`${mW}?projectId=${this.core.projectId}&st=events_sdk&sv=js-${V0}${i}`,{method:"POST",body:JSON.stringify(s)})}),jr(this,"getAppDomain",()=>F$().url),this.logger=Cs(r,this.context),this.telemetryEnabled=n,n?this.restore().then(async()=>{await this.submit(),this.setEventListeners()}):this.persist()}get storageKey(){return this.storagePrefix+this.storageVersion+this.core.customStoragePrefix+"//"+this.context}};var yG=Object.defineProperty,Ix=Object.getOwnPropertySymbols,mG=Object.prototype.hasOwnProperty,wG=Object.prototype.propertyIsEnumerable,tb=(t,e,r)=>e in t?yG(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Cx=(t,e)=>{for(var r in e||(e={}))mG.call(e,r)&&tb(t,r,e[r]);if(Ix)for(var r of Ix(e))wG.call(e,r)&&tb(t,r,e[r]);return t},Ht=(t,e,r)=>tb(t,typeof e!="symbol"?e+"":e,r);let bG=class wN extends yR{constructor(e){var r;super(e),Ht(this,"protocol",rN),Ht(this,"version",nN),Ht(this,"name",W0),Ht(this,"relayUrl"),Ht(this,"projectId"),Ht(this,"customStoragePrefix"),Ht(this,"events",new dr.EventEmitter),Ht(this,"logger"),Ht(this,"heartbeat"),Ht(this,"relayer"),Ht(this,"crypto"),Ht(this,"storage"),Ht(this,"history"),Ht(this,"expirer"),Ht(this,"pairing"),Ht(this,"verify"),Ht(this,"echoClient"),Ht(this,"linkModeSupportedApps"),Ht(this,"eventClient"),Ht(this,"initialized",!1),Ht(this,"logChunkController"),Ht(this,"on",(a,c)=>this.events.on(a,c)),Ht(this,"once",(a,c)=>this.events.once(a,c)),Ht(this,"off",(a,c)=>this.events.off(a,c)),Ht(this,"removeListener",(a,c)=>this.events.removeListener(a,c)),Ht(this,"dispatchEnvelope",({topic:a,message:c,sessionExists:l})=>{if(!a||!c)return;const u={topic:a,message:c,publishedAt:Date.now(),transportType:Kt.link_mode};this.relayer.onLinkMessageEvent(u,{sessionExists:l})});const n=this.getGlobalCore(e?.customStoragePrefix);if(n)try{return this.customStoragePrefix=n.customStoragePrefix,this.logger=n.logger,this.heartbeat=n.heartbeat,this.crypto=n.crypto,this.history=n.history,this.expirer=n.expirer,this.storage=n.storage,this.relayer=n.relayer,this.pairing=n.pairing,this.verify=n.verify,this.echoClient=n.echoClient,this.linkModeSupportedApps=n.linkModeSupportedApps,this.eventClient=n.eventClient,this.initialized=n.initialized,this.logChunkController=n.logChunkController,n}catch(a){console.warn("Failed to copy global core",a)}this.projectId=e?.projectId,this.relayUrl=e?.relayUrl||iN,this.customStoragePrefix=e!=null&&e.customStoragePrefix?`:${e.customStoragePrefix}`:"";const s=lR({level:typeof e?.logger=="string"&&e.logger?e.logger:LH.logger,name:W0}),{logger:i,chunkLoggerController:o}=a3({opts:s,maxSizeInBytes:e?.maxLogBlobSizeInBytes,loggerOverride:e?.logger});this.logChunkController=o,(r=this.logChunkController)!=null&&r.downloadLogsBlobInBrowser&&(window.downloadLogsBlobInBrowser=async()=>{var a,c;(a=this.logChunkController)!=null&&a.downloadLogsBlobInBrowser&&((c=this.logChunkController)==null||c.downloadLogsBlobInBrowser({clientId:await this.crypto.getClientId()}))}),this.logger=Cs(i,this.name),this.heartbeat=new a4,this.crypto=new VV(this,this.logger,e?.keychain),this.history=new rG(this,this.logger),this.expirer=new iG(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new s3(Cx(Cx({},MH),e?.storageOptions)),this.relayer=new bK({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new QK(this,this.logger),this.verify=new cG(this,this.logger,this.storage),this.echoClient=new dG(this.projectId||"",this.logger),this.linkModeSupportedApps=[],this.eventClient=new gG(this,this.logger,e?.telemetryEnabled),this.setGlobalCore(this)}static async init(e){const r=new wN(e);await r.initialize();const n=await r.crypto.getClientId();return await r.storage.setItem(QH,n),r}get context(){return os(this.logger)}async start(){this.initialized||await this.initialize()}async getLogsBlob(){var e;return(e=this.logChunkController)==null?void 0:e.logsToBlob({clientId:await this.crypto.getClientId()})}async addLinkModeSupportedApp(e){this.linkModeSupportedApps.includes(e)||(this.linkModeSupportedApps.push(e),await this.storage.setItem(ix,this.linkModeSupportedApps))}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.linkModeSupportedApps=await this.storage.getItem(ix)||[],this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(e,`Core Initialization Failure at epoch ${Date.now()}`),this.logger.error(e.message),e}}getGlobalCore(e=""){try{if(this.isGlobalCoreDisabled())return;const r=`_walletConnectCore_${e}`,n=`${r}_count`;return globalThis[n]=(globalThis[n]||0)+1,globalThis[n]>1&&console.warn(`WalletConnect Core is already initialized. This is probably a mistake and can lead to unexpected behavior. Init() was called ${globalThis[n]} times.`),globalThis[r]}catch(r){console.warn("Failed to get global WalletConnect core",r);return}}setGlobalCore(e){var r;try{if(this.isGlobalCoreDisabled())return;const n=`_walletConnectCore_${((r=e.opts)==null?void 0:r.customStoragePrefix)||""}`;globalThis[n]=e}catch(n){console.warn("Failed to set global WalletConnect core",n)}}isGlobalCoreDisabled(){try{return typeof process<"u"&&BH.DISABLE_GLOBAL_CORE==="true"}catch{return!0}}};const vG=bG,bN="wc",vN=2,EN="client",rv=`${bN}@${vN}:${EN}:`,Wm={name:EN,logger:"error"},$x="WALLETCONNECT_DEEPLINK_CHOICE",EG="proposal",Tx="Proposal expired",_G="session",gl=X.SEVEN_DAYS,xG="engine",Qr={wc_sessionPropose:{req:{ttl:X.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:X.FIVE_MINUTES,prompt:!1,tag:1101},reject:{ttl:X.FIVE_MINUTES,prompt:!1,tag:1120},autoReject:{ttl:X.FIVE_MINUTES,prompt:!1,tag:1121}},wc_sessionSettle:{req:{ttl:X.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:X.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:X.ONE_DAY,prompt:!1,tag:1104},res:{ttl:X.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:X.ONE_DAY,prompt:!1,tag:1106},res:{ttl:X.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:X.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:X.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:X.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:X.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:X.ONE_DAY,prompt:!1,tag:1112},res:{ttl:X.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:X.ONE_DAY,prompt:!1,tag:1114},res:{ttl:X.ONE_DAY,prompt:!1,tag:1115}},wc_sessionAuthenticate:{req:{ttl:X.ONE_HOUR,prompt:!0,tag:1116},res:{ttl:X.ONE_HOUR,prompt:!1,tag:1117},reject:{ttl:X.FIVE_MINUTES,prompt:!1,tag:1118},autoReject:{ttl:X.FIVE_MINUTES,prompt:!1,tag:1119}}},Vm={min:X.FIVE_MINUTES,max:X.SEVEN_DAYS},Ii={idle:"IDLE",active:"ACTIVE"},SG={eth_sendTransaction:{key:""},eth_sendRawTransaction:{key:""},wallet_sendCalls:{key:""},solana_signTransaction:{key:"signature"},solana_signAllTransactions:{key:"transactions"},solana_signAndSendTransaction:{key:"signature"},sui_signAndExecuteTransaction:{key:"digest"},sui_signTransaction:{key:""},hedera_signAndExecuteTransaction:{key:"transactionId"},hedera_executeTransaction:{key:"transactionId"},near_signTransaction:{key:""},near_signTransactions:{key:""},tron_signTransaction:{key:"txID"},xrpl_signTransaction:{key:""},xrpl_signTransactionFor:{key:""},algo_signTxn:{key:""},sendTransfer:{key:"txid"},stacks_stxTransfer:{key:"txId"},polkadot_signTransaction:{key:""},cosmos_signDirect:{key:""}},AG="request",IG=["wc_sessionPropose","wc_sessionRequest","wc_authRequest","wc_sessionAuthenticate"],CG="wc",$G="auth",TG="authKeys",NG="pairingTopics",OG="requests",sy=`${CG}@${1.5}:${$G}:`,fp=`${sy}:PUB_KEY`;var kG=Object.defineProperty,PG=Object.defineProperties,RG=Object.getOwnPropertyDescriptors,Nx=Object.getOwnPropertySymbols,DG=Object.prototype.hasOwnProperty,UG=Object.prototype.propertyIsEnumerable,rb=(t,e,r)=>e in t?kG(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Tt=(t,e)=>{for(var r in e||(e={}))DG.call(e,r)&&rb(t,r,e[r]);if(Nx)for(var r of Nx(e))UG.call(e,r)&&rb(t,r,e[r]);return t},en=(t,e)=>PG(t,RG(e)),le=(t,e,r)=>rb(t,typeof e!="symbol"?e+"":e,r);let BG=class extends PR{constructor(e){super(e),le(this,"name",xG),le(this,"events",new $h),le(this,"initialized",!1),le(this,"requestQueue",{state:Ii.idle,queue:[]}),le(this,"sessionRequestQueue",{state:Ii.idle,queue:[]}),le(this,"emittedSessionRequests",new Z7({limit:500})),le(this,"requestQueueDelay",X.ONE_SECOND),le(this,"expectedPairingMethodMap",new Map),le(this,"recentlyDeletedMap",new Map),le(this,"recentlyDeletedLimit",200),le(this,"relayMessageCache",[]),le(this,"pendingSessions",new Map),le(this,"init",async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),await this.registerLinkModeListeners(),this.client.core.pairing.register({methods:Object.keys(Qr)}),this.initialized=!0,setTimeout(async()=>{await this.processPendingMessageEvents(),this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},X.toMiliseconds(this.requestQueueDelay)))}),le(this,"connect",async r=>{var n;this.isInitialized(),await this.confirmOnlineStateOrThrow();const s=en(Tt({},r),{requiredNamespaces:r.requiredNamespaces||{},optionalNamespaces:r.optionalNamespaces||{}});await this.isValidConnect(s),s.optionalNamespaces=cz(s.requiredNamespaces,s.optionalNamespaces),s.requiredNamespaces={};const{pairingTopic:i,requiredNamespaces:o,optionalNamespaces:a,sessionProperties:c,scopedProperties:l,relays:u,authentication:d,walletPay:h}=s,p=((n=d?.[0])==null?void 0:n.ttl)||Qr.wc_sessionPropose.req.ttl||X.FIVE_MINUTES;this.validateRequestExpiry(p);let y=i,g,w=!1;try{if(y){const D=this.client.core.pairing.pairings.get(y);this.client.logger.warn("connect() with existing pairing topic is deprecated and will be removed in the next major release."),w=D.active}}catch(D){throw this.client.logger.error(`connect() -> pairing.get(${y}) failed`),D}if(!y||!w){const{topic:D,uri:W}=await this.client.core.pairing.create({internal:{skipSubscribe:!0}});y=D,g=W}if(!y){const{message:D}=we("NO_MATCHING_KEY",`connect() pairing topic: ${y}`);throw new Error(D)}const S=await this.client.core.crypto.generateKeyPair(),A=Or(p),E=Tt(en(Tt(Tt({requiredNamespaces:o,optionalNamespaces:a,relays:u??[{protocol:sN}],proposer:{publicKey:S,metadata:this.client.metadata},expiryTimestamp:A,pairingTopic:y},c&&{sessionProperties:c}),l&&{scopedProperties:l}),{id:Vr()}),(d||h)&&{requests:{authentication:d?.map(D=>{const{domain:W,chains:P,nonce:R,uri:T,exp:k,nbf:f,type:m,statement:_,requestId:$,resources:x,signatureTypes:N}=D;return{domain:W,chains:P,nonce:R,type:m??"caip122",aud:T,version:"1",iat:new Date().toISOString(),exp:k,nbf:f,statement:_,requestId:$,resources:x,signatureTypes:N}}),walletPay:h}}),v=Ut("session_connect",E.id),{reject:C,resolve:O,done:L}=ec(p,Tx),j=({id:D})=>{D===E.id&&(this.client.events.off("proposal_expire",j),this.pendingSessions.delete(E.id),this.events.emit(v,{error:{message:Tx,code:0}}))};return this.client.events.on("proposal_expire",j),this.events.once(v,({error:D,session:W})=>{this.client.events.off("proposal_expire",j),D?C(D):W&&O(W)}),await this.setProposal(E.id,E),await this.sendProposeSession({proposal:E,publishOpts:{internal:{throwOnFailedPublish:!0},tvf:{correlationId:E.id}}}).catch(D=>{throw this.deleteProposal(E.id),D}),{uri:g,approval:L}}),le(this,"pair",async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{return await this.client.core.pairing.pair(r)}catch(n){throw this.client.logger.error("pair() failed"),n}}),le(this,"approve",async r=>{var n,s,i;const o=this.client.core.eventClient.createEvent({properties:{topic:(n=r?.id)==null?void 0:n.toString(),trace:[ri.session_approve_started]}});try{this.isInitialized(),await this.confirmOnlineStateOrThrow()}catch(W){throw o.setError(Va.no_internet_connection),W}try{await this.isValidProposalId(r?.id)}catch(W){throw this.client.logger.error(`approve() -> proposal.get(${r?.id}) failed`),o.setError(Va.proposal_not_found),W}try{await this.isValidApprove(r)}catch(W){throw this.client.logger.error("approve() -> isValidApprove() failed"),o.setError(Va.session_approve_namespace_validation_failure),W}const{id:a,relayProtocol:c,namespaces:l,sessionProperties:u,scopedProperties:d,sessionConfig:h,proposalRequestsResponses:p}=r,y=this.client.proposal.get(a);this.client.core.eventClient.deleteEvent({eventId:o.eventId});const{pairingTopic:g,proposer:w,requiredNamespaces:S,optionalNamespaces:A}=y;let E=(s=this.client.core.eventClient)==null?void 0:s.getEvent({topic:g});E||(E=(i=this.client.core.eventClient)==null?void 0:i.createEvent({type:ri.session_approve_started,properties:{topic:g,trace:[ri.session_approve_started,ri.session_namespaces_validation_success]}}));const v=await this.client.core.crypto.generateKeyPair(),C=w.publicKey,O=await this.client.core.crypto.generateSharedKey(v,C),L=en(Tt(Tt(Tt({relay:{protocol:c??"irn"},namespaces:l,controller:{publicKey:v,metadata:this.client.metadata},expiry:Or(gl)},u&&{sessionProperties:u}),d&&{scopedProperties:d}),h&&{sessionConfig:h}),{proposalRequestsResponses:p}),j=Kt.relay;E.addTrace(ri.subscribing_session_topic);try{await this.client.core.relayer.subscribe(O,{transportType:j,internal:{skipSubscribe:!0}})}catch(W){throw E.setError(Va.subscribe_session_topic_failure),W}E.addTrace(ri.subscribe_session_topic_success);const D=en(Tt({},L),{topic:O,requiredNamespaces:S,optionalNamespaces:A,pairingTopic:g,acknowledged:!1,self:L.controller,peer:{publicKey:w.publicKey,metadata:w.metadata},controller:v,transportType:Kt.relay,authentication:p?.authentication,walletPayResult:p?.walletPay});await this.client.session.set(O,D),E.addTrace(ri.store_session);try{await this.sendApproveSession({sessionTopic:O,proposal:y,pairingProposalResponse:{relay:{protocol:c??"irn"},responderPublicKey:v},sessionSettleRequest:L,publishOpts:{internal:{throwOnFailedPublish:!0},tvf:Tt({correlationId:a},this.getTVFApproveParams(D))}}),E.addTrace(ri.session_approve_publish_success)}catch(W){throw this.client.logger.error(W),this.client.session.delete(O,lr("USER_DISCONNECTED")),await this.client.core.relayer.unsubscribe(O),W}return this.client.core.eventClient.deleteEvent({eventId:E.eventId}),await this.client.core.pairing.updateMetadata({topic:g,metadata:w.metadata}),await this.deleteProposal(a),await this.client.core.pairing.activate({topic:g}),await this.setExpiry(O,Or(gl)),{topic:O,acknowledged:()=>Promise.resolve(this.client.session.get(O))}}),le(this,"reject",async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidReject(r)}catch(o){throw this.client.logger.error("reject() -> isValidReject() failed"),o}const{id:n,reason:s}=r;let i;try{i=this.client.proposal.get(n).pairingTopic}catch(o){throw this.client.logger.error(`reject() -> proposal.get(${n}) failed`),o}i&&await this.sendError({id:n,topic:i,error:s,rpcOpts:Qr.wc_sessionPropose.reject}),await this.deleteProposal(n)}),le(this,"update",async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidUpdate(r)}catch(d){throw this.client.logger.error("update() -> isValidUpdate() failed"),d}const{topic:n,namespaces:s}=r,{done:i,resolve:o,reject:a}=ec(X.FIVE_MINUTES,"Session update request expired without receiving any acknowledgement"),c=Vr(),l=Tn().toString(),u=this.client.session.get(n).namespaces;return this.events.once(Ut("session_update",c),({error:d})=>{d?a(d):o()}),await this.client.session.update(n,{namespaces:s}),await this.sendRequest({topic:n,method:"wc_sessionUpdate",params:{namespaces:s},throwOnFailedPublish:!0,clientRpcId:c,relayRpcId:l}).catch(d=>{this.client.logger.error(d),this.client.session.update(n,{namespaces:u}),a(d)}),{acknowledged:i}}),le(this,"extend",async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidExtend(r)}catch(c){throw this.client.logger.error("extend() -> isValidExtend() failed"),c}const{topic:n}=r,s=Vr(),{done:i,resolve:o,reject:a}=ec(X.FIVE_MINUTES,"Session extend request expired without receiving any acknowledgement");return this.events.once(Ut("session_extend",s),({error:c})=>{c?a(c):o()}),await this.setExpiry(n,Or(gl)),this.sendRequest({topic:n,method:"wc_sessionExtend",params:{},clientRpcId:s,throwOnFailedPublish:!0}).catch(c=>{a(c)}),{acknowledged:i}}),le(this,"request",async r=>{this.isInitialized();try{await this.isValidRequest(r)}catch(w){throw this.client.logger.error("request() -> isValidRequest() failed"),w}const{chainId:n,request:s,topic:i,expiry:o=Qr.wc_sessionRequest.req.ttl}=r,a=this.client.session.get(i);a?.transportType===Kt.relay&&await this.confirmOnlineStateOrThrow();const c=Vr(),l=Tn().toString(),{done:u,resolve:d,reject:h}=ec(o,"Request expired. Please try again.");this.events.once(Ut("session_request",c),({error:w,result:S})=>{w?h(w):d(S)});const p="wc_sessionRequest",y=this.getAppLinkIfEnabled(a.peer.metadata,a.transportType);if(y)return await this.sendRequest({clientRpcId:c,relayRpcId:l,topic:i,method:p,params:{request:en(Tt({},s),{expiryTimestamp:Or(o)}),chainId:n},expiry:o,throwOnFailedPublish:!0,appLink:y}).catch(w=>h(w)),this.client.events.emit("session_request_sent",{topic:i,request:s,chainId:n,id:c}),await u();const g={request:en(Tt({},s),{expiryTimestamp:Or(o)}),chainId:n};return await Promise.all([new Promise(async w=>{await this.sendRequest({clientRpcId:c,relayRpcId:l,topic:i,method:p,params:g,expiry:o,throwOnFailedPublish:!0,tvf:this.getTVFParams(c,g)}).catch(S=>h(S)),this.client.events.emit("session_request_sent",{topic:i,request:s,chainId:n,id:c}),w()}),new Promise(async w=>{var S;if(!((S=a.sessionConfig)!=null&&S.disableDeepLink)){const A=await V7(this.client.core.storage,$x);await z7({id:c,topic:i,wcDeepLink:A})}w()}),u()]).then(w=>w[2])}),le(this,"respond",async r=>{var n,s;this.isInitialized();const i=this.client.core.eventClient.createEvent({properties:{topic:r?.topic||((s=(n=r?.response)==null?void 0:n.id)==null?void 0:s.toString()),trace:[ri.session_request_response_started]}});try{await this.isValidRespond(r)}catch(d){throw i.addTrace(d?.message),i.setError(Va.session_request_response_validation_failure),d}i.addTrace(ri.session_request_response_validation_success);const{topic:o,response:a}=r,{id:c}=a,l=this.client.session.get(o);l.transportType===Kt.relay&&await this.confirmOnlineStateOrThrow();const u=this.getAppLinkIfEnabled(l.peer.metadata,l.transportType);try{i.addTrace(ri.session_request_response_publish_started),Rr(a)?await this.sendResult({id:c,topic:o,result:a.result,throwOnFailedPublish:!0,appLink:u}):nr(a)&&await this.sendError({id:c,topic:o,error:a.error,appLink:u}),this.cleanupAfterResponse(r)}catch(d){throw i.addTrace(d?.message),i.setError(Va.session_request_response_publish_failure),d}}),le(this,"ping",async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidPing(r)}catch(s){throw this.client.logger.error("ping() -> isValidPing() failed"),s}const{topic:n}=r;if(this.client.session.keys.includes(n)){const s=Vr(),i=Tn().toString(),{done:o,resolve:a,reject:c}=ec(X.FIVE_MINUTES,"Ping request expired without receiving any acknowledgement");this.events.once(Ut("session_ping",s),({error:l})=>{l?c(l):a()}),await Promise.all([this.sendRequest({topic:n,method:"wc_sessionPing",params:{},throwOnFailedPublish:!0,clientRpcId:s,relayRpcId:i}),o()])}else this.client.core.pairing.pairings.keys.includes(n)&&(this.client.logger.warn("ping() on pairing topic is deprecated and will be removed in the next major release."),await this.client.core.pairing.ping({topic:n}))}),le(this,"emit",async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidEmit(r);const{topic:n,event:s,chainId:i}=r,o=Tn().toString(),a=Vr();await this.sendRequest({topic:n,method:"wc_sessionEvent",params:{event:s,chainId:i},throwOnFailedPublish:!0,relayRpcId:o,clientRpcId:a})}),le(this,"disconnect",async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidDisconnect(r);const{topic:n}=r;if(this.client.session.keys.includes(n))await this.sendRequest({topic:n,method:"wc_sessionDelete",params:lr("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession({topic:n,emitEvent:!1});else if(this.client.core.pairing.pairings.keys.includes(n))await this.client.core.pairing.disconnect({topic:n});else{const{message:s}=we("MISMATCHED_TOPIC",`Session or pairing topic not found: ${n}`);throw new Error(s)}}),le(this,"find",r=>(this.isInitialized(),this.client.session.getAll().filter(n=>dz(n,r)))),le(this,"getPendingSessionRequests",()=>this.client.pendingRequest.getAll()),le(this,"authenticate",async(r,n)=>{var s;this.isInitialized(),this.isValidAuthenticate(r);const i=n&&this.client.core.linkModeSupportedApps.includes(n)&&((s=this.client.metadata.redirect)==null?void 0:s.linkMode),o=i?Kt.link_mode:Kt.relay;o===Kt.relay&&await this.confirmOnlineStateOrThrow();const{chains:a,statement:c="",uri:l,domain:u,nonce:d,type:h,exp:p,nbf:y,methods:g=[],expiry:w}=r,S=[...r.resources||[]],{topic:A,uri:E}=await this.client.core.pairing.create({methods:["wc_sessionAuthenticate"],transportType:o});this.client.logger.info({message:"Generated new pairing",pairing:{topic:A,uri:E}});const v=await this.client.core.crypto.generateKeyPair(),C=dp(v);if(await Promise.all([this.client.auth.authKeys.set(fp,{responseTopic:C,publicKey:v}),this.client.auth.pairingTopics.set(C,{topic:C,pairingTopic:A})]),await this.client.core.relayer.subscribe(C,{transportType:o}),this.client.logger.info(`sending request to new pairing topic: ${A}`),g.length>0){const{namespace:x}=lp(a[0]);let N=uF(x,"request",g);up(S)&&(N=hF(N,S.pop())),S.push(N)}const O=w&&w>Qr.wc_sessionAuthenticate.req.ttl?w:Qr.wc_sessionAuthenticate.req.ttl,L={authPayload:{type:h??"caip122",chains:a,statement:c,aud:l,domain:u,version:"1",nonce:d,iat:new Date().toISOString(),exp:p,nbf:y,resources:S},requester:{publicKey:v,metadata:this.client.metadata},expiryTimestamp:Or(O)},j={eip155:{chains:a,methods:[...new Set(["personal_sign",...g])],events:["chainChanged","accountsChanged"]}},D={requiredNamespaces:{},optionalNamespaces:j,relays:[{protocol:"irn"}],pairingTopic:A,proposer:{publicKey:v,metadata:this.client.metadata},expiryTimestamp:Or(Qr.wc_sessionPropose.req.ttl),id:Vr()},{done:W,resolve:P,reject:R}=ec(O,"Request expired"),T=Vr(),k=Ut("session_connect",D.id),f=Ut("session_request",T),m=async({error:x,session:N})=>{this.events.off(f,_),x?R(x):N&&P({session:N})},_=async x=>{var N,H,z;if(await this.deletePendingAuthRequest(T,{message:"fulfilled",code:0}),x.error){const ne=lr("WC_METHOD_UNSUPPORTED","wc_sessionAuthenticate");return x.error.code===ne.code?void 0:(this.events.off(k,m),R(x.error.message))}await this.deleteProposal(D.id),this.events.off(k,m);const{cacaos:G,responder:M}=x.result,V=[],J=[];for(const ne of G){await m2({cacao:ne,projectId:this.client.core.projectId})||(this.client.logger.error(ne,"Signature verification failed"),R(lr("SESSION_SETTLEMENT_FAILED","Signature verification failed")));const{p:se}=ne,Ie=up(se.resources),Me=[N0(se.iss)],Ve=Xp(se.iss);if(Ie){const Ze=w2(Ie),Nt=b2(Ie);V.push(...Ze),Me.push(...Nt)}for(const Ze of Me)J.push(`${Ze}:${Ve}`)}const re=await this.client.core.crypto.generateSharedKey(v,M.publicKey);let ye;V.length>0&&(ye={topic:re,acknowledged:!0,self:{publicKey:v,metadata:this.client.metadata},peer:M,controller:M.publicKey,expiry:Or(gl),requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:A,namespaces:W2([...new Set(V)],[...new Set(J)]),transportType:o},await this.client.core.relayer.subscribe(re,{transportType:o}),await this.client.session.set(re,ye),A&&await this.client.core.pairing.updateMetadata({topic:A,metadata:M.metadata}),ye=this.client.session.get(re)),(N=this.client.metadata.redirect)!=null&&N.linkMode&&(H=M.metadata.redirect)!=null&&H.linkMode&&(z=M.metadata.redirect)!=null&&z.universal&&n&&(this.client.core.addLinkModeSupportedApp(M.metadata.redirect.universal),this.client.session.update(re,{transportType:Kt.link_mode})),P({auths:G,session:ye})};this.events.once(k,m),this.events.once(f,_);let $;try{if(i){const x=Ar("wc_sessionAuthenticate",L,T);this.client.core.history.set(A,x);const N=await this.client.core.crypto.encode("",x,{type:Mh,encoding:pa});$=If(n,A,N)}else await Promise.all([this.sendRequest({topic:A,method:"wc_sessionAuthenticate",params:L,expiry:r.expiry,throwOnFailedPublish:!0,clientRpcId:T}),this.sendRequest({topic:A,method:"wc_sessionPropose",params:D,expiry:Qr.wc_sessionPropose.req.ttl,throwOnFailedPublish:!0,clientRpcId:D.id})])}catch(x){throw this.events.off(k,m),this.events.off(f,_),x}return await this.setProposal(D.id,D),await this.setAuthRequest(T,{request:en(Tt({},L),{verifyContext:{}}),pairingTopic:A,transportType:o}),{uri:$??E,response:W}}),le(this,"approveSessionAuthenticate",async r=>{const{id:n,auths:s}=r,i=this.client.core.eventClient.createEvent({properties:{topic:n.toString(),trace:[Ka.authenticated_session_approve_started]}});try{this.isInitialized()}catch(w){throw i.setError(Fu.no_internet_connection),w}const o=this.getPendingAuthRequest(n);if(!o)throw i.setError(Fu.authenticated_session_pending_request_not_found),new Error(`Could not find pending auth request with id ${n}`);const a=o.transportType||Kt.relay;a===Kt.relay&&await this.confirmOnlineStateOrThrow();const c=o.requester.publicKey,l=await this.client.core.crypto.generateKeyPair(),u=dp(c),d={type:No,receiverPublicKey:c,senderPublicKey:l},h=[],p=[];for(const w of s){if(!await m2({cacao:w,projectId:this.client.core.projectId})){i.setError(Fu.invalid_cacao);const C=lr("SESSION_SETTLEMENT_FAILED","Signature verification failed");throw await this.sendError({id:n,topic:u,error:C,encodeOpts:d}),new Error(C.message)}i.addTrace(Ka.cacaos_verified);const{p:S}=w,A=up(S.resources),E=[N0(S.iss)],v=Xp(S.iss);if(A){const C=w2(A),O=b2(A);h.push(...C),E.push(...O)}for(const C of E)p.push(`${C}:${v}`)}const y=await this.client.core.crypto.generateSharedKey(l,c);i.addTrace(Ka.create_authenticated_session_topic);let g;if(h?.length>0){g={topic:y,acknowledged:!0,self:{publicKey:l,metadata:this.client.metadata},peer:{publicKey:c,metadata:o.requester.metadata},controller:c,expiry:Or(gl),authentication:s,requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:o.pairingTopic,namespaces:W2([...new Set(h)],[...new Set(p)]),transportType:a},i.addTrace(Ka.subscribing_authenticated_session_topic);try{await this.client.core.relayer.subscribe(y,{transportType:a})}catch(w){throw i.setError(Fu.subscribe_authenticated_session_topic_failure),w}i.addTrace(Ka.subscribe_authenticated_session_topic_success),await this.client.session.set(y,g),i.addTrace(Ka.store_authenticated_session),await this.client.core.pairing.updateMetadata({topic:o.pairingTopic,metadata:o.requester.metadata})}i.addTrace(Ka.publishing_authenticated_session_approve);try{await this.sendResult({topic:u,id:n,result:{cacaos:s,responder:{publicKey:l,metadata:this.client.metadata}},encodeOpts:d,throwOnFailedPublish:!0,appLink:this.getAppLinkIfEnabled(o.requester.metadata,a)})}catch(w){throw i.setError(Fu.authenticated_session_approve_publish_failure),w}return await this.client.auth.requests.delete(n,{message:"fulfilled",code:0}),await this.client.core.pairing.activate({topic:o.pairingTopic}),this.client.core.eventClient.deleteEvent({eventId:i.eventId}),{session:g}}),le(this,"rejectSessionAuthenticate",async r=>{this.isInitialized();const{id:n,reason:s}=r,i=this.getPendingAuthRequest(n);if(!i)throw new Error(`Could not find pending auth request with id ${n}`);i.transportType===Kt.relay&&await this.confirmOnlineStateOrThrow();const o=i.requester.publicKey,a=await this.client.core.crypto.generateKeyPair(),c=dp(o),l={type:No,receiverPublicKey:o,senderPublicKey:a};await this.sendError({id:n,topic:c,error:s,encodeOpts:l,rpcOpts:Qr.wc_sessionAuthenticate.reject,appLink:this.getAppLinkIfEnabled(i.requester.metadata,i.transportType)}),await this.client.auth.requests.delete(n,{message:"rejected",code:0}),await this.deleteProposal(n)}),le(this,"formatAuthMessage",r=>{this.isInitialized();const{request:n,iss:s}=r;return aT(n,s)}),le(this,"processRelayMessageCache",()=>{setTimeout(async()=>{if(this.relayMessageCache.length!==0)for(;this.relayMessageCache.length>0;)try{const r=this.relayMessageCache.shift();r&&await this.onRelayMessage(r)}catch(r){this.client.logger.error(r)}},50)}),le(this,"cleanupDuplicatePairings",async r=>{if(r.pairingTopic)try{const n=this.client.core.pairing.pairings.get(r.pairingTopic),s=this.client.core.pairing.pairings.getAll().filter(i=>{var o,a;return((o=i.peerMetadata)==null?void 0:o.url)&&((a=i.peerMetadata)==null?void 0:a.url)===r.peer.metadata.url&&i.topic&&i.topic!==n.topic});if(s.length===0)return;this.client.logger.info(`Cleaning up ${s.length} duplicate pairing(s)`),await Promise.all(s.map(i=>this.client.core.pairing.disconnect({topic:i.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(n){this.client.logger.error(n)}}),le(this,"deleteSession",async r=>{var n;const{topic:s,expirerHasDeleted:i=!1,emitEvent:o=!0,id:a=0}=r,{self:c}=this.client.session.get(s);await this.client.core.relayer.unsubscribe(s),await this.client.session.delete(s,lr("USER_DISCONNECTED")),this.addToRecentlyDeleted(s,"session"),this.client.core.crypto.keychain.has(c.publicKey)&&await this.client.core.crypto.deleteKeyPair(c.publicKey),this.client.core.crypto.keychain.has(s)&&await this.client.core.crypto.deleteSymKey(s),i||this.client.core.expirer.del(s),this.client.core.storage.removeItem($x).catch(l=>this.client.logger.warn(l)),s===((n=this.sessionRequestQueue.queue[0])==null?void 0:n.topic)&&(this.sessionRequestQueue.state=Ii.idle),await Promise.all(this.getPendingSessionRequests().filter(l=>l.topic===s).map(l=>this.deletePendingSessionRequest(l.id,lr("USER_DISCONNECTED")))),o&&this.client.events.emit("session_delete",{id:a,topic:s})}),le(this,"deleteProposal",async(r,n)=>{if(n)try{const s=this.client.proposal.get(r);this.client.core.eventClient.getEvent({topic:s.pairingTopic})?.setError(Va.proposal_expired)}catch{}await Promise.all([this.client.proposal.delete(r,lr("USER_DISCONNECTED")),n?Promise.resolve():this.client.core.expirer.del(r)]),this.addToRecentlyDeleted(r,"proposal")}),le(this,"deletePendingSessionRequest",async(r,n,s=!1)=>{await Promise.all([this.client.pendingRequest.delete(r,n),s?Promise.resolve():this.client.core.expirer.del(r)]),this.addToRecentlyDeleted(r,"request"),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(i=>i.id!==r),s&&(this.sessionRequestQueue.state=Ii.idle,this.client.events.emit("session_request_expire",{id:r}))}),le(this,"deletePendingAuthRequest",async(r,n,s=!1)=>{await Promise.all([this.client.auth.requests.delete(r,n),s?Promise.resolve():this.client.core.expirer.del(r)])}),le(this,"setExpiry",async(r,n)=>{this.client.session.keys.includes(r)&&(this.client.core.expirer.set(r,n),await this.client.session.update(r,{expiry:n}))}),le(this,"setProposal",async(r,n)=>{this.client.core.expirer.set(r,Or(Qr.wc_sessionPropose.req.ttl)),await this.client.proposal.set(r,n)}),le(this,"setAuthRequest",async(r,n)=>{const{request:s,pairingTopic:i,transportType:o=Kt.relay}=n;this.client.core.expirer.set(r,s.expiryTimestamp),await this.client.auth.requests.set(r,{authPayload:s.authPayload,requester:s.requester,expiryTimestamp:s.expiryTimestamp,id:r,pairingTopic:i,verifyContext:s.verifyContext,transportType:o})}),le(this,"setPendingSessionRequest",async r=>{const{id:n,topic:s,params:i,verifyContext:o}=r,a=i.request.expiryTimestamp||Or(Qr.wc_sessionRequest.req.ttl);this.client.core.expirer.set(n,a),await this.client.pendingRequest.set(n,{id:n,topic:s,params:i,verifyContext:o})}),le(this,"sendRequest",async r=>{const{topic:n,method:s,params:i,expiry:o,relayRpcId:a,clientRpcId:c,throwOnFailedPublish:l,appLink:u,tvf:d,publishOpts:h={}}=r,p=Ar(s,i,c);let y;const g=!!u;try{const A=g?pa:Xn;y=await this.client.core.crypto.encode(n,p,{encoding:A})}catch(A){throw await this.cleanup(),this.client.logger.error(`sendRequest() -> core.crypto.encode() for topic ${n} failed`),A}let w;if(IG.includes(s)){const A=Vs(JSON.stringify(p)),E=Vs(y);w=await this.client.core.verify.register({id:E,decryptedId:A})}const S=Tt(Tt({},Qr[s].req),h);if(S.attestation=w,o&&(S.ttl=o),a&&(S.id=a),this.client.core.history.set(n,p),g){const A=If(u,n,y);await global.Linking.openURL(A,this.client.name)}else S.tvf=en(Tt({},d),{correlationId:p.id}),l?(S.internal=en(Tt({},S.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(n,y,S)):this.client.core.relayer.publish(n,y,S).catch(A=>this.client.logger.error(A));return p.id}),le(this,"sendProposeSession",async r=>{const{proposal:n,publishOpts:s}=r,i=Ar("wc_sessionPropose",n,n.id);this.client.core.history.set(n.pairingTopic,i);const o=await this.client.core.crypto.encode(n.pairingTopic,i,{encoding:Xn}),a=Vs(JSON.stringify(i)),c=Vs(o),l=await this.client.core.verify.register({id:c,decryptedId:a});await this.client.core.relayer.publishCustom({payload:{pairingTopic:n.pairingTopic,sessionProposal:o},opts:en(Tt({},s),{publishMethod:"wc_proposeSession",attestation:l})})}),le(this,"sendApproveSession",async r=>{const{sessionTopic:n,pairingProposalResponse:s,proposal:i,sessionSettleRequest:o,publishOpts:a}=r,c=Do(i.id,s),l=await this.client.core.crypto.encode(i.pairingTopic,c,{encoding:Xn}),u=Ar("wc_sessionSettle",o,a?.id),d=await this.client.core.crypto.encode(n,u,{encoding:Xn});this.client.core.history.set(n,u),await this.client.core.relayer.publishCustom({payload:{sessionTopic:n,pairingTopic:i.pairingTopic,sessionProposalResponse:l,sessionSettlementRequest:d},opts:en(Tt({},a),{publishMethod:"wc_approveSession"})})}),le(this,"sendResult",async r=>{const{id:n,topic:s,result:i,throwOnFailedPublish:o,encodeOpts:a,appLink:c}=r,l=Do(n,i);let u;const d=c&&typeof(global==null?void 0:global.Linking)<"u";try{const y=d?pa:Xn;u=await this.client.core.crypto.encode(s,l,en(Tt({},a||{}),{encoding:y}))}catch(y){throw await this.cleanup(),this.client.logger.error(`sendResult() -> core.crypto.encode() for topic ${s} failed`),y}let h,p;try{h=await this.client.core.history.get(s,n);const y=h.request;try{p=this.getTVFParams(n,y.params,i)}catch(g){this.client.logger.warn(`sendResult() -> getTVFParams() failed: ${g?.message}`)}}catch(y){throw this.client.logger.error(`sendResult() -> history.get(${s}, ${n}) failed`),y}if(d){const y=If(c,s,u);await global.Linking.openURL(y,this.client.name)}else{const y=h.request.method,g=Qr[y].res;g.tvf=en(Tt({},p),{correlationId:n}),o?(g.internal=en(Tt({},g.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(s,u,g)):this.client.core.relayer.publish(s,u,g).catch(w=>this.client.logger.error(w))}await this.client.core.history.resolve(l)}),le(this,"sendError",async r=>{const{id:n,topic:s,error:i,encodeOpts:o,rpcOpts:a,appLink:c}=r,l=Vc(n,i);let u;const d=c&&typeof(global==null?void 0:global.Linking)<"u";try{const p=d?pa:Xn;u=await this.client.core.crypto.encode(s,l,en(Tt({},o||{}),{encoding:p}))}catch(p){throw await this.cleanup(),this.client.logger.error(`sendError() -> core.crypto.encode() for topic ${s} failed`),p}let h;try{h=await this.client.core.history.get(s,n)}catch(p){throw this.client.logger.error(`sendError() -> history.get(${s}, ${n}) failed`),p}if(d){const p=If(c,s,u);await global.Linking.openURL(p,this.client.name)}else{const p=h.request.method,y=a||Qr[p].res;this.client.core.relayer.publish(s,u,y)}await this.client.core.history.resolve(l)}),le(this,"cleanup",async()=>{const r=[],n=[];this.client.session.getAll().forEach(s=>{let i=!1;ia(s.expiry)&&(i=!0),this.client.core.crypto.keychain.has(s.topic)||(i=!0),i&&r.push(s.topic)}),this.client.proposal.getAll().forEach(s=>{ia(s.expiryTimestamp)&&n.push(s.id)}),await Promise.all([...r.map(s=>this.deleteSession({topic:s})),...n.map(s=>this.deleteProposal(s))])}),le(this,"onProviderMessageEvent",async r=>{!this.initialized||this.relayMessageCache.length>0?this.relayMessageCache.push(r):await this.onRelayMessage(r)}),le(this,"onRelayEventRequest",async r=>{this.requestQueue.queue.push(r),await this.processRequestsQueue()}),le(this,"processRequestsQueue",async()=>{if(this.requestQueue.state===Ii.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=Ii.active;const r=this.requestQueue.queue.shift();if(r)try{await this.processRequest(r)}catch(n){this.client.logger.warn(n)}}this.requestQueue.state=Ii.idle}),le(this,"processRequest",async r=>{const{topic:n,payload:s,attestation:i,transportType:o,encryptedId:a}=r,c=s.method;if(!this.shouldIgnorePairingRequest({topic:n,requestMethod:c}))switch(c){case"wc_sessionPropose":return await this.onSessionProposeRequest({topic:n,payload:s,attestation:i,encryptedId:a});case"wc_sessionSettle":return await this.onSessionSettleRequest(n,s);case"wc_sessionUpdate":return await this.onSessionUpdateRequest(n,s);case"wc_sessionExtend":return await this.onSessionExtendRequest(n,s);case"wc_sessionPing":return await this.onSessionPingRequest(n,s);case"wc_sessionDelete":return await this.onSessionDeleteRequest(n,s);case"wc_sessionRequest":return await this.onSessionRequest({topic:n,payload:s,attestation:i,encryptedId:a,transportType:o});case"wc_sessionEvent":return await this.onSessionEventRequest(n,s);case"wc_sessionAuthenticate":return await this.onSessionAuthenticateRequest({topic:n,payload:s,attestation:i,encryptedId:a,transportType:o});default:return this.client.logger.info(`Unsupported request method ${c}`)}}),le(this,"onRelayEventResponse",async r=>{const{topic:n,payload:s,transportType:i}=r,o=(await this.client.core.history.get(n,s.id)).request.method;switch(o){case"wc_sessionPropose":return this.onSessionProposeResponse(n,s,i);case"wc_sessionSettle":return this.onSessionSettleResponse(n,s);case"wc_sessionUpdate":return this.onSessionUpdateResponse(n,s);case"wc_sessionExtend":return this.onSessionExtendResponse(n,s);case"wc_sessionPing":return this.onSessionPingResponse(n,s);case"wc_sessionRequest":return this.onSessionRequestResponse(n,s);case"wc_sessionAuthenticate":return this.onSessionAuthenticateResponse(n,s);default:return this.client.logger.info(`Unsupported response method ${o}`)}}),le(this,"onRelayEventUnknownPayload",r=>{const{topic:n}=r,{message:s}=we("MISSING_OR_INVALID",`Decoded payload on topic ${n} is not identifiable as a JSON-RPC request or a response.`);throw new Error(s)}),le(this,"shouldIgnorePairingRequest",r=>{const{topic:n,requestMethod:s}=r,i=this.expectedPairingMethodMap.get(n);return!i||i.includes(s)?!1:!!(i.includes("wc_sessionAuthenticate")&&this.client.events.listenerCount("session_authenticate")>0)}),le(this,"onSessionProposeRequest",async r=>{const{topic:n,payload:s,attestation:i,encryptedId:o}=r,{params:a,id:c}=s;try{const l=this.client.core.eventClient.getEvent({topic:n});this.client.events.listenerCount("session_proposal")===0&&(console.warn("No listener for session_proposal event"),l?.setError(ao.proposal_listener_not_found)),this.isValidConnect(Tt({},s.params));const u=a.expiryTimestamp||Or(Qr.wc_sessionPropose.req.ttl),d=Tt({id:c,pairingTopic:n,expiryTimestamp:u,attestation:i,encryptedId:o},a);await this.setProposal(c,d);const h=await this.getVerifyContext({attestationId:i,hash:Vs(JSON.stringify(s)),encryptedId:o,metadata:d.proposer.metadata});l?.addTrace(Oi.emit_session_proposal),this.client.events.emit("session_proposal",{id:c,params:d,verifyContext:h})}catch(l){await this.sendError({id:c,topic:n,error:l,rpcOpts:Qr.wc_sessionPropose.autoReject}),this.client.logger.error(l)}}),le(this,"onSessionProposeResponse",async(r,n,s)=>{const{id:i}=n;if(Rr(n)){const{result:o}=n;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:o});const a=this.client.proposal.get(i);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:a});const c=a.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:c});const l=o.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:l});const u=await this.client.core.crypto.generateSharedKey(c,l);this.pendingSessions.set(i,{sessionTopic:u,pairingTopic:r,proposalId:i,publicKey:c});const d=await this.client.core.relayer.subscribe(u,{transportType:s});this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:d}),await this.client.core.pairing.activate({topic:r})}else if(nr(n)){await this.deleteProposal(i);const o=Ut("session_connect",i);if(this.events.listenerCount(o)===0)throw new Error(`emitting ${o} without any listeners, 954`);this.events.emit(o,{error:n.error})}}),le(this,"onSessionSettleRequest",async(r,n)=>{const{id:s,params:i}=n;try{this.isValidSessionSettleRequest(i);const{relay:o,controller:a,expiry:c,namespaces:l,sessionProperties:u,scopedProperties:d,sessionConfig:h,proposalRequestsResponses:p}=n.params,y=[...this.pendingSessions.values()].find(S=>S.sessionTopic===r);if(!y)return this.client.logger.error(`Pending session not found for topic ${r}`);const g=this.client.proposal.get(y.proposalId),w=en(Tt(Tt(Tt({topic:r,relay:o,expiry:c,namespaces:l,acknowledged:!0,pairingTopic:y.pairingTopic,requiredNamespaces:g.requiredNamespaces,optionalNamespaces:g.optionalNamespaces,controller:a.publicKey,self:{publicKey:y.publicKey,metadata:this.client.metadata},peer:{publicKey:a.publicKey,metadata:a.metadata}},u&&{sessionProperties:u}),d&&{scopedProperties:d}),h&&{sessionConfig:h}),{transportType:Kt.relay,authentication:p?.authentication,walletPayResult:p?.walletPay});await this.client.session.set(w.topic,w),await this.setExpiry(w.topic,w.expiry),await this.client.core.pairing.updateMetadata({topic:y.pairingTopic,metadata:w.peer.metadata}),this.pendingSessions.delete(y.proposalId),this.deleteProposal(y.proposalId,!1),this.cleanupDuplicatePairings(w),await this.sendResult({id:n.id,topic:r,throwOnFailedPublish:!0,result:!0}),this.client.events.emit("session_connect",{session:w}),this.events.emit(Ut("session_connect",y.proposalId),{session:w})}catch(o){await this.sendError({id:s,topic:r,error:o}),this.client.logger.error(o)}}),le(this,"onSessionSettleResponse",async(r,n)=>{const{id:s}=n;Rr(n)?(await this.client.session.update(r,{acknowledged:!0}),this.events.emit(Ut("session_approve",s),{})):nr(n)&&(await this.client.session.delete(r,lr("USER_DISCONNECTED")),this.events.emit(Ut("session_approve",s),{error:n.error}))}),le(this,"onSessionUpdateRequest",async(r,n)=>{const{params:s,id:i}=n;try{const o=`${r}_session_update`,a=Mu.get(o);if(a&&this.isRequestOutOfSync(a,i)){this.client.logger.warn(`Discarding out of sync request - ${i}`),this.sendError({id:i,topic:r,error:lr("INVALID_UPDATE_REQUEST")});return}this.isValidUpdate(Tt({topic:r},s));try{Mu.set(o,i),await this.client.session.update(r,{namespaces:s.namespaces}),await this.sendResult({id:i,topic:r,result:!0})}catch(c){throw Mu.delete(o),c}this.client.events.emit("session_update",{id:i,topic:r,params:s})}catch(o){await this.sendError({id:i,topic:r,error:o}),this.client.logger.error(o)}}),le(this,"isRequestOutOfSync",(r,n)=>n.toString().slice(0,-3)<r.toString().slice(0,-3)),le(this,"onSessionUpdateResponse",(r,n)=>{const{id:s}=n,i=Ut("session_update",s);if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners`);Rr(n)?this.events.emit(Ut("session_update",s),{}):nr(n)&&this.events.emit(Ut("session_update",s),{error:n.error})}),le(this,"onSessionExtendRequest",async(r,n)=>{const{id:s}=n;try{this.isValidExtend({topic:r}),await this.setExpiry(r,Or(gl)),await this.sendResult({id:s,topic:r,result:!0}),this.client.events.emit("session_extend",{id:s,topic:r})}catch(i){await this.sendError({id:s,topic:r,error:i}),this.client.logger.error(i)}}),le(this,"onSessionExtendResponse",(r,n)=>{const{id:s}=n,i=Ut("session_extend",s);if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners`);Rr(n)?this.events.emit(Ut("session_extend",s),{}):nr(n)&&this.events.emit(Ut("session_extend",s),{error:n.error})}),le(this,"onSessionPingRequest",async(r,n)=>{const{id:s}=n;try{this.isValidPing({topic:r}),await this.sendResult({id:s,topic:r,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_ping",{id:s,topic:r})}catch(i){await this.sendError({id:s,topic:r,error:i}),this.client.logger.error(i)}}),le(this,"onSessionPingResponse",(r,n)=>{const{id:s}=n,i=Ut("session_ping",s);setTimeout(()=>{if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners 2176`);Rr(n)?this.events.emit(Ut("session_ping",s),{}):nr(n)&&this.events.emit(Ut("session_ping",s),{error:n.error})},500)}),le(this,"onSessionDeleteRequest",async(r,n)=>{const{id:s}=n;try{await this.isValidDisconnect({topic:r,reason:n.params}),this.cleanupPendingSentRequestsForTopic({topic:r,error:lr("USER_DISCONNECTED")}),await this.deleteSession({topic:r,id:s})}catch(i){this.client.logger.error(i)}}),le(this,"onSessionRequest",async r=>{var n,s,i;const{topic:o,payload:a,attestation:c,encryptedId:l,transportType:u}=r,{id:d,params:h}=a;try{await this.isValidRequest(Tt({topic:o},h));const p=this.client.session.get(o),y=await this.getVerifyContext({attestationId:c,hash:Vs(JSON.stringify(Ar("wc_sessionRequest",h,d))),encryptedId:l,metadata:p.peer.metadata,transportType:u}),g={id:d,topic:o,params:h,verifyContext:y};await this.setPendingSessionRequest(g),u===Kt.link_mode&&(n=p.peer.metadata.redirect)!=null&&n.universal&&this.client.core.addLinkModeSupportedApp((s=p.peer.metadata.redirect)==null?void 0:s.universal),(i=this.client.signConfig)!=null&&i.disableRequestQueue?this.emitSessionRequest(g):(this.addSessionRequestToSessionRequestQueue(g),this.processSessionRequestQueue())}catch(p){await this.sendError({id:d,topic:o,error:p}),this.client.logger.error(p)}}),le(this,"onSessionRequestResponse",(r,n)=>{const{id:s}=n,i=Ut("session_request",s);if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners`);Rr(n)?this.events.emit(Ut("session_request",s),{result:n.result}):nr(n)&&this.events.emit(Ut("session_request",s),{error:n.error})}),le(this,"onSessionEventRequest",async(r,n)=>{const{id:s,params:i}=n;try{const o=`${r}_session_event_${i.event.name}`,a=Mu.get(o);if(a&&this.isRequestOutOfSync(a,s)){this.client.logger.info(`Discarding out of sync request - ${s}`);return}this.isValidEmit(Tt({topic:r},i)),this.client.events.emit("session_event",{id:s,topic:r,params:i}),Mu.set(o,s)}catch(o){await this.sendError({id:s,topic:r,error:o}),this.client.logger.error(o)}}),le(this,"onSessionAuthenticateResponse",(r,n)=>{const{id:s}=n;this.client.logger.trace({type:"method",method:"onSessionAuthenticateResponse",topic:r,payload:n}),Rr(n)?this.events.emit(Ut("session_request",s),{result:n.result}):nr(n)&&this.events.emit(Ut("session_request",s),{error:n.error})}),le(this,"onSessionAuthenticateRequest",async r=>{var n;const{topic:s,payload:i,attestation:o,encryptedId:a,transportType:c}=r;try{const{requester:l,authPayload:u,expiryTimestamp:d}=i.params,h=await this.getVerifyContext({attestationId:o,hash:Vs(JSON.stringify(i)),encryptedId:a,metadata:l.metadata,transportType:c}),p={requester:l,pairingTopic:s,id:i.id,authPayload:u,verifyContext:h,expiryTimestamp:d};await this.setAuthRequest(i.id,{request:p,pairingTopic:s,transportType:c}),c===Kt.link_mode&&(n=l.metadata.redirect)!=null&&n.universal&&this.client.core.addLinkModeSupportedApp(l.metadata.redirect.universal),this.client.events.emit("session_authenticate",{topic:s,params:i.params,id:i.id,verifyContext:h})}catch(l){this.client.logger.error(l);const u=i.params.requester.publicKey,d=await this.client.core.crypto.generateKeyPair(),h=this.getAppLinkIfEnabled(i.params.requester.metadata,c),p={type:No,receiverPublicKey:u,senderPublicKey:d};await this.sendError({id:i.id,topic:s,error:l,encodeOpts:p,rpcOpts:Qr.wc_sessionAuthenticate.autoReject,appLink:h})}}),le(this,"addSessionRequestToSessionRequestQueue",r=>{this.sessionRequestQueue.queue.push(r)}),le(this,"cleanupAfterResponse",r=>{this.deletePendingSessionRequest(r.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=Ii.idle,this.processSessionRequestQueue()},X.toMiliseconds(this.requestQueueDelay))}),le(this,"cleanupPendingSentRequestsForTopic",({topic:r,error:n})=>{const s=this.client.core.history.pending;s.length>0&&s.filter(i=>i.topic===r&&i.request.method==="wc_sessionRequest").forEach(i=>{this.events.emit(Ut("session_request",i.request.id),{error:n})})}),le(this,"processSessionRequestQueue",()=>{if(this.sessionRequestQueue.state===Ii.active){this.client.logger.info("session request queue is already active.");return}const r=this.sessionRequestQueue.queue[0];if(!r){this.client.logger.info("session request queue is empty.");return}try{this.emitSessionRequest(r)}catch(n){this.client.logger.error(n)}}),le(this,"emitSessionRequest",r=>{if(this.emittedSessionRequests.has(r.id)){this.client.logger.warn({id:r.id},`Skipping emitting \`session_request\` event for duplicate request. id: ${r.id}`);return}this.sessionRequestQueue.state=Ii.active,this.emittedSessionRequests.add(r.id),this.client.events.emit("session_request",r)}),le(this,"onPairingCreated",r=>{if(r.methods&&this.expectedPairingMethodMap.set(r.topic,r.methods),r.active)return;const n=this.client.proposal.getAll().find(s=>s.pairingTopic===r.topic);n&&this.onSessionProposeRequest({topic:r.topic,payload:Ar("wc_sessionPropose",en(Tt({},n),{requiredNamespaces:n.requiredNamespaces,optionalNamespaces:n.optionalNamespaces,relays:n.relays,proposer:n.proposer,sessionProperties:n.sessionProperties,scopedProperties:n.scopedProperties}),n.id),attestation:n.attestation,encryptedId:n.encryptedId})}),le(this,"isValidConnect",async r=>{if(!Wn(r)){const{message:l}=we("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(r)}`);throw new Error(l)}const{pairingTopic:n,requiredNamespaces:s,optionalNamespaces:i,sessionProperties:o,scopedProperties:a,relays:c}=r;if(Kr(n)||await this.isValidPairingTopic(n),!xz(c)){const{message:l}=we("MISSING_OR_INVALID",`connect() relays: ${c}`);throw new Error(l)}if(s&&!Kr(s)&&qd(s)!==0){const l="requiredNamespaces are deprecated and are automatically assigned to optionalNamespaces";["fatal","error","silent"].includes(this.client.logger.level)?console.warn(l):this.client.logger.warn(l),this.validateNamespaces(s,"requiredNamespaces")}if(i&&!Kr(i)&&qd(i)!==0&&this.validateNamespaces(i,"optionalNamespaces"),o&&!Kr(o)&&this.validateSessionProps(o,"sessionProperties"),a&&!Kr(a)){this.validateSessionProps(a,"scopedProperties");const l=Object.keys(s||{}).concat(Object.keys(i||{}));if(!Object.keys(a).every(u=>l.includes(u.split(":")[0])))throw new Error(`Scoped properties must be a subset of required/optional namespaces, received: ${JSON.stringify(a)}, required/optional namespaces: ${JSON.stringify(l)}`)}}),le(this,"validateNamespaces",(r,n)=>{const s=_z(r,"connect()",n);if(s)throw new Error(s.message)}),le(this,"isValidApprove",async r=>{if(!Wn(r))throw new Error(we("MISSING_OR_INVALID",`approve() params: ${r}`).message);const{id:n,namespaces:s,relayProtocol:i,sessionProperties:o,scopedProperties:a}=r;this.checkRecentlyDeleted(n),await this.isValidProposalId(n);const c=this.client.proposal.get(n),l=Mm(s,"approve()");if(l)throw new Error(l.message);const u=G2(c.requiredNamespaces,s,"approve()");if(u)throw new Error(u.message);if(!xr(i,!0)){const{message:d}=we("MISSING_OR_INVALID",`approve() relayProtocol: ${i}`);throw new Error(d)}if(o&&!Kr(o)&&this.validateSessionProps(o,"sessionProperties"),a&&!Kr(a)){this.validateSessionProps(a,"scopedProperties");const d=new Set(Object.keys(s));if(!Object.keys(a).every(h=>d.has(h.split(":")[0])))throw new Error(`Scoped properties must be a subset of approved namespaces, received: ${JSON.stringify(a)}, approved namespaces: ${Array.from(d).join(", ")}`)}}),le(this,"isValidReject",async r=>{if(!Wn(r)){const{message:i}=we("MISSING_OR_INVALID",`reject() params: ${r}`);throw new Error(i)}const{id:n,reason:s}=r;if(this.checkRecentlyDeleted(n),await this.isValidProposalId(n),!Az(s)){const{message:i}=we("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(s)}`);throw new Error(i)}}),le(this,"isValidSessionSettleRequest",r=>{if(!Wn(r)){const{message:l}=we("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${r}`);throw new Error(l)}const{relay:n,controller:s,namespaces:i,expiry:o}=r;if(!VT(n)){const{message:l}=we("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(l)}const a=yz(s,"onSessionSettleRequest()");if(a)throw new Error(a.message);const c=Mm(i,"onSessionSettleRequest()");if(c)throw new Error(c.message);if(ia(o)){const{message:l}=we("EXPIRED","onSessionSettleRequest()");throw new Error(l)}}),le(this,"isValidUpdate",async r=>{if(!Wn(r)){const{message:c}=we("MISSING_OR_INVALID",`update() params: ${r}`);throw new Error(c)}const{topic:n,namespaces:s}=r;this.checkRecentlyDeleted(n),await this.isValidSessionTopic(n);const i=this.client.session.get(n),o=Mm(s,"update()");if(o)throw new Error(o.message);const a=G2(i.requiredNamespaces,s,"update()");if(a)throw new Error(a.message)}),le(this,"isValidExtend",async r=>{if(!Wn(r)){const{message:s}=we("MISSING_OR_INVALID",`extend() params: ${r}`);throw new Error(s)}const{topic:n}=r;this.checkRecentlyDeleted(n),await this.isValidSessionTopic(n)}),le(this,"isValidRequest",async r=>{if(!Wn(r)){const{message:c}=we("MISSING_OR_INVALID",`request() params: ${r}`);throw new Error(c)}const{topic:n,request:s,chainId:i,expiry:o}=r;this.checkRecentlyDeleted(n),await this.isValidSessionTopic(n);const{namespaces:a}=this.client.session.get(n);if(!K2(a,i)){const{message:c}=we("MISSING_OR_INVALID",`request() chainId: ${i}`);throw new Error(c)}if(!Iz(s)){const{message:c}=we("MISSING_OR_INVALID",`request() ${JSON.stringify(s)}`);throw new Error(c)}if(!Tz(a,i,s.method)){const{message:c}=we("MISSING_OR_INVALID",`request() method: ${s.method}`);throw new Error(c)}this.validateRequestExpiry(o)}),le(this,"isValidRespond",async r=>{var n;if(!Wn(r)){const{message:a}=we("MISSING_OR_INVALID",`respond() params: ${r}`);throw new Error(a)}const{topic:s,response:i}=r;try{await this.isValidSessionTopic(s)}catch(a){throw(n=r?.response)!=null&&n.id&&this.cleanupAfterResponse(r),a}if(!Cz(i)){const{message:a}=we("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(i)}`);throw new Error(a)}const o=this.client.pendingRequest.get(i.id);if(o.topic!==s){const{message:a}=we("MISMATCHED_TOPIC",`Request response topic mismatch. reqId: ${i.id}, expected topic: ${o.topic}, received topic: ${s}`);throw new Error(a)}}),le(this,"isValidPing",async r=>{if(!Wn(r)){const{message:s}=we("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(s)}const{topic:n}=r;await this.isValidSessionOrPairingTopic(n)}),le(this,"isValidEmit",async r=>{if(!Wn(r)){const{message:a}=we("MISSING_OR_INVALID",`emit() params: ${r}`);throw new Error(a)}const{topic:n,event:s,chainId:i}=r;await this.isValidSessionTopic(n);const{namespaces:o}=this.client.session.get(n);if(!K2(o,i)){const{message:a}=we("MISSING_OR_INVALID",`emit() chainId: ${i}`);throw new Error(a)}if(!$z(s)){const{message:a}=we("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(s)}`);throw new Error(a)}if(!Nz(o,i,s.name)){const{message:a}=we("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(s)}`);throw new Error(a)}}),le(this,"isValidDisconnect",async r=>{if(!Wn(r)){const{message:s}=we("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(s)}const{topic:n}=r;await this.isValidSessionOrPairingTopic(n)}),le(this,"isValidAuthenticate",r=>{const{chains:n,uri:s,domain:i,nonce:o}=r;if(!Array.isArray(n)||n.length===0)throw new Error("chains is required and must be a non-empty array");if(!xr(s,!1))throw new Error("uri is required parameter");if(!xr(i,!1))throw new Error("domain is required parameter");if(!xr(o,!1))throw new Error("nonce is required parameter");if([...new Set(n.map(c=>lp(c).namespace))].length>1)throw new Error("Multi-namespace requests are not supported. Please request single namespace only.");const{namespace:a}=lp(n[0]);if(a!=="eip155")throw new Error("Only eip155 namespace is supported for authenticated sessions. Please use .connect() for non-eip155 chains.")}),le(this,"getVerifyContext",async r=>{const{attestationId:n,hash:s,encryptedId:i,metadata:o,transportType:a}=r,c={verified:{verifyUrl:o.verifyUrl||wd,validation:"UNKNOWN",origin:o.url||""}};try{if(a===Kt.link_mode){const u=this.getAppLinkIfEnabled(o,a);return c.verified.validation=u&&new URL(u).origin===new URL(o.url).origin?"VALID":"INVALID",c}const l=await this.client.core.verify.resolve({attestationId:n,hash:s,encryptedId:i,verifyUrl:o.verifyUrl});l&&(c.verified.origin=l.origin,c.verified.isScam=l.isScam,c.verified.validation=l.origin===new URL(o.url).origin?"VALID":"INVALID")}catch(l){this.client.logger.warn(l)}return this.client.logger.debug(`Verify context: ${JSON.stringify(c)}`),c}),le(this,"validateSessionProps",(r,n)=>{Object.values(r).forEach((s,i)=>{if(s==null){const{message:o}=we("MISSING_OR_INVALID",`${n} must contain an existing value for each key. Received: ${s} for key ${Object.keys(r)[i]}`);throw new Error(o)}})}),le(this,"getPendingAuthRequest",r=>{const n=this.client.auth.requests.get(r);return typeof n=="object"?n:void 0}),le(this,"addToRecentlyDeleted",(r,n)=>{if(this.recentlyDeletedMap.set(r,n),this.recentlyDeletedMap.size>=this.recentlyDeletedLimit){let s=0;const i=this.recentlyDeletedLimit/2;for(const o of this.recentlyDeletedMap.keys()){if(s++>=i)break;this.recentlyDeletedMap.delete(o)}}}),le(this,"checkRecentlyDeleted",r=>{const n=this.recentlyDeletedMap.get(r);if(n){const{message:s}=we("MISSING_OR_INVALID",`Record was recently deleted - ${n}: ${r}`);throw new Error(s)}}),le(this,"isLinkModeEnabled",(r,n)=>{var s,i,o,a,c,l,u,d,h;return!r||n!==Kt.link_mode?!1:((i=(s=this.client.metadata)==null?void 0:s.redirect)==null?void 0:i.linkMode)===!0&&((a=(o=this.client.metadata)==null?void 0:o.redirect)==null?void 0:a.universal)!==void 0&&((l=(c=this.client.metadata)==null?void 0:c.redirect)==null?void 0:l.universal)!==""&&((u=r?.redirect)==null?void 0:u.universal)!==void 0&&((d=r?.redirect)==null?void 0:d.universal)!==""&&((h=r?.redirect)==null?void 0:h.linkMode)===!0&&this.client.core.linkModeSupportedApps.includes(r.redirect.universal)&&typeof(global==null?void 0:global.Linking)<"u"}),le(this,"getAppLinkIfEnabled",(r,n)=>{var s;return this.isLinkModeEnabled(r,n)?(s=r?.redirect)==null?void 0:s.universal:void 0}),le(this,"handleLinkModeMessage",({url:r})=>{if(!r||!r.includes("wc_ev")||!r.includes("topic"))return;const n=i2(r,"topic")||"",s=decodeURIComponent(i2(r,"wc_ev")||""),i=this.client.session.keys.includes(n);i&&this.client.session.update(n,{transportType:Kt.link_mode}),this.client.core.dispatchEnvelope({topic:n,message:s,sessionExists:i})}),le(this,"registerLinkModeListeners",async()=>{var r;if(z1()||Ra()&&(r=this.client.metadata.redirect)!=null&&r.linkMode){const n=global==null?void 0:global.Linking;if(typeof n<"u"){n.addEventListener("url",this.handleLinkModeMessage,this.client.name);const s=await n.getInitialURL();s&&setTimeout(()=>{this.handleLinkModeMessage({url:s})},50)}}}),le(this,"getTVFApproveParams",r=>{try{const n=zT(r.namespaces),s=rz(r.namespaces),i=nz(r.namespaces),o=r.sessionProperties,a=r.scopedProperties;return{approvedChains:n,approvedMethods:s,approvedEvents:i,sessionProperties:o,scopedProperties:a}}catch(n){return this.client.logger.warn(n,"Error getting TVF approve params"),{}}}),le(this,"getTVFParams",(r,n,s)=>{var i,o,a;if(!((i=n.request)!=null&&i.method))return{};const c={correlationId:r,rpcMethods:[n.request.method],chainId:n.chainId};try{const l=this.extractTxHashesFromResult(n.request,s);c.txHashes=l,c.contractAddresses=this.isValidContractData(n.request.params)?[(a=(o=n.request.params)==null?void 0:o[0])==null?void 0:a.to]:[]}catch(l){this.client.logger.warn(l,"Error getting TVF params")}return c}),le(this,"isValidContractData",r=>{var n;if(!r)return!1;try{const s=r?.data||((n=r?.[0])==null?void 0:n.data);if(!s.startsWith("0x"))return!1;const i=s.slice(2);return/^[0-9a-fA-F]*$/.test(i)?i.length%2===0:!1}catch{}return!1}),le(this,"extractTxHashesFromResult",(r,n)=>{var s;try{if(!n)return[];const i=r.method,o=SG[i];if(i==="sui_signTransaction")return[Wj(n.transactionBytes)];if(i==="near_signTransaction")return[f2(n)];if(i==="near_signTransactions")return n.map(c=>f2(c));if(i==="xrpl_signTransactionFor"||i==="xrpl_signTransaction")return[(s=n.tx_json)==null?void 0:s.hash];if(i==="polkadot_signTransaction")return[Gz({transaction:r.params.transactionPayload,signature:n.signature})];if(i==="algo_signTxn")return tu(n)?n.map(c=>p2(c)):[p2(n)];if(i==="cosmos_signDirect")return[Kj(n)];if(i==="wallet_sendCalls")return Gj(n);if(typeof n=="string")return[n];const a=n[o.key];if(tu(a))return i==="solana_signAllTransactions"?a.map(c=>Hj(c)):a;if(typeof a=="string")return[a]}catch(i){this.client.logger.warn(i,"Error extracting tx hashes from result")}return[]})}async processPendingMessageEvents(){try{const e=this.client.session.keys,r=this.client.core.relayer.messages.getWithoutAck(e);for(const[n,s]of Object.entries(r))for(const i of s)try{await this.onProviderMessageEvent({topic:n,message:i,publishedAt:Date.now()})}catch{this.client.logger.warn(`Error processing pending message event for topic: ${n}, message: ${i}`)}}catch(e){this.client.logger.warn(e,"processPendingMessageEvents failed")}}isInitialized(){if(!this.initialized){const{message:e}=we("NOT_INITIALIZED",this.name);throw new Error(e)}}async confirmOnlineStateOrThrow(){await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(_r.message,e=>{this.onProviderMessageEvent(e)})}async onRelayMessage(e){const{topic:r,message:n,attestation:s,transportType:i}=e,{publicKey:o}=this.client.auth.authKeys.keys.includes(fp)?this.client.auth.authKeys.get(fp):{publicKey:void 0};try{const a=await this.client.core.crypto.decode(r,n,{receiverPublicKey:o,encoding:i===Kt.link_mode?pa:Xn});yu(a)?(this.client.core.history.set(r,a),await this.onRelayEventRequest({topic:r,payload:a,attestation:s,transportType:i,encryptedId:Vs(n)})):Ua(a)?(await this.client.core.history.resolve(a),await this.onRelayEventResponse({topic:r,payload:a,transportType:i}),this.client.core.history.delete(r,a.id)):(this.client.logger.error(`onRelayMessage() -> unknown payload: ${JSON.stringify(a)}`),await this.onRelayEventUnknownPayload({topic:r,payload:a,transportType:i})),await this.client.core.relayer.messages.ack(r,n)}catch(a){this.client.logger.error(`onRelayMessage() -> failed to process an inbound message: ${n}`),this.client.logger.error(a)}}registerExpirerEvents(){this.client.core.expirer.on(Fs.expired,async e=>{const{topic:r,id:n}=H$(e.target);if(n&&this.client.pendingRequest.keys.includes(n))return await this.deletePendingSessionRequest(n,we("EXPIRED"),!0);if(n&&this.client.auth.requests.keys.includes(n))return await this.deletePendingAuthRequest(n,we("EXPIRED"),!0);r?this.client.session.keys.includes(r)&&(await this.deleteSession({topic:r,expirerHasDeleted:!0}),this.client.events.emit("session_expire",{topic:r})):n&&(await this.deleteProposal(n,!0),this.client.events.emit("proposal_expire",{id:n}))})}registerPairingEvents(){this.client.core.pairing.events.on(ac.create,e=>this.onPairingCreated(e)),this.client.core.pairing.events.on(ac.delete,e=>{this.addToRecentlyDeleted(e.topic,"pairing")})}isValidPairingTopic(e){if(!xr(e,!1)){const{message:r}=we("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(r)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:r}=we("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(r)}if(ia(this.client.core.pairing.pairings.get(e).expiry)){const{message:r}=we("EXPIRED",`pairing topic: ${e}`);throw new Error(r)}}async isValidSessionTopic(e){if(!xr(e,!1)){const{message:r}=we("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(r)}if(this.checkRecentlyDeleted(e),!this.client.session.keys.includes(e)){const{message:r}=we("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(r)}if(ia(this.client.session.get(e).expiry)){await this.deleteSession({topic:e});const{message:r}=we("EXPIRED",`session topic: ${e}`);throw new Error(r)}if(!this.client.core.crypto.keychain.has(e)){const{message:r}=we("MISSING_OR_INVALID",`session topic does not exist in keychain: ${e}`);throw await this.deleteSession({topic:e}),new Error(r)}}async isValidSessionOrPairingTopic(e){if(this.checkRecentlyDeleted(e),this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(xr(e,!1)){const{message:r}=we("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(r)}else{const{message:r}=we("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(r)}}async isValidProposalId(e){if(!Sz(e)){const{message:r}=we("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(r)}if(!this.client.proposal.keys.includes(e)){const{message:r}=we("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(r)}if(ia(this.client.proposal.get(e).expiryTimestamp)){await this.deleteProposal(e);const{message:r}=we("EXPIRED",`proposal id: ${e}`);throw new Error(r)}}validateRequestExpiry(e){if(e&&!Pz(e,Vm)){const{message:r}=we("MISSING_OR_INVALID",`request() expiry: ${e}. Expiry must be a number (in seconds) between ${Vm.min} and ${Vm.max}`);throw new Error(r)}}},LG=class extends Kc{constructor(e,r){super(e,r,EG,rv),this.core=e,this.logger=r}},MG=class extends Kc{constructor(e,r){super(e,r,_G,rv),this.core=e,this.logger=r}},jG=class extends Kc{constructor(e,r){super(e,r,AG,rv,n=>n.id),this.core=e,this.logger=r}},FG=class extends Kc{constructor(e,r){super(e,r,TG,sy,()=>fp),this.core=e,this.logger=r}},qG=class extends Kc{constructor(e,r){super(e,r,NG,sy),this.core=e,this.logger=r}},zG=class extends Kc{constructor(e,r){super(e,r,OG,sy,n=>n.id),this.core=e,this.logger=r}};var HG=Object.defineProperty,WG=(t,e,r)=>e in t?HG(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Km=(t,e,r)=>WG(t,typeof e!="symbol"?e+"":e,r);class VG{constructor(e,r){this.core=e,this.logger=r,Km(this,"authKeys"),Km(this,"pairingTopics"),Km(this,"requests"),this.authKeys=new FG(this.core,this.logger),this.pairingTopics=new qG(this.core,this.logger),this.requests=new zG(this.core,this.logger)}async init(){await this.authKeys.init(),await this.pairingTopics.init(),await this.requests.init()}}var KG=Object.defineProperty,GG=(t,e,r)=>e in t?KG(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,dt=(t,e,r)=>GG(t,typeof e!="symbol"?e+"":e,r);let YG=class _N extends kR{constructor(e){super(e),dt(this,"protocol",bN),dt(this,"version",vN),dt(this,"name",Wm.name),dt(this,"metadata"),dt(this,"core"),dt(this,"logger"),dt(this,"events",new dr.EventEmitter),dt(this,"engine"),dt(this,"session"),dt(this,"proposal"),dt(this,"pendingRequest"),dt(this,"auth"),dt(this,"signConfig"),dt(this,"on",(n,s)=>this.events.on(n,s)),dt(this,"once",(n,s)=>this.events.once(n,s)),dt(this,"off",(n,s)=>this.events.off(n,s)),dt(this,"removeListener",(n,s)=>this.events.removeListener(n,s)),dt(this,"removeAllListeners",n=>this.events.removeAllListeners(n)),dt(this,"connect",async n=>{try{return await this.engine.connect(n)}catch(s){throw this.logger.error(s.message),s}}),dt(this,"pair",async n=>{try{return await this.engine.pair(n)}catch(s){throw this.logger.error(s.message),s}}),dt(this,"approve",async n=>{try{return await this.engine.approve(n)}catch(s){throw this.logger.error(s.message),s}}),dt(this,"reject",async n=>{try{return await this.engine.reject(n)}catch(s){throw this.logger.error(s.message),s}}),dt(this,"update",async n=>{try{return await this.engine.update(n)}catch(s){throw this.logger.error(s.message),s}}),dt(this,"extend",async n=>{try{return await this.engine.extend(n)}catch(s){throw this.logger.error(s.message),s}}),dt(this,"request",async n=>{try{return await this.engine.request(n)}catch(s){throw this.logger.error(s.message),s}}),dt(this,"respond",async n=>{try{return await this.engine.respond(n)}catch(s){throw this.logger.error(s.message),s}}),dt(this,"ping",async n=>{try{return await this.engine.ping(n)}catch(s){throw this.logger.error(s.message),s}}),dt(this,"emit",async n=>{try{return await this.engine.emit(n)}catch(s){throw this.logger.error(s.message),s}}),dt(this,"disconnect",async n=>{try{return await this.engine.disconnect(n)}catch(s){throw this.logger.error(s.message),s}}),dt(this,"find",n=>{try{return this.engine.find(n)}catch(s){throw this.logger.error(s.message),s}}),dt(this,"getPendingSessionRequests",()=>{try{return this.engine.getPendingSessionRequests()}catch(n){throw this.logger.error(n.message),n}}),dt(this,"authenticate",async(n,s)=>{try{return await this.engine.authenticate(n,s)}catch(i){throw this.logger.error(i.message),i}}),dt(this,"formatAuthMessage",n=>{try{return this.engine.formatAuthMessage(n)}catch(s){throw this.logger.error(s.message),s}}),dt(this,"approveSessionAuthenticate",async n=>{try{return await this.engine.approveSessionAuthenticate(n)}catch(s){throw this.logger.error(s.message),s}}),dt(this,"rejectSessionAuthenticate",async n=>{try{return await this.engine.rejectSessionAuthenticate(n)}catch(s){throw this.logger.error(s.message),s}}),this.name=e?.name||Wm.name,this.metadata=B7(e?.metadata),this.signConfig=e?.signConfig;const r=KT({logger:e?.logger||Wm.logger,name:this.name});this.logger=r,this.core=e?.core||new vG(e),this.session=new MG(this.core,this.logger),this.proposal=new LG(this.core,this.logger),this.pendingRequest=new jG(this.core,this.logger),this.engine=new BG(this),this.auth=new VG(this.core,this.logger)}static async init(e){const r=new _N(e);return await r.initialize(),r}get context(){return os(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.auth.init(),await this.engine.init(),this.logger.info("SignClient Initialization Success")}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}};const XG=YG,ZG="modulepreload",JG=function(t){return"/portalx-lite-test/"+t},Ox={},ng=function(e,r,n){let s=Promise.resolve();if(r&&r.length>0){let c=function(l){return Promise.all(l.map(u=>Promise.resolve(u).then(d=>({status:"fulfilled",value:d}),d=>({status:"rejected",reason:d}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=o?.nonce||o?.getAttribute("nonce");s=c(r.map(l=>{if(l=JG(l),l in Ox)return;Ox[l]=!0;const u=l.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${d}`))return;const h=document.createElement("link");if(h.rel=u?"stylesheet":ZG,u||(h.as="script"),h.crossOrigin="",h.href=l,a&&h.setAttribute("nonce",a),document.head.appendChild(h),u)return new Promise((p,y)=>{h.addEventListener("load",p),h.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${l}`)))})}))}function i(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return s.then(o=>{for(const a of o||[])a.status==="rejected"&&i(a.reason);return e().catch(i)})};var kx={};const fe={WC_NAME_SUFFIX:".reown.id",WC_NAME_SUFFIX_LEGACY:".wcn.id",BLOCKCHAIN_API_RPC_URL:"https://rpc.walletconnect.org",PULSE_API_URL:"https://pulse.walletconnect.org",W3M_API_URL:"https://api.web3modal.org",CONNECTOR_ID:{WALLET_CONNECT:"walletConnect",INJECTED:"injected",WALLET_STANDARD:"announced",COINBASE:"coinbaseWallet",COINBASE_SDK:"coinbaseWalletSDK",BASE_ACCOUNT:"baseAccount",SAFE:"safe",LEDGER:"ledger",OKX:"okx",EIP6963:"eip6963",AUTH:"AUTH"},CONNECTOR_NAMES:{AUTH:"Auth"},AUTH_CONNECTOR_SUPPORTED_CHAINS:["eip155","solana"],LIMITS:{PENDING_TRANSACTIONS:99},CHAIN:{EVM:"eip155",SOLANA:"solana",POLKADOT:"polkadot",BITCOIN:"bip122"},CHAIN_NAME_MAP:{eip155:"EVM Networks",solana:"Solana",polkadot:"Polkadot",bip122:"Bitcoin",cosmos:"Cosmos",sui:"Sui",stacks:"Stacks"},ADAPTER_TYPES:{BITCOIN:"bitcoin",SOLANA:"solana",WAGMI:"wagmi",ETHERS:"ethers",ETHERS5:"ethers5"},USDT_CONTRACT_ADDRESSES:["0xdac17f958d2ee523a2206206994597c13d831ec7","0xc2132d05d31c914a87c6611c10748aeb04b58e8f","0x9702230a8ea53601f5cd2dc00fdbc13d4df4a8c7","0x919C1c267BC06a7039e03fcc2eF738525769109c","0x48065fbBE25f71C9282ddf5e1cD6D6A887483D5e","0x55d398326f99059fF775485246999027B3197955","0xfd086bc7cd5c481dcc9c85ebe478a1c0b69fcbb9"],SOLANA_SPL_TOKEN_ADDRESSES:{SOL:"So11111111111111111111111111111111111111112"},HTTP_STATUS_CODES:{SERVER_ERROR:500,TOO_MANY_REQUESTS:429,SERVICE_UNAVAILABLE:503,FORBIDDEN:403},UNSUPPORTED_NETWORK_NAME:"Unknown Network",SECURE_SITE_SDK_ORIGIN:(typeof process<"u"&&typeof kx<"u"?kx.NEXT_PUBLIC_SECURE_SITE_ORIGIN:void 0)||"https://secure.walletconnect.org",REMOTE_FEATURES_ALERTS:{MULTI_WALLET_NOT_ENABLED:{DEFAULT:{displayMessage:"Multi-Wallet Not Enabled",debugMessage:"Multi-wallet support is not enabled. Please enable it in your AppKit configuration at cloud.reown.com."},CONNECTIONS_HOOK:{displayMessage:"Multi-Wallet Not Enabled",debugMessage:"Multi-wallet support is not enabled. Please enable it in your AppKit configuration at cloud.reown.com to use the useAppKitConnections hook."},CONNECTION_HOOK:{displayMessage:"Multi-Wallet Not Enabled",debugMessage:"Multi-wallet support is not enabled. Please enable it in your AppKit configuration at cloud.reown.com to use the useAppKitConnection hook."}}},IS_DEVELOPMENT:typeof process<"u"&&!1,DEFAULT_ALLOWED_ANCESTORS:["http://localhost:*","https://localhost:*","http://127.0.0.1:*","https://127.0.0.1:*","https://*.pages.dev","https://*.vercel.app","https://*.ngrok-free.app","https://secure-mobile.walletconnect.com","https://secure-mobile.walletconnect.org"]},xN={caipNetworkIdToNumber(t){return t?Number(t.split(":")[1]):void 0},parseEvmChainId(t){return typeof t=="string"?this.caipNetworkIdToNumber(t):t},getNetworksByNamespace(t,e){return t?.filter(r=>r.chainNamespace===e)||[]},getFirstNetworkByNamespace(t,e){return this.getNetworksByNamespace(t,e)[0]},getNetworkNameByCaipNetworkId(t,e){if(!e)return;const r=t.find(s=>s.caipNetworkId===e);if(r)return r.name;const[n]=e.split(":");return fe.CHAIN_NAME_MAP?.[n]||void 0}},SN=["eip155","solana","polkadot","bip122","cosmos","sui","stacks"];var QG=20,eY=1,Uc=1e6,Px=1e6,tY=-7,rY=21,nY=!1,Fh="[big.js] ",Gc=Fh+"Invalid ",iy=Gc+"decimal places",sY=Gc+"rounding mode",AN=Fh+"Division by zero",Lt={},qi=void 0,iY=/^-?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i;function IN(){function t(e){var r=this;if(!(r instanceof t))return e===qi?IN():new t(e);if(e instanceof t)r.s=e.s,r.e=e.e,r.c=e.c.slice();else{if(typeof e!="string"){if(t.strict===!0&&typeof e!="bigint")throw TypeError(Gc+"value");e=e===0&&1/e<0?"-0":String(e)}oY(r,e)}r.constructor=t}return t.prototype=Lt,t.DP=QG,t.RM=eY,t.NE=tY,t.PE=rY,t.strict=nY,t.roundDown=0,t.roundHalfUp=1,t.roundHalfEven=2,t.roundUp=3,t}function oY(t,e){var r,n,s;if(!iY.test(e))throw Error(Gc+"number");for(t.s=e.charAt(0)=="-"?(e=e.slice(1),-1):1,(r=e.indexOf("."))>-1&&(e=e.replace(".","")),(n=e.search(/e/i))>0?(r<0&&(r=n),r+=+e.slice(n+1),e=e.substring(0,n)):r<0&&(r=e.length),s=e.length,n=0;n<s&&e.charAt(n)=="0";)++n;if(n==s)t.c=[t.e=0];else{for(;s>0&&e.charAt(--s)=="0";);for(t.e=r-n-1,t.c=[],r=0;n<=s;)t.c[r++]=+e.charAt(n++)}return t}function Yc(t,e,r,n){var s=t.c;if(r===qi&&(r=t.constructor.RM),r!==0&&r!==1&&r!==2&&r!==3)throw Error(sY);if(e<1)n=r===3&&(n||!!s[0])||e===0&&(r===1&&s[0]>=5||r===2&&(s[0]>5||s[0]===5&&(n||s[1]!==qi))),s.length=1,n?(t.e=t.e-e+1,s[0]=1):s[0]=t.e=0;else if(e<s.length){if(n=r===1&&s[e]>=5||r===2&&(s[e]>5||s[e]===5&&(n||s[e+1]!==qi||s[e-1]&1))||r===3&&(n||!!s[0]),s.length=e,n){for(;++s[--e]>9;)if(s[e]=0,e===0){++t.e,s.unshift(1);break}}for(e=s.length;!s[--e];)s.pop()}return t}function Xc(t,e,r){var n=t.e,s=t.c.join(""),i=s.length;if(e)s=s.charAt(0)+(i>1?"."+s.slice(1):"")+(n<0?"e":"e+")+n;else if(n<0){for(;++n;)s="0"+s;s="0."+s}else if(n>0)if(++n>i)for(n-=i;n--;)s+="0";else n<i&&(s=s.slice(0,n)+"."+s.slice(n));else i>1&&(s=s.charAt(0)+"."+s.slice(1));return t.s<0&&r?"-"+s:s}Lt.abs=function(){var t=new this.constructor(this);return t.s=1,t};Lt.cmp=function(t){var e,r=this,n=r.c,s=(t=new r.constructor(t)).c,i=r.s,o=t.s,a=r.e,c=t.e;if(!n[0]||!s[0])return n[0]?i:s[0]?-o:0;if(i!=o)return i;if(e=i<0,a!=c)return a>c^e?1:-1;for(o=(a=n.length)<(c=s.length)?a:c,i=-1;++i<o;)if(n[i]!=s[i])return n[i]>s[i]^e?1:-1;return a==c?0:a>c^e?1:-1};Lt.div=function(t){var e=this,r=e.constructor,n=e.c,s=(t=new r(t)).c,i=e.s==t.s?1:-1,o=r.DP;if(o!==~~o||o<0||o>Uc)throw Error(iy);if(!s[0])throw Error(AN);if(!n[0])return t.s=i,t.c=[t.e=0],t;var a,c,l,u,d,h=s.slice(),p=a=s.length,y=n.length,g=n.slice(0,a),w=g.length,S=t,A=S.c=[],E=0,v=o+(S.e=e.e-t.e)+1;for(S.s=i,i=v<0?0:v,h.unshift(0);w++<a;)g.push(0);do{for(l=0;l<10;l++){if(a!=(w=g.length))u=a>w?1:-1;else for(d=-1,u=0;++d<a;)if(s[d]!=g[d]){u=s[d]>g[d]?1:-1;break}if(u<0){for(c=w==a?s:h;w;){if(g[--w]<c[w]){for(d=w;d&&!g[--d];)g[d]=9;--g[d],g[w]+=10}g[w]-=c[w]}for(;!g[0];)g.shift()}else break}A[E++]=u?l:++l,g[0]&&u?g[w]=n[p]||0:g=[n[p]]}while((p++<y||g[0]!==qi)&&i--);return!A[0]&&E!=1&&(A.shift(),S.e--,v--),E>v&&Yc(S,v,r.RM,g[0]!==qi),S};Lt.eq=function(t){return this.cmp(t)===0};Lt.gt=function(t){return this.cmp(t)>0};Lt.gte=function(t){return this.cmp(t)>-1};Lt.lt=function(t){return this.cmp(t)<0};Lt.lte=function(t){return this.cmp(t)<1};Lt.minus=Lt.sub=function(t){var e,r,n,s,i=this,o=i.constructor,a=i.s,c=(t=new o(t)).s;if(a!=c)return t.s=-c,i.plus(t);var l=i.c.slice(),u=i.e,d=t.c,h=t.e;if(!l[0]||!d[0])return d[0]?t.s=-c:l[0]?t=new o(i):t.s=1,t;if(a=u-h){for((s=a<0)?(a=-a,n=l):(h=u,n=d),n.reverse(),c=a;c--;)n.push(0);n.reverse()}else for(r=((s=l.length<d.length)?l:d).length,a=c=0;c<r;c++)if(l[c]!=d[c]){s=l[c]<d[c];break}if(s&&(n=l,l=d,d=n,t.s=-t.s),(c=(r=d.length)-(e=l.length))>0)for(;c--;)l[e++]=0;for(c=e;r>a;){if(l[--r]<d[r]){for(e=r;e&&!l[--e];)l[e]=9;--l[e],l[r]+=10}l[r]-=d[r]}for(;l[--c]===0;)l.pop();for(;l[0]===0;)l.shift(),--h;return l[0]||(t.s=1,l=[h=0]),t.c=l,t.e=h,t};Lt.mod=function(t){var e,r=this,n=r.constructor,s=r.s,i=(t=new n(t)).s;if(!t.c[0])throw Error(AN);return r.s=t.s=1,e=t.cmp(r)==1,r.s=s,t.s=i,e?new n(r):(s=n.DP,i=n.RM,n.DP=n.RM=0,r=r.div(t),n.DP=s,n.RM=i,this.minus(r.times(t)))};Lt.neg=function(){var t=new this.constructor(this);return t.s=-t.s,t};Lt.plus=Lt.add=function(t){var e,r,n,s=this,i=s.constructor;if(t=new i(t),s.s!=t.s)return t.s=-t.s,s.minus(t);var o=s.e,a=s.c,c=t.e,l=t.c;if(!a[0]||!l[0])return l[0]||(a[0]?t=new i(s):t.s=s.s),t;if(a=a.slice(),e=o-c){for(e>0?(c=o,n=l):(e=-e,n=a),n.reverse();e--;)n.push(0);n.reverse()}for(a.length-l.length<0&&(n=l,l=a,a=n),e=l.length,r=0;e;a[e]%=10)r=(a[--e]=a[e]+l[e]+r)/10|0;for(r&&(a.unshift(r),++c),e=a.length;a[--e]===0;)a.pop();return t.c=a,t.e=c,t};Lt.pow=function(t){var e=this,r=new e.constructor("1"),n=r,s=t<0;if(t!==~~t||t<-Px||t>Px)throw Error(Gc+"exponent");for(s&&(t=-t);t&1&&(n=n.times(e)),t>>=1,!!t;)e=e.times(e);return s?r.div(n):n};Lt.prec=function(t,e){if(t!==~~t||t<1||t>Uc)throw Error(Gc+"precision");return Yc(new this.constructor(this),t,e)};Lt.round=function(t,e){if(t===qi)t=0;else if(t!==~~t||t<-Uc||t>Uc)throw Error(iy);return Yc(new this.constructor(this),t+this.e+1,e)};Lt.sqrt=function(){var t,e,r,n=this,s=n.constructor,i=n.s,o=n.e,a=new s("0.5");if(!n.c[0])return new s(n);if(i<0)throw Error(Fh+"No square root");i=Math.sqrt(+Xc(n,!0,!0)),i===0||i===1/0?(e=n.c.join(""),e.length+o&1||(e+="0"),i=Math.sqrt(e),o=((o+1)/2|0)-(o<0||o&1),t=new s((i==1/0?"5e":(i=i.toExponential()).slice(0,i.indexOf("e")+1))+o)):t=new s(i+""),o=t.e+(s.DP+=4);do r=t,t=a.times(r.plus(n.div(r)));while(r.c.slice(0,o).join("")!==t.c.slice(0,o).join(""));return Yc(t,(s.DP-=4)+t.e+1,s.RM)};Lt.times=Lt.mul=function(t){var e,r=this,n=r.constructor,s=r.c,i=(t=new n(t)).c,o=s.length,a=i.length,c=r.e,l=t.e;if(t.s=r.s==t.s?1:-1,!s[0]||!i[0])return t.c=[t.e=0],t;for(t.e=c+l,o<a&&(e=s,s=i,i=e,l=o,o=a,a=l),e=new Array(l=o+a);l--;)e[l]=0;for(c=a;c--;){for(a=0,l=o+c;l>c;)a=e[l]+i[c]*s[l-c-1]+a,e[l--]=a%10,a=a/10|0;e[l]=a}for(a?++t.e:e.shift(),c=e.length;!e[--c];)e.pop();return t.c=e,t};Lt.toExponential=function(t,e){var r=this,n=r.c[0];if(t!==qi){if(t!==~~t||t<0||t>Uc)throw Error(iy);for(r=Yc(new r.constructor(r),++t,e);r.c.length<t;)r.c.push(0)}return Xc(r,!0,!!n)};Lt.toFixed=function(t,e){var r=this,n=r.c[0];if(t!==qi){if(t!==~~t||t<0||t>Uc)throw Error(iy);for(r=Yc(new r.constructor(r),t+r.e+1,e),t=t+r.e+1;r.c.length<t;)r.c.push(0)}return Xc(r,!1,!!n)};Lt[Symbol.for("nodejs.util.inspect.custom")]=Lt.toJSON=Lt.toString=function(){var t=this,e=t.constructor;return Xc(t,t.e<=e.NE||t.e>=e.PE,!!t.c[0])};Lt.toNumber=function(){var t=+Xc(this,!0,!0);if(this.constructor.strict===!0&&!this.eq(t.toString()))throw Error(Fh+"Imprecise conversion");return t};Lt.toPrecision=function(t,e){var r=this,n=r.constructor,s=r.c[0];if(t!==qi){if(t!==~~t||t<1||t>Uc)throw Error(Gc+"precision");for(r=Yc(new n(r),t,e);r.c.length<t;)r.c.push(0)}return Xc(r,t<=r.e||r.e<=n.NE||r.e>=n.PE,!!s)};Lt.valueOf=function(){var t=this,e=t.constructor;if(e.strict===!0)throw Error(Fh+"valueOf disallowed");return Xc(t,t.e<=e.NE||t.e>=e.PE,!0)};var Go=IN();const aY={bigNumber(t){return t?new Go(t):new Go(0)},multiply(t,e){if(t===void 0||e===void 0)return new Go(0);const r=new Go(t),n=new Go(e);return r.times(n)},toFixed(t,e=2){return t===void 0||t===""?new Go(0).toFixed(e):new Go(t).toFixed(e)},formatNumberToLocalString(t,e=2){return t===void 0||t===""?"0.00":typeof t=="number"?t.toLocaleString("en-US",{maximumFractionDigits:e,minimumFractionDigits:e,roundingMode:"floor"}):parseFloat(t).toLocaleString("en-US",{maximumFractionDigits:e,minimumFractionDigits:e,roundingMode:"floor"})},parseLocalStringToNumber(t){if(t===void 0||t==="")return 0;const e=t.replace(/,/gu,"");return new Go(e).toNumber()}},cY=[{type:"function",name:"transfer",stateMutability:"nonpayable",inputs:[{name:"_to",type:"address"},{name:"_value",type:"uint256"}],outputs:[{name:"",type:"bool"}]},{type:"function",name:"transferFrom",stateMutability:"nonpayable",inputs:[{name:"_from",type:"address"},{name:"_to",type:"address"},{name:"_value",type:"uint256"}],outputs:[{name:"",type:"bool"}]}],lY=[{type:"function",name:"approve",stateMutability:"nonpayable",inputs:[{name:"spender",type:"address"},{name:"amount",type:"uint256"}],outputs:[{type:"bool"}]}],uY=[{type:"function",name:"transfer",stateMutability:"nonpayable",inputs:[{name:"recipient",type:"address"},{name:"amount",type:"uint256"}],outputs:[]},{type:"function",name:"transferFrom",stateMutability:"nonpayable",inputs:[{name:"sender",type:"address"},{name:"recipient",type:"address"},{name:"amount",type:"uint256"}],outputs:[{name:"",type:"bool"}]}],dY={getERC20Abi:t=>fe.USDT_CONTRACT_ADDRESSES.includes(t)?uY:cY,getSwapAbi:()=>lY},sn={validateCaipAddress(t){if(t.split(":")?.length!==3)throw new Error("Invalid CAIP Address");return t},parseCaipAddress(t){const e=t.split(":");if(e.length!==3)throw new Error(`Invalid CAIP-10 address: ${t}`);const[r,n,s]=e;if(!r||!n||!s)throw new Error(`Invalid CAIP-10 address: ${t}`);return{chainNamespace:r,chainId:n,address:s}},parseCaipNetworkId(t){const e=t.split(":");if(e.length!==2)throw new Error(`Invalid CAIP-2 network id: ${t}`);const[r,n]=e;if(!r||!n)throw new Error(`Invalid CAIP-2 network id: ${t}`);return{chainNamespace:r,chainId:n}}},_o={RPC_ERROR_CODE:{USER_REJECTED_REQUEST:4001,USER_REJECTED_METHODS:5002,USER_REJECTED:5e3},PROVIDER_RPC_ERROR_NAME:{PROVIDER_RPC:"ProviderRpcError",USER_REJECTED_REQUEST:"UserRejectedRequestError"},isRpcProviderError(t){try{if(typeof t=="object"&&t!==null){const e=t,r=typeof e.message=="string",n=typeof e.code=="number";return r&&n}return!1}catch{return!1}},isUserRejectedMessage(t){return t.toLowerCase().includes("user rejected")||t.toLowerCase().includes("user cancelled")||t.toLowerCase().includes("user canceled")},isUserRejectedRequestError(t){if(_o.isRpcProviderError(t)){const e=t.code===_o.RPC_ERROR_CODE.USER_REJECTED_REQUEST,r=t.code===_o.RPC_ERROR_CODE.USER_REJECTED_METHODS;return e||r||_o.isUserRejectedMessage(t.message)}return t instanceof Error?_o.isUserRejectedMessage(t.message):!1}};let hY=class extends Error{constructor(e,r){super(r.message,{cause:e}),this.name=_o.PROVIDER_RPC_ERROR_NAME.PROVIDER_RPC,this.code=r.code}},CN=class extends hY{constructor(e){super(e,{code:_o.RPC_ERROR_CODE.USER_REJECTED_REQUEST,message:"User rejected the request"}),this.name=_o.PROVIDER_RPC_ERROR_NAME.USER_REJECTED_REQUEST}};const Le={WALLET_ID:"@appkit/wallet_id",WALLET_NAME:"@appkit/wallet_name",SOLANA_WALLET:"@appkit/solana_wallet",SOLANA_CAIP_CHAIN:"@appkit/solana_caip_chain",ACTIVE_CAIP_NETWORK_ID:"@appkit/active_caip_network_id",CONNECTED_SOCIAL:"@appkit/connected_social",CONNECTED_SOCIAL_USERNAME:"@appkit-wallet/SOCIAL_USERNAME",RECENT_WALLETS:"@appkit/recent_wallets",RECENT_WALLET:"@appkit/recent_wallet",DEEPLINK_CHOICE:"WALLETCONNECT_DEEPLINK_CHOICE",ACTIVE_NAMESPACE:"@appkit/active_namespace",CONNECTED_NAMESPACES:"@appkit/connected_namespaces",CONNECTION_STATUS:"@appkit/connection_status",SIWX_AUTH_TOKEN:"@appkit/siwx-auth-token",SIWX_NONCE_TOKEN:"@appkit/siwx-nonce-token",TELEGRAM_SOCIAL_PROVIDER:"@appkit/social_provider",NATIVE_BALANCE_CACHE:"@appkit/native_balance_cache",PORTFOLIO_CACHE:"@appkit/portfolio_cache",ENS_CACHE:"@appkit/ens_cache",IDENTITY_CACHE:"@appkit/identity_cache",PREFERRED_ACCOUNT_TYPES:"@appkit/preferred_account_types",CONNECTIONS:"@appkit/connections",DISCONNECTED_CONNECTOR_IDS:"@appkit/disconnected_connector_ids",HISTORY_TRANSACTIONS_CACHE:"@appkit/history_transactions_cache",TOKEN_PRICE_CACHE:"@appkit/token_price_cache",RECENT_EMAILS:"@appkit/recent_emails",LATEST_APPKIT_VERSION:"@appkit/latest_version"};function Gm(t){if(!t)throw new Error("Namespace is required for CONNECTED_CONNECTOR_ID");return`@appkit/${t}:connected_connector_id`}const De={setItem(t,e){ad()&&e!==void 0&&localStorage.setItem(t,e)},getItem(t){if(ad())return localStorage.getItem(t)||void 0},removeItem(t){ad()&&localStorage.removeItem(t)},clear(){ad()&&localStorage.clear()}};function ad(){return typeof window<"u"&&typeof localStorage<"u"}function sg(t,e){return e==="light"?{"--w3m-accent":t?.["--w3m-accent"]||"hsla(231, 100%, 70%, 1)","--w3m-background":"#fff"}:{"--w3m-accent":t?.["--w3m-accent"]||"hsla(230, 100%, 67%, 1)","--w3m-background":"#202020"}}const fY=Symbol(),Rx=Object.getPrototypeOf,nb=new WeakMap,pY=t=>t&&(nb.has(t)?nb.get(t):Rx(t)===Object.prototype||Rx(t)===Array.prototype),gY=t=>pY(t)&&t[fY]||null,Dx=(t,e=!0)=>{nb.set(t,e)},ig={},nv=t=>typeof t=="object"&&t!==null,yY=t=>nv(t)&&!qh.has(t)&&(Array.isArray(t)||!(Symbol.iterator in t))&&!(t instanceof WeakMap)&&!(t instanceof WeakSet)&&!(t instanceof Error)&&!(t instanceof Number)&&!(t instanceof Date)&&!(t instanceof String)&&!(t instanceof RegExp)&&!(t instanceof ArrayBuffer)&&!(t instanceof Promise),$N=(t,e)=>{const r=sb.get(t);if(r?.[0]===e)return r[1];const n=Array.isArray(t)?[]:Object.create(Object.getPrototypeOf(t));return Dx(n,!0),sb.set(t,[e,n]),Reflect.ownKeys(t).forEach(s=>{if(Object.getOwnPropertyDescriptor(n,s))return;const i=Reflect.get(t,s),{enumerable:o}=Reflect.getOwnPropertyDescriptor(t,s),a={value:i,enumerable:o,configurable:!0};if(qh.has(i))Dx(i,!1);else if(Na.has(i)){const[c,l]=Na.get(i);a.value=$N(c,l())}Object.defineProperty(n,s,a)}),Object.preventExtensions(n)},mY=(t,e,r,n)=>({deleteProperty(s,i){const o=Reflect.get(s,i);r(i);const a=Reflect.deleteProperty(s,i);return a&&n(["delete",[i],o]),a},set(s,i,o,a){const c=!t()&&Reflect.has(s,i),l=Reflect.get(s,i,a);if(c&&(Ux(l,o)||Hd.has(o)&&Ux(l,Hd.get(o))))return!0;r(i),nv(o)&&(o=gY(o)||o);const u=!Na.has(o)&&bY(o)?Xt(o):o;return e(i,u),Reflect.set(s,i,u,a),n(["set",[i],o,l]),!0}}),Na=new WeakMap,qh=new WeakSet,sb=new WeakMap,pp=[1],Hd=new WeakMap;let Ux=Object.is,wY=(t,e)=>new Proxy(t,e),bY=yY,vY=$N,EY=mY;function Xt(t={}){if(!nv(t))throw new Error("object required");const e=Hd.get(t);if(e)return e;let r=pp[0];const n=new Set,s=(w,S=++pp[0])=>{r!==S&&(i=r=S,n.forEach(A=>A(w,S)))};let i=r;const o=(w=pp[0])=>(i!==w&&(i=w,c.forEach(([S])=>{const A=S[1](w);A>r&&(r=A)})),r),a=w=>(S,A)=>{const E=[...S];E[1]=[w,...E[1]],s(E,A)},c=new Map,l=(w,S)=>{const A=!qh.has(S)&&Na.get(S);if(A){if((ig?"production":void 0)!=="production"&&c.has(w))throw new Error("prop listener already exists");if(n.size){const E=A[2](a(w));c.set(w,[A,E])}else c.set(w,[A])}},u=w=>{var S;const A=c.get(w);A&&(c.delete(w),(S=A[1])==null||S.call(A))},d=w=>(n.add(w),n.size===1&&c.forEach(([A,E],v)=>{if((ig?"production":void 0)!=="production"&&E)throw new Error("remove already exists");const C=A[2](a(v));c.set(v,[A,C])}),()=>{n.delete(w),n.size===0&&c.forEach(([A,E],v)=>{E&&(E(),c.set(v,[A]))})});let h=!0;const p=EY(()=>h,l,u,s),y=wY(t,p);Hd.set(t,y);const g=[t,o,d];return Na.set(y,g),Reflect.ownKeys(t).forEach(w=>{const S=Object.getOwnPropertyDescriptor(t,w);"value"in S&&S.writable&&(y[w]=t[w])}),h=!1,y}function an(t,e,r){const n=Na.get(t);(ig?"production":void 0)!=="production"&&!n&&console.warn("Please use proxy object");let s;const i=[],o=n[2];let a=!1;const l=o(u=>{i.push(u),s||(s=Promise.resolve().then(()=>{s=void 0,a&&e(i.splice(0))}))});return a=!0,()=>{a=!1,l()}}function Wd(t){const e=Na.get(t);(ig?"production":void 0)!=="production"&&!e&&console.warn("Please use proxy object");const[r,n]=e;return vY(r,n())}function Vd(t){return qh.add(t),t}function _Y(){return{proxyStateMap:Na,refSet:qh,snapCache:sb,versionHolder:pp,proxyCache:Hd}}function cn(t,e,r,n){let s=t[e];return an(t,()=>{const i=t[e];Object.is(s,i)||r(s=i)})}const{proxyStateMap:xY,snapCache:SY}=_Y(),Cf=t=>xY.has(t);function AY(t){const e=[];let r=0;const n=new Map,s=new WeakMap,i=()=>{const l=SY.get(a),u=l?.[1];if(u&&!s.has(u)){const d=new Map(n);s.set(u,d)}},o=l=>s.get(l)||n,a={data:e,index:r,epoch:0,get size(){return Cf(this)||i(),o(this).size},get(l){const d=o(this).get(l);if(d===void 0){this.epoch;return}return this.data[d]},has(l){const u=o(this);return this.epoch,u.has(l)},set(l,u){if(!Cf(this))throw new Error("Cannot perform mutations on a snapshot");const d=n.get(l);return d===void 0?(n.set(l,this.index),this.data[this.index++]=u):this.data[d]=u,this.epoch++,this},delete(l){if(!Cf(this))throw new Error("Cannot perform mutations on a snapshot");const u=n.get(l);return u===void 0?!1:(delete this.data[u],n.delete(l),this.epoch++,!0)},clear(){if(!Cf(this))throw new Error("Cannot perform mutations on a snapshot");this.data.length=0,this.index=0,this.epoch++,n.clear()},forEach(l){this.epoch,o(this).forEach((d,h)=>{l(this.data[d],h,this)})},*entries(){this.epoch;const l=o(this);for(const[u,d]of l)yield[u,this.data[d]]},*keys(){this.epoch;const l=o(this);for(const u of l.keys())yield u},*values(){this.epoch;const l=o(this);for(const u of l.values())yield this.data[u]},[Symbol.iterator](){return this.entries()},get[Symbol.toStringTag](){return"Map"},toJSON(){return new Map(this.entries())}},c=Xt(a);return Object.defineProperties(c,{size:{enumerable:!1},index:{enumerable:!1},epoch:{enumerable:!1},data:{enumerable:!1},toJSON:{enumerable:!1}}),Object.seal(c),c}var Bx={};const Ym=(typeof process<"u"&&typeof Bx<"u"?Bx.NEXT_PUBLIC_SECURE_SITE_ORIGIN:void 0)||"https://secure.walletconnect.org",TN=[{label:"Meld.io",name:"meld",feeRange:"1-2%",url:"https://meldcrypto.com",supportedChains:["eip155","solana"]}],IY="WXETMuFUQmqqybHuRkSgxv:25B8LJHSfpG6LVjR2ytU5Cwh7Z4Sch2ocoU",mt={FOUR_MINUTES_MS:24e4,TEN_SEC_MS:1e4,FIVE_SEC_MS:5e3,THREE_SEC_MS:3e3,ONE_SEC_MS:1e3,SECURE_SITE:Ym,SECURE_SITE_DASHBOARD:`${Ym}/dashboard`,SECURE_SITE_FAVICON:`${Ym}/images/favicon.png`,SOLANA_NATIVE_TOKEN_ADDRESS:"So11111111111111111111111111111111111111111",RESTRICTED_TIMEZONES:["ASIA/SHANGHAI","ASIA/URUMQI","ASIA/CHONGQING","ASIA/HARBIN","ASIA/KASHGAR","ASIA/MACAU","ASIA/HONG_KONG","ASIA/MACAO","ASIA/BEIJING","ASIA/HARBIN"],SWAP_SUGGESTED_TOKENS:["ETH","UNI","1INCH","AAVE","SOL","ADA","AVAX","DOT","LINK","NITRO","GAIA","MILK","TRX","NEAR","GNO","WBTC","DAI","WETH","USDC","USDT","ARB","BAL","BICO","CRV","ENS","MATIC","OP"],SWAP_POPULAR_TOKENS:["ETH","UNI","1INCH","AAVE","SOL","ADA","AVAX","DOT","LINK","NITRO","GAIA","MILK","TRX","NEAR","GNO","WBTC","DAI","WETH","USDC","USDT","ARB","BAL","BICO","CRV","ENS","MATIC","OP","METAL","DAI","CHAMP","WOLF","SALE","BAL","BUSD","MUST","BTCpx","ROUTE","HEX","WELT","amDAI","VSQ","VISION","AURUM","pSP","SNX","VC","LINK","CHP","amUSDT","SPHERE","FOX","GIDDY","GFC","OMEN","OX_OLD","DE","WNT"],SUGGESTED_TOKENS_BY_CHAIN:{"eip155:42161":["USD0"]},BALANCE_SUPPORTED_CHAINS:[fe.CHAIN.EVM,fe.CHAIN.SOLANA],SEND_PARAMS_SUPPORTED_CHAINS:[fe.CHAIN.EVM],SWAP_SUPPORTED_NETWORKS:["eip155:1","eip155:42161","eip155:10","eip155:324","eip155:8453","eip155:56","eip155:137","eip155:100","eip155:43114","eip155:250","eip155:8217","eip155:1313161554"],NAMES_SUPPORTED_CHAIN_NAMESPACES:[fe.CHAIN.EVM],ONRAMP_SUPPORTED_CHAIN_NAMESPACES:[fe.CHAIN.EVM,fe.CHAIN.SOLANA],PAY_WITH_EXCHANGE_SUPPORTED_CHAIN_NAMESPACES:[fe.CHAIN.EVM,fe.CHAIN.SOLANA],ACTIVITY_ENABLED_CHAIN_NAMESPACES:[fe.CHAIN.EVM],NATIVE_TOKEN_ADDRESS:{eip155:"0xeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee",solana:"So11111111111111111111111111111111111111111",polkadot:"0x",bip122:"0x",cosmos:"0x",sui:"0x",stacks:"0x"},CONVERT_SLIPPAGE_TOLERANCE:1,CONNECT_LABELS:{MOBILE:"Open and continue in the wallet app",WEB:"Open and continue in the wallet app"},SEND_SUPPORTED_NAMESPACES:[fe.CHAIN.EVM,fe.CHAIN.SOLANA],DEFAULT_REMOTE_FEATURES:{swaps:["1inch"],onramp:["meld"],email:!0,socials:["google","x","discord","farcaster","github","apple","facebook"],activity:!0,reownBranding:!0,multiWallet:!1,emailCapture:!1,payWithExchange:!1,payments:!1,reownAuthentication:!1},DEFAULT_REMOTE_FEATURES_DISABLED:{email:!1,socials:!1,swaps:!1,onramp:!1,activity:!1,reownBranding:!1,emailCapture:!1,reownAuthentication:!1},DEFAULT_FEATURES:{receive:!0,send:!0,emailShowWallets:!0,connectorTypeOrder:["walletConnect","recent","injected","featured","custom","external","recommended"],analytics:!0,allWallets:!0,legalCheckbox:!1,smartSessions:!1,collapseWallets:!1,walletFeaturesOrder:["onramp","swaps","receive","send"],connectMethodsOrder:void 0,pay:!1,reownAuthentication:!1},DEFAULT_SOCIALS:["google","x","farcaster","discord","apple","github","facebook"],DEFAULT_ACCOUNT_TYPES:{bip122:"payment",eip155:"smartAccount",polkadot:"eoa",solana:"eoa"},ADAPTER_TYPES:{UNIVERSAL:"universal",SOLANA:"solana",WAGMI:"wagmi",ETHERS:"ethers",ETHERS5:"ethers5",BITCOIN:"bitcoin"},SIWX_DEFAULTS:{signOutOnDisconnect:!0}},de={cacheExpiry:{portfolio:3e4,nativeBalance:3e4,ens:3e5,identity:3e5,transactionsHistory:15e3,tokenPrice:15e3,latestAppKitVersion:6048e5},isCacheExpired(t,e){return Date.now()-t>e},getActiveNetworkProps(){const t=de.getActiveNamespace(),e=de.getActiveCaipNetworkId(),r=e?e.split(":")[1]:void 0,n=r?isNaN(Number(r))?r:Number(r):void 0;return{namespace:t,caipNetworkId:e,chainId:n}},setWalletConnectDeepLink({name:t,href:e}){try{De.setItem(Le.DEEPLINK_CHOICE,JSON.stringify({href:e,name:t}))}catch{console.info("Unable to set WalletConnect deep link")}},getWalletConnectDeepLink(){try{const t=De.getItem(Le.DEEPLINK_CHOICE);if(t)return JSON.parse(t)}catch{console.info("Unable to get WalletConnect deep link")}},deleteWalletConnectDeepLink(){try{De.removeItem(Le.DEEPLINK_CHOICE)}catch{console.info("Unable to delete WalletConnect deep link")}},setActiveNamespace(t){try{De.setItem(Le.ACTIVE_NAMESPACE,t)}catch{console.info("Unable to set active namespace")}},setActiveCaipNetworkId(t){try{De.setItem(Le.ACTIVE_CAIP_NETWORK_ID,t),de.setActiveNamespace(t.split(":")[0])}catch{console.info("Unable to set active caip network id")}},getActiveCaipNetworkId(){try{return De.getItem(Le.ACTIVE_CAIP_NETWORK_ID)}catch{console.info("Unable to get active caip network id");return}},deleteActiveCaipNetworkId(){try{De.removeItem(Le.ACTIVE_CAIP_NETWORK_ID)}catch{console.info("Unable to delete active caip network id")}},deleteConnectedConnectorId(t){try{const e=Gm(t);De.removeItem(e)}catch{console.info("Unable to delete connected connector id")}},setAppKitRecent(t){try{const e=de.getRecentWallets();e.find(n=>n.id===t.id)||(e.unshift(t),e.length>2&&e.pop(),De.setItem(Le.RECENT_WALLETS,JSON.stringify(e)),De.setItem(Le.RECENT_WALLET,JSON.stringify(t)))}catch{console.info("Unable to set AppKit recent")}},getRecentWallets(){try{const t=De.getItem(Le.RECENT_WALLETS);return t?JSON.parse(t):[]}catch{console.info("Unable to get AppKit recent")}return[]},getRecentWallet(){try{const t=De.getItem(Le.RECENT_WALLET);return t?JSON.parse(t):null}catch{console.info("Unable to get AppKit recent")}return null},deleteRecentWallet(){try{De.removeItem(Le.RECENT_WALLET)}catch{console.info("Unable to delete AppKit recent")}},setConnectedConnectorId(t,e){try{const r=Gm(t);De.setItem(r,e)}catch{console.info("Unable to set Connected Connector Id")}},getActiveNamespace(){try{return De.getItem(Le.ACTIVE_NAMESPACE)}catch{console.info("Unable to get active namespace")}},getConnectedConnectorId(t){if(t)try{const e=Gm(t);return De.getItem(e)}catch{console.info("Unable to get connected connector id in namespace",t)}},setConnectedSocialProvider(t){try{De.setItem(Le.CONNECTED_SOCIAL,t)}catch{console.info("Unable to set connected social provider")}},getConnectedSocialProvider(){try{return De.getItem(Le.CONNECTED_SOCIAL)}catch{console.info("Unable to get connected social provider")}},deleteConnectedSocialProvider(){try{De.removeItem(Le.CONNECTED_SOCIAL)}catch{console.info("Unable to delete connected social provider")}},getConnectedSocialUsername(){try{return De.getItem(Le.CONNECTED_SOCIAL_USERNAME)}catch{console.info("Unable to get connected social username")}},getStoredActiveCaipNetworkId(){return De.getItem(Le.ACTIVE_CAIP_NETWORK_ID)?.split(":")?.[1]},setConnectionStatus(t){try{De.setItem(Le.CONNECTION_STATUS,t)}catch{console.info("Unable to set connection status")}},getConnectionStatus(){try{return De.getItem(Le.CONNECTION_STATUS)}catch{return}},getConnectedNamespaces(){try{const t=De.getItem(Le.CONNECTED_NAMESPACES);return t?.length?t.split(","):[]}catch{return[]}},setConnectedNamespaces(t){try{const e=Array.from(new Set(t));De.setItem(Le.CONNECTED_NAMESPACES,e.join(","))}catch{console.info("Unable to set namespaces in storage")}},addConnectedNamespace(t){try{const e=de.getConnectedNamespaces();e.includes(t)||(e.push(t),de.setConnectedNamespaces(e))}catch{console.info("Unable to add connected namespace")}},removeConnectedNamespace(t){try{const e=de.getConnectedNamespaces(),r=e.indexOf(t);r>-1&&(e.splice(r,1),de.setConnectedNamespaces(e))}catch{console.info("Unable to remove connected namespace")}},getTelegramSocialProvider(){try{return De.getItem(Le.TELEGRAM_SOCIAL_PROVIDER)}catch{return console.info("Unable to get telegram social provider"),null}},setTelegramSocialProvider(t){try{De.setItem(Le.TELEGRAM_SOCIAL_PROVIDER,t)}catch{console.info("Unable to set telegram social provider")}},removeTelegramSocialProvider(){try{De.removeItem(Le.TELEGRAM_SOCIAL_PROVIDER)}catch{console.info("Unable to remove telegram social provider")}},getBalanceCache(){let t={};try{const e=De.getItem(Le.PORTFOLIO_CACHE);t=e?JSON.parse(e):{}}catch{console.info("Unable to get balance cache")}return t},removeAddressFromBalanceCache(t){try{const e=de.getBalanceCache();De.setItem(Le.PORTFOLIO_CACHE,JSON.stringify({...e,[t]:void 0}))}catch{console.info("Unable to remove address from balance cache",t)}},getBalanceCacheForCaipAddress(t){try{const r=de.getBalanceCache()[t];if(r&&!this.isCacheExpired(r.timestamp,this.cacheExpiry.portfolio))return r.balance;de.removeAddressFromBalanceCache(t)}catch{console.info("Unable to get balance cache for address",t)}},updateBalanceCache(t){try{const e=de.getBalanceCache();e[t.caipAddress]=t,De.setItem(Le.PORTFOLIO_CACHE,JSON.stringify(e))}catch{console.info("Unable to update balance cache",t)}},getNativeBalanceCache(){let t={};try{const e=De.getItem(Le.NATIVE_BALANCE_CACHE);t=e?JSON.parse(e):{}}catch{console.info("Unable to get balance cache")}return t},removeAddressFromNativeBalanceCache(t){try{const e=de.getBalanceCache();De.setItem(Le.NATIVE_BALANCE_CACHE,JSON.stringify({...e,[t]:void 0}))}catch{console.info("Unable to remove address from balance cache",t)}},getNativeBalanceCacheForCaipAddress(t){try{const r=de.getNativeBalanceCache()[t];if(r&&!this.isCacheExpired(r.timestamp,this.cacheExpiry.nativeBalance))return r;console.info("Discarding cache for address",t),de.removeAddressFromBalanceCache(t)}catch{console.info("Unable to get balance cache for address",t)}},updateNativeBalanceCache(t){try{const e=de.getNativeBalanceCache();e[t.caipAddress]=t,De.setItem(Le.NATIVE_BALANCE_CACHE,JSON.stringify(e))}catch{console.info("Unable to update balance cache",t)}},getEnsCache(){let t={};try{const e=De.getItem(Le.ENS_CACHE);t=e?JSON.parse(e):{}}catch{console.info("Unable to get ens name cache")}return t},getEnsFromCacheForAddress(t){try{const r=de.getEnsCache()[t];if(r&&!this.isCacheExpired(r.timestamp,this.cacheExpiry.ens))return r.ens;de.removeEnsFromCache(t)}catch{console.info("Unable to get ens name from cache",t)}},updateEnsCache(t){try{const e=de.getEnsCache();e[t.address]=t,De.setItem(Le.ENS_CACHE,JSON.stringify(e))}catch{console.info("Unable to update ens name cache",t)}},removeEnsFromCache(t){try{const e=de.getEnsCache();De.setItem(Le.ENS_CACHE,JSON.stringify({...e,[t]:void 0}))}catch{console.info("Unable to remove ens name from cache",t)}},getIdentityCache(){let t={};try{const e=De.getItem(Le.IDENTITY_CACHE);t=e?JSON.parse(e):{}}catch{console.info("Unable to get identity cache")}return t},getIdentityFromCacheForAddress(t){try{const r=de.getIdentityCache()[t];if(r&&!this.isCacheExpired(r.timestamp,this.cacheExpiry.identity))return r.identity;de.removeIdentityFromCache(t)}catch{console.info("Unable to get identity from cache",t)}},updateIdentityCache(t){try{const e=de.getIdentityCache();e[t.address]={identity:t.identity,timestamp:t.timestamp},De.setItem(Le.IDENTITY_CACHE,JSON.stringify(e))}catch{console.info("Unable to update identity cache",t)}},removeIdentityFromCache(t){try{const e=de.getIdentityCache();De.setItem(Le.IDENTITY_CACHE,JSON.stringify({...e,[t]:void 0}))}catch{console.info("Unable to remove identity from cache",t)}},clearAddressCache(){try{De.removeItem(Le.PORTFOLIO_CACHE),De.removeItem(Le.NATIVE_BALANCE_CACHE),De.removeItem(Le.ENS_CACHE),De.removeItem(Le.IDENTITY_CACHE),De.removeItem(Le.HISTORY_TRANSACTIONS_CACHE)}catch{console.info("Unable to clear address cache")}},setPreferredAccountTypes(t){try{De.setItem(Le.PREFERRED_ACCOUNT_TYPES,JSON.stringify(t))}catch{console.info("Unable to set preferred account types",t)}},getPreferredAccountTypes(){try{const t=De.getItem(Le.PREFERRED_ACCOUNT_TYPES);return t?JSON.parse(t):{}}catch{console.info("Unable to get preferred account types")}return{}},setConnections(t,e){try{const r=de.getConnections(),n=r[e]??[],s=new Map;for(const o of n)s.set(o.connectorId,{...o});for(const o of t){const a=s.get(o.connectorId),c=o.connectorId===fe.CONNECTOR_ID.AUTH;if(a&&!c){const l=new Set(a.accounts.map(d=>d.address.toLowerCase())),u=o.accounts.filter(d=>!l.has(d.address.toLowerCase()));a.accounts.push(...u)}else s.set(o.connectorId,{...o})}const i={...r,[e]:Array.from(s.values())};De.setItem(Le.CONNECTIONS,JSON.stringify(i))}catch(r){console.error("Unable to sync connections to storage",r)}},getConnections(){try{const t=De.getItem(Le.CONNECTIONS);return t?JSON.parse(t):{}}catch(t){return console.error("Unable to get connections from storage",t),{}}},deleteAddressFromConnection({connectorId:t,address:e,namespace:r}){try{const n=de.getConnections(),s=n[r]??[],i=new Map(s.map(a=>[a.connectorId,a])),o=i.get(t);o&&(o.accounts.filter(c=>c.address.toLowerCase()!==e.toLowerCase()).length===0?i.delete(t):i.set(t,{...o,accounts:o.accounts.filter(c=>c.address.toLowerCase()!==e.toLowerCase())})),De.setItem(Le.CONNECTIONS,JSON.stringify({...n,[r]:Array.from(i.values())}))}catch{console.error(`Unable to remove address "${e}" from connector "${t}" in namespace "${r}"`)}},getDisconnectedConnectorIds(){try{const t=De.getItem(Le.DISCONNECTED_CONNECTOR_IDS);return t?JSON.parse(t):{}}catch{console.info("Unable to get disconnected connector ids")}return{}},addDisconnectedConnectorId(t,e){try{const r=de.getDisconnectedConnectorIds(),n=r[e]??[];n.push(t),De.setItem(Le.DISCONNECTED_CONNECTOR_IDS,JSON.stringify({...r,[e]:Array.from(new Set(n))}))}catch{console.error(`Unable to set disconnected connector id "${t}" for namespace "${e}"`)}},removeDisconnectedConnectorId(t,e){try{const r=de.getDisconnectedConnectorIds();let n=r[e]??[];n=n.filter(s=>s.toLowerCase()!==t.toLowerCase()),De.setItem(Le.DISCONNECTED_CONNECTOR_IDS,JSON.stringify({...r,[e]:Array.from(new Set(n))}))}catch{console.error(`Unable to remove disconnected connector id "${t}" for namespace "${e}"`)}},isConnectorDisconnected(t,e){try{return(de.getDisconnectedConnectorIds()[e]??[]).some(s=>s.toLowerCase()===t.toLowerCase())}catch{console.info(`Unable to get disconnected connector id "${t}" for namespace "${e}"`)}return!1},getTransactionsCache(){try{const t=De.getItem(Le.HISTORY_TRANSACTIONS_CACHE);return t?JSON.parse(t):{}}catch{console.info("Unable to get transactions cache")}return{}},getTransactionsCacheForAddress({address:t,chainId:e=""}){try{const n=de.getTransactionsCache()[t]?.[e];if(n&&!this.isCacheExpired(n.timestamp,this.cacheExpiry.transactionsHistory))return n.transactions;de.removeTransactionsCache({address:t,chainId:e})}catch{console.info("Unable to get transactions cache")}},updateTransactionsCache({address:t,chainId:e="",timestamp:r,transactions:n}){try{const s=de.getTransactionsCache();s[t]={...s[t],[e]:{timestamp:r,transactions:n}},De.setItem(Le.HISTORY_TRANSACTIONS_CACHE,JSON.stringify(s))}catch{console.info("Unable to update transactions cache",{address:t,chainId:e,timestamp:r,transactions:n})}},removeTransactionsCache({address:t,chainId:e}){try{const r=de.getTransactionsCache(),n=r?.[t]||{},{[e]:s,...i}=n;De.setItem(Le.HISTORY_TRANSACTIONS_CACHE,JSON.stringify({...r,[t]:i}))}catch{console.info("Unable to remove transactions cache",{address:t,chainId:e})}},getTokenPriceCache(){try{const t=De.getItem(Le.TOKEN_PRICE_CACHE);return t?JSON.parse(t):{}}catch{console.info("Unable to get token price cache")}return{}},getTokenPriceCacheForAddresses(t){try{const r=de.getTokenPriceCache()[t.join(",")];if(r&&!this.isCacheExpired(r.timestamp,this.cacheExpiry.tokenPrice))return r.tokenPrice;de.removeTokenPriceCache(t)}catch{console.info("Unable to get token price cache for addresses",t)}},updateTokenPriceCache(t){try{const e=de.getTokenPriceCache();e[t.addresses.join(",")]={timestamp:t.timestamp,tokenPrice:t.tokenPrice},De.setItem(Le.TOKEN_PRICE_CACHE,JSON.stringify(e))}catch{console.info("Unable to update token price cache",t)}},removeTokenPriceCache(t){try{const e=de.getTokenPriceCache();De.setItem(Le.TOKEN_PRICE_CACHE,JSON.stringify({...e,[t.join(",")]:void 0}))}catch{console.info("Unable to remove token price cache",t)}},getLatestAppKitVersion(){try{const t=this.getLatestAppKitVersionCache(),e=t?.version;return e&&!this.isCacheExpired(t.timestamp,this.cacheExpiry.latestAppKitVersion)?e:void 0}catch{console.info("Unable to get latest AppKit version")}},getLatestAppKitVersionCache(){try{const t=De.getItem(Le.LATEST_APPKIT_VERSION);return t?JSON.parse(t):{}}catch{console.info("Unable to get latest AppKit version cache")}return{}},updateLatestAppKitVersion(t){try{const e=de.getLatestAppKitVersionCache();e.timestamp=t.timestamp,e.version=t.version,De.setItem(Le.LATEST_APPKIT_VERSION,JSON.stringify(e))}catch{console.info("Unable to update latest AppKit version on local storage",t)}}},Ne={isMobile(){return this.isClient()?!!(window?.matchMedia&&typeof window.matchMedia=="function"&&window.matchMedia("(pointer:coarse)")?.matches||/Android|webOS|iPhone|iPad|iPod|BlackBerry|Opera Mini/u.test(navigator.userAgent)):!1},checkCaipNetwork(t,e=""){return t?.caipNetworkId.toLocaleLowerCase().includes(e.toLowerCase())},isAndroid(){if(!this.isMobile())return!1;const t=window?.navigator.userAgent.toLowerCase();return Ne.isMobile()&&t.includes("android")},isIos(){if(!this.isMobile())return!1;const t=window?.navigator.userAgent.toLowerCase();return t.includes("iphone")||t.includes("ipad")},isSafari(){return this.isClient()?(window?.navigator.userAgent.toLowerCase()).includes("safari"):!1},isClient(){return typeof window<"u"},isPairingExpired(t){return t?t-Date.now()<=mt.TEN_SEC_MS:!0},isAllowedRetry(t,e=mt.ONE_SEC_MS){return Date.now()-t>=e},copyToClopboard(t){navigator.clipboard.writeText(t)},isIframe(){try{return window?.self!==window?.top}catch{return!1}},isSafeApp(){if(Ne.isClient()&&window.self!==window.top)try{const t=window?.location?.ancestorOrigins?.[0],e="https://app.safe.global";if(t){const r=new URL(t),n=new URL(e);return r.hostname===n.hostname}}catch{return!1}return!1},getPairingExpiry(){return Date.now()+mt.FOUR_MINUTES_MS},getNetworkId(t){return t?.split(":")[1]},getPlainAddress(t){return t?.split(":")[2]},async wait(t){return new Promise(e=>{setTimeout(e,t)})},debounce(t,e=500){let r;return(...n)=>{function s(){t(...n)}r&&clearTimeout(r),r=setTimeout(s,e)}},isHttpUrl(t){return t.startsWith("http://")||t.startsWith("https://")},formatNativeUrl(t,e,r=null){if(Ne.isHttpUrl(t))return this.formatUniversalUrl(t,e);let n=t,s=r;n.includes("://")||(n=t.replaceAll("/","").replaceAll(":",""),n=`${n}://`),n.endsWith("/")||(n=`${n}/`),s&&!s?.endsWith("/")&&(s=`${s}/`),this.isTelegram()&&this.isAndroid()&&(e=encodeURIComponent(e));const i=encodeURIComponent(e);return{redirect:`${n}wc?uri=${i}`,redirectUniversalLink:s?`${s}wc?uri=${i}`:void 0,href:n}},formatUniversalUrl(t,e){if(!Ne.isHttpUrl(t))return this.formatNativeUrl(t,e);let r=t;r.endsWith("/")||(r=`${r}/`);const n=encodeURIComponent(e);return{redirect:`${r}wc?uri=${n}`,href:r}},getOpenTargetForPlatform(t){return t==="popupWindow"?t:this.isTelegram()?de.getTelegramSocialProvider()?"_top":"_blank":t},openHref(t,e,r){window?.open(t,this.getOpenTargetForPlatform(e),r||"noreferrer noopener")},returnOpenHref(t,e,r){return window?.open(t,this.getOpenTargetForPlatform(e),r||"noreferrer noopener")},isTelegram(){return typeof window<"u"&&(!!window.TelegramWebviewProxy||!!window.Telegram||!!window.TelegramWebviewProxyProto)},isPWA(){if(typeof window>"u")return!1;const t=window?.matchMedia&&typeof window.matchMedia=="function"?window.matchMedia("(display-mode: standalone)")?.matches:!1,e=window?.navigator?.standalone;return!!(t||e)},async preloadImage(t){const e=new Promise((r,n)=>{const s=new Image;s.onload=r,s.onerror=n,s.crossOrigin="anonymous",s.src=t});return Promise.race([e,Ne.wait(2e3)])},parseBalance(t,e){let r="0.000";if(typeof t=="string"){const c=Number(t);if(!isNaN(c)){const l=(Math.floor(c*1e3)/1e3).toFixed(3);l&&(r=l)}}const[n,s]=r.split("."),i=n||"0",o=s||"000";return{formattedText:`${i}.${o}${e?` ${e}`:""}`,value:i,decimals:o,symbol:e}},getApiUrl(){return fe.W3M_API_URL},getBlockchainApiUrl(){return fe.BLOCKCHAIN_API_RPC_URL},getAnalyticsUrl(){return fe.PULSE_API_URL},getUUID(){return crypto?.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,t=>{const e=Math.random()*16|0;return(t==="x"?e:e&3|8).toString(16)})},parseError(t){return typeof t=="string"?t:typeof t?.issues?.[0]?.message=="string"?t.issues[0].message:t instanceof Error?t.message:"Unknown error"},sortRequestedNetworks(t,e=[]){const r={};return e&&t&&(t.forEach((n,s)=>{r[n]=s}),e.sort((n,s)=>{const i=r[n.id],o=r[s.id];return i!==void 0&&o!==void 0?i-o:i!==void 0?-1:o!==void 0?1:0})),e},calculateBalance(t){let e=0;for(const r of t)e+=r.value??0;return e},formatTokenBalance(t){const e=t.toFixed(2),[r,n]=e.split(".");return{dollars:r,pennies:n}},isAddress(t,e="eip155"){switch(e){case"eip155":if(/^(?:0x)?[0-9a-f]{40}$/iu.test(t)){if(/^(?:0x)?[0-9a-f]{40}$/iu.test(t)||/^(?:0x)?[0-9A-F]{40}$/iu.test(t))return!0}else return!1;return!1;case"solana":return/[1-9A-HJ-NP-Za-km-z]{32,44}$/iu.test(t);default:return!1}},uniqueBy(t,e){const r=new Set;return t.filter(n=>{const s=n[e];return r.has(s)?!1:(r.add(s),!0)})},generateSdkVersion(t,e,r){const s=t.length===0?mt.ADAPTER_TYPES.UNIVERSAL:t.map(i=>i.adapterType).join(",");return`${e}-${s}-${r}`},createAccount(t,e,r,n,s){return{namespace:t,address:e,type:r,publicKey:n,path:s}},isCaipAddress(t){if(typeof t!="string")return!1;const e=t.split(":"),r=e[0];return e.filter(Boolean).length===3&&r in fe.CHAIN_NAME_MAP},getAccount(t){return t?typeof t=="string"?{address:t,chainId:void 0}:{address:t.address,chainId:t.chainId}:{address:void 0,chainId:void 0}},isMac(){const t=window?.navigator.userAgent.toLowerCase();return t.includes("macintosh")&&!t.includes("safari")},formatTelegramSocialLoginUrl(t){const e=`--${encodeURIComponent(window?.location.href)}`,r="state=";if(new URL(t).host==="auth.magic.link"){const s="provider_authorization_url=",i=t.substring(t.indexOf(s)+s.length),o=this.injectIntoUrl(decodeURIComponent(i),r,e);return t.replace(i,encodeURIComponent(o))}return this.injectIntoUrl(t,r,e)},injectIntoUrl(t,e,r){const n=t.indexOf(e);if(n===-1)throw new Error(`${e} parameter not found in the URL: ${t}`);const s=t.indexOf("&",n),i=e.length,o=s!==-1?s:t.length,a=t.substring(0,n+i),c=t.substring(n+i,o),l=t.substring(s),u=c+r;return a+u+l}},gp={STORAGE_KEY:"@appkit-wallet/",SMART_ACCOUNT_ENABLED_NETWORKS:"SMART_ACCOUNT_ENABLED_NETWORKS"},xo={SAFE_RPC_METHODS:["eth_accounts","eth_blockNumber","eth_call","eth_chainId","eth_estimateGas","eth_feeHistory","eth_gasPrice","eth_getAccount","eth_getBalance","eth_getBlockByHash","eth_getBlockByNumber","eth_getBlockReceipts","eth_getBlockTransactionCountByHash","eth_getBlockTransactionCountByNumber","eth_getCode","eth_getFilterChanges","eth_getFilterLogs","eth_getLogs","eth_getProof","eth_getStorageAt","eth_getTransactionByBlockHashAndIndex","eth_getTransactionByBlockNumberAndIndex","eth_getTransactionByHash","eth_getTransactionCount","eth_getTransactionReceipt","eth_getUncleCountByBlockHash","eth_getUncleCountByBlockNumber","eth_maxPriorityFeePerGas","eth_newBlockFilter","eth_newFilter","eth_newPendingTransactionFilter","eth_sendRawTransaction","eth_syncing","eth_uninstallFilter","wallet_getCapabilities","wallet_getCallsStatus","eth_getUserOperationReceipt","eth_estimateUserOperationGas","eth_getUserOperationByHash","eth_supportedEntryPoints","wallet_getAssets"],NOT_SAFE_RPC_METHODS:["personal_sign","eth_signTypedData_v4","eth_sendTransaction","solana_signMessage","solana_signTransaction","solana_signAllTransactions","solana_signAndSendTransaction","wallet_sendCalls","wallet_grantPermissions","wallet_revokePermissions","eth_sendUserOperation"],GET_CHAIN_ID:"eth_chainId",RPC_METHOD_NOT_ALLOWED_MESSAGE:"Requested RPC call is not allowed",RPC_METHOD_NOT_ALLOWED_UI_MESSAGE:"Action not allowed",ACCOUNT_TYPES:{EOA:"eoa",SMART_ACCOUNT:"smartAccount"}},CY={set(t,e){Xm.isClient&&localStorage.setItem(`${gp.STORAGE_KEY}${t}`,e)},get(t){return Xm.isClient?localStorage.getItem(`${gp.STORAGE_KEY}${t}`):null},delete(t,e){Xm.isClient&&(e?localStorage.removeItem(t):localStorage.removeItem(`${gp.STORAGE_KEY}${t}`))}},Xm={isClient:typeof window<"u"};function $Y(t,{strict:e=!0}={}){return!t||typeof t!="string"?!1:e?/^0x[0-9a-fA-F]*$/.test(t):t.startsWith("0x")}function Lx(t){return $Y(t,{strict:!1})?Math.ceil((t.length-2)/2):t.length}const NN="2.40.0";let Zm={getDocsUrl:({docsBaseUrl:t,docsPath:e="",docsSlug:r})=>e?`${t??"https://viem.sh"}${e}${r?`#${r}`:""}`:void 0,version:`viem@${NN}`},Zt=class ib extends Error{constructor(e,r={}){const n=r.cause instanceof ib?r.cause.details:r.cause?.message?r.cause.message:r.details,s=r.cause instanceof ib&&r.cause.docsPath||r.docsPath,i=Zm.getDocsUrl?.({...r,docsPath:s}),o=[e||"An error occurred.","",...r.metaMessages?[...r.metaMessages,""]:[],...i?[`Docs: ${i}`]:[],...n?[`Details: ${n}`]:[],...Zm.version?[`Version: ${Zm.version}`]:[]].join(`
`);super(o,r.cause?{cause:r.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metaMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),this.details=n,this.docsPath=s,this.metaMessages=r.metaMessages,this.name=r.name??this.name,this.shortMessage=e,this.version=NN}walk(e){return ON(this,e)}};function ON(t,e){return e?.(t)?t:t&&typeof t=="object"&&"cause"in t&&t.cause!==void 0?ON(t.cause,e):e?null:t}let Afe=class extends Zt{constructor({offset:e,position:r,size:n}){super(`Slice ${r==="start"?"starting":"ending"} at offset "${e}" is out-of-bounds (size: ${n}).`,{name:"SliceOffsetOutOfBoundsError"})}},kN=class extends Zt{constructor({size:e,targetSize:r,type:n}){super(`${n.charAt(0).toUpperCase()}${n.slice(1).toLowerCase()} size (${e}) exceeds padding size (${r}).`,{name:"SizeExceedsPaddingSizeError"})}};class $fe extends Zt{constructor({size:e,targetSize:r,type:n}){super(`${n.charAt(0).toUpperCase()}${n.slice(1).toLowerCase()} is expected to be ${r} ${n} long, but is ${e} ${n} long.`,{name:"InvalidBytesLengthError"})}}function sv(t,{dir:e,size:r=32}={}){return typeof t=="string"?TY(t,{dir:e,size:r}):NY(t,{dir:e,size:r})}function TY(t,{dir:e,size:r=32}={}){if(r===null)return t;const n=t.replace("0x","");if(n.length>r*2)throw new kN({size:Math.ceil(n.length/2),targetSize:r,type:"hex"});return`0x${n[e==="right"?"padEnd":"padStart"](r*2,"0")}`}function NY(t,{dir:e,size:r=32}={}){if(r===null)return t;if(t.length>r)throw new kN({size:t.length,targetSize:r,type:"bytes"});const n=new Uint8Array(r);for(let s=0;s<r;s++){const i=e==="right";n[i?s:r-s-1]=t[i?s:t.length-s-1]}return n}let OY=class extends Zt{constructor({max:e,min:r,signed:n,size:s,value:i}){super(`Number "${i}" is not in safe ${s?`${s*8}-bit ${n?"signed":"unsigned"} `:""}integer range ${e?`(${r} to ${e})`:`(above ${r})`}`,{name:"IntegerOutOfRangeError"})}};class Nfe extends Zt{constructor(e){super(`Bytes value "${e}" is not a valid boolean. The bytes array must contain a single byte of either a 0 or 1 value.`,{name:"InvalidBytesBooleanError"})}}class kY extends Zt{constructor(e){super(`Hex value "${e}" is not a valid boolean. The hex value must be "0x0" (false) or "0x1" (true).`,{name:"InvalidHexBooleanError"})}}let PY=class extends Zt{constructor({givenSize:e,maxSize:r}){super(`Size cannot exceed ${r} bytes. Given size: ${e} bytes.`,{name:"SizeOverflowError"})}};function Jm(t,{dir:e="left"}={}){let r=typeof t=="string"?t.replace("0x",""):t,n=0;for(let s=0;s<r.length-1&&r[e==="left"?s:r.length-s-1].toString()==="0";s++)n++;return r=e==="left"?r.slice(n):r.slice(0,r.length-n),typeof t=="string"?(r.length===1&&e==="right"&&(r=`${r}0`),`0x${r.length%2===1?`0${r}`:r}`):r}function oy(t,{size:e}){if(Lx(t)>e)throw new PY({givenSize:Lx(t),maxSize:e})}function RY(t,e={}){const{signed:r}=e;e.size&&oy(t,{size:e.size});const n=BigInt(t);if(!r)return n;const s=(t.length-2)/2,i=(1n<<BigInt(s)*8n-1n)-1n;return n<=i?n:n-BigInt(`0x${"f".padStart(s*2,"f")}`)-1n}function kfe(t,e={}){let r=t;if(e.size&&(oy(r,{size:e.size}),r=Jm(r)),Jm(r)==="0x00")return!1;if(Jm(r)==="0x01")return!0;throw new kY(r)}function Pfe(t,e={}){return Number(RY(t,e))}const DY=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Mx(t,e={}){return typeof t=="number"||typeof t=="bigint"?BY(t,e):typeof t=="string"?RN(t,e):typeof t=="boolean"?UY(t,e):PN(t,e)}function UY(t,e={}){const r=`0x${Number(t)}`;return typeof e.size=="number"?(oy(r,{size:e.size}),sv(r,{size:e.size})):r}function PN(t,e={}){let r="";for(let s=0;s<t.length;s++)r+=DY[t[s]];const n=`0x${r}`;return typeof e.size=="number"?(oy(n,{size:e.size}),sv(n,{dir:"right",size:e.size})):n}function BY(t,e={}){const{signed:r,size:n}=e,s=BigInt(t);let i;n?r?i=(1n<<BigInt(n)*8n-1n)-1n:i=2n**(BigInt(n)*8n)-1n:typeof t=="number"&&(i=BigInt(Number.MAX_SAFE_INTEGER));const o=typeof i=="bigint"&&r?-i-1n:0;if(i&&s>i||s<o){const c=typeof t=="bigint"?"n":"";throw new OY({max:i?`${i}${c}`:void 0,min:`${o}${c}`,signed:r,size:n,value:`${t}${c}`})}const a=`0x${(r&&s<0?(1n<<BigInt(n*8))+BigInt(s):s).toString(16)}`;return n?sv(a,{size:n}):a}const LY=new TextEncoder;function RN(t,e={}){const r=LY.encode(t);return PN(r,e)}let MY=class extends Map{constructor(e){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=e}get(e){const r=super.get(e);return super.has(e)&&r!==void 0&&(this.delete(e),super.set(e,r)),r}set(e,r){if(super.set(e,r),this.maxSize&&this.size>this.maxSize){const n=this.keys().next().value;n&&this.delete(n)}return this}};const $c=(t,e,r)=>JSON.stringify(t,(n,s)=>typeof s=="bigint"?s.toString():s,r),Dfe={gwei:9,wei:18},jY={ether:-9,wei:9};function iv(t,e){let r=t.toString();const n=r.startsWith("-");n&&(r=r.slice(1)),r=r.padStart(e,"0");let[s,i]=[r.slice(0,r.length-e),r.slice(r.length-e)];return i=i.replace(/(0+)$/,""),`${n?"-":""}${s||"0"}${i?`.${i}`:""}`}function og(t,e="wei"){return iv(t,jY[e])}const Ufe=t=>t,ov=t=>t;class vd extends Zt{constructor({body:e,cause:r,details:n,headers:s,status:i,url:o}){super("HTTP request failed.",{cause:r,details:n,metaMessages:[i&&`Status: ${i}`,`URL: ${ov(o)}`,e&&`Request body: ${$c(e)}`].filter(Boolean),name:"HttpRequestError"}),Object.defineProperty(this,"body",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"headers",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"status",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"url",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.body=e,this.headers=s,this.status=i,this.url=o}}class DN extends Zt{constructor({body:e,error:r,url:n}){super("RPC Request failed.",{cause:r,details:r.message,metaMessages:[`URL: ${ov(n)}`,`Request body: ${$c(e)}`],name:"RpcRequestError"}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"url",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.code=r.code,this.data=r.data,this.url=n}}class jx extends Zt{constructor({body:e,url:r}){super("The request took too long to respond.",{details:"The request timed out.",metaMessages:[`URL: ${ov(r)}`,`Request body: ${$c(e)}`],name:"TimeoutError"}),Object.defineProperty(this,"url",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.url=r}}const FY=-1;class as extends Zt{constructor(e,{code:r,docsPath:n,metaMessages:s,name:i,shortMessage:o}){super(o,{cause:e,docsPath:n,metaMessages:s||e?.metaMessages,name:i||"RpcError"}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=i||e.name,this.code=e instanceof DN?e.code:r??FY}}class $s extends as{constructor(e,r){super(e,r),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.data=r.data}}class Kd extends as{constructor(e){super(e,{code:Kd.code,name:"ParseRpcError",shortMessage:"Invalid JSON was received by the server. An error occurred on the server while parsing the JSON text."})}}Object.defineProperty(Kd,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32700});class Gd extends as{constructor(e){super(e,{code:Gd.code,name:"InvalidRequestRpcError",shortMessage:"JSON is not a valid request object."})}}Object.defineProperty(Gd,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32600});class Yd extends as{constructor(e,{method:r}={}){super(e,{code:Yd.code,name:"MethodNotFoundRpcError",shortMessage:`The method${r?` "${r}"`:""} does not exist / is not available.`})}}Object.defineProperty(Yd,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32601});class Xd extends as{constructor(e){super(e,{code:Xd.code,name:"InvalidParamsRpcError",shortMessage:["Invalid parameters were provided to the RPC method.","Double check you have provided the correct parameters."].join(`
`)})}}Object.defineProperty(Xd,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32602});class ru extends as{constructor(e){super(e,{code:ru.code,name:"InternalRpcError",shortMessage:"An internal error was received."})}}Object.defineProperty(ru,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32603});class Zd extends as{constructor(e){super(e,{code:Zd.code,name:"InvalidInputRpcError",shortMessage:["Missing or invalid parameters.","Double check you have provided the correct parameters."].join(`
`)})}}Object.defineProperty(Zd,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32e3});class Jd extends as{constructor(e){super(e,{code:Jd.code,name:"ResourceNotFoundRpcError",shortMessage:"Requested resource not found."}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ResourceNotFoundRpcError"})}}Object.defineProperty(Jd,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32001});class Qd extends as{constructor(e){super(e,{code:Qd.code,name:"ResourceUnavailableRpcError",shortMessage:"Requested resource not available."})}}Object.defineProperty(Qd,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32002});class nu extends as{constructor(e){super(e,{code:nu.code,name:"TransactionRejectedRpcError",shortMessage:"Transaction creation failed."})}}Object.defineProperty(nu,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32003});class mc extends as{constructor(e,{method:r}={}){super(e,{code:mc.code,name:"MethodNotSupportedRpcError",shortMessage:`Method${r?` "${r}"`:""} is not supported.`})}}Object.defineProperty(mc,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32004});class su extends as{constructor(e){super(e,{code:su.code,name:"LimitExceededRpcError",shortMessage:"Request exceeds defined limit."})}}Object.defineProperty(su,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32005});class eh extends as{constructor(e){super(e,{code:eh.code,name:"JsonRpcVersionUnsupportedError",shortMessage:"Version of JSON-RPC protocol is not supported."})}}Object.defineProperty(eh,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32006});class Tc extends $s{constructor(e){super(e,{code:Tc.code,name:"UserRejectedRequestError",shortMessage:"User rejected the request."})}}Object.defineProperty(Tc,"code",{enumerable:!0,configurable:!0,writable:!0,value:4001});class th extends $s{constructor(e){super(e,{code:th.code,name:"UnauthorizedProviderError",shortMessage:"The requested method and/or account has not been authorized by the user."})}}Object.defineProperty(th,"code",{enumerable:!0,configurable:!0,writable:!0,value:4100});class rh extends $s{constructor(e,{method:r}={}){super(e,{code:rh.code,name:"UnsupportedProviderMethodError",shortMessage:`The Provider does not support the requested method${r?` " ${r}"`:""}.`})}}Object.defineProperty(rh,"code",{enumerable:!0,configurable:!0,writable:!0,value:4200});class nh extends $s{constructor(e){super(e,{code:nh.code,name:"ProviderDisconnectedError",shortMessage:"The Provider is disconnected from all chains."})}}Object.defineProperty(nh,"code",{enumerable:!0,configurable:!0,writable:!0,value:4900});class sh extends $s{constructor(e){super(e,{code:sh.code,name:"ChainDisconnectedError",shortMessage:"The Provider is not connected to the requested chain."})}}Object.defineProperty(sh,"code",{enumerable:!0,configurable:!0,writable:!0,value:4901});class ih extends $s{constructor(e){super(e,{code:ih.code,name:"SwitchChainError",shortMessage:"An error occurred when attempting to switch chain."})}}Object.defineProperty(ih,"code",{enumerable:!0,configurable:!0,writable:!0,value:4902});class oh extends $s{constructor(e){super(e,{code:oh.code,name:"UnsupportedNonOptionalCapabilityError",shortMessage:"This Wallet does not support a capability that was not marked as optional."})}}Object.defineProperty(oh,"code",{enumerable:!0,configurable:!0,writable:!0,value:5700});class ah extends $s{constructor(e){super(e,{code:ah.code,name:"UnsupportedChainIdError",shortMessage:"This Wallet does not support the requested chain ID."})}}Object.defineProperty(ah,"code",{enumerable:!0,configurable:!0,writable:!0,value:5710});class ch extends $s{constructor(e){super(e,{code:ch.code,name:"DuplicateIdError",shortMessage:"There is already a bundle submitted with this ID."})}}Object.defineProperty(ch,"code",{enumerable:!0,configurable:!0,writable:!0,value:5720});class lh extends $s{constructor(e){super(e,{code:lh.code,name:"UnknownBundleIdError",shortMessage:"This bundle id is unknown / has not been submitted"})}}Object.defineProperty(lh,"code",{enumerable:!0,configurable:!0,writable:!0,value:5730});class uh extends $s{constructor(e){super(e,{code:uh.code,name:"BundleTooLargeError",shortMessage:"The call bundle is too large for the Wallet to process."})}}Object.defineProperty(uh,"code",{enumerable:!0,configurable:!0,writable:!0,value:5740});class dh extends $s{constructor(e){super(e,{code:dh.code,name:"AtomicReadyWalletRejectedUpgradeError",shortMessage:"The Wallet can support atomicity after an upgrade, but the user rejected the upgrade."})}}Object.defineProperty(dh,"code",{enumerable:!0,configurable:!0,writable:!0,value:5750});class hh extends $s{constructor(e){super(e,{code:hh.code,name:"AtomicityNotSupportedError",shortMessage:"The wallet does not support atomic execution but the request requires it."})}}Object.defineProperty(hh,"code",{enumerable:!0,configurable:!0,writable:!0,value:5760});class qY extends as{constructor(e){super(e,{name:"UnknownRpcError",shortMessage:"An unknown RPC error occurred."})}}class av extends Zt{constructor({cause:e,message:r}={}){const n=r?.replace("execution reverted: ","")?.replace("execution reverted","");super(`Execution reverted ${n?`with reason: ${n}`:"for an unknown reason"}.`,{cause:e,name:"ExecutionRevertedError"})}}Object.defineProperty(av,"code",{enumerable:!0,configurable:!0,writable:!0,value:3});Object.defineProperty(av,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/execution reverted/});class zY extends Zt{constructor({cause:e,maxFeePerGas:r}={}){super(`The fee cap (\`maxFeePerGas\`${r?` = ${og(r)} gwei`:""}) cannot be higher than the maximum allowed value (2^256-1).`,{cause:e,name:"FeeCapTooHighError"})}}Object.defineProperty(zY,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/max fee per gas higher than 2\^256-1|fee cap higher than 2\^256-1/});class HY extends Zt{constructor({cause:e,maxFeePerGas:r}={}){super(`The fee cap (\`maxFeePerGas\`${r?` = ${og(r)}`:""} gwei) cannot be lower than the block base fee.`,{cause:e,name:"FeeCapTooLowError"})}}Object.defineProperty(HY,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/max fee per gas less than block base fee|fee cap less than block base fee|transaction is outdated/});class WY extends Zt{constructor({cause:e,nonce:r}={}){super(`Nonce provided for the transaction ${r?`(${r}) `:""}is higher than the next one expected.`,{cause:e,name:"NonceTooHighError"})}}Object.defineProperty(WY,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/nonce too high/});class VY extends Zt{constructor({cause:e,nonce:r}={}){super([`Nonce provided for the transaction ${r?`(${r}) `:""}is lower than the current nonce of the account.`,"Try increasing the nonce or find the latest nonce with `getTransactionCount`."].join(`
`),{cause:e,name:"NonceTooLowError"})}}Object.defineProperty(VY,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/nonce too low|transaction already imported|already known/});class KY extends Zt{constructor({cause:e,nonce:r}={}){super(`Nonce provided for the transaction ${r?`(${r}) `:""}exceeds the maximum allowed nonce.`,{cause:e,name:"NonceMaxValueError"})}}Object.defineProperty(KY,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/nonce has max value/});class GY extends Zt{constructor({cause:e}={}){super(["The total cost (gas * gas fee + value) of executing this transaction exceeds the balance of the account."].join(`
`),{cause:e,metaMessages:["This error could arise when the account does not have enough funds to:"," - pay for the total gas fee,"," - pay for the value to send."," ","The cost of the transaction is calculated as `gas * gas fee + value`, where:"," - `gas` is the amount of gas needed for transaction to execute,"," - `gas fee` is the gas fee,"," - `value` is the amount of ether to send to the recipient."],name:"InsufficientFundsError"})}}Object.defineProperty(GY,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/insufficient funds|exceeds transaction sender account balance/});class YY extends Zt{constructor({cause:e,gas:r}={}){super(`The amount of gas ${r?`(${r}) `:""}provided for the transaction exceeds the limit allowed for the block.`,{cause:e,name:"IntrinsicGasTooHighError"})}}Object.defineProperty(YY,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/intrinsic gas too high|gas limit reached/});class XY extends Zt{constructor({cause:e,gas:r}={}){super(`The amount of gas ${r?`(${r}) `:""}provided for the transaction is too low.`,{cause:e,name:"IntrinsicGasTooLowError"})}}Object.defineProperty(XY,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/intrinsic gas too low/});class ZY extends Zt{constructor({cause:e}){super("The transaction type is not supported for this chain.",{cause:e,name:"TransactionTypeNotSupportedError"})}}Object.defineProperty(ZY,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/transaction type not valid/});class JY extends Zt{constructor({cause:e,maxPriorityFeePerGas:r,maxFeePerGas:n}={}){super([`The provided tip (\`maxPriorityFeePerGas\`${r?` = ${og(r)} gwei`:""}) cannot be higher than the fee cap (\`maxFeePerGas\`${n?` = ${og(n)} gwei`:""}).`].join(`
`),{cause:e,name:"TipAboveFeeCapError"})}}Object.defineProperty(JY,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/max priority fee per gas higher than max fee per gas|tip higher than fee cap/});class Bfe extends Zt{constructor({cause:e}){super(`An error occurred while executing: ${e?.shortMessage}`,{cause:e,name:"UnknownNodeError"})}}const Lfe=[{inputs:[{components:[{name:"target",type:"address"},{name:"allowFailure",type:"bool"},{name:"callData",type:"bytes"}],name:"calls",type:"tuple[]"}],name:"aggregate3",outputs:[{components:[{name:"success",type:"bool"},{name:"returnData",type:"bytes"}],name:"returnData",type:"tuple[]"}],stateMutability:"view",type:"function"},{inputs:[],name:"getCurrentBlockTimestamp",outputs:[{internalType:"uint256",name:"timestamp",type:"uint256"}],stateMutability:"view",type:"function"}],Mfe=[{name:"query",type:"function",stateMutability:"view",inputs:[{type:"tuple[]",name:"queries",components:[{type:"address",name:"sender"},{type:"string[]",name:"urls"},{type:"bytes",name:"data"}]}],outputs:[{type:"bool[]",name:"failures"},{type:"bytes[]",name:"responses"}]},{name:"HttpError",type:"error",inputs:[{type:"uint16",name:"status"},{type:"string",name:"message"}]}],UN=[{inputs:[{name:"dns",type:"bytes"}],name:"DNSDecodingFailed",type:"error"},{inputs:[{name:"ens",type:"string"}],name:"DNSEncodingFailed",type:"error"},{inputs:[],name:"EmptyAddress",type:"error"},{inputs:[{name:"status",type:"uint16"},{name:"message",type:"string"}],name:"HttpError",type:"error"},{inputs:[],name:"InvalidBatchGatewayResponse",type:"error"},{inputs:[{name:"errorData",type:"bytes"}],name:"ResolverError",type:"error"},{inputs:[{name:"name",type:"bytes"},{name:"resolver",type:"address"}],name:"ResolverNotContract",type:"error"},{inputs:[{name:"name",type:"bytes"}],name:"ResolverNotFound",type:"error"},{inputs:[{name:"primary",type:"string"},{name:"primaryAddress",type:"bytes"}],name:"ReverseAddressMismatch",type:"error"},{inputs:[{internalType:"bytes4",name:"selector",type:"bytes4"}],name:"UnsupportedResolverProfile",type:"error"}],jfe=[...UN,{name:"resolveWithGateways",type:"function",stateMutability:"view",inputs:[{name:"name",type:"bytes"},{name:"data",type:"bytes"},{name:"gateways",type:"string[]"}],outputs:[{name:"",type:"bytes"},{name:"address",type:"address"}]}],Ffe=[...UN,{name:"reverseWithGateways",type:"function",stateMutability:"view",inputs:[{type:"bytes",name:"reverseName"},{type:"uint256",name:"coinType"},{type:"string[]",name:"gateways"}],outputs:[{type:"string",name:"resolvedName"},{type:"address",name:"resolver"},{type:"address",name:"reverseResolver"}]}],qfe=[{name:"text",type:"function",stateMutability:"view",inputs:[{name:"name",type:"bytes32"},{name:"key",type:"string"}],outputs:[{name:"",type:"string"}]}],zfe=[{name:"addr",type:"function",stateMutability:"view",inputs:[{name:"name",type:"bytes32"}],outputs:[{name:"",type:"address"}]},{name:"addr",type:"function",stateMutability:"view",inputs:[{name:"name",type:"bytes32"},{name:"coinType",type:"uint256"}],outputs:[{name:"",type:"bytes"}]}],Hfe=[{name:"isValidSignature",type:"function",stateMutability:"view",inputs:[{name:"hash",type:"bytes32"},{name:"signature",type:"bytes"}],outputs:[{name:"",type:"bytes4"}]}],Wfe=[{inputs:[{name:"_signer",type:"address"},{name:"_hash",type:"bytes32"},{name:"_signature",type:"bytes"}],stateMutability:"nonpayable",type:"constructor"},{inputs:[{name:"_signer",type:"address"},{name:"_hash",type:"bytes32"},{name:"_signature",type:"bytes"}],outputs:[{type:"bool"}],stateMutability:"nonpayable",type:"function",name:"isValidSig"}],$f=[{type:"event",name:"Approval",inputs:[{indexed:!0,name:"owner",type:"address"},{indexed:!0,name:"spender",type:"address"},{indexed:!1,name:"value",type:"uint256"}]},{type:"event",name:"Transfer",inputs:[{indexed:!0,name:"from",type:"address"},{indexed:!0,name:"to",type:"address"},{indexed:!1,name:"value",type:"uint256"}]},{type:"function",name:"allowance",stateMutability:"view",inputs:[{name:"owner",type:"address"},{name:"spender",type:"address"}],outputs:[{type:"uint256"}]},{type:"function",name:"approve",stateMutability:"nonpayable",inputs:[{name:"spender",type:"address"},{name:"amount",type:"uint256"}],outputs:[{type:"bool"}]},{type:"function",name:"balanceOf",stateMutability:"view",inputs:[{name:"account",type:"address"}],outputs:[{type:"uint256"}]},{type:"function",name:"decimals",stateMutability:"view",inputs:[],outputs:[{type:"uint8"}]},{type:"function",name:"name",stateMutability:"view",inputs:[],outputs:[{type:"string"}]},{type:"function",name:"symbol",stateMutability:"view",inputs:[],outputs:[{type:"string"}]},{type:"function",name:"totalSupply",stateMutability:"view",inputs:[],outputs:[{type:"uint256"}]},{type:"function",name:"transfer",stateMutability:"nonpayable",inputs:[{name:"recipient",type:"address"},{name:"amount",type:"uint256"}],outputs:[{type:"bool"}]},{type:"function",name:"transferFrom",stateMutability:"nonpayable",inputs:[{name:"sender",type:"address"},{name:"recipient",type:"address"},{name:"amount",type:"uint256"}],outputs:[{type:"bool"}]}];function QY(){let t=()=>{},e=()=>{};return{promise:new Promise((n,s)=>{t=n,e=s}),resolve:t,reject:e}}const Qm=new Map;function eX({fn:t,id:e,shouldSplitBatch:r,wait:n=0,sort:s}){const i=async()=>{const u=c();o();const d=u.map(({args:h})=>h);d.length!==0&&t(d).then(h=>{s&&Array.isArray(h)&&h.sort(s);for(let p=0;p<u.length;p++){const{resolve:y}=u[p];y?.([h[p],h])}}).catch(h=>{for(let p=0;p<u.length;p++){const{reject:y}=u[p];y?.(h)}})},o=()=>Qm.delete(e),a=()=>c().map(({args:u})=>u),c=()=>Qm.get(e)||[],l=u=>Qm.set(e,[...c(),u]);return{flush:o,async schedule(u){const{promise:d,resolve:h,reject:p}=QY();return r?.([...a(),u])&&i(),c().length>0?(l({args:u,resolve:h,reject:p}),d):(l({args:u,resolve:h,reject:p}),setTimeout(i,n),d)}}}async function BN(t){return new Promise(e=>setTimeout(e,t))}function tX(t,{delay:e=100,retryCount:r=2,shouldRetry:n=()=>!0}={}){return new Promise((s,i)=>{const o=async({count:a=0}={})=>{const c=async({error:l})=>{const u=typeof e=="function"?e({count:a,error:l}):e;u&&await BN(u),o({count:a+1})};try{const l=await t();s(l)}catch(l){if(a<r&&await n({count:a,error:l}))return c({error:l});i(l)}};o()})}const ob=256;let Tf=ob,Nf;function rX(t=11){if(!Nf||Tf+t>ob*2){Nf="",Tf=0;for(let e=0;e<ob;e++)Nf+=(256+Math.random()*256|0).toString(16).substring(1)}return Nf.substring(Tf,Tf+++t)}const Of=new MY(8192);function nX(t,{enabled:e=!0,id:r}){if(!e||!r)return t();if(Of.get(r))return Of.get(r);const n=t().finally(()=>Of.delete(r));return Of.set(r,n),n}function sX(t,e={}){return async(r,n={})=>{const{dedupe:s=!1,methods:i,retryDelay:o=150,retryCount:a=3,uid:c}={...e,...n},{method:l}=r;if(i?.exclude?.includes(l))throw new mc(new Error("method not supported"),{method:l});if(i?.include&&!i.include.includes(l))throw new mc(new Error("method not supported"),{method:l});const u=s?RN(`${c}.${$c(r)}`):void 0;return nX(()=>tX(async()=>{try{return await t(r)}catch(d){const h=d;switch(h.code){case Kd.code:throw new Kd(h);case Gd.code:throw new Gd(h);case Yd.code:throw new Yd(h,{method:r.method});case Xd.code:throw new Xd(h);case ru.code:throw new ru(h);case Zd.code:throw new Zd(h);case Jd.code:throw new Jd(h);case Qd.code:throw new Qd(h);case nu.code:throw new nu(h);case mc.code:throw new mc(h,{method:r.method});case su.code:throw new su(h);case eh.code:throw new eh(h);case Tc.code:throw new Tc(h);case th.code:throw new th(h);case rh.code:throw new rh(h);case nh.code:throw new nh(h);case sh.code:throw new sh(h);case ih.code:throw new ih(h);case oh.code:throw new oh(h);case ah.code:throw new ah(h);case ch.code:throw new ch(h);case lh.code:throw new lh(h);case uh.code:throw new uh(h);case dh.code:throw new dh(h);case hh.code:throw new hh(h);case 5e3:throw new Tc(h);default:throw d instanceof Zt?d:new qY(h)}}},{delay:({count:d,error:h})=>{if(h&&h instanceof vd){const p=h?.headers?.get("Retry-After");if(p?.match(/\d/))return Number.parseInt(p,10)*1e3}return~~(1<<d)*o},retryCount:a,shouldRetry:({error:d})=>iX(d)}),{enabled:s,id:u})}}function iX(t){return"code"in t&&typeof t.code=="number"?t.code===-1||t.code===su.code||t.code===ru.code:t instanceof vd&&t.status?t.status===403||t.status===408||t.status===413||t.status===429||t.status===500||t.status===502||t.status===503||t.status===504:!0}function oX(t){return{formatters:void 0,fees:void 0,serializers:void 0,...t}}function aX(t,{errorInstance:e=new Error("timed out"),timeout:r,signal:n}){return new Promise((s,i)=>{(async()=>{let o;try{const a=new AbortController;r>0&&(o=setTimeout(()=>{n&&a.abort()},r)),s(await t({signal:a?.signal||null}))}catch(a){a?.name==="AbortError"&&i(e),i(a)}finally{clearTimeout(o)}})()})}function cX(){return{current:0,take(){return this.current++},reset(){this.current=0}}}const Fx=cX();function lX(t,e={}){return{async request(r){const{body:n,fetchFn:s=e.fetchFn??fetch,onRequest:i=e.onRequest,onResponse:o=e.onResponse,timeout:a=e.timeout??1e4}=r,c={...e.fetchOptions??{},...r.fetchOptions??{}},{headers:l,method:u,signal:d}=c;try{const h=await aX(async({signal:y})=>{const g={...c,body:Array.isArray(n)?$c(n.map(E=>({jsonrpc:"2.0",id:E.id??Fx.take(),...E}))):$c({jsonrpc:"2.0",id:n.id??Fx.take(),...n}),headers:{"Content-Type":"application/json",...l},method:u||"POST",signal:d||(a>0?y:null)},w=new Request(t,g),S=await i?.(w,g)??{...g,url:t};return await s(S.url??t,S)},{errorInstance:new jx({body:n,url:t}),timeout:a,signal:!0});o&&await o(h);let p;if(h.headers.get("Content-Type")?.startsWith("application/json"))p=await h.json();else{p=await h.text();try{p=JSON.parse(p||"{}")}catch(y){if(h.ok)throw y;p={error:p}}}if(!h.ok)throw new vd({body:n,details:$c(p.error)||h.statusText,headers:h.headers,status:h.status,url:t});return p}catch(h){throw h instanceof vd||h instanceof jx?h:new vd({body:n,cause:h,url:t})}}}}function LN({key:t,methods:e,name:r,request:n,retryCount:s=3,retryDelay:i=150,timeout:o,type:a},c){const l=rX();return{config:{key:t,methods:e,name:r,request:n,retryCount:s,retryDelay:i,timeout:o,type:a},request:sX(n,{methods:e,retryCount:s,retryDelay:i,uid:l}),value:c}}function qx(t,e={}){const{key:r="fallback",name:n="Fallback",rank:s=!1,shouldThrow:i=uX,retryCount:o,retryDelay:a}=e;return(({chain:c,pollingInterval:l=4e3,timeout:u,...d})=>{let h=t,p=()=>{};const y=LN({key:r,name:n,async request({method:g,params:w}){let S;const A=async(E=0)=>{const v=h[E]({...d,chain:c,retryCount:0,timeout:u});try{const C=await v.request({method:g,params:w});return p({method:g,params:w,response:C,transport:v,status:"success"}),C}catch(C){if(p({error:C,method:g,params:w,transport:v,status:"error"}),i(C)||E===h.length-1||(S??=h.slice(E+1).some(O=>{const{include:L,exclude:j}=O({chain:c}).config.methods||{};return L?L.includes(g):j?!j.includes(g):!0}),!S))throw C;return A(E+1)}};return A()},retryCount:o,retryDelay:a,type:"fallback"},{onResponse:g=>p=g,transports:h.map(g=>g({chain:c,retryCount:0}))});if(s){const g=typeof s=="object"?s:{};dX({chain:c,interval:g.interval??l,onTransports:w=>h=w,ping:g.ping,sampleCount:g.sampleCount,timeout:g.timeout,transports:h,weights:g.weights})}return y})}function uX(t){return!!("code"in t&&typeof t.code=="number"&&(t.code===nu.code||t.code===Tc.code||av.nodeMessage.test(t.message)||t.code===5e3))}function dX({chain:t,interval:e=4e3,onTransports:r,ping:n,sampleCount:s=10,timeout:i=1e3,transports:o,weights:a={}}){const{stability:c=.7,latency:l=.3}=a,u=[],d=async()=>{const h=await Promise.all(o.map(async g=>{const w=g({chain:t,retryCount:0,timeout:i}),S=Date.now();let A,E;try{await(n?n({transport:w}):w.request({method:"net_listening"})),E=1}catch{E=0}finally{A=Date.now()}return{latency:A-S,success:E}}));u.push(h),u.length>s&&u.shift();const p=Math.max(...u.map(g=>Math.max(...g.map(({latency:w})=>w)))),y=o.map((g,w)=>{const S=u.map(O=>O[w].latency),E=1-S.reduce((O,L)=>O+L,0)/S.length/p,v=u.map(O=>O[w].success),C=v.reduce((O,L)=>O+L,0)/v.length;return C===0?[0,w]:[l*E+c*C,w]}).sort((g,w)=>w[0]-g[0]);r(y.map(([,g])=>o[g])),await BN(e),d()};d()}class hX extends Zt{constructor(){super("No URL was provided to the Transport. Please provide a valid RPC URL to the Transport.",{docsPath:"/docs/clients/intro",name:"UrlRequiredError"})}}function kf(t,e={}){const{batch:r,fetchFn:n,fetchOptions:s,key:i="http",methods:o,name:a="HTTP JSON-RPC",onFetchRequest:c,onFetchResponse:l,retryDelay:u,raw:d}=e;return({chain:h,retryCount:p,timeout:y})=>{const{batchSize:g=1e3,wait:w=0}=typeof r=="object"?r:{},S=e.retryCount??p,A=y??e.timeout??1e4,E=t||h?.rpcUrls.default.http[0];if(!E)throw new hX;const v=lX(E,{fetchFn:n,fetchOptions:s,onRequest:c,onResponse:l,timeout:A});return LN({key:i,methods:o,name:a,async request({method:C,params:O}){const L={method:C,params:O},{schedule:j}=eX({id:E,wait:w,shouldSplitBatch(R){return R.length>g},fn:R=>v.request({body:R}),sort:(R,T)=>R.id-T.id}),D=async R=>r?j(R):[await v.request({body:R})],[{error:W,result:P}]=await D(L);if(d)return{error:W,result:P};if(W)throw new DN({body:L,error:W,url:E});return P},retryCount:S,retryDelay:u,timeout:A,type:"http"},{fetchOptions:s,url:E})}}async function Hu(...t){const e=await fetch(...t);if(!e.ok)throw new Error(`HTTP status code: ${e.status}`,{cause:e});return e}class zh{constructor({baseUrl:e,clientId:r}){this.baseUrl=e,this.clientId=r}async get({headers:e,signal:r,cache:n,...s}){const i=this.createUrl(s);return(await Hu(i,{method:"GET",headers:e,signal:r,cache:n})).json()}async getBlob({headers:e,signal:r,...n}){const s=this.createUrl(n);return(await Hu(s,{method:"GET",headers:e,signal:r})).blob()}async post({body:e,headers:r,signal:n,...s}){const i=this.createUrl(s);return(await Hu(i,{method:"POST",headers:r,body:e?JSON.stringify(e):void 0,signal:n})).json()}async put({body:e,headers:r,signal:n,...s}){const i=this.createUrl(s);return(await Hu(i,{method:"PUT",headers:r,body:e?JSON.stringify(e):void 0,signal:n})).json()}async delete({body:e,headers:r,signal:n,...s}){const i=this.createUrl(s);return(await Hu(i,{method:"DELETE",headers:r,body:e?JSON.stringify(e):void 0,signal:n})).json()}createUrl({path:e,params:r}){const n=new URL(e,this.baseUrl);return r&&Object.entries(r).forEach(([s,i])=>{i&&n.searchParams.append(s,i)}),this.clientId&&n.searchParams.append("clientId",this.clientId),n}sendBeacon({body:e,...r}){const n=this.createUrl(r);return navigator.sendBeacon(n.toString(),e?JSON.stringify(e):void 0)}}const ab={getFeatureValue(t,e){const r=e?.[t];return r===void 0?mt.DEFAULT_FEATURES[t]:r},filterSocialsByPlatform(t){if(!t||!t.length)return t;let e=t;return Ne.isTelegram()&&(Ne.isIos()&&(e=e.filter(r=>r!=="google")),Ne.isMac()&&(e=e.filter(r=>r!=="x")),Ne.isAndroid()&&(e=e.filter(r=>!["facebook","x"].includes(r)))),Ne.isMobile()&&(e=e.filter(r=>r!=="facebook")),e},isSocialsEnabled(){return Array.isArray(te.state.features?.socials)&&te.state.features?.socials.length>0||Array.isArray(te.state.remoteFeatures?.socials)&&te.state.remoteFeatures?.socials.length>0},isEmailEnabled(){return!!(te.state.features?.email||te.state.remoteFeatures?.email)}},Be=Xt({features:mt.DEFAULT_FEATURES,projectId:"",sdkType:"appkit",sdkVersion:"html-wagmi-undefined",defaultAccountTypes:mt.DEFAULT_ACCOUNT_TYPES,enableNetworkSwitch:!0,experimental_preferUniversalLinks:!1,remoteFeatures:{},enableMobileFullScreen:!1,coinbasePreference:"all"}),te={state:Be,subscribeKey(t,e){return cn(Be,t,e)},setOptions(t){Object.assign(Be,t)},setRemoteFeatures(t){if(!t)return;const e={...Be.remoteFeatures,...t};Be.remoteFeatures=e,Be.remoteFeatures?.socials&&(Be.remoteFeatures.socials=ab.filterSocialsByPlatform(Be.remoteFeatures.socials)),Be.features?.pay&&(Be.remoteFeatures.email=!1,Be.remoteFeatures.socials=!1)},setFeatures(t){if(!t)return;Be.features||(Be.features=mt.DEFAULT_FEATURES);const e={...Be.features,...t};Be.features=e,Be.features?.pay&&Be.remoteFeatures&&(Be.remoteFeatures.email=!1,Be.remoteFeatures.socials=!1)},setProjectId(t){Be.projectId=t},setCustomRpcUrls(t){Be.customRpcUrls=t},setAllWallets(t){Be.allWallets=t},setIncludeWalletIds(t){Be.includeWalletIds=t},setExcludeWalletIds(t){Be.excludeWalletIds=t},setFeaturedWalletIds(t){Be.featuredWalletIds=t},setTokens(t){Be.tokens=t},setTermsConditionsUrl(t){Be.termsConditionsUrl=t},setPrivacyPolicyUrl(t){Be.privacyPolicyUrl=t},setCustomWallets(t){Be.customWallets=t},setIsSiweEnabled(t){Be.isSiweEnabled=t},setIsUniversalProvider(t){Be.isUniversalProvider=t},setSdkVersion(t){Be.sdkVersion=t},setMetadata(t){Be.metadata=t},setDisableAppend(t){Be.disableAppend=t},setEIP6963Enabled(t){Be.enableEIP6963=t},setDebug(t){Be.debug=t},setEnableWalletGuide(t){Be.enableWalletGuide=t},setEnableAuthLogger(t){Be.enableAuthLogger=t},setEnableWallets(t){Be.enableWallets=t},setPreferUniversalLinks(t){Be.experimental_preferUniversalLinks=t},setSIWX(t){if(t)for(const[e,r]of Object.entries(mt.SIWX_DEFAULTS))t[e]??=r;Be.siwx=t},setConnectMethodsOrder(t){Be.features={...Be.features,connectMethodsOrder:t}},setWalletFeaturesOrder(t){Be.features={...Be.features,walletFeaturesOrder:t}},setSocialsOrder(t){Be.remoteFeatures={...Be.remoteFeatures,socials:t}},setCollapseWallets(t){Be.features={...Be.features,collapseWallets:t}},setEnableEmbedded(t){Be.enableEmbedded=t},setAllowUnsupportedChain(t){Be.allowUnsupportedChain=t},setManualWCControl(t){Be.manualWCControl=t},setEnableNetworkSwitch(t){Be.enableNetworkSwitch=t},setEnableMobileFullScreen(t){Be.enableMobileFullScreen=Ne.isMobile()&&t},setEnableReconnect(t){Be.enableReconnect=t},setCoinbasePreference(t){Be.coinbasePreference=t},setDefaultAccountTypes(t={}){Object.entries(t).forEach(([e,r])=>{r&&(Be.defaultAccountTypes[e]=r)})},setUniversalProviderConfigOverride(t){Be.universalProviderConfigOverride=t},getUniversalProviderConfigOverride(){return Be.universalProviderConfigOverride},getSnapshot(){return Wd(Be)}},tc=Object.freeze({message:"",variant:"success",svg:void 0,open:!1,autoClose:!0}),Tr=Xt({...tc}),fX={state:Tr,subscribeKey(t,e){return cn(Tr,t,e)},showLoading(t,e={}){this._showMessage({message:t,variant:"loading",...e})},showSuccess(t){this._showMessage({message:t,variant:"success"})},showSvg(t,e){this._showMessage({message:t,svg:e})},showError(t){const e=Ne.parseError(t);this._showMessage({message:e,variant:"error"})},hide(){Tr.message=tc.message,Tr.variant=tc.variant,Tr.svg=tc.svg,Tr.open=tc.open,Tr.autoClose=tc.autoClose},_showMessage({message:t,svg:e,variant:r="success",autoClose:n=tc.autoClose}){Tr.open?(Tr.open=!1,setTimeout(()=>{Tr.message=t,Tr.variant=r,Tr.svg=e,Tr.open=!0,Tr.autoClose=n},150)):(Tr.message=t,Tr.variant=r,Tr.svg=e,Tr.open=!0,Tr.autoClose=n)}},Li=fX,pX={purchaseCurrencies:[{id:"2b92315d-eab7-5bef-84fa-089a131333f5",name:"USD Coin",symbol:"USDC",networks:[{name:"ethereum-mainnet",display_name:"Ethereum",chain_id:"1",contract_address:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"},{name:"polygon-mainnet",display_name:"Polygon",chain_id:"137",contract_address:"0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174"}]},{id:"2b92315d-eab7-5bef-84fa-089a131333f5",name:"Ether",symbol:"ETH",networks:[{name:"ethereum-mainnet",display_name:"Ethereum",chain_id:"1",contract_address:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"},{name:"polygon-mainnet",display_name:"Polygon",chain_id:"137",contract_address:"0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174"}]}],paymentCurrencies:[{id:"USD",payment_method_limits:[{id:"card",min:"10.00",max:"7500.00"},{id:"ach_bank_account",min:"10.00",max:"25000.00"}]},{id:"EUR",payment_method_limits:[{id:"card",min:"10.00",max:"7500.00"},{id:"ach_bank_account",min:"10.00",max:"25000.00"}]}]},MN=Ne.getBlockchainApiUrl(),jn=Xt({clientId:null,api:new zh({baseUrl:MN,clientId:null}),supportedChains:{http:[],ws:[]}}),He={state:jn,async get(t){const{st:e,sv:r}=He.getSdkProperties(),n=te.state.projectId,s={...t.params||{},st:e,sv:r,projectId:n};return jn.api.get({...t,params:s})},getSdkProperties(){const{sdkType:t,sdkVersion:e}=te.state;return{st:t||"unknown",sv:e||"unknown"}},async isNetworkSupported(t){if(!t)return!1;try{jn.supportedChains.http.length||await He.getSupportedNetworks()}catch{return!1}return jn.supportedChains.http.includes(t)},async getSupportedNetworks(){try{const t=await He.get({path:"v1/supported-chains"});return jn.supportedChains=t,t}catch{return jn.supportedChains}},async fetchIdentity({address:t}){const e=de.getIdentityFromCacheForAddress(t);if(e)return e;const r=await He.get({path:`/v1/identity/${t}`,params:{sender:q.state.activeCaipAddress?Ne.getPlainAddress(q.state.activeCaipAddress):void 0}});return de.updateIdentityCache({address:t,identity:r,timestamp:Date.now()}),r},async fetchTransactions({account:t,cursor:e,signal:r,cache:n,chainId:s}){if(!await He.isNetworkSupported(q.state.activeCaipNetwork?.caipNetworkId))return{data:[],next:void 0};const o=de.getTransactionsCacheForAddress({address:t,chainId:s});if(o)return o;const a=await He.get({path:`/v1/account/${t}/history`,params:{cursor:e,chainId:s},signal:r,cache:n});return de.updateTransactionsCache({address:t,chainId:s,timestamp:Date.now(),transactions:a}),a},async fetchSwapQuote({amount:t,userAddress:e,from:r,to:n,gasPrice:s}){return await He.isNetworkSupported(q.state.activeCaipNetwork?.caipNetworkId)?He.get({path:"/v1/convert/quotes",headers:{"Content-Type":"application/json"},params:{amount:t,userAddress:e,from:r,to:n,gasPrice:s}}):{quotes:[]}},async fetchSwapTokens({chainId:t}){return await He.isNetworkSupported(q.state.activeCaipNetwork?.caipNetworkId)?He.get({path:"/v1/convert/tokens",params:{chainId:t}}):{tokens:[]}},async fetchTokenPrice({addresses:t}){if(!await He.isNetworkSupported(q.state.activeCaipNetwork?.caipNetworkId))return{fungibles:[]};const r=de.getTokenPriceCacheForAddresses(t);if(r)return r;const n=await jn.api.post({path:"/v1/fungible/price",body:{currency:"usd",addresses:t,projectId:te.state.projectId},headers:{"Content-Type":"application/json"}});return de.updateTokenPriceCache({addresses:t,timestamp:Date.now(),tokenPrice:n}),n},async fetchSwapAllowance({tokenAddress:t,userAddress:e}){return await He.isNetworkSupported(q.state.activeCaipNetwork?.caipNetworkId)?He.get({path:"/v1/convert/allowance",params:{tokenAddress:t,userAddress:e},headers:{"Content-Type":"application/json"}}):{allowance:"0"}},async fetchGasPrice({chainId:t}){const{st:e,sv:r}=He.getSdkProperties();if(!await He.isNetworkSupported(q.state.activeCaipNetwork?.caipNetworkId))throw new Error("Network not supported for Gas Price");return He.get({path:"/v1/convert/gas-price",headers:{"Content-Type":"application/json"},params:{chainId:t,st:e,sv:r}})},async generateSwapCalldata({amount:t,from:e,to:r,userAddress:n,disableEstimate:s}){if(!await He.isNetworkSupported(q.state.activeCaipNetwork?.caipNetworkId))throw new Error("Network not supported for Swaps");return jn.api.post({path:"/v1/convert/build-transaction",headers:{"Content-Type":"application/json"},body:{amount:t,eip155:{slippage:mt.CONVERT_SLIPPAGE_TOLERANCE},projectId:te.state.projectId,from:e,to:r,userAddress:n,disableEstimate:s}})},async generateApproveCalldata({from:t,to:e,userAddress:r}){const{st:n,sv:s}=He.getSdkProperties();if(!await He.isNetworkSupported(q.state.activeCaipNetwork?.caipNetworkId))throw new Error("Network not supported for Swaps");return He.get({path:"/v1/convert/build-approve",headers:{"Content-Type":"application/json"},params:{userAddress:r,from:t,to:e,st:n,sv:s}})},async getBalance(t,e,r){const{st:n,sv:s}=He.getSdkProperties();if(!await He.isNetworkSupported(q.state.activeCaipNetwork?.caipNetworkId))return Li.showError("Token Balance Unavailable"),{balances:[]};const o=`${e}:${t}`,a=de.getBalanceCacheForCaipAddress(o);if(a)return a;const c=await He.get({path:`/v1/account/${t}/balance`,params:{currency:"usd",chainId:e,forceUpdate:r,st:n,sv:s}});return de.updateBalanceCache({caipAddress:o,balance:c,timestamp:Date.now()}),c},async lookupEnsName(t){return await He.isNetworkSupported(q.state.activeCaipNetwork?.caipNetworkId)?He.get({path:`/v1/profile/account/${t}`,params:{apiVersion:"2"}}):{addresses:{},attributes:[]}},async reverseLookupEnsName({address:t}){if(!await He.isNetworkSupported(q.state.activeCaipNetwork?.caipNetworkId))return[];const r=q.getAccountData()?.address;return He.get({path:`/v1/profile/reverse/${t}`,params:{sender:r,apiVersion:"2"}})},async getEnsNameSuggestions(t){return await He.isNetworkSupported(q.state.activeCaipNetwork?.caipNetworkId)?He.get({path:`/v1/profile/suggestions/${t}`,params:{zone:"reown.id"}}):{suggestions:[]}},async registerEnsName({coinType:t,address:e,message:r,signature:n}){return await He.isNetworkSupported(q.state.activeCaipNetwork?.caipNetworkId)?jn.api.post({path:"/v1/profile/account",body:{coin_type:t,address:e,message:r,signature:n},headers:{"Content-Type":"application/json"}}):{success:!1}},async generateOnRampURL({destinationWallets:t,partnerUserId:e,defaultNetwork:r,purchaseAmount:n,paymentAmount:s}){return await He.isNetworkSupported(q.state.activeCaipNetwork?.caipNetworkId)?(await jn.api.post({path:"/v1/generators/onrampurl",params:{projectId:te.state.projectId},body:{destinationWallets:t,defaultNetwork:r,partnerUserId:e,defaultExperience:"buy",presetCryptoAmount:n,presetFiatAmount:s}})).url:""},async getOnrampOptions(){if(!await He.isNetworkSupported(q.state.activeCaipNetwork?.caipNetworkId))return{paymentCurrencies:[],purchaseCurrencies:[]};try{return await He.get({path:"/v1/onramp/options"})}catch{return pX}},async getOnrampQuote({purchaseCurrency:t,paymentCurrency:e,amount:r,network:n}){try{return await He.isNetworkSupported(q.state.activeCaipNetwork?.caipNetworkId)?await jn.api.post({path:"/v1/onramp/quote",params:{projectId:te.state.projectId},body:{purchaseCurrency:t,paymentCurrency:e,amount:r,network:n}}):null}catch{return{networkFee:{amount:r,currency:e.id},paymentSubtotal:{amount:r,currency:e.id},paymentTotal:{amount:r,currency:e.id},purchaseAmount:{amount:r,currency:e.id},quoteId:"mocked-quote-id"}}},async getSmartSessions(t){return await He.isNetworkSupported(q.state.activeCaipNetwork?.caipNetworkId)?He.get({path:`/v1/sessions/${t}`}):[]},async revokeSmartSession(t,e,r){return await He.isNetworkSupported(q.state.activeCaipNetwork?.caipNetworkId)?jn.api.post({path:`/v1/sessions/${t}/revoke`,params:{projectId:te.state.projectId},body:{pci:e,signature:r}}):{success:!1}},setClientId(t){jn.clientId=t,jn.api=new zh({baseUrl:MN,clientId:t})}},qs={PHANTOM:{id:"a797aa35c0fadbfc1a53e7f675162ed5226968b44a19ee3d24385c64d1d3c393",url:"https://phantom.app"},SOLFLARE:{id:"1ca0bdd4747578705b1939af023d120677c64fe6ca76add81fda36e350605e79",url:"https://solflare.com"},COINBASE:{id:"fd20dc426fb37566d803205b19bbc1d4096b248ac04548e3cfb6b3a38bd033aa",url:"https://go.cb-w.com"},BINANCE:{id:"2fafea35bb471d22889ccb49c08d99dd0a18a37982602c33f696a5723934ba25",appId:"yFK5FCqYprrXDiVFbhyRx7",deeplink:"bnc://app.binance.com/mp/app",url:"https://app.binance.com/en/download"}},gX={handleMobileDeeplinkRedirect(t,e){const r=window.location.href,n=encodeURIComponent(r);if(t===qs.PHANTOM.id&&!("phantom"in window)){const s=r.startsWith("https")?"https":"http",i=r.split("/")[2],o=encodeURIComponent(`${s}://${i}`);window.location.href=`${qs.PHANTOM.url}/ul/browse/${n}?ref=${o}`}if(t===qs.SOLFLARE.id&&!("solflare"in window)&&(window.location.href=`${qs.SOLFLARE.url}/ul/v1/browse/${n}?ref=${n}`),e===fe.CHAIN.SOLANA&&t===qs.COINBASE.id&&!("coinbaseSolana"in window)&&(window.location.href=`${qs.COINBASE.url}/dapp?cb_url=${n}`),e===fe.CHAIN.BITCOIN&&t===qs.BINANCE.id&&!("binancew3w"in window)){const s=q.state.activeCaipNetwork,i=window.btoa("/pages/browser/index"),o=window.btoa(`url=${n}&defaultChainId=${s?.id??1}`),a=new URL(qs.BINANCE.deeplink);a.searchParams.set("appId",qs.BINANCE.appId),a.searchParams.set("startPagePath",i),a.searchParams.set("startPageQuery",o);const c=new URL(qs.BINANCE.url);c.searchParams.set("_dp",window.btoa(a.toString())),window.location.href=c.toString()}}},yX=Object.freeze({enabled:!0,events:[]}),mX=new zh({baseUrl:Ne.getAnalyticsUrl(),clientId:null}),wX=5,bX=60*1e3,Yo=Xt({...yX}),vX={state:Yo,subscribeKey(t,e){return cn(Yo,t,e)},async sendError(t,e){if(!Yo.enabled)return;const r=Date.now();if(Yo.events.filter(i=>{const o=new Date(i.properties.timestamp||"").getTime();return r-o<bX}).length>=wX)return;const s={type:"error",event:e,properties:{errorType:t.name,errorMessage:t.message,stackTrace:t.stack,timestamp:new Date().toISOString()}};Yo.events.push(s);try{if(typeof window>"u")return;const{projectId:i,sdkType:o,sdkVersion:a}=te.state;await mX.post({path:"/e",params:{projectId:i,st:o,sv:a||"html-wagmi-4.2.2"},body:{eventId:Ne.getUUID(),url:window.location.href,domain:window.location.hostname,timestamp:new Date().toISOString(),props:{type:"error",event:e,errorType:t.name,errorMessage:t.message,stackTrace:t.stack}}})}catch{}},enable(){Yo.enabled=!0},disable(){Yo.enabled=!1},clearEvents(){Yo.events=[]}};class Bc extends Error{constructor(e,r,n){super(e),this.originalName="AppKitError",this.name="AppKitError",this.category=r,this.originalError=n,n&&n instanceof Error&&(this.originalName=n.name),Object.setPrototypeOf(this,Bc.prototype);let s=!1;if(n instanceof Error&&typeof n.stack=="string"&&n.stack){const i=n.stack,o=i.indexOf(`
`);if(o>-1){const a=i.substring(o+1);this.stack=`${this.name}: ${this.message}
${a}`,s=!0}}s||(Error.captureStackTrace?Error.captureStackTrace(this,Bc):this.stack||(this.stack=`${this.name}: ${this.message}`))}}function zx(t,e){let r="";try{t instanceof Error?r=t.message:typeof t=="string"?r=t:typeof t=="object"&&t!==null?Object.keys(t).length===0?r="Unknown error":r=t?.message||JSON.stringify(t):r=String(t)}catch(s){r="Unknown error",console.error("Error parsing error message",s)}const n=t instanceof Bc?t:new Bc(r,e,t);throw vX.sendError(n,n.category),n}function Js(t,e="INTERNAL_SDK_ERROR"){const r={};return Object.keys(t).forEach(n=>{const s=t[n];if(typeof s=="function"){let i=s;s.constructor.name==="AsyncFunction"?i=async(...o)=>{try{return await s(...o)}catch(a){return zx(a,e)}}:i=(...o)=>{try{return s(...o)}catch(a){return zx(a,e)}},r[n]=i}else r[n]=s}),r}const fs=Xt({walletImages:{},networkImages:{},chainImages:{},connectorImages:{},tokenImages:{},currencyImages:{}}),EX={state:fs,subscribeNetworkImages(t){return an(fs.networkImages,()=>t(fs.networkImages))},subscribeKey(t,e){return cn(fs,t,e)},subscribe(t){return an(fs,()=>t(fs))},setWalletImage(t,e){fs.walletImages[t]=e},setNetworkImage(t,e){fs.networkImages[t]=e},setChainImage(t,e){fs.chainImages[t]=e},setConnectorImage(t,e){fs.connectorImages={...fs.connectorImages,[t]:e}},setTokenImage(t,e){fs.tokenImages[t]=e},setCurrencyImage(t,e){fs.currencyImages[t]=e}},Gs=Js(EX),_X={eip155:"ba0ba0cd-17c6-4806-ad93-f9d174f17900",solana:"a1b58899-f671-4276-6a5e-56ca5bd59700",polkadot:"",bip122:"0b4838db-0161-4ffe-022d-532bf03dba00",cosmos:"",sui:"",stacks:""},ew=Xt({networkImagePromises:{}}),jN={async fetchWalletImage(t){if(t)return await Ue._fetchWalletImage(t),this.getWalletImageById(t)},async fetchNetworkImage(t){if(!t)return;const e=this.getNetworkImageById(t);return e||(ew.networkImagePromises[t]||(ew.networkImagePromises[t]=Ue._fetchNetworkImage(t)),await ew.networkImagePromises[t],this.getNetworkImageById(t))},getWalletImageById(t){if(t)return Gs.state.walletImages[t]},getWalletImage(t){if(t?.image_url)return t?.image_url;if(t?.image_id)return Gs.state.walletImages[t.image_id]},getNetworkImage(t){if(t?.assets?.imageUrl)return t?.assets?.imageUrl;if(t?.assets?.imageId)return Gs.state.networkImages[t.assets.imageId]},getNetworkImageById(t){if(t)return Gs.state.networkImages[t]},getConnectorImage(t){if(t?.imageUrl)return t.imageUrl;if(t?.info?.icon)return t.info.icon;if(t?.imageId)return Gs.state.connectorImages[t.imageId]},getChainImage(t){return Gs.state.networkImages[_X[t]]},getTokenImage(t){if(t)return Gs.state.tokenImages[t]}},xX=Ne.getAnalyticsUrl(),SX=new zh({baseUrl:xX,clientId:null}),AX=["MODAL_CREATED"],IX=45,Hx=1e3*10,cr=Xt({timestamp:Date.now(),lastFlush:Date.now(),reportedErrors:{},data:{type:"track",event:"MODAL_CREATED"},pendingEvents:[],subscribedToVisibilityChange:!1,walletImpressions:[]}),ct={state:cr,subscribe(t){return an(cr,()=>t(cr))},getSdkProperties(){const{projectId:t,sdkType:e,sdkVersion:r}=te.state;return{projectId:t,st:e,sv:r||"html-wagmi-4.2.2"}},shouldFlushEvents(){const t=JSON.stringify(cr.pendingEvents).length/1024>IX,e=cr.lastFlush+Hx<Date.now();return t||e},_setPendingEvent(t){try{let e=q.getAccountData()?.address;if("address"in t.data&&t.data.address&&(e=t.data.address),AX.includes(t.data.event)||typeof window>"u")return;const r=q.getActiveCaipNetwork()?.caipNetworkId;this.state.pendingEvents.push({eventId:Ne.getUUID(),url:window.location.href,domain:window.location.hostname,timestamp:t.timestamp,props:{...t.data,address:e,properties:{..."properties"in t.data?t.data.properties:{},caipNetworkId:r}}}),cr.reportedErrors.FORBIDDEN=!1,ct.shouldFlushEvents()&&ct._submitPendingEvents()}catch(e){console.warn("_setPendingEvent",e)}},sendEvent(t){cr.timestamp=Date.now(),cr.data=t;const e=["INITIALIZE","CONNECT_SUCCESS","SOCIAL_LOGIN_SUCCESS"];(te.state.features?.analytics||e.includes(t.event))&&ct._setPendingEvent(cr),this.subscribeToFlushTriggers()},sendWalletImpressionEvent(t){cr.walletImpressions.push(t)},_transformPendingEventsForBatch(t){try{return t.filter(e=>e.props.event!=="WALLET_IMPRESSION_V2")}catch{return t}},_submitPendingEvents(){if(cr.lastFlush=Date.now(),!(cr.pendingEvents.length===0&&cr.walletImpressions.length===0))try{const t=ct._transformPendingEventsForBatch(cr.pendingEvents);cr.walletImpressions.length&&t.push({eventId:Ne.getUUID(),url:window.location.href,domain:window.location.hostname,timestamp:Date.now(),props:{type:"track",event:"WALLET_IMPRESSION_V2",items:[...cr.walletImpressions]}}),SX.sendBeacon({path:"/batch",params:ct.getSdkProperties(),body:t}),cr.reportedErrors.FORBIDDEN=!1,cr.pendingEvents=[],cr.walletImpressions=[]}catch{cr.reportedErrors.FORBIDDEN=!0}},subscribeToFlushTriggers(){cr.subscribedToVisibilityChange||typeof document>"u"||(cr.subscribedToVisibilityChange=!0,document?.addEventListener?.("visibilitychange",()=>{document.visibilityState==="hidden"&&ct._submitPendingEvents()}),document?.addEventListener?.("freeze",()=>{ct._submitPendingEvents()}),window?.addEventListener?.("pagehide",()=>{ct._submitPendingEvents()}),setInterval(()=>{ct._submitPendingEvents()},Hx))}},CX=Ne.getApiUrl(),Nn=new zh({baseUrl:CX,clientId:null}),$X=40,Wx=4,TX=20,Xe=Xt({promises:{},page:1,count:0,featured:[],allFeatured:[],recommended:[],allRecommended:[],wallets:[],filteredWallets:[],search:[],isAnalyticsEnabled:!1,excludedWallets:[],isFetchingRecommendedWallets:!1,explorerWallets:[],explorerFilteredWallets:[],plan:{tier:"none",hasExceededUsageLimit:!1,limits:{isAboveRpcLimit:!1,isAboveMauLimit:!1}}}),Ue={state:Xe,subscribeKey(t,e){return cn(Xe,t,e)},_getSdkProperties(){const{projectId:t,sdkType:e,sdkVersion:r}=te.state;return{projectId:t,st:e||"appkit",sv:r||"html-wagmi-4.2.2"}},_filterOutExtensions(t){return te.state.isUniversalProvider?t.filter(e=>!!(e.mobile_link||e.desktop_link||e.webapp_link)):t},async _fetchWalletImage(t){const e=`${Nn.baseUrl}/getWalletImage/${t}`,r=await Nn.getBlob({path:e,params:Ue._getSdkProperties()});Gs.setWalletImage(t,URL.createObjectURL(r))},async _fetchNetworkImage(t){const e=`${Nn.baseUrl}/public/getAssetImage/${t}`,r=await Nn.getBlob({path:e,params:Ue._getSdkProperties()});Gs.setNetworkImage(t,URL.createObjectURL(r))},async _fetchConnectorImage(t){const e=`${Nn.baseUrl}/public/getAssetImage/${t}`,r=await Nn.getBlob({path:e,params:Ue._getSdkProperties()});Gs.setConnectorImage(t,URL.createObjectURL(r))},async _fetchCurrencyImage(t){const e=`${Nn.baseUrl}/public/getCurrencyImage/${t}`,r=await Nn.getBlob({path:e,params:Ue._getSdkProperties()});Gs.setCurrencyImage(t,URL.createObjectURL(r))},async _fetchTokenImage(t){const e=`${Nn.baseUrl}/public/getTokenImage/${t}`,r=await Nn.getBlob({path:e,params:Ue._getSdkProperties()});Gs.setTokenImage(t,URL.createObjectURL(r))},_filterWalletsByPlatform(t){const e=t.length,r=Ne.isMobile()?t?.filter(s=>s.mobile_link||s.webapp_link?!0:Object.values(qs).map(o=>o.id).includes(s.id)):t,n=e-r.length;return{filteredWallets:r,mobileFilteredOutWalletsLength:n}},async fetchProjectConfig(){return(await Nn.get({path:"/appkit/v1/config",params:Ue._getSdkProperties()})).features},async fetchUsage(){try{const t=await Nn.get({path:"/appkit/v1/project-limits",params:Ue._getSdkProperties()}),{tier:e,isAboveMauLimit:r,isAboveRpcLimit:n}=t.planLimits,s=e==="starter",i=r||n;Ue.state.plan={tier:e,hasExceededUsageLimit:s&&i,limits:{isAboveRpcLimit:n,isAboveMauLimit:r}}}catch(t){console.warn("Failed to fetch usage",t)}},async fetchAllowedOrigins(){try{const{allowedOrigins:t}=await Nn.get({path:"/projects/v1/origins",params:Ue._getSdkProperties()});return t}catch(t){if(t instanceof Error&&t.cause instanceof Response){const e=t.cause.status;if(e===fe.HTTP_STATUS_CODES.TOO_MANY_REQUESTS)throw new Error("RATE_LIMITED",{cause:t});if(e>=fe.HTTP_STATUS_CODES.SERVER_ERROR&&e<600)throw new Error("SERVER_ERROR",{cause:t});return[]}return[]}},async fetchNetworkImages(){const e=q.getAllRequestedCaipNetworks()?.map(({assets:r})=>r?.imageId).filter(Boolean).filter(r=>!jN.getNetworkImageById(r));e&&await Promise.allSettled(e.map(r=>Ue._fetchNetworkImage(r)))},async fetchConnectorImages(){const{connectors:t}=ge.state,e=t.map(({imageId:r})=>r).filter(Boolean);await Promise.allSettled(e.map(r=>Ue._fetchConnectorImage(r)))},async fetchCurrencyImages(t=[]){await Promise.allSettled(t.map(e=>Ue._fetchCurrencyImage(e)))},async fetchTokenImages(t=[]){await Promise.allSettled(t.map(e=>Ue._fetchTokenImage(e)))},async fetchWallets(t){const e=t.exclude??[];Ue._getSdkProperties().sv.startsWith("html-core-")&&e.push(...Object.values(qs).map(o=>o.id));const n=await Nn.get({path:"/getWallets",params:{...Ue._getSdkProperties(),...t,page:String(t.page),entries:String(t.entries),include:t.include?.join(","),exclude:e.join(",")}}),{filteredWallets:s,mobileFilteredOutWalletsLength:i}=Ue._filterWalletsByPlatform(n?.data);return{data:s||[],count:n?.count,mobileFilteredOutWalletsLength:i}},async prefetchWalletRanks(){const t=ge.state.connectors;if(!t?.length)return;const e={page:1,entries:20,badge:"certified"};if(e.names=t.map(s=>s.name).join(","),q.state.activeChain===fe.CHAIN.EVM){const s=[...t.flatMap(i=>i.connectors?.map(o=>o.info?.rdns)||[]),...t.map(i=>i.info?.rdns)].filter(i=>typeof i=="string"&&i.length>0);s.length&&(e.rdns=s.join(","))}const{data:r}=await Ue.fetchWallets(e);Xe.explorerWallets=r;const n=q.getRequestedCaipNetworkIds().join(",");Xe.explorerFilteredWallets=r.filter(s=>s.chains?.some(i=>n.includes(i)))},async fetchFeaturedWallets(){const{featuredWalletIds:t}=te.state;if(t?.length){const e={...Ue._getSdkProperties(),page:1,entries:t?.length??Wx,include:t},{data:r}=await Ue.fetchWallets(e),n=[...r].sort((i,o)=>t.indexOf(i.id)-t.indexOf(o.id)),s=n.map(i=>i.image_id).filter(Boolean);await Promise.allSettled(s.map(i=>Ue._fetchWalletImage(i))),Xe.featured=n,Xe.allFeatured=n}},async fetchRecommendedWallets(){try{Xe.isFetchingRecommendedWallets=!0;const{includeWalletIds:t,excludeWalletIds:e,featuredWalletIds:r}=te.state,n=[...e??[],...r??[]].filter(Boolean),s=q.getRequestedCaipNetworkIds().join(","),i={page:1,entries:Wx,include:t,exclude:n,chains:s},{data:o,count:a}=await Ue.fetchWallets(i),c=de.getRecentWallets(),l=o.map(d=>d.image_id).filter(Boolean),u=c.map(d=>d.image_id).filter(Boolean);await Promise.allSettled([...l,...u].map(d=>Ue._fetchWalletImage(d))),Xe.recommended=o,Xe.allRecommended=o,Xe.count=a??0}catch{}finally{Xe.isFetchingRecommendedWallets=!1}},async fetchWalletsByPage({page:t}){const{includeWalletIds:e,excludeWalletIds:r,featuredWalletIds:n}=te.state,s=q.getRequestedCaipNetworkIds().join(","),i=[...Xe.recommended.map(({id:d})=>d),...r??[],...n??[]].filter(Boolean),o={page:t,entries:$X,include:e,exclude:i,chains:s},{data:a,count:c,mobileFilteredOutWalletsLength:l}=await Ue.fetchWallets(o);Xe.mobileFilteredOutWalletsLength=l+(Xe.mobileFilteredOutWalletsLength??0);const u=a.slice(0,TX).map(d=>d.image_id).filter(Boolean);await Promise.allSettled(u.map(d=>Ue._fetchWalletImage(d))),Xe.wallets=Ne.uniqueBy([...Xe.wallets,...Ue._filterOutExtensions(a)],"id").filter(d=>d.chains?.some(h=>s.includes(h))),Xe.count=c>Xe.count?c:Xe.count,Xe.page=t},async initializeExcludedWallets({ids:t}){const e={page:1,entries:t.length,include:t},{data:r}=await Ue.fetchWallets(e);r&&r.forEach(n=>{Xe.excludedWallets.push({rdns:n.rdns,name:n.name})})},async searchWallet({search:t,badge:e}){const{includeWalletIds:r,excludeWalletIds:n}=te.state,s=q.getRequestedCaipNetworkIds().join(",");Xe.search=[];const i={page:1,entries:100,search:t?.trim(),badge_type:e,include:r,exclude:n,chains:s},{data:o}=await Ue.fetchWallets(i);ct.sendEvent({type:"track",event:"SEARCH_WALLET",properties:{badge:e??"",search:t??""}});const a=o.map(c=>c.image_id).filter(Boolean);await Promise.allSettled([...a.map(c=>Ue._fetchWalletImage(c)),Ne.wait(300)]),Xe.search=Ue._filterOutExtensions(o)},initPromise(t,e){const r=Xe.promises[t];return r||(Xe.promises[t]=e())},prefetch({fetchConnectorImages:t=!0,fetchFeaturedWallets:e=!0,fetchRecommendedWallets:r=!0,fetchNetworkImages:n=!0,fetchWalletRanks:s=!0}={}){const i=[t&&Ue.initPromise("connectorImages",Ue.fetchConnectorImages),e&&Ue.initPromise("featuredWallets",Ue.fetchFeaturedWallets),r&&Ue.initPromise("recommendedWallets",Ue.fetchRecommendedWallets),n&&Ue.initPromise("networkImages",Ue.fetchNetworkImages),s&&Ue.initPromise("walletRanks",Ue.prefetchWalletRanks)].filter(Boolean);return Promise.allSettled(i)},prefetchAnalyticsConfig(){te.state.features?.analytics&&Ue.fetchAnalyticsConfig()},async fetchAnalyticsConfig(){try{const{isAnalyticsEnabled:t}=await Nn.get({path:"/getAnalyticsConfig",params:Ue._getSdkProperties()});te.setFeatures({analytics:t})}catch{te.setFeatures({analytics:!1})}},filterByNamespaces(t){if(!t?.length){Xe.featured=Xe.allFeatured,Xe.recommended=Xe.allRecommended;return}const e=q.getRequestedCaipNetworkIds().join(",");Xe.featured=Xe.allFeatured.filter(r=>r.chains?.some(n=>e.includes(n))),Xe.recommended=Xe.allRecommended.filter(r=>r.chains?.some(n=>e.includes(n))),Xe.filteredWallets=Xe.wallets.filter(r=>r.chains?.some(n=>e.includes(n)))},clearFilterByNamespaces(){Xe.filteredWallets=[]},setFilterByNamespace(t){if(!t){Xe.featured=Xe.allFeatured,Xe.recommended=Xe.allRecommended;return}const e=q.getRequestedCaipNetworkIds().join(",");Xe.featured=Xe.allFeatured.filter(r=>r.chains?.some(n=>e.includes(n))),Xe.recommended=Xe.allRecommended.filter(r=>r.chains?.some(n=>e.includes(n))),Xe.filteredWallets=Xe.wallets.filter(r=>r.chains?.some(n=>e.includes(n)))}},NX=["ConnectingExternal","ConnectingMultiChain","ConnectingSocial","ConnectingFarcaster"],Ot=Xt({view:"Connect",history:["Connect"],transactionStack:[]}),OX={state:Ot,subscribeKey(t,e){return cn(Ot,t,e)},pushTransactionStack(t){Ot.transactionStack.push(t)},popTransactionStack(t){const e=Ot.transactionStack.pop();if(!e)return;const{onSuccess:r,onError:n,onCancel:s}=e;switch(t){case"success":r?.();break;case"error":n?.(),qe.goBack();break;case"cancel":s?.(),qe.goBack();break}},push(t,e){let r=t,n=e;Ue.state.plan.hasExceededUsageLimit&&NX.includes(t)&&(r="UsageExceeded",n=void 0),r!==Ot.view&&(Ot.view=r,Ot.history.push(r),Ot.data=n)},reset(t,e){Ot.view=t,Ot.history=[t],Ot.data=e},replace(t,e){Ot.history.at(-1)===t||(Ot.view=t,Ot.history[Ot.history.length-1]=t,Ot.data=e)},goBack(){const t=q.state.activeCaipAddress,e=qe.state.view==="ConnectingFarcaster",r=!t&&e;if(Ot.history.length>1){Ot.history.pop();const[n]=Ot.history.slice(-1);n&&(t&&n==="Connect"?Ot.view="Account":Ot.view=n)}else lt.close();Ot.data?.wallet&&(Ot.data.wallet=void 0),Ot.data?.redirectView&&(Ot.data.redirectView=void 0),setTimeout(()=>{if(r){q.setAccountProp("farcasterUrl",void 0,q.state.activeChain);const n=ge.getAuthConnector();n?.provider?.reload();const s=Wd(te.state);n?.provider?.syncDappData?.({metadata:s.metadata,sdkVersion:s.sdkVersion,projectId:s.projectId,sdkType:s.sdkType})}},100)},goBackToIndex(t){if(Ot.history.length>1){Ot.history=Ot.history.slice(0,t+1);const[e]=Ot.history.slice(-1);e&&(Ot.view=e)}},goBackOrCloseModal(){qe.state.history.length>1?qe.goBack():lt.close()}},qe=Js(OX),ro=Xt({themeMode:"dark",themeVariables:{},w3mThemeVariables:void 0}),cb={state:ro,subscribe(t){return an(ro,()=>t(ro))},setThemeMode(t){ro.themeMode=t;try{const e=ge.getAuthConnector();if(e){const r=cb.getSnapshot().themeVariables;e.provider.syncTheme({themeMode:t,themeVariables:r,w3mThemeVariables:sg(r,t)})}}catch{console.info("Unable to sync theme to auth connector")}},setThemeVariables(t){ro.themeVariables={...ro.themeVariables,...t};try{const e=ge.getAuthConnector();if(e){const r=cb.getSnapshot().themeVariables;e.provider.syncTheme({themeVariables:r,w3mThemeVariables:sg(ro.themeVariables,ro.themeMode)})}}catch{console.info("Unable to sync theme to auth connector")}},getSnapshot(){return Wd(ro)}},ws=Js(cb),FN=Object.fromEntries(SN.map(t=>[t,void 0])),kX=Object.fromEntries(SN.map(t=>[t,!0])),At=Xt({allConnectors:[],connectors:[],activeConnector:void 0,filterByNamespace:void 0,activeConnectorIds:FN,filterByNamespaceMap:kX}),PX={state:At,subscribe(t){return an(At,()=>{t(At)})},subscribeKey(t,e){return cn(At,t,e)},initialize(t){t.forEach(e=>{const r=de.getConnectedConnectorId(e);r&&ge.setConnectorId(r,e)})},setActiveConnector(t){t&&(At.activeConnector=Vd(t))},setConnectors(t){t.filter(s=>!At.allConnectors.some(i=>i.id===s.id&&ge.getConnectorName(i.name)===ge.getConnectorName(s.name)&&i.chain===s.chain)).forEach(s=>{s.type!=="MULTI_CHAIN"&&At.allConnectors.push(Vd(s))});const r=ge.getEnabledNamespaces(),n=ge.getEnabledConnectors(r);At.connectors=ge.mergeMultiChainConnectors(n)},filterByNamespaces(t){Object.keys(At.filterByNamespaceMap).forEach(e=>{At.filterByNamespaceMap[e]=!1}),t.forEach(e=>{At.filterByNamespaceMap[e]=!0}),ge.updateConnectorsForEnabledNamespaces()},filterByNamespace(t,e){At.filterByNamespaceMap[t]=e,ge.updateConnectorsForEnabledNamespaces()},updateConnectorsForEnabledNamespaces(){const t=ge.getEnabledNamespaces(),e=ge.getEnabledConnectors(t),r=ge.areAllNamespacesEnabled();At.connectors=ge.mergeMultiChainConnectors(e),r?Ue.clearFilterByNamespaces():Ue.filterByNamespaces(t)},getEnabledNamespaces(){return Object.entries(At.filterByNamespaceMap).filter(([t,e])=>e).map(([t])=>t)},getEnabledConnectors(t){return At.allConnectors.filter(e=>t.includes(e.chain))},areAllNamespacesEnabled(){return Object.values(At.filterByNamespaceMap).every(t=>t)},mergeMultiChainConnectors(t){const e=ge.generateConnectorMapByName(t),r=[];return e.forEach(n=>{const s=n[0],i=s?.id===fe.CONNECTOR_ID.AUTH;n.length>1&&s?r.push({name:s.name,imageUrl:s.imageUrl,imageId:s.imageId,connectors:[...n],type:i?"AUTH":"MULTI_CHAIN",chain:"eip155",id:s?.id||""}):s&&r.push(s)}),r},generateConnectorMapByName(t){const e=new Map;return t.forEach(r=>{const{name:n}=r,s=ge.getConnectorName(n);if(!s)return;const i=e.get(s)||[];i.find(a=>a.chain===r.chain)||i.push(r),e.set(s,i)}),e},getConnectorName(t){return t&&({"Trust Wallet":"Trust"}[t]||t)},getUniqueConnectorsByName(t){const e=[];return t.forEach(r=>{e.find(n=>n.chain===r.chain)||e.push(r)}),e},addConnector(t){if(t.id===fe.CONNECTOR_ID.AUTH){const e=t,r=Wd(te.state),n=ws.getSnapshot().themeMode,s=ws.getSnapshot().themeVariables;e?.provider?.syncDappData?.({metadata:r.metadata,sdkVersion:r.sdkVersion,projectId:r.projectId,sdkType:r.sdkType}),e?.provider?.syncTheme({themeMode:n,themeVariables:s,w3mThemeVariables:sg(s,n)}),ge.setConnectors([t])}else ge.setConnectors([t])},getAuthConnector(t){const e=t||q.state.activeChain,r=At.connectors.find(n=>n.id===fe.CONNECTOR_ID.AUTH);if(r)return r?.connectors?.length?r.connectors.find(s=>s.chain===e):r},getAnnouncedConnectorRdns(){return At.connectors.filter(t=>t.type==="ANNOUNCED").map(t=>t.info?.rdns)},getConnectorById(t){return At.allConnectors.find(e=>e.id===t)},getConnector({id:t,rdns:e,namespace:r}){const n=r||q.state.activeChain;return At.allConnectors.filter(i=>i.chain===n).find(i=>i.explorerId===t||i.info?.rdns===e)},syncIfAuthConnector(t){if(t.id!=="AUTH")return;const e=t,r=Wd(te.state),n=ws.getSnapshot().themeMode,s=ws.getSnapshot().themeVariables;e?.provider?.syncDappData?.({metadata:r.metadata,sdkVersion:r.sdkVersion,sdkType:r.sdkType,projectId:r.projectId}),e.provider.syncTheme({themeMode:n,themeVariables:s,w3mThemeVariables:sg(s,n)})},getConnectorsByNamespace(t){const e=At.allConnectors.filter(r=>r.chain===t);return ge.mergeMultiChainConnectors(e)},canSwitchToSmartAccount(t){return q.checkIfSmartAccountEnabled()&&Ys(t)===xo.ACCOUNT_TYPES.EOA},selectWalletConnector(t){const e=qe.state.data?.redirectView,r=ge.getConnector({id:t.id,rdns:t.rdns});gX.handleMobileDeeplinkRedirect(r?.explorerId||t.id,q.state.activeChain),r?qe.push("ConnectingExternal",{connector:r,wallet:t,redirectView:e}):qe.push("ConnectingWalletConnect",{wallet:t,redirectView:e})},getConnectors(t){return t?ge.getConnectorsByNamespace(t):ge.mergeMultiChainConnectors(At.allConnectors)},setFilterByNamespace(t){At.filterByNamespace=t,At.connectors=ge.getConnectors(t),Ue.setFilterByNamespace(t)},setConnectorId(t,e){t&&(At.activeConnectorIds={...At.activeConnectorIds,[e]:t},de.setConnectedConnectorId(e,t))},removeConnectorId(t){At.activeConnectorIds={...At.activeConnectorIds,[t]:void 0},de.deleteConnectedConnectorId(t)},getConnectorId(t){if(t)return At.activeConnectorIds[t]},isConnected(t){return t?!!At.activeConnectorIds[t]:Object.values(At.activeConnectorIds).some(e=>!!e)},resetConnectorIds(){At.activeConnectorIds={...FN}}},ge=Js(PX),RX=1e3,Wu={checkNamespaceConnectorId(t,e){return ge.getConnectorId(t)===e},isSocialProvider(t){return mt.DEFAULT_REMOTE_FEATURES.socials.includes(t)},connectWalletConnect({walletConnect:t,connector:e,closeModalOnConnect:r=!0,redirectViewOnModalClose:n="Connect",onOpen:s,onConnect:i}){return new Promise((o,a)=>{if(t&&ge.setActiveConnector(e),s?.(Ne.isMobile()&&t),n){const l=lt.subscribeKey("open",u=>{u||(qe.state.view!==n&&qe.replace(n),l(),a(new Error("Modal closed")))})}const c=q.subscribeKey("activeCaipAddress",l=>{l&&(i?.(),r&&lt.close(),c(),o(sn.parseCaipAddress(l)))})})},connectExternal(t){return new Promise((e,r)=>{const n=q.subscribeKey("activeCaipAddress",s=>{s&&(lt.close(),n(),e(sn.parseCaipAddress(s)))});Ee.connectExternal(t,t.chain).catch(()=>{n(),r(new Error("Connection rejected"))})})},connectSocial({social:t,namespace:e,closeModalOnConnect:r=!0,onOpenFarcaster:n,onConnect:s}){let i,o=!1,a=null;const c=e||q.state.activeChain,l=q.subscribeKey("activeCaipAddress",u=>{u&&(r&&lt.close(),l())});return new Promise((u,d)=>{async function h(y){if(y.data?.resultUri)if(y.origin===fe.SECURE_SITE_SDK_ORIGIN){window.removeEventListener("message",h,!1);try{const g=ge.getAuthConnector(c);if(g&&!o){i&&i.close(),o=!0;const w=y.data.resultUri;ct.sendEvent({type:"track",event:"SOCIAL_LOGIN_REQUEST_USER_DATA",properties:{provider:t}}),de.setConnectedSocialProvider(t),await Ee.connectExternal({id:g.id,type:g.type,socialUri:w},g.chain);const S=q.state.activeCaipAddress;if(!S){d(new Error("Failed to connect"));return}u(sn.parseCaipAddress(S)),ct.sendEvent({type:"track",event:"SOCIAL_LOGIN_SUCCESS",properties:{provider:t}})}}catch(g){ct.sendEvent({type:"track",event:"SOCIAL_LOGIN_ERROR",properties:{provider:t,message:Ne.parseError(g)}}),d(new Error("Failed to connect"))}}else ct.sendEvent({type:"track",event:"SOCIAL_LOGIN_ERROR",properties:{provider:t,message:"Untrusted Origin"}})}async function p(){if(ct.sendEvent({type:"track",event:"SOCIAL_LOGIN_STARTED",properties:{provider:t}}),t==="farcaster"){n?.();const y=lt.subscribeKey("open",w=>{!w&&t==="farcaster"&&(d(new Error("Popup closed")),s?.(),y())}),g=ge.getAuthConnector();if(g&&!q.getAccountData(c)?.farcasterUrl)try{const{url:S}=await g.provider.getFarcasterUri();q.setAccountProp("farcasterUrl",S,c)}catch{d(new Error("Failed to connect to farcaster"))}}else{const y=ge.getAuthConnector();a=Ne.returnOpenHref(`${fe.SECURE_SITE_SDK_ORIGIN}/loading`,"popupWindow","width=600,height=800,scrollbars=yes");try{if(y){const{uri:g}=await y.provider.getSocialRedirectUri({provider:t});if(a&&g){a.location.href=g,i=a;const w=setInterval(()=>{i?.closed&&!o&&(d(new Error("Popup closed")),clearInterval(w))},1e3);window.addEventListener("message",h,!1)}else a?.close(),d(new Error("Failed to initiate social connection"))}}catch{d(new Error("Failed to initiate social connection")),a?.close()}}}p()})},connectEmail({closeModalOnConnect:t=!0,redirectViewOnModalClose:e="Connect",onOpen:r,onConnect:n}){return new Promise((s,i)=>{if(r?.(),e){const a=lt.subscribeKey("open",c=>{c||(qe.state.view!==e&&qe.replace(e),a(),i(new Error("Modal closed")))})}const o=q.subscribeKey("activeCaipAddress",a=>{a&&(n?.(),t&&lt.close(),o(),s(sn.parseCaipAddress(a)))})})},async updateEmail(){const t=de.getConnectedConnectorId(q.state.activeChain),e=ge.getAuthConnector();if(!e)throw new Error("No auth connector found");if(t!==fe.CONNECTOR_ID.AUTH)throw new Error("Not connected to email or social");const r=e.provider.getEmail()??"";return await lt.open({view:"UpdateEmailWallet",data:{email:r,redirectView:void 0}}),new Promise((n,s)=>{const i=setInterval(()=>{const a=e.provider.getEmail()??"";a!==r&&(lt.close(),clearInterval(i),o(),n({email:a}))},RX),o=lt.subscribeKey("open",a=>{a||(qe.state.view!=="Connect"&&qe.push("Connect"),clearInterval(i),o(),s(new Error("Modal closed")))})})},canSwitchToSmartAccount(t){return q.checkIfSmartAccountEnabled()&&Ys(t)===xo.ACCOUNT_TYPES.EOA}};function qN(){const t=q.state.activeCaipNetwork?.chainNamespace||"eip155",e=q.state.activeCaipNetwork?.id||1,r=mt.NATIVE_TOKEN_ADDRESS[t];return`${t}:${e}:${r}`}function Ys(t){return q.getAccountData(t)?.preferredAccountType}function Pf(t){return q.state.activeCaipNetwork}const ag={getConnectionStatus(t,e){const r=ge.state.activeConnectorIds[e],n=Ee.getConnections(e);return!!r&&t.connectorId===r?"connected":n.some(o=>o.connectorId.toLowerCase()===t.connectorId.toLowerCase())?"active":"disconnected"},excludeConnectorAddressFromConnections({connections:t,connectorId:e,addresses:r}){return t.map(n=>{if((e?n.connectorId.toLowerCase()===e.toLowerCase():!1)&&r){const i=n.accounts.filter(o=>!r.some(c=>c.toLowerCase()===o.address.toLowerCase()));return{...n,accounts:i}}return n})},excludeExistingConnections(t,e){const r=new Set(t);return e.filter(n=>!r.has(n.connectorId))},getConnectionsByConnectorId(t,e){return t.filter(r=>r.connectorId.toLowerCase()===e.toLowerCase())},getConnectionsData(t){const e=!!te.state.remoteFeatures?.multiWallet,r=ge.state.activeConnectorIds[t],n=Ee.getConnections(t),i=(Ee.state.recentConnections.get(t)??[]).filter(a=>ge.getConnectorById(a.connectorId)),o=ag.excludeExistingConnections([...n.map(a=>a.connectorId),...r?[r]:[]],i);return e?{connections:n,recentConnections:o}:{connections:n.filter(a=>a.connectorId.toLowerCase()===r?.toLowerCase()),recentConnections:[]}}},Jt=Xt({transactions:[],transactionsByYear:{},lastNetworkInView:void 0,loading:!1,empty:!1,next:void 0}),DX={state:Jt,subscribe(t){return an(Jt,()=>t(Jt))},setLastNetworkInView(t){Jt.lastNetworkInView=t},async fetchTransactions(t){if(!t)throw new Error("Transactions can't be fetched without an accountAddress");Jt.loading=!0;try{const e=await He.fetchTransactions({account:t,cursor:Jt.next,chainId:q.state.activeCaipNetwork?.caipNetworkId}),r=yp.filterSpamTransactions(e.data),n=yp.filterByConnectedChain(r),s=[...Jt.transactions,...n];Jt.loading=!1,Jt.transactions=s,Jt.transactionsByYear=yp.groupTransactionsByYearAndMonth(Jt.transactionsByYear,n),Jt.empty=s.length===0,Jt.next=e.next?e.next:void 0}catch{const r=q.state.activeChain;ct.sendEvent({type:"track",event:"ERROR_FETCH_TRANSACTIONS",properties:{address:t,projectId:te.state.projectId,cursor:Jt.next,isSmartAccount:Ys(r)===xo.ACCOUNT_TYPES.SMART_ACCOUNT}}),Li.showError("Failed to fetch transactions"),Jt.loading=!1,Jt.empty=!0,Jt.next=void 0}},groupTransactionsByYearAndMonth(t={},e=[]){const r=t;return e.forEach(n=>{const s=new Date(n.metadata.minedAt).getFullYear(),i=new Date(n.metadata.minedAt).getMonth(),o=r[s]??{},c=(o[i]??[]).filter(l=>l.id!==n.id);r[s]={...o,[i]:[...c,n].sort((l,u)=>new Date(u.metadata.minedAt).getTime()-new Date(l.metadata.minedAt).getTime())}}),r},filterSpamTransactions(t){return t.filter(e=>!e.transfers.every(n=>n.nft_info?.flags.is_spam===!0))},filterByConnectedChain(t){const e=q.state.activeCaipNetwork?.caipNetworkId;return t.filter(n=>n.metadata.chain===e)},clearCursor(){Jt.next=void 0},resetTransactions(){Jt.transactions=[],Jt.transactionsByYear={},Jt.lastNetworkInView=void 0,Jt.loading=!1,Jt.empty=!1,Jt.next=void 0}},yp=Js(DX,"API_ERROR"),It=Xt({connections:new Map,recentConnections:new Map,isSwitchingConnection:!1,wcError:!1,buffering:!1,status:"disconnected"});let Ga;const UX={state:It,subscribe(t){return an(It,()=>t(It))},subscribeKey(t,e){return cn(It,t,e)},_getClient(){return It._client},setClient(t){It._client=Vd(t)},initialize(t){const e=t.filter(r=>!!r.namespace).map(r=>r.namespace);Ee.syncStorageConnections(e)},syncStorageConnections(t){const e=de.getConnections(),r=t??Array.from(q.state.chains.keys());for(const n of r){const s=e[n]??[],i=new Map(It.recentConnections);i.set(n,s),It.recentConnections=i}},getConnections(t){return t?It.connections.get(t)??[]:[]},hasAnyConnection(t){const e=Ee.state.connections;return Array.from(e.values()).flatMap(r=>r).some(({connectorId:r})=>r===t)},async connectWalletConnect({cache:t="auto"}={}){const e=Ne.isTelegram()||Ne.isSafari()&&Ne.isIos();if(t==="always"||t==="auto"&&e){if(Ga){await Ga,Ga=void 0;return}if(!Ne.isPairingExpired(It?.wcPairingExpiry)){const r=It.wcUri;It.wcUri=r;return}Ga=Ee._getClient()?.connectWalletConnect?.().catch(()=>{}),Ee.state.status="connecting",await Ga,Ga=void 0,It.wcPairingExpiry=void 0,Ee.state.status="connected"}else await Ee._getClient()?.connectWalletConnect?.()},async connectExternal(t,e,r=!0){const n=await Ee._getClient()?.connectExternal?.(t);return r&&q.setActiveNamespace(e),n},async reconnectExternal(t){await Ee._getClient()?.reconnectExternal?.(t);const e=t.chain||q.state.activeChain;e&&ge.setConnectorId(t.id,e)},async setPreferredAccountType(t,e){if(!e)return;lt.setLoading(!0,q.state.activeChain);const r=ge.getAuthConnector();r&&(q.setAccountProp("preferredAccountType",t,e),await r.provider.setPreferredAccount(t),de.setPreferredAccountTypes(Object.entries(q.state.chains).reduce((n,[s,i])=>{const o=s,a=Ys(o);return a!==void 0&&(n[o]=a),n},{})),await Ee.reconnectExternal(r),lt.setLoading(!1,q.state.activeChain),ct.sendEvent({type:"track",event:"SET_PREFERRED_ACCOUNT_TYPE",properties:{accountType:t,network:q.state.activeCaipNetwork?.caipNetworkId||""}}))},async signMessage(t){return Ee._getClient()?.signMessage(t)},parseUnits(t,e){return Ee._getClient()?.parseUnits(t,e)},formatUnits(t,e){return Ee._getClient()?.formatUnits(t,e)},updateBalance(t){return Ee._getClient()?.updateBalance(t)},async sendTransaction(t){return Ee._getClient()?.sendTransaction(t)},async getCapabilities(t){return Ee._getClient()?.getCapabilities(t)},async grantPermissions(t){return Ee._getClient()?.grantPermissions(t)},async walletGetAssets(t){return Ee._getClient()?.walletGetAssets(t)??{}},async estimateGas(t){return Ee._getClient()?.estimateGas(t)},async writeContract(t){return Ee._getClient()?.writeContract(t)},async getEnsAddress(t){return Ee._getClient()?.getEnsAddress(t)},async getEnsAvatar(t){return Ee._getClient()?.getEnsAvatar(t)},checkInstalled(t){return Ee._getClient()?.checkInstalled?.(t)||!1},resetWcConnection(){It.wcUri=void 0,It.wcPairingExpiry=void 0,It.wcLinking=void 0,It.recentWallet=void 0,It.status="disconnected",yp.resetTransactions(),de.deleteWalletConnectDeepLink(),de.deleteRecentWallet()},resetUri(){It.wcUri=void 0,It.wcPairingExpiry=void 0,Ga=void 0},finalizeWcConnection(t){const{wcLinking:e,recentWallet:r}=Ee.state;e&&de.setWalletConnectDeepLink(e),r&&de.setAppKitRecent(r),t&&ct.sendEvent({type:"track",event:"CONNECT_SUCCESS",address:t,properties:{method:e?"mobile":"qrcode",name:qe.state.data?.wallet?.name||"Unknown",view:qe.state.view,walletRank:r?.order}})},setWcBasic(t){It.wcBasic=t},setUri(t){It.wcUri=t,It.wcPairingExpiry=Ne.getPairingExpiry()},setWcLinking(t){It.wcLinking=t},setWcError(t){It.wcError=t,It.buffering=!1},setRecentWallet(t){It.recentWallet=t},setBuffering(t){It.buffering=t},setStatus(t){It.status=t},setIsSwitchingConnection(t){It.isSwitchingConnection=t},async disconnect({id:t,namespace:e,initialDisconnect:r}={}){try{await Ee._getClient()?.disconnect({id:t,chainNamespace:e,initialDisconnect:r})}catch(n){throw new Bc("Failed to disconnect","INTERNAL_SDK_ERROR",n)}},async disconnectConnector({id:t,namespace:e}){try{await Ee._getClient()?.disconnectConnector({id:t,namespace:e})}catch(r){throw new Bc("Failed to disconnect connector","INTERNAL_SDK_ERROR",r)}},setConnections(t,e){const r=new Map(It.connections);r.set(e,t),It.connections=r},async handleAuthAccountSwitch({address:t,namespace:e}){const n=q.getAccountData(e)?.user?.accounts?.find(i=>i.type==="smartAccount"),s=n&&n.address.toLowerCase()===t.toLowerCase()&&Wu.canSwitchToSmartAccount(e)?"smartAccount":"eoa";await Ee.setPreferredAccountType(s,e)},async handleActiveConnection({connection:t,namespace:e,address:r}){const n=ge.getConnectorById(t.connectorId),s=t.connectorId===fe.CONNECTOR_ID.AUTH;if(!n)throw new Error(`No connector found for connection: ${t.connectorId}`);if(s)r&&await Ee.handleAuthAccountSwitch({address:r,namespace:e});else return(await Ee.connectExternal({id:n.id,type:n.type,provider:n.provider,address:r,chain:e},e))?.address;return r},async handleDisconnectedConnection({connection:t,namespace:e,address:r,closeModalOnConnect:n}){const s=ge.getConnectorById(t.connectorId),i=t.auth?.name?.toLowerCase(),o=t.connectorId===fe.CONNECTOR_ID.AUTH,a=t.connectorId===fe.CONNECTOR_ID.WALLET_CONNECT;if(!s)throw new Error(`No connector found for connection: ${t.connectorId}`);let c;if(o)if(i&&Wu.isSocialProvider(i)){const{address:l}=await Wu.connectSocial({social:i,closeModalOnConnect:n,onOpenFarcaster(){lt.open({view:"ConnectingFarcaster"})},onConnect(){qe.replace("ProfileWallets")}});c=l}else{const{address:l}=await Wu.connectEmail({closeModalOnConnect:n,onOpen(){lt.open({view:"EmailLogin"})},onConnect(){qe.replace("ProfileWallets")}});c=l}else if(a){const{address:l}=await Wu.connectWalletConnect({walletConnect:!0,connector:s,closeModalOnConnect:n,onOpen(u){const d=u?"AllWallets":"ConnectingWalletConnect";lt.state.open?qe.push(d):lt.open({view:d})},onConnect(){qe.replace("ProfileWallets")}});c=l}else{const l=await Ee.connectExternal({id:s.id,type:s.type,provider:s.provider,chain:e},e);l&&(c=l.address)}return o&&r&&await Ee.handleAuthAccountSwitch({address:r,namespace:e}),c},async switchConnection({connection:t,address:e,namespace:r,closeModalOnConnect:n,onChange:s}){let i;const o=q.getAccountData(r)?.caipAddress;if(o){const{address:c}=sn.parseCaipAddress(o);i=c}const a=ag.getConnectionStatus(t,r);switch(a){case"connected":case"active":{const c=await Ee.handleActiveConnection({connection:t,namespace:r,address:e});if(i&&c){const l=c.toLowerCase()!==i.toLowerCase();s?.({address:c,namespace:r,hasSwitchedAccount:l,hasSwitchedWallet:a==="active"})}break}case"disconnected":{const c=await Ee.handleDisconnectedConnection({connection:t,namespace:r,address:e,closeModalOnConnect:n});c&&s?.({address:c,namespace:r,hasSwitchedAccount:!0,hasSwitchedWallet:!0});break}default:throw new Error(`Invalid connection status: ${a}`)}}},Ee=Js(UX),tw={createBalance(t,e){const r={name:t.metadata.name||"",symbol:t.metadata.symbol||"",decimals:t.metadata.decimals||0,value:t.metadata.value||0,price:t.metadata.price||0,iconUrl:t.metadata.iconUrl||""};return{name:r.name,symbol:r.symbol,chainId:e,address:t.address==="native"?void 0:this.convertAddressToCAIP10Address(t.address,e),value:r.value,price:r.price,quantity:{decimals:r.decimals.toString(),numeric:this.convertHexToBalance({hex:t.balance,decimals:r.decimals})},iconUrl:r.iconUrl}},convertHexToBalance({hex:t,decimals:e}){return iv(BigInt(t),e)},convertAddressToCAIP10Address(t,e){return`${e}:${t}`},createCAIP2ChainId(t,e){return`${e}:${parseInt(t,16)}`},getChainIdHexFromCAIP2ChainId(t){const e=t.split(":");if(e.length<2||!e[1])return"0x0";const r=e[1],n=parseInt(r,10);return isNaN(n)?"0x0":`0x${n.toString(16)}`},isWalletGetAssetsResponse(t){return typeof t!="object"||t===null?!1:Object.values(t).every(e=>Array.isArray(e)&&e.every(r=>this.isValidAsset(r)))},isValidAsset(t){return typeof t=="object"&&t!==null&&typeof t.address=="string"&&typeof t.balance=="string"&&(t.type==="ERC20"||t.type==="NATIVE")&&typeof t.metadata=="object"&&t.metadata!==null&&typeof t.metadata.name=="string"&&typeof t.metadata.symbol=="string"&&typeof t.metadata.decimals=="number"&&typeof t.metadata.price=="number"&&typeof t.metadata.iconUrl=="string"}};let rw;async function Vx(){if(!rw){const{createPublicClient:t,http:e,defineChain:r}=await ng(async()=>{const{createPublicClient:n,http:s,defineChain:i}=await import("./index-CHh4j5CF.js");return{createPublicClient:n,http:s,defineChain:i}},[]);rw={createPublicClient:t,http:e,defineChain:r}}return rw}const lb={getBlockchainApiRpcUrl(t,e){const r=new URL("https://rpc.walletconnect.org/v1/");return r.searchParams.set("chainId",t),r.searchParams.set("projectId",e),r.toString()},async getViemChain(t){const{defineChain:e}=await Vx(),{chainId:r}=sn.parseCaipNetworkId(t.caipNetworkId);return e({...t,id:Number(r)})},async createViemPublicClient(t){const{createPublicClient:e,http:r}=await Vx(),n=te.state.projectId,s=await lb.getViemChain(t);if(!s)throw new Error(`Chain ${t.caipNetworkId} not found in viem/chains`);return e({chain:s,transport:r(lb.getBlockchainApiRpcUrl(t.caipNetworkId,n))})}},cv={async getMyTokensWithBalance(t){const e=q.getAccountData()?.address,r=q.state.activeCaipNetwork,n=ge.getConnectorId("eip155")===fe.CONNECTOR_ID.AUTH;if(!e||!r)return[];const s=`${r.caipNetworkId}:${e}`,i=de.getBalanceCacheForCaipAddress(s);if(i)return i.balances;if(r.chainNamespace===fe.CHAIN.EVM&&n){const a=await this.getEIP155Balances(e,r);if(a)return this.filterLowQualityTokens(a)}const o=await He.getBalance(e,r.caipNetworkId,t);return this.filterLowQualityTokens(o.balances)},async getEIP155Balances(t,e){try{const r=tw.getChainIdHexFromCAIP2ChainId(e.caipNetworkId);if(!(await Ee.getCapabilities(t))?.[r]?.assetDiscovery?.supported)return null;const s=await Ee.walletGetAssets({account:t,chainFilter:[r]});if(!tw.isWalletGetAssetsResponse(s))return null;const o=(s[r]||[]).map(a=>tw.createBalance(a,e.caipNetworkId));return de.updateBalanceCache({caipAddress:`${e.caipNetworkId}:${t}`,balance:{balances:o},timestamp:Date.now()}),o}catch{return null}},filterLowQualityTokens(t){return t.filter(e=>e.quantity.decimals!=="0")},async fetchERC20Balance({caipAddress:t,assetAddress:e,caipNetwork:r}){const n=await lb.createViemPublicClient(r),{address:s}=sn.parseCaipAddress(t),[{result:i},{result:o},{result:a},{result:c}]=await n.multicall({contracts:[{address:e,functionName:"name",args:[],abi:$f},{address:e,functionName:"symbol",args:[],abi:$f},{address:e,functionName:"balanceOf",args:[s],abi:$f},{address:e,functionName:"decimals",args:[],abi:$f}]});return{name:i,symbol:o,decimals:c,balance:a&&c?iv(a,c):"0"}}},nw={adapters:{}},zN={state:nw,initialize(t){nw.adapters={...t}},get(t){return nw.adapters[t]}},cg={eip155:void 0,solana:void 0,polkadot:void 0,bip122:void 0,cosmos:void 0,sui:void 0,stacks:void 0},Fn=Xt({providers:{...cg},providerIds:{...cg}}),Qt={state:Fn,subscribeKey(t,e){return cn(Fn,t,e)},subscribe(t){return an(Fn,()=>{t(Fn)})},subscribeProviders(t){return an(Fn.providers,()=>t(Fn.providers))},setProvider(t,e){t&&e&&(Fn.providers[t]=Vd(e))},getProvider(t){if(t)return Fn.providers[t]},setProviderId(t,e){e&&(Fn.providerIds[t]=e)},getProviderId(t){if(t)return Fn.providerIds[t]},reset(){Fn.providers={...cg},Fn.providerIds={...cg}},resetChain(t){Fn.providers[t]=void 0,Fn.providerIds[t]=void 0}},yl=Xt({loading:!1,open:!1,selectedNetworkId:void 0,activeChain:void 0,initialized:!1}),$o={state:yl,subscribe(t){return an(yl,()=>t(yl))},subscribeOpen(t){return cn(yl,"open",t)},set(t){Object.assign(yl,{...yl,...t})}},BX={async getTokenList(t){return(await He.fetchSwapTokens({chainId:t}))?.tokens?.map(n=>({...n,eip2612:!1,quantity:{decimals:"0",numeric:"0"},price:0,value:0}))||[]},async fetchGasPrice(){const t=q.state.activeCaipNetwork;if(!t)return null;try{switch(t.chainNamespace){case"solana":const e=(await Ee?.estimateGas({chainNamespace:"solana"}))?.toString();return{standard:e,fast:e,instant:e};case"eip155":default:return await He.fetchGasPrice({chainId:t.caipNetworkId})}}catch{return null}},async fetchSwapAllowance({tokenAddress:t,userAddress:e,sourceTokenAmount:r,sourceTokenDecimals:n}){const s=await He.fetchSwapAllowance({tokenAddress:t,userAddress:e});if(s?.allowance&&r&&n){const i=Ee.parseUnits(r,n)||0;return BigInt(s.allowance)>=i}return!1},async getMyTokensWithBalance(t){const e=await cv.getMyTokensWithBalance(t);return q.setAccountProp("tokenBalance",e,q.state.activeChain),this.mapBalancesToSwapTokens(e)},mapBalancesToSwapTokens(t){return t?.map(e=>({...e,address:e?.address?e.address:qN(),decimals:parseInt(e.quantity.decimals,10),logoUri:e.iconUrl,eip2612:!1}))||[]},async handleSwapError(t){try{const e=t?.cause;return e?.json&&(await e.json())?.reasons?.[0]?.description?.includes("insufficient liquidity")?"Insufficient liquidity":void 0}catch{return}}},yt=Xt({tokenBalances:[],loading:!1}),LX={state:yt,subscribe(t){return an(yt,()=>t(yt))},subscribeKey(t,e){return cn(yt,t,e)},setToken(t){t&&(yt.token=Vd(t))},setTokenAmount(t){yt.sendTokenAmount=t},setReceiverAddress(t){yt.receiverAddress=t},setReceiverProfileImageUrl(t){yt.receiverProfileImageUrl=t},setReceiverProfileName(t){yt.receiverProfileName=t},setNetworkBalanceInUsd(t){yt.networkBalanceInUSD=t},setLoading(t){yt.loading=t},getSdkEventProperties(t){return{message:Ne.parseError(t),isSmartAccount:Ys(q.state.activeChain)===xo.ACCOUNT_TYPES.SMART_ACCOUNT,token:yt.token?.symbol||"",amount:yt.sendTokenAmount??0,network:q.state.activeCaipNetwork?.caipNetworkId||""}},async sendToken(){try{switch(ot.setLoading(!0),q.state.activeCaipNetwork?.chainNamespace){case"eip155":await ot.sendEvmToken();return;case"solana":await ot.sendSolanaToken();return;default:throw new Error("Unsupported chain")}}catch(t){throw _o.isUserRejectedRequestError(t)?new CN(t):t}finally{ot.setLoading(!1)}},async sendEvmToken(){const t=q.state.activeChain;if(!t)throw new Error("SendController:sendEvmToken - activeChainNamespace is required");const e=Ys(t);if(!ot.state.sendTokenAmount||!ot.state.receiverAddress)throw new Error("An amount and receiver address are required");if(!ot.state.token)throw new Error("A token is required");if(ot.state.token?.address){ct.sendEvent({type:"track",event:"SEND_INITIATED",properties:{isSmartAccount:e===xo.ACCOUNT_TYPES.SMART_ACCOUNT,token:ot.state.token.address,amount:ot.state.sendTokenAmount,network:q.state.activeCaipNetwork?.caipNetworkId||""}});const{hash:r}=await ot.sendERC20Token({receiverAddress:ot.state.receiverAddress,tokenAddress:ot.state.token.address,sendTokenAmount:ot.state.sendTokenAmount,decimals:ot.state.token.quantity.decimals});r&&(yt.hash=r)}else{ct.sendEvent({type:"track",event:"SEND_INITIATED",properties:{isSmartAccount:e===xo.ACCOUNT_TYPES.SMART_ACCOUNT,token:ot.state.token.symbol||"",amount:ot.state.sendTokenAmount,network:q.state.activeCaipNetwork?.caipNetworkId||""}});const{hash:r}=await ot.sendNativeToken({receiverAddress:ot.state.receiverAddress,sendTokenAmount:ot.state.sendTokenAmount,decimals:ot.state.token.quantity.decimals});r&&(yt.hash=r)}},async fetchTokenBalance(t){yt.loading=!0;const e=q.state.activeChain,r=q.state.activeCaipNetwork?.caipNetworkId,n=q.state.activeCaipNetwork?.chainNamespace,s=q.getAccountData(e)?.caipAddress??q.state.activeCaipAddress,i=s?Ne.getPlainAddress(s):void 0;if(yt.lastRetry&&!Ne.isAllowedRetry(yt.lastRetry,30*mt.ONE_SEC_MS))return yt.loading=!1,[];try{if(i&&r&&n){const o=await cv.getMyTokensWithBalance();return yt.tokenBalances=o,yt.lastRetry=void 0,o}}catch(o){yt.lastRetry=Date.now(),t?.(o),Li.showError("Token Balance Unavailable")}finally{yt.loading=!1}return[]},fetchNetworkBalance(){if(yt.tokenBalances.length===0)return;const t=BX.mapBalancesToSwapTokens(yt.tokenBalances);if(!t)return;const e=t.find(r=>r.address===qN());e&&(yt.networkBalanceInUSD=e?aY.multiply(e.quantity.numeric,e.price).toString():"0")},async sendNativeToken(t){qe.pushTransactionStack({});const e=t.receiverAddress,r=q.getAccountData()?.address,n=Ee.parseUnits(t.sendTokenAmount.toString(),Number(t.decimals)),i=await Ee.sendTransaction({chainNamespace:fe.CHAIN.EVM,to:e,address:r,data:"0x",value:n??BigInt(0)});return ct.sendEvent({type:"track",event:"SEND_SUCCESS",properties:{isSmartAccount:Ys("eip155")===xo.ACCOUNT_TYPES.SMART_ACCOUNT,token:ot.state.token?.symbol||"",amount:t.sendTokenAmount,network:q.state.activeCaipNetwork?.caipNetworkId||"",hash:i||""}}),Ee._getClient()?.updateBalance("eip155"),ot.resetSend(),{hash:i}},async sendERC20Token(t){qe.pushTransactionStack({onSuccess(){qe.replace("Account")}});const e=Ee.parseUnits(t.sendTokenAmount.toString(),Number(t.decimals)),r=q.getAccountData()?.address;if(r&&t.sendTokenAmount&&t.receiverAddress&&t.tokenAddress){const n=Ne.getPlainAddress(t.tokenAddress);if(!n)throw new Error("SendController:sendERC20Token - tokenAddress is required");const s=await Ee.writeContract({fromAddress:r,tokenAddress:n,args:[t.receiverAddress,e??BigInt(0)],method:"transfer",abi:dY.getERC20Abi(n),chainNamespace:fe.CHAIN.EVM});return ct.sendEvent({type:"track",event:"SEND_SUCCESS",properties:{isSmartAccount:Ys("eip155")===xo.ACCOUNT_TYPES.SMART_ACCOUNT,token:ot.state.token?.symbol||"",amount:t.sendTokenAmount,network:q.state.activeCaipNetwork?.caipNetworkId||"",hash:s||""}}),ot.resetSend(),{hash:s}}return{hash:void 0}},async sendSolanaToken(){if(!ot.state.sendTokenAmount||!ot.state.receiverAddress)throw new Error("An amount and receiver address are required");qe.pushTransactionStack({onSuccess(){qe.replace("Account")}});let t;ot.state.token&&ot.state.token.address!==mt.SOLANA_NATIVE_TOKEN_ADDRESS&&(Ne.isCaipAddress(ot.state.token.address)?t=Ne.getPlainAddress(ot.state.token.address):t=ot.state.token.address);const e=await Ee.sendTransaction({chainNamespace:"solana",tokenMint:t,to:ot.state.receiverAddress,value:ot.state.sendTokenAmount});e&&(yt.hash=e),Ee._getClient()?.updateBalance("solana"),ct.sendEvent({type:"track",event:"SEND_SUCCESS",properties:{isSmartAccount:!1,token:ot.state.token?.symbol||"",amount:ot.state.sendTokenAmount,network:q.state.activeCaipNetwork?.caipNetworkId||"",hash:e||""}}),ot.resetSend()},resetSend(){yt.token=void 0,yt.sendTokenAmount=void 0,yt.receiverAddress=void 0,yt.receiverProfileImageUrl=void 0,yt.receiverProfileName=void 0,yt.loading=!1,yt.tokenBalances=[]}},ot=Js(LX),sw={currentTab:0,tokenBalance:[],smartAccountDeployed:!1,addressLabels:new Map,user:void 0,preferredAccountType:void 0},Rf={caipNetwork:void 0,supportsAllNetworks:!0,smartAccountEnabledNetworks:[]},_e=Xt({chains:AY(),activeCaipAddress:void 0,activeChain:void 0,activeCaipNetwork:void 0,noAdapters:!1,universalAdapter:{connectionControllerClient:void 0},isSwitchingNamespace:!1}),HN={state:_e,subscribe(t){return an(_e,()=>{t(_e)})},subscribeKey(t,e){return cn(_e,t,e)},subscribeAccountStateProp(t,e,r){const n=r||_e.activeChain;return n?cn(_e.chains.get(n)?.accountState||{},t,e):()=>{}},subscribeChainProp(t,e,r){let n;return an(_e.chains,()=>{const s=r||_e.activeChain;if(s){const i=_e.chains.get(s)?.[t];n!==i&&(n=i,e(i))}})},initialize(t,e,r){const{chainId:n,namespace:s}=de.getActiveNetworkProps(),i=e?.find(u=>u.id.toString()===n?.toString()),a=t.find(u=>u?.namespace===s)||t?.[0],c=t.map(u=>u.namespace).filter(u=>u!==void 0),l=te.state.enableEmbedded?new Set([...c]):new Set([...e?.map(u=>u.chainNamespace)??[]]);(t?.length===0||!a)&&(_e.noAdapters=!0),_e.noAdapters||(_e.activeChain=a?.namespace,_e.activeCaipNetwork=i,q.setChainNetworkData(a?.namespace,{caipNetwork:i}),_e.activeChain&&$o.set({activeChain:a?.namespace})),l.forEach(u=>{const d=e?.filter(y=>y.chainNamespace===u),h=de.getPreferredAccountTypes()||{},p={...te.state.defaultAccountTypes,...h};q.state.chains.set(u,{namespace:u,networkState:Xt({...Rf,caipNetwork:d?.[0]}),accountState:Xt({...sw,preferredAccountType:p[u]}),caipNetworks:d??[],...r}),q.setRequestedCaipNetworks(d??[],u)})},removeAdapter(t){if(_e.activeChain===t){const e=Array.from(_e.chains.entries()).find(([r])=>r!==t);if(e){const r=e[1]?.caipNetworks?.[0];r&&q.setActiveCaipNetwork(r)}}_e.chains.delete(t)},addAdapter(t,{connectionControllerClient:e},r){if(!t.namespace)throw new Error("ChainController:addAdapter - adapter must have a namespace");_e.chains.set(t.namespace,{namespace:t.namespace,networkState:{...Rf,caipNetwork:r[0]},accountState:{...sw},caipNetworks:r,connectionControllerClient:e}),q.setRequestedCaipNetworks(r?.filter(n=>n.chainNamespace===t.namespace)??[],t.namespace)},addNetwork(t){const e=_e.chains.get(t.chainNamespace);if(e){const r=[...e.caipNetworks||[]];e.caipNetworks?.find(n=>n.id===t.id)||r.push(t),_e.chains.set(t.chainNamespace,{...e,caipNetworks:r}),q.setRequestedCaipNetworks(r,t.chainNamespace),ge.filterByNamespace(t.chainNamespace,!0)}},removeNetwork(t,e){const r=_e.chains.get(t);if(r){const n=_e.activeCaipNetwork?.id===e,s=[...r.caipNetworks?.filter(i=>i.id!==e)||[]];n&&r?.caipNetworks?.[0]&&q.setActiveCaipNetwork(r.caipNetworks[0]),_e.chains.set(t,{...r,caipNetworks:s}),q.setRequestedCaipNetworks(s||[],t),s.length===0&&ge.filterByNamespace(t,!1)}},setAdapterNetworkState(t,e){const r=_e.chains.get(t);r&&(r.networkState={...r.networkState||Rf,...e},_e.chains.set(t,r))},setChainAccountData(t,e,r=!0){if(!t)throw new Error("Chain is required to update chain account data");const n=_e.chains.get(t);if(n){const s={...n.accountState||sw,...e};_e.chains.set(t,{...n,accountState:s}),(_e.chains.size===1||_e.activeChain===t)&&e.caipAddress&&(_e.activeCaipAddress=e.caipAddress)}},setChainNetworkData(t,e){if(!t)return;const r=_e.chains.get(t);if(r){const n={...r.networkState||Rf,...e};_e.chains.set(t,{...r,networkState:n})}},setAccountProp(t,e,r,n=!0){q.setChainAccountData(r,{[t]:e},n)},setActiveNamespace(t){_e.activeChain=t;const e=t?_e.chains.get(t):void 0,r=e?.networkState?.caipNetwork;r?.id&&t&&(_e.activeCaipAddress=e?.accountState?.caipAddress,_e.activeCaipNetwork=r,q.setChainNetworkData(t,{caipNetwork:r}),de.setActiveCaipNetworkId(r?.caipNetworkId),$o.set({activeChain:t,selectedNetworkId:r?.caipNetworkId}))},setActiveCaipNetwork(t){if(!t)return;const e=_e.activeChain===t.chainNamespace;e||q.setIsSwitchingNamespace(!0);const r=_e.chains.get(t.chainNamespace);_e.activeChain=t.chainNamespace,_e.activeCaipNetwork=t,q.setChainNetworkData(t.chainNamespace,{caipNetwork:t});let n=r?.accountState?.address;if(n)_e.activeCaipAddress=`${t.chainNamespace}:${t.id}:${n}`;else if(e&&_e.activeCaipAddress){const{address:i}=sn.parseCaipAddress(_e.activeCaipAddress);n=i,_e.activeCaipAddress=`${t.caipNetworkId}:${n}`}else _e.activeCaipAddress=void 0;q.setChainAccountData(t.chainNamespace,{address:n,caipAddress:_e.activeCaipAddress}),ot.resetSend(),$o.set({activeChain:_e.activeChain,selectedNetworkId:_e.activeCaipNetwork?.caipNetworkId}),de.setActiveCaipNetworkId(t.caipNetworkId),!q.checkIfSupportedNetwork(t.chainNamespace)&&te.state.enableNetworkSwitch&&!te.state.allowUnsupportedChain&&!Ee.state.wcBasic&&q.showUnsupportedChainUI()},addCaipNetwork(t){if(!t)return;const e=_e.chains.get(t.chainNamespace);e&&e?.caipNetworks?.push(t)},async switchActiveNamespace(t){if(!t)return;const e=t!==q.state.activeChain,r=q.getNetworkData(t)?.caipNetwork,n=q.getCaipNetworkByNamespace(t,r?.id);e&&n&&await q.switchActiveNetwork(n)},async switchActiveNetwork(t,{throwOnFailure:e=!1}={}){const r=q.state.activeChain;if(!r)throw new Error("ChainController:switchActiveNetwork - namespace is required");const n=Qt.getProviderId(_e.activeChain)==="AUTH",s=q.getAccountData(r)?.address,i=fe.AUTH_CONNECTOR_SUPPORTED_CHAINS.includes(t.chainNamespace);try{if(s&&t.chainNamespace===r||n&&i){const o=zN.get(t.chainNamespace);if(!o)throw new Error("Adapter not found");await o.switchNetwork({caipNetwork:t})}q.setActiveCaipNetwork(t)}catch(o){if(e)throw o}ct.sendEvent({type:"track",event:"SWITCH_NETWORK",properties:{network:t.caipNetworkId}})},getConnectionControllerClient(t){const e=t||_e.activeChain;if(!e)throw new Error("Chain is required to get connection controller client");const r=_e.chains.get(e);if(!r?.connectionControllerClient)throw new Error("ConnectionController client not set");return r.connectionControllerClient},getNetworkProp(t,e){const r=_e.chains.get(e)?.networkState;if(r)return r[t]},getRequestedCaipNetworks(t){const e=_e.chains.get(t),{approvedCaipNetworkIds:r=[],requestedCaipNetworks:n=[]}=e?.networkState||{};return Ne.sortRequestedNetworks(r,n).filter(o=>o?.id)},getAllRequestedCaipNetworks(){const t=[];return _e.chains.forEach(e=>{if(!e.namespace)throw new Error("ChainController:getAllRequestedCaipNetworks - chainAdapter must have a namespace");const r=q.getRequestedCaipNetworks(e.namespace);t.push(...r)}),t},setRequestedCaipNetworks(t,e){q.setAdapterNetworkState(e,{requestedCaipNetworks:t});const n=q.getAllRequestedCaipNetworks().map(i=>i.chainNamespace),s=Array.from(new Set(n));ge.filterByNamespaces(s)},getAllApprovedCaipNetworkIds(){const t=[];return _e.chains.forEach(e=>{if(!e.namespace)throw new Error("ChainController:getAllApprovedCaipNetworkIds - chainAdapter must have a namespace");const r=q.getApprovedCaipNetworkIds(e.namespace);t.push(...r)}),t},getActiveCaipNetwork(t){return t?_e.chains.get(t)?.networkState?.caipNetwork:_e.activeCaipNetwork},getActiveCaipAddress(){return _e.activeCaipAddress},getApprovedCaipNetworkIds(t){return _e.chains.get(t)?.networkState?.approvedCaipNetworkIds||[]},setApprovedCaipNetworksData(t,e){q.setAdapterNetworkState(t,e)},checkIfSupportedNetwork(t,e){const r=e||_e.activeCaipNetwork?.caipNetworkId,n=q.getRequestedCaipNetworks(t);return n.length?n?.some(s=>s.caipNetworkId===r):!0},checkIfSupportedChainId(t){return _e.activeChain?q.getRequestedCaipNetworks(_e.activeChain)?.some(r=>r.id===t):!0},checkIfSmartAccountEnabled(){const t=xN.caipNetworkIdToNumber(_e.activeCaipNetwork?.caipNetworkId);return!_e.activeChain||!t?!1:!!(CY.get(gp.SMART_ACCOUNT_ENABLED_NETWORKS)?.split(",")||[])?.includes(t.toString())},showUnsupportedChainUI(){lt.open({view:"UnsupportedChain"})},checkIfNamesSupported(){const t=_e.activeCaipNetwork;return!!(t?.chainNamespace&&mt.NAMES_SUPPORTED_CHAIN_NAMESPACES.includes(t.chainNamespace))},resetNetwork(t){q.setAdapterNetworkState(t,{approvedCaipNetworkIds:void 0,supportsAllNetworks:!0})},resetAccount(t){const e=t;if(!e)throw new Error("Chain is required to set account prop");const r=q.state.chains.get(e)?.accountState?.preferredAccountType,n=te.state.defaultAccountTypes[e];_e.activeCaipAddress=void 0,q.setChainAccountData(e,{smartAccountDeployed:!1,currentTab:0,caipAddress:void 0,address:void 0,balance:void 0,balanceSymbol:void 0,profileName:void 0,profileImage:void 0,addressExplorerUrl:void 0,tokenBalance:[],connectedWalletInfo:void 0,preferredAccountType:n||r,socialProvider:void 0,socialWindow:void 0,farcasterUrl:void 0,user:void 0,status:"disconnected"}),ge.removeConnectorId(e)},setIsSwitchingNamespace(t){_e.isSwitchingNamespace=t},getFirstCaipNetworkSupportsAuthConnector(){const t=[];let e;if(_e.chains.forEach(r=>{fe.AUTH_CONNECTOR_SUPPORTED_CHAINS.find(n=>n===r.namespace)&&r.namespace&&t.push(r.namespace)}),t.length>0){const r=t[0];return e=r?_e.chains.get(r)?.caipNetworks?.[0]:void 0,e}},getAccountData(t){const e=t||_e.activeChain;if(e)return q.state.chains.get(e)?.accountState},getNetworkData(t){const e=t||_e.activeChain;if(e)return q.state.chains.get(e)?.networkState},getCaipNetworkByNamespace(t,e){if(!t)return;const r=q.state.chains.get(t),n=r?.caipNetworks?.find(s=>s.id.toString()===e?.toString());return n||r?.networkState?.caipNetwork||r?.caipNetworks?.[0]},getRequestedCaipNetworkIds(){const t=ge.state.filterByNamespace;return(t?[_e.chains.get(t)]:Array.from(_e.chains.values())).flatMap(r=>r?.caipNetworks||[]).map(r=>r.caipNetworkId)},getCaipNetworks(t){return t?q.getRequestedCaipNetworks(t):q.getAllRequestedCaipNetworks()},getCaipNetworkById(t,e){return HN.getCaipNetworks(e).find(r=>r.id.toString()===t.toString()||r.caipNetworkId.toString()===t.toString())},setLastConnectedSIWECaipNetwork(t){_e.lastConnectedSIWECaipNetwork=t},getLastConnectedSIWECaipNetwork(){return _e.lastConnectedSIWECaipNetwork},async fetchTokenBalance(t){const e=q.getAccountData();if(!e)return[];const r=q.state.activeCaipNetwork?.caipNetworkId,n=q.state.activeCaipNetwork?.chainNamespace,s=q.state.activeCaipAddress,i=s?Ne.getPlainAddress(s):void 0;if(q.setAccountProp("balanceLoading",!0,n),e.lastRetry&&!Ne.isAllowedRetry(e.lastRetry,30*mt.ONE_SEC_MS))return q.setAccountProp("balanceLoading",!1,n),[];try{if(i&&r&&n){const o=await cv.getMyTokensWithBalance();return q.setAccountProp("tokenBalance",o,n),q.setAccountProp("lastRetry",void 0,n),q.setAccountProp("balanceLoading",!1,n),o}}catch(o){q.setAccountProp("lastRetry",Date.now(),n),t?.(o),Li.showError("Token Balance Unavailable")}finally{q.setAccountProp("balanceLoading",!1,n)}return[]},isCaipNetworkDisabled(t){const e=t.chainNamespace,r=!!q.getAccountData(e)?.caipAddress,n=q.getAllApprovedCaipNetworkIds(),s=q.getNetworkProp("supportsAllNetworks",e)!==!1,i=ge.getConnectorId(e),o=ge.getAuthConnector(),a=i===fe.CONNECTOR_ID.AUTH&&o;return!r||s||a?!1:!n?.includes(t.caipNetworkId)}},q=Js(HN),MX={onSwitchNetwork({network:t,ignoreSwitchConfirmation:e=!1}){const r=q.state.activeCaipNetwork,n=q.state.activeChain,s=qe.state.data;if(t.id===r?.id)return;const o=!!q.getAccountData(n)?.address,a=!!q.getAccountData(t.chainNamespace)?.address,c=t.chainNamespace!==n,u=ge.getConnectorId(n)===fe.CONNECTOR_ID.AUTH,d=fe.AUTH_CONNECTOR_SUPPORTED_CHAINS.find(h=>h===t.chainNamespace);e||u&&d?qe.push("SwitchNetwork",{...s,network:t}):o&&c&&!a?qe.push("SwitchActiveChain",{switchToChain:t.chainNamespace,navigateTo:"Connect",navigateWithReplace:!0,network:t}):qe.push("SwitchNetwork",{...s,network:t})}},qn=Xt({loading:!1,loadingNamespaceMap:new Map,open:!1,shake:!1,namespace:void 0}),jX={state:qn,subscribe(t){return an(qn,()=>t(qn))},subscribeKey(t,e){return cn(qn,t,e)},async open(t){const e=t?.namespace,r=q.state.activeChain,n=e&&e!==r,s=q.getAccountData(t?.namespace)?.caipAddress,i=q.state.noAdapters;if(Ee.state.wcBasic?Ue.prefetch({fetchNetworkImages:!1,fetchConnectorImages:!1,fetchWalletRanks:!1}):await Ue.prefetch(),ge.setFilterByNamespace(t?.namespace),lt.setLoading(!0,e),e&&n){const o=q.getNetworkData(e)?.caipNetwork||q.getRequestedCaipNetworks(e)[0];o&&(i?(await q.switchActiveNetwork(o),qe.push("ConnectingWalletConnectBasic")):MX.onSwitchNetwork({network:o,ignoreSwitchConfirmation:!0}))}else te.state.manualWCControl||i&&!s?Ne.isMobile()?qe.reset("AllWallets"):qe.reset("ConnectingWalletConnectBasic"):t?.view?qe.reset(t.view,t.data):s?qe.reset("Account"):qe.reset("Connect");qn.open=!0,$o.set({open:!0}),ct.sendEvent({type:"track",event:"MODAL_OPEN",properties:{connected:!!s}})},close(){const t=te.state.enableEmbedded,e=!!q.state.activeCaipAddress;qn.open&&ct.sendEvent({type:"track",event:"MODAL_CLOSE",properties:{connected:e}}),qn.open=!1,qe.reset("Connect"),lt.clearLoading(),t?e?qe.replace("Account"):qe.push("Connect"):$o.set({open:!1}),Ee.resetUri()},setLoading(t,e){e&&qn.loadingNamespaceMap.set(e,t),qn.loading=t,$o.set({loading:t})},clearLoading(){qn.loadingNamespaceMap.clear(),qn.loading=!1,$o.set({loading:!1})},shake(){qn.shake||(qn.shake=!0,setTimeout(()=>{qn.shake=!1},500))}},lt=Js(jX),Ed={id:"2b92315d-eab7-5bef-84fa-089a131333f5",name:"USD Coin",symbol:"USDC",networks:[{name:"ethereum-mainnet",display_name:"Ethereum",chain_id:"1",contract_address:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"},{name:"polygon-mainnet",display_name:"Polygon",chain_id:"137",contract_address:"0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174"}]},ub={id:"USD",payment_method_limits:[{id:"card",min:"10.00",max:"7500.00"},{id:"ach_bank_account",min:"10.00",max:"25000.00"}]},FX={providers:TN,selectedProvider:null,error:null,purchaseCurrency:Ed,paymentCurrency:ub,purchaseCurrencies:[Ed],paymentCurrencies:[],quotesLoading:!1},_t=Xt(FX),qX={state:_t,subscribe(t){return an(_t,()=>t(_t))},subscribeKey(t,e){return cn(_t,t,e)},setSelectedProvider(t){if(t&&t.name==="meld"){const e=q.state.activeChain,r=e===fe.CHAIN.SOLANA?"SOL":"USDC",n=e?q.state.chains.get(e)?.accountState?.address??"":"",s=new URL(t.url);s.searchParams.append("publicKey",IY),s.searchParams.append("destinationCurrencyCode",r),s.searchParams.append("walletAddress",n),s.searchParams.append("externalCustomerId",te.state.projectId),_t.selectedProvider={...t,url:s.toString()}}else _t.selectedProvider=t},setOnrampProviders(t){if(Array.isArray(t)&&t.every(e=>typeof e=="string")){const e=t,r=TN.filter(n=>e.includes(n.name));_t.providers=r}else _t.providers=[]},setPurchaseCurrency(t){_t.purchaseCurrency=t},setPaymentCurrency(t){_t.paymentCurrency=t},setPurchaseAmount(t){db.state.purchaseAmount=t},setPaymentAmount(t){db.state.paymentAmount=t},async getAvailableCurrencies(){const t=await He.getOnrampOptions();_t.purchaseCurrencies=t.purchaseCurrencies,_t.paymentCurrencies=t.paymentCurrencies,_t.paymentCurrency=t.paymentCurrencies[0]||ub,_t.purchaseCurrency=t.purchaseCurrencies[0]||Ed,await Ue.fetchCurrencyImages(t.paymentCurrencies.map(e=>e.id)),await Ue.fetchTokenImages(t.purchaseCurrencies.map(e=>e.symbol))},async getQuote(){_t.quotesLoading=!0;try{const t=await He.getOnrampQuote({purchaseCurrency:_t.purchaseCurrency,paymentCurrency:_t.paymentCurrency,amount:_t.paymentAmount?.toString()||"0",network:_t.purchaseCurrency?.symbol});return _t.quotesLoading=!1,_t.purchaseAmount=Number(t?.purchaseAmount.amount),t}catch(t){return _t.error=t.message,_t.quotesLoading=!1,null}finally{_t.quotesLoading=!1}},resetState(){_t.selectedProvider=null,_t.error=null,_t.purchaseCurrency=Ed,_t.paymentCurrency=ub,_t.purchaseCurrencies=[Ed],_t.paymentCurrencies=[],_t.paymentAmount=void 0,_t.purchaseAmount=void 0,_t.quotesLoading=!1}},db=Js(qX);let zX=class extends is{constructor(e){super()}};const Kx=X.FIVE_SECONDS,Zc={pulse:"heartbeat_pulse"};let HX=class WN extends zX{constructor(e){super(e),this.events=new dr.EventEmitter,this.interval=Kx,this.interval=e?.interval||Kx}static async init(e){const r=new WN(e);return await r.init(),r}async init(){await this.initialize()}stop(){clearInterval(this.intervalRef)}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async initialize(){this.intervalRef=setInterval(()=>this.pulse(),X.toMiliseconds(this.interval))}pulse(){this.events.emit(Zc.pulse)}};var Vu={exports:{}},Gx;function WX(){if(Gx)return Vu.exports;Gx=1;const t=x1();Vu.exports=u;const e=k().console||{},r={mapHttpRequest:L,mapHttpResponse:L,wrapRequestSerializer:j,wrapResponseSerializer:j,wrapErrorSerializer:j,req:L,res:L,err:C,errWithCause:C};function n(f,m){return f==="silent"?1/0:m.levels.values[f]}const s=Symbol("pino.logFuncs"),i=Symbol("pino.hierarchy"),o={error:"log",fatal:"error",warn:"error",info:"log",debug:"log",trace:"log"};function a(f,m){const _={logger:m,parent:f[i]};m[i]=_}function c(f,m,_){const $={};m.forEach(x=>{$[x]=_[x]?_[x]:e[x]||e[o[x]||"log"]||D}),f[s]=$}function l(f,m){return Array.isArray(f)?f.filter(function($){return $!=="!stdSerializers.err"}):f===!0?Object.keys(m):!1}function u(f){f=f||{},f.browser=f.browser||{};const m=f.browser.transmit;if(m&&typeof m.send!="function")throw Error("pino: transmit option must have a send function");const _=f.browser.write||e;f.browser.write&&(f.browser.asObject=!0);const $=f.serializers||{},x=l(f.browser.serialize,$);let N=f.browser.serialize;Array.isArray(f.browser.serialize)&&f.browser.serialize.indexOf("!stdSerializers.err")>-1&&(N=!1);const H=Object.keys(f.customLevels||{}),z=["error","fatal","warn","info","debug","trace"].concat(H);typeof _=="function"&&z.forEach(function(se){_[se]=_}),(f.enabled===!1||f.browser.disabled)&&(f.level="silent");const G=f.level||"info",M=Object.create(_);M.log||(M.log=D),c(M,z,_),a({},M),Object.defineProperty(M,"levelVal",{get:J}),Object.defineProperty(M,"level",{get:re,set:ye});const V={transmit:m,serialize:x,asObject:f.browser.asObject,asObjectBindingsOnly:f.browser.asObjectBindingsOnly,formatters:f.browser.formatters,levels:z,timestamp:O(f),messageKey:f.messageKey||"msg",onChild:f.onChild||D};M.levels=d(f),M.level=G,M.isLevelEnabled=function(se){return this.levels.values[se]?this.levels.values[se]>=this.levels.values[this.level]:!1},M.setMaxListeners=M.getMaxListeners=M.emit=M.addListener=M.on=M.prependListener=M.once=M.prependOnceListener=M.removeListener=M.removeAllListeners=M.listeners=M.listenerCount=M.eventNames=M.write=M.flush=D,M.serializers=$,M._serialize=x,M._stdErrSerialize=N,M.child=function(...se){return ne.call(this,V,...se)},m&&(M._logEvent=v());function J(){return n(this.level,this)}function re(){return this._level}function ye(se){if(se!=="silent"&&!this.levels.values[se])throw Error("unknown level "+se);this._level=se,y(this,V,M,"error"),y(this,V,M,"fatal"),y(this,V,M,"warn"),y(this,V,M,"info"),y(this,V,M,"debug"),y(this,V,M,"trace"),H.forEach(Ie=>{y(this,V,M,Ie)})}function ne(se,Ie,Me){if(!Ie)throw new Error("missing bindings for child Pino");Me=Me||{},x&&Ie.serializers&&(Me.serializers=Ie.serializers);const Ve=Me.serializers;if(x&&Ve){var Ze=Object.assign({},$,Ve),Nt=f.browser.serialize===!0?Object.keys(Ze):x;delete Ie.serializers,A([Ie],Nt,Ze,this._stdErrSerialize)}function Br(Ir){this._childLevel=(Ir._childLevel|0)+1,this.bindings=Ie,Ze&&(this.serializers=Ze,this._serialize=Nt),m&&(this._logEvent=v([].concat(Ir._logEvent.bindings,Ie)))}Br.prototype=this;const sr=new Br(this);return a(this,sr),sr.child=function(...Ir){return ne.call(this,se,...Ir)},sr.level=Me.level||this.level,se.onChild(sr),sr}return M}function d(f){const m=f.customLevels||{},_=Object.assign({},u.levels.values,m),$=Object.assign({},u.levels.labels,h(m));return{values:_,labels:$}}function h(f){const m={};return Object.keys(f).forEach(function(_){m[f[_]]=_}),m}u.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},u.stdSerializers=r,u.stdTimeFunctions=Object.assign({},{nullTime:W,epochTime:P,unixTime:R,isoTime:T});function p(f){const m=[];f.bindings&&m.push(f.bindings);let _=f[i];for(;_.parent;)_=_.parent,_.logger.bindings&&m.push(_.logger.bindings);return m.reverse()}function y(f,m,_,$){if(Object.defineProperty(f,$,{value:n(f.level,_)>n($,_)?D:_[s][$],writable:!0,enumerable:!0,configurable:!0}),f[$]===D){if(!m.transmit)return;const N=m.transmit.level||f.level,H=n(N,_);if(n($,_)<H)return}f[$]=w(f,m,_,$);const x=p(f);x.length!==0&&(f[$]=g(x,f[$]))}function g(f,m){return function(){return m.apply(this,[...f,...arguments])}}function w(f,m,_,$){return(function(x){return function(){const H=m.timestamp(),z=new Array(arguments.length),G=Object.getPrototypeOf&&Object.getPrototypeOf(this)===e?e:this;for(var M=0;M<z.length;M++)z[M]=arguments[M];var V=!1;if(m.serialize&&(A(z,this._serialize,this.serializers,this._stdErrSerialize),V=!0),m.asObject||m.formatters?x.call(G,...S(this,$,z,H,m)):x.apply(G,z),m.transmit){const J=m.transmit.level||f._level,re=n(J,_),ye=n($,_);if(ye<re)return;E(this,{ts:H,methodLevel:$,methodValue:ye,transmitValue:_.levels.values[m.transmit.level||f._level],send:m.transmit.send,val:n(f._level,_)},z,V)}}})(f[s][$])}function S(f,m,_,$,x){const{level:N,log:H=J=>J}=x.formatters||{},z=_.slice();let G=z[0];const M={};let V=(f._childLevel|0)+1;if(V<1&&(V=1),$&&(M.time=$),N){const J=N(m,f.levels.values[m]);Object.assign(M,J)}else M.level=f.levels.values[m];if(x.asObjectBindingsOnly){if(G!==null&&typeof G=="object")for(;V--&&typeof z[0]=="object";)Object.assign(M,z.shift());return[H(M),...z]}else{if(G!==null&&typeof G=="object"){for(;V--&&typeof z[0]=="object";)Object.assign(M,z.shift());G=z.length?t(z.shift(),z):void 0}else typeof G=="string"&&(G=t(z.shift(),z));return G!==void 0&&(M[x.messageKey]=G),[H(M)]}}function A(f,m,_,$){for(const x in f)if($&&f[x]instanceof Error)f[x]=u.stdSerializers.err(f[x]);else if(typeof f[x]=="object"&&!Array.isArray(f[x])&&m)for(const N in f[x])m.indexOf(N)>-1&&N in _&&(f[x][N]=_[N](f[x][N]))}function E(f,m,_,$=!1){const x=m.send,N=m.ts,H=m.methodLevel,z=m.methodValue,G=m.val,M=f._logEvent.bindings;$||A(_,f._serialize||Object.keys(f.serializers),f.serializers,f._stdErrSerialize===void 0?!0:f._stdErrSerialize),f._logEvent.ts=N,f._logEvent.messages=_.filter(function(V){return M.indexOf(V)===-1}),f._logEvent.level.label=H,f._logEvent.level.value=z,x(H,f._logEvent,G),f._logEvent=v(M)}function v(f){return{ts:0,messages:[],bindings:f||[],level:{label:"",value:0}}}function C(f){const m={type:f.constructor.name,msg:f.message,stack:f.stack};for(const _ in f)m[_]===void 0&&(m[_]=f[_]);return m}function O(f){return typeof f.timestamp=="function"?f.timestamp:f.timestamp===!1?W:P}function L(){return{}}function j(f){return f}function D(){}function W(){return!1}function P(){return Date.now()}function R(){return Math.round(Date.now()/1e3)}function T(){return new Date(Date.now()).toISOString()}function k(){function f(m){return typeof m<"u"&&m}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return f(self)||f(window)||f(this)||{}}}return Vu.exports.default=u,Vu.exports.pino=u,Vu.exports}var Al=WX();const VN=Sh(Al),VX={level:"info"},ay="custom_context",lv=1e3*1024;var KX=Object.defineProperty,GX=(t,e,r)=>e in t?KX(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ga=(t,e,r)=>GX(t,typeof e!="symbol"?e+"":e,r);let YX=class{constructor(e){ga(this,"nodeValue"),ga(this,"sizeInBytes"),ga(this,"next"),this.nodeValue=e,this.sizeInBytes=new TextEncoder().encode(this.nodeValue).length,this.next=null}get value(){return this.nodeValue}get size(){return this.sizeInBytes}},Yx=class{constructor(e){ga(this,"lengthInNodes"),ga(this,"sizeInBytes"),ga(this,"head"),ga(this,"tail"),ga(this,"maxSizeInBytes"),this.head=null,this.tail=null,this.lengthInNodes=0,this.maxSizeInBytes=e,this.sizeInBytes=0}append(e){const r=new YX(e);if(r.size>this.maxSizeInBytes)throw new Error(`[LinkedList] Value too big to insert into list: ${e} with size ${r.size}`);for(;this.size+r.size>this.maxSizeInBytes;)this.shift();this.head?(this.tail&&(this.tail.next=r),this.tail=r):(this.head=r,this.tail=r),this.lengthInNodes++,this.sizeInBytes+=r.size}shift(){if(!this.head)return;const e=this.head;this.head=this.head.next,this.head||(this.tail=null),this.lengthInNodes--,this.sizeInBytes-=e.size}toArray(){const e=[];let r=this.head;for(;r!==null;)e.push(r.value),r=r.next;return e}get length(){return this.lengthInNodes}get size(){return this.sizeInBytes}toOrderedArray(){return Array.from(this)}[Symbol.iterator](){let e=this.head;return{next:()=>{if(!e)return{done:!0,value:null};const r=e.value;return e=e.next,{done:!1,value:r}}}}};var XX=Object.defineProperty,ZX=(t,e,r)=>e in t?XX(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Df=(t,e,r)=>ZX(t,typeof e!="symbol"?e+"":e,r);let KN=class{constructor(e,r=lv){Df(this,"logs"),Df(this,"level"),Df(this,"levelValue"),Df(this,"MAX_LOG_SIZE_IN_BYTES"),this.level=e??"error",this.levelValue=Al.levels.values[this.level],this.MAX_LOG_SIZE_IN_BYTES=r,this.logs=new Yx(this.MAX_LOG_SIZE_IN_BYTES)}forwardToConsole(e,r){r===Al.levels.values.error?console.error(e):r===Al.levels.values.warn?console.warn(e):r===Al.levels.values.debug?console.debug(e):r===Al.levels.values.trace?console.trace(e):console.log(e)}appendToLogs(e){this.logs.append(Bn({timestamp:new Date().toISOString(),log:e}));const r=typeof e=="string"?JSON.parse(e).level:e.level;r>=this.levelValue&&this.forwardToConsole(e,r)}getLogs(){return this.logs}clearLogs(){this.logs=new Yx(this.MAX_LOG_SIZE_IN_BYTES)}getLogArray(){return Array.from(this.logs)}logsToBlob(e){const r=this.getLogArray();return r.push(Bn({extraMetadata:e})),new Blob(r,{type:"application/json"})}};var JX=Object.defineProperty,QX=(t,e,r)=>e in t?JX(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,eZ=(t,e,r)=>QX(t,e+"",r);let tZ=class{constructor(e,r=lv){eZ(this,"baseChunkLogger"),this.baseChunkLogger=new KN(e,r)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}downloadLogsBlobInBrowser(e){const r=URL.createObjectURL(this.logsToBlob(e)),n=document.createElement("a");n.href=r,n.download=`walletconnect-logs-${new Date().toISOString()}.txt`,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(r)}};var rZ=Object.defineProperty,nZ=(t,e,r)=>e in t?rZ(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,sZ=(t,e,r)=>nZ(t,e+"",r);let iZ=class{constructor(e,r=lv){sZ(this,"baseChunkLogger"),this.baseChunkLogger=new KN(e,r)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}};var oZ=Object.defineProperty,aZ=Object.defineProperties,cZ=Object.getOwnPropertyDescriptors,Xx=Object.getOwnPropertySymbols,lZ=Object.prototype.hasOwnProperty,uZ=Object.prototype.propertyIsEnumerable,Zx=(t,e,r)=>e in t?oZ(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,lg=(t,e)=>{for(var r in e||(e={}))lZ.call(e,r)&&Zx(t,r,e[r]);if(Xx)for(var r of Xx(e))uZ.call(e,r)&&Zx(t,r,e[r]);return t},ug=(t,e)=>aZ(t,cZ(e));function dZ(t){return ug(lg({},t),{level:t?.level||VX.level})}function hZ(t,e,r=ay){return t[r]=e,t}function cs(t,e=ay){return t[e]||""}function fZ(t,e,r=ay){const n=cs(t,r);return n.trim()?`${n}/${e}`:e}function Ts(t,e,r=ay){const n=fZ(t,e,r),s=t.child({context:n});return hZ(s,n,r)}function pZ(t){var e,r;const n=new tZ((e=t.opts)==null?void 0:e.level,t.maxSizeInBytes);return{logger:VN(ug(lg({},t.opts),{level:"trace",browser:ug(lg({},(r=t.opts)==null?void 0:r.browser),{write:s=>n.write(s)})})),chunkLoggerController:n}}function gZ(t){var e;const r=new iZ((e=t.opts)==null?void 0:e.level,t.maxSizeInBytes);return{logger:VN(ug(lg({},t.opts),{level:"trace"}),r),chunkLoggerController:r}}function GN(t){return typeof t.loggerOverride<"u"&&typeof t.loggerOverride!="string"?{logger:t.loggerOverride,chunkLoggerController:null}:typeof window<"u"?pZ(t):gZ(t)}var yZ=Object.defineProperty,mZ=(t,e,r)=>e in t?yZ(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Jx=(t,e,r)=>mZ(t,typeof e!="symbol"?e+"":e,r);let wZ=class extends is{constructor(e){super(),this.opts=e,Jx(this,"protocol","wc"),Jx(this,"version",2)}};var bZ=Object.defineProperty,vZ=(t,e,r)=>e in t?bZ(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,EZ=(t,e,r)=>vZ(t,e+"",r);let _Z=class extends is{constructor(e,r){super(),this.core=e,this.logger=r,EZ(this,"records",new Map)}},xZ=class{constructor(e,r){this.logger=e,this.core=r}},SZ=class extends is{constructor(e,r){super(),this.relayer=e,this.logger=r}},AZ=class extends is{constructor(e){super()}},IZ=class{constructor(e,r,n,s){this.core=e,this.logger=r,this.name=n}},CZ=class extends is{constructor(e,r){super(),this.relayer=e,this.logger=r}},$Z=class extends is{constructor(e,r){super(),this.core=e,this.logger=r}},TZ=class{constructor(e,r,n){this.core=e,this.logger=r,this.store=n}},NZ=class{constructor(e,r){this.projectId=e,this.logger=r}},OZ=class{constructor(e,r,n){this.core=e,this.logger=r,this.telemetryEnabled=n}};var kZ=Object.defineProperty,PZ=(t,e,r)=>e in t?kZ(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Qx=(t,e,r)=>PZ(t,typeof e!="symbol"?e+"":e,r);let RZ=class{constructor(e){this.opts=e,Qx(this,"protocol","wc"),Qx(this,"version",2)}},DZ=class{constructor(e){this.client=e}};const UZ="0.1.1";function BZ(){return UZ}class rr extends Error{constructor(e,r={}){const n=(()=>{if(r.cause instanceof rr){if(r.cause.details)return r.cause.details;if(r.cause.shortMessage)return r.cause.shortMessage}return r.cause&&"details"in r.cause&&typeof r.cause.details=="string"?r.cause.details:r.cause?.message?r.cause.message:r.details})(),s=r.cause instanceof rr&&r.cause.docsPath||r.docsPath,o=`https://oxlib.sh${s??""}`,a=[e||"An error occurred.",...r.metaMessages?["",...r.metaMessages]:[],...n||s?["",n?`Details: ${n}`:void 0,s?`See: ${o}`:void 0]:[]].filter(c=>typeof c=="string").join(`
`);super(a,r.cause?{cause:r.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:`ox@${BZ()}`}),this.cause=r.cause,this.details=n,this.docs=o,this.docsPath=s,this.shortMessage=e}walk(e){return YN(this,e)}}function YN(t,e){return e?.(t)?t:t&&typeof t=="object"&&"cause"in t&&t.cause?YN(t.cause,e):e?null:t}const ml=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function LZ(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function fh(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function Lc(t,...e){if(!LZ(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function MZ(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");fh(t.outputLen),fh(t.blockLen)}function iu(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function XN(t,e){Lc(t);const r=e.outputLen;if(t.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}function jZ(t){return new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4))}function ou(...t){for(let e=0;e<t.length;e++)t[e].fill(0)}function iw(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Ci(t,e){return t<<32-e|t>>>e}const FZ=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function qZ(t){return t<<24&4278190080|t<<8&16711680|t>>>8&65280|t>>>24&255}function zZ(t){for(let e=0;e<t.length;e++)t[e]=qZ(t[e]);return t}const eS=FZ?t=>t:zZ;function HZ(t){if(typeof t!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(t))}function cy(t){return typeof t=="string"&&(t=HZ(t)),Lc(t),t}function WZ(...t){let e=0;for(let n=0;n<t.length;n++){const s=t[n];Lc(s),e+=s.length}const r=new Uint8Array(e);for(let n=0,s=0;n<t.length;n++){const i=t[n];r.set(i,s),s+=i.length}return r}class uv{}function ZN(t){const e=n=>t().update(cy(n)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function VZ(t=32){if(ml&&typeof ml.getRandomValues=="function")return ml.getRandomValues(new Uint8Array(t));if(ml&&typeof ml.randomBytes=="function")return Uint8Array.from(ml.randomBytes(t));throw new Error("crypto.getRandomValues must be defined")}function KZ(t,e,r,n){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,n);const s=BigInt(32),i=BigInt(4294967295),o=Number(r>>s&i),a=Number(r&i),c=n?4:0,l=n?0:4;t.setUint32(e+c,o,n),t.setUint32(e+l,a,n)}function GZ(t,e,r){return t&e^~t&r}function YZ(t,e,r){return t&e^t&r^e&r}class XZ extends uv{constructor(e,r,n,s){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=e,this.outputLen=r,this.padOffset=n,this.isLE=s,this.buffer=new Uint8Array(e),this.view=iw(this.buffer)}update(e){iu(this),e=cy(e),Lc(e);const{view:r,buffer:n,blockLen:s}=this,i=e.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const c=iw(e);for(;s<=i-o;o+=s)this.process(c,o);continue}n.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){iu(this),XN(e,this),this.finished=!0;const{buffer:r,view:n,blockLen:s,isLE:i}=this;let{pos:o}=this;r[o++]=128,ou(this.buffer.subarray(o)),this.padOffset>s-o&&(this.process(n,0),o=0);for(let d=o;d<s;d++)r[d]=0;KZ(n,s-8,BigInt(this.length*8),i),this.process(n,0);const a=iw(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=c/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<l;d++)a.setUint32(4*d,u[d],i)}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const n=e.slice(0,r);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:r,buffer:n,length:s,finished:i,destroyed:o,pos:a}=this;return e.destroyed=o,e.finished=i,e.length=s,e.pos=a,s%r&&e.buffer.set(n),e}clone(){return this._cloneInto()}}const Xo=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Uf=BigInt(2**32-1),tS=BigInt(32);function ZZ(t,e=!1){return e?{h:Number(t&Uf),l:Number(t>>tS&Uf)}:{h:Number(t>>tS&Uf)|0,l:Number(t&Uf)|0}}function JZ(t,e=!1){const r=t.length;let n=new Uint32Array(r),s=new Uint32Array(r);for(let i=0;i<r;i++){const{h:o,l:a}=ZZ(t[i],e);[n[i],s[i]]=[o,a]}return[n,s]}const QZ=(t,e,r)=>t<<r|e>>>32-r,eJ=(t,e,r)=>e<<r|t>>>32-r,tJ=(t,e,r)=>e<<r-32|t>>>64-r,rJ=(t,e,r)=>t<<r-32|e>>>64-r,nJ=BigInt(0),Ku=BigInt(1),sJ=BigInt(2),iJ=BigInt(7),oJ=BigInt(256),aJ=BigInt(113),JN=[],QN=[],eO=[];for(let t=0,e=Ku,r=1,n=0;t<24;t++){[r,n]=[n,(2*r+3*n)%5],JN.push(2*(5*n+r)),QN.push((t+1)*(t+2)/2%64);let s=nJ;for(let i=0;i<7;i++)e=(e<<Ku^(e>>iJ)*aJ)%oJ,e&sJ&&(s^=Ku<<(Ku<<BigInt(i))-Ku);eO.push(s)}const tO=JZ(eO,!0),cJ=tO[0],lJ=tO[1],rS=(t,e,r)=>r>32?tJ(t,e,r):QZ(t,e,r),nS=(t,e,r)=>r>32?rJ(t,e,r):eJ(t,e,r);function uJ(t,e=24){const r=new Uint32Array(10);for(let n=24-e;n<24;n++){for(let o=0;o<10;o++)r[o]=t[o]^t[o+10]^t[o+20]^t[o+30]^t[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,c=(o+2)%10,l=r[c],u=r[c+1],d=rS(l,u,1)^r[a],h=nS(l,u,1)^r[a+1];for(let p=0;p<50;p+=10)t[o+p]^=d,t[o+p+1]^=h}let s=t[2],i=t[3];for(let o=0;o<24;o++){const a=QN[o],c=rS(s,i,a),l=nS(s,i,a),u=JN[o];s=t[u],i=t[u+1],t[u]=c,t[u+1]=l}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)r[a]=t[o+a];for(let a=0;a<10;a++)t[o+a]^=~r[(a+2)%10]&r[(a+4)%10]}t[0]^=cJ[n],t[1]^=lJ[n]}ou(r)}class dv extends uv{constructor(e,r,n,s=!1,i=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=e,this.suffix=r,this.outputLen=n,this.enableXOF=s,this.rounds=i,fh(n),!(0<e&&e<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=jZ(this.state)}clone(){return this._cloneInto()}keccak(){eS(this.state32),uJ(this.state32,this.rounds),eS(this.state32),this.posOut=0,this.pos=0}update(e){iu(this),e=cy(e),Lc(e);const{blockLen:r,state:n}=this,s=e.length;for(let i=0;i<s;){const o=Math.min(r-this.pos,s-i);for(let a=0;a<o;a++)n[this.pos++]^=e[i++];this.pos===r&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:r,pos:n,blockLen:s}=this;e[n]^=r,(r&128)!==0&&n===s-1&&this.keccak(),e[s-1]^=128,this.keccak()}writeInto(e){iu(this,!1),Lc(e),this.finish();const r=this.state,{blockLen:n}=this;for(let s=0,i=e.length;s<i;){this.posOut>=n&&this.keccak();const o=Math.min(n-this.posOut,i-s);e.set(r.subarray(this.posOut,this.posOut+o),s),this.posOut+=o,s+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return fh(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(XN(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,ou(this.state)}_cloneInto(e){const{blockLen:r,suffix:n,outputLen:s,rounds:i,enableXOF:o}=this;return e||(e=new dv(r,n,s,o,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=n,e.outputLen=s,e.enableXOF=o,e.destroyed=this.destroyed,e}}const dJ=(t,e,r)=>ZN(()=>new dv(e,t,r)),hJ=dJ(1,136,256/8),fJ=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Zo=new Uint32Array(64);class pJ extends XZ{constructor(e=32){super(64,e,8,!1),this.A=Xo[0]|0,this.B=Xo[1]|0,this.C=Xo[2]|0,this.D=Xo[3]|0,this.E=Xo[4]|0,this.F=Xo[5]|0,this.G=Xo[6]|0,this.H=Xo[7]|0}get(){const{A:e,B:r,C:n,D:s,E:i,F:o,G:a,H:c}=this;return[e,r,n,s,i,o,a,c]}set(e,r,n,s,i,o,a,c){this.A=e|0,this.B=r|0,this.C=n|0,this.D=s|0,this.E=i|0,this.F=o|0,this.G=a|0,this.H=c|0}process(e,r){for(let d=0;d<16;d++,r+=4)Zo[d]=e.getUint32(r,!1);for(let d=16;d<64;d++){const h=Zo[d-15],p=Zo[d-2],y=Ci(h,7)^Ci(h,18)^h>>>3,g=Ci(p,17)^Ci(p,19)^p>>>10;Zo[d]=g+Zo[d-7]+y+Zo[d-16]|0}let{A:n,B:s,C:i,D:o,E:a,F:c,G:l,H:u}=this;for(let d=0;d<64;d++){const h=Ci(a,6)^Ci(a,11)^Ci(a,25),p=u+h+GZ(a,c,l)+fJ[d]+Zo[d]|0,g=(Ci(n,2)^Ci(n,13)^Ci(n,22))+YZ(n,s,i)|0;u=l,l=c,c=a,a=o+p|0,o=i,i=s,s=n,n=p+g|0}n=n+this.A|0,s=s+this.B|0,i=i+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,l=l+this.G|0,u=u+this.H|0,this.set(n,s,i,o,a,c,l,u)}roundClean(){ou(Zo)}destroy(){this.set(0,0,0,0,0,0,0,0),ou(this.buffer)}}const gJ=ZN(()=>new pJ);const hv=BigInt(0),hb=BigInt(1);function Hh(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function fv(t){if(!Hh(t))throw new Error("Uint8Array expected")}function ph(t,e){if(typeof e!="boolean")throw new Error(t+" boolean expected, got "+e)}function Bf(t){const e=t.toString(16);return e.length&1?"0"+e:e}function rO(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return t===""?hv:BigInt("0x"+t)}const nO=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",yJ=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function gh(t){if(fv(t),nO)return t.toHex();let e="";for(let r=0;r<t.length;r++)e+=yJ[t[r]];return e}const no={_0:48,_9:57,A:65,F:70,a:97,f:102};function sS(t){if(t>=no._0&&t<=no._9)return t-no._0;if(t>=no.A&&t<=no.F)return t-(no.A-10);if(t>=no.a&&t<=no.f)return t-(no.a-10)}function dg(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);if(nO)return Uint8Array.fromHex(t);const e=t.length,r=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(r);for(let s=0,i=0;s<r;s++,i+=2){const o=sS(t.charCodeAt(i)),a=sS(t.charCodeAt(i+1));if(o===void 0||a===void 0){const c=t[i]+t[i+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+i)}n[s]=o*16+a}return n}function Nc(t){return rO(gh(t))}function sO(t){return fv(t),rO(gh(Uint8Array.from(t).reverse()))}function Wh(t,e){return dg(t.toString(16).padStart(e*2,"0"))}function iO(t,e){return Wh(t,e).reverse()}function Ws(t,e,r){let n;if(typeof e=="string")try{n=dg(e)}catch(i){throw new Error(t+" must be hex string or Uint8Array, cause: "+i)}else if(Hh(e))n=Uint8Array.from(e);else throw new Error(t+" must be hex string or Uint8Array");const s=n.length;if(typeof r=="number"&&s!==r)throw new Error(t+" of length "+r+" expected, got "+s);return n}function hg(...t){let e=0;for(let n=0;n<t.length;n++){const s=t[n];fv(s),e+=s.length}const r=new Uint8Array(e);for(let n=0,s=0;n<t.length;n++){const i=t[n];r.set(i,s),s+=i.length}return r}const ow=t=>typeof t=="bigint"&&hv<=t;function pv(t,e,r){return ow(t)&&ow(e)&&ow(r)&&e<=t&&t<r}function jl(t,e,r,n){if(!pv(e,r,n))throw new Error("expected valid "+t+": "+r+" <= n < "+n+", got "+e)}function mJ(t){let e;for(e=0;t>hv;t>>=hb,e+=1);return e}const ly=t=>(hb<<BigInt(t))-hb,aw=t=>new Uint8Array(t),iS=t=>Uint8Array.from(t);function wJ(t,e,r){if(typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof r!="function")throw new Error("hmacFn must be a function");let n=aw(t),s=aw(t),i=0;const o=()=>{n.fill(1),s.fill(0),i=0},a=(...d)=>r(s,n,...d),c=(d=aw(0))=>{s=a(iS([0]),d),n=a(),d.length!==0&&(s=a(iS([1]),d),n=a())},l=()=>{if(i++>=1e3)throw new Error("drbg: tried 1000 values");let d=0;const h=[];for(;d<e;){n=a();const p=n.slice();h.push(p),d+=n.length}return hg(...h)};return(d,h)=>{o(),c(d);let p;for(;!(p=h(l()));)c();return o(),p}}const bJ={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||Hh(t),isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function uy(t,e,r={}){const n=(s,i,o)=>{const a=bJ[i];if(typeof a!="function")throw new Error("invalid validator function");const c=t[s];if(!(o&&c===void 0)&&!a(c,t))throw new Error("param "+String(s)+" is invalid. Expected "+i+", got "+c)};for(const[s,i]of Object.entries(e))n(s,i,!1);for(const[s,i]of Object.entries(r))n(s,i,!0);return t}function oS(t){const e=new WeakMap;return(r,...n)=>{const s=e.get(r);if(s!==void 0)return s;const i=t(r,...n);return e.set(r,i),i}}function vJ(t,e){if(uS(t)>e)throw new FJ({givenSize:uS(t),maxSize:e})}const so={zero:48,nine:57,A:65,F:70,a:97,f:102};function aS(t){if(t>=so.zero&&t<=so.nine)return t-so.zero;if(t>=so.A&&t<=so.F)return t-(so.A-10);if(t>=so.a&&t<=so.f)return t-(so.a-10)}function EJ(t,e={}){const{dir:r,size:n=32}=e;if(n===0)return t;if(t.length>n)throw new qJ({size:t.length,targetSize:n,type:"Bytes"});const s=new Uint8Array(n);for(let i=0;i<n;i++){const o=r==="right";s[o?i:n-i-1]=t[o?i:t.length-i-1]}return s}function oO(t,e){if(Oa(t)>e)throw new OJ({givenSize:Oa(t),maxSize:e})}function _J(t,e){if(typeof e=="number"&&e>0&&e>Oa(t)-1)throw new lO({offset:e,position:"start",size:Oa(t)})}function xJ(t,e,r){if(typeof e=="number"&&typeof r=="number"&&Oa(t)!==r-e)throw new lO({offset:r,position:"end",size:Oa(t)})}function aO(t,e={}){const{dir:r,size:n=32}=e;if(n===0)return t;const s=t.replace("0x","");if(s.length>n*2)throw new kJ({size:Math.ceil(s.length/2),targetSize:n,type:"Hex"});return`0x${s[r==="right"?"padEnd":"padStart"](n*2,"0")}`}const SJ="#__bigint";function gv(t,e,r){return JSON.stringify(t,(n,s)=>typeof s=="bigint"?s.toString()+SJ:s,r)}const AJ=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function IJ(t,e={}){const{strict:r=!1}=e;if(!t)throw new cS(t);if(typeof t!="string")throw new cS(t);if(r&&!/^0x[0-9a-fA-F]*$/.test(t))throw new lS(t);if(!t.startsWith("0x"))throw new lS(t)}function CJ(...t){return`0x${t.reduce((e,r)=>e+r.replace("0x",""),"")}`}function yv(t){return t instanceof Uint8Array?fg(t):Array.isArray(t)?fg(new Uint8Array(t)):t}function fg(t,e={}){let r="";for(let s=0;s<t.length;s++)r+=AJ[t[s]];const n=`0x${r}`;return typeof e.size=="number"?(oO(n,e.size),cO(n,e.size)):n}function cw(t,e={}){const{signed:r,size:n}=e,s=BigInt(t);let i;n?r?i=(1n<<BigInt(n)*8n-1n)-1n:i=2n**(BigInt(n)*8n)-1n:typeof t=="number"&&(i=BigInt(Number.MAX_SAFE_INTEGER));const o=typeof i=="bigint"&&r?-i-1n:0;if(i&&s>i||s<o){const l=typeof t=="bigint"?"n":"";throw new NJ({max:i?`${i}${l}`:void 0,min:`${o}${l}`,signed:r,size:n,value:`${t}${l}`})}const c=`0x${(r&&s<0?(1n<<BigInt(n*8))+BigInt(s):s).toString(16)}`;return n?$J(c,n):c}function $J(t,e){return aO(t,{dir:"left",size:e})}function cO(t,e){return aO(t,{dir:"right",size:e})}function po(t,e,r,n={}){const{strict:s}=n;_J(t,e);const i=`0x${t.replace("0x","").slice((e??0)*2,(r??t.length)*2)}`;return s&&xJ(i,e,r),i}function Oa(t){return Math.ceil((t.length-2)/2)}function TJ(t,e={}){const{strict:r=!1}=e;try{return IJ(t,{strict:r}),!0}catch{return!1}}class NJ extends rr{constructor({max:e,min:r,signed:n,size:s,value:i}){super(`Number \`${i}\` is not in safe${s?` ${s*8}-bit`:""}${n?" signed":" unsigned"} integer range ${e?`(\`${r}\` to \`${e}\`)`:`(above \`${r}\`)`}`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.IntegerOutOfRangeError"})}}class cS extends rr{constructor(e){super(`Value \`${typeof e=="object"?gv(e):e}\` of type \`${typeof e}\` is an invalid hex type.`,{metaMessages:['Hex types must be represented as `"0x${string}"`.']}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.InvalidHexTypeError"})}}class lS extends rr{constructor(e){super(`Value \`${e}\` is an invalid hex value.`,{metaMessages:['Hex values must start with `"0x"` and contain only hexadecimal characters (0-9, a-f, A-F).']}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.InvalidHexValueError"})}}let OJ=class extends rr{constructor({givenSize:e,maxSize:r}){super(`Size cannot exceed \`${r}\` bytes. Given size: \`${e}\` bytes.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SizeOverflowError"})}};class lO extends rr{constructor({offset:e,position:r,size:n}){super(`Slice ${r==="start"?"starting":"ending"} at offset \`${e}\` is out-of-bounds (size: \`${n}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SliceOffsetOutOfBoundsError"})}}let kJ=class extends rr{constructor({size:e,targetSize:r,type:n}){super(`${n.charAt(0).toUpperCase()}${n.slice(1).toLowerCase()} size (\`${e}\`) exceeds padding size (\`${r}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SizeExceedsPaddingSizeError"})}};const PJ=new TextEncoder;function RJ(t){if(!(t instanceof Uint8Array)){if(!t)throw new Lf(t);if(typeof t!="object")throw new Lf(t);if(!("BYTES_PER_ELEMENT"in t))throw new Lf(t);if(t.BYTES_PER_ELEMENT!==1||t.constructor.name!=="Uint8Array")throw new Lf(t)}}function DJ(t){return t instanceof Uint8Array?t:typeof t=="string"?BJ(t):UJ(t)}function UJ(t){return t instanceof Uint8Array?t:new Uint8Array(t)}function BJ(t,e={}){const{size:r}=e;let n=t;r&&(oO(t,r),n=cO(t,r));let s=n.slice(2);s.length%2&&(s=`0${s}`);const i=s.length/2,o=new Uint8Array(i);for(let a=0,c=0;a<i;a++){const l=aS(s.charCodeAt(c++)),u=aS(s.charCodeAt(c++));if(l===void 0||u===void 0)throw new rr(`Invalid byte sequence ("${s[c-2]}${s[c-1]}" in "${s}").`);o[a]=l*16+u}return o}function LJ(t,e={}){const{size:r}=e,n=PJ.encode(t);return typeof r=="number"?(vJ(n,r),MJ(n,r)):n}function MJ(t,e){return EJ(t,{dir:"right",size:e})}function uS(t){return t.length}function jJ(t){try{return RJ(t),!0}catch{return!1}}class Lf extends rr{constructor(e){super(`Value \`${typeof e=="object"?gv(e):e}\` of type \`${typeof e}\` is an invalid Bytes value.`,{metaMessages:["Bytes values must be of type `Bytes`."]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Bytes.InvalidBytesTypeError"})}}class FJ extends rr{constructor({givenSize:e,maxSize:r}){super(`Size cannot exceed \`${r}\` bytes. Given size: \`${e}\` bytes.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Bytes.SizeOverflowError"})}}class qJ extends rr{constructor({size:e,targetSize:r,type:n}){super(`${n.charAt(0).toUpperCase()}${n.slice(1).toLowerCase()} size (\`${e}\`) exceeds padding size (\`${r}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Bytes.SizeExceedsPaddingSizeError"})}}function uO(t,e={}){const{as:r=typeof t=="string"?"Hex":"Bytes"}=e,n=hJ(DJ(t));return r==="Bytes"?n:fg(n)}class zJ extends Map{constructor(e){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=e}get(e){const r=super.get(e);return super.has(e)&&r!==void 0&&(this.delete(e),super.set(e,r)),r}set(e,r){if(super.set(e,r),this.maxSize&&this.size>this.maxSize){const n=this.keys().next().value;n&&this.delete(n)}return this}}const HJ={checksum:new zJ(8192)},lw=HJ.checksum;function dO(t,e={}){const{compressed:r}=e,{prefix:n,x:s,y:i}=t;if(r===!1||typeof s=="bigint"&&typeof i=="bigint"){if(n!==4)throw new dS({prefix:n,cause:new XJ});return}if(r===!0||typeof s=="bigint"&&typeof i>"u"){if(n!==3&&n!==2)throw new dS({prefix:n,cause:new YJ});return}throw new GJ({publicKey:t})}function WJ(t){const e=(()=>{if(TJ(t))return hO(t);if(jJ(t))return VJ(t);const{prefix:r,x:n,y:s}=t;return typeof n=="bigint"&&typeof s=="bigint"?{prefix:r??4,x:n,y:s}:{prefix:r,x:n}})();return dO(e),e}function VJ(t){return hO(fg(t))}function hO(t){if(t.length!==132&&t.length!==130&&t.length!==68)throw new ZJ({publicKey:t});if(t.length===130){const n=BigInt(po(t,0,32)),s=BigInt(po(t,32,64));return{prefix:4,x:n,y:s}}if(t.length===132){const n=Number(po(t,0,1)),s=BigInt(po(t,1,33)),i=BigInt(po(t,33,65));return{prefix:n,x:s,y:i}}const e=Number(po(t,0,1)),r=BigInt(po(t,1,33));return{prefix:e,x:r}}function KJ(t,e={}){dO(t);const{prefix:r,x:n,y:s}=t,{includePrefix:i=!0}=e;return CJ(i?cw(r,{size:1}):"0x",cw(n,{size:32}),typeof s=="bigint"?cw(s,{size:32}):"0x")}class GJ extends rr{constructor({publicKey:e}){super(`Value \`${gv(e)}\` is not a valid public key.`,{metaMessages:["Public key must contain:","- an `x` and `prefix` value (compressed)","- an `x`, `y`, and `prefix` value (uncompressed)"]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidError"})}}class dS extends rr{constructor({prefix:e,cause:r}){super(`Prefix "${e}" is invalid.`,{cause:r}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidPrefixError"})}}class YJ extends rr{constructor(){super("Prefix must be 2 or 3 for compressed public keys."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidCompressedPrefixError"})}}class XJ extends rr{constructor(){super("Prefix must be 4 for uncompressed public keys."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidUncompressedPrefixError"})}}let ZJ=class extends rr{constructor({publicKey:e}){super(`Value \`${e}\` is an invalid public key size.`,{metaMessages:["Expected: 33 bytes (compressed + prefix), 64 bytes (uncompressed) or 65 bytes (uncompressed + prefix).",`Received ${Oa(yv(e))} bytes.`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidSerializedSizeError"})}};const JJ=/^0x[a-fA-F0-9]{40}$/;function fO(t,e={}){const{strict:r=!0}=e;if(!JJ.test(t))throw new hS({address:t,cause:new tQ});if(r){if(t.toLowerCase()===t)return;if(pO(t)!==t)throw new hS({address:t,cause:new rQ})}}function pO(t){if(lw.has(t))return lw.get(t);fO(t,{strict:!1});const e=t.substring(2).toLowerCase(),r=uO(LJ(e),{as:"Bytes"}),n=e.split("");for(let i=0;i<40;i+=2)r[i>>1]>>4>=8&&n[i]&&(n[i]=n[i].toUpperCase()),(r[i>>1]&15)>=8&&n[i+1]&&(n[i+1]=n[i+1].toUpperCase());const s=`0x${n.join("")}`;return lw.set(t,s),s}function QJ(t,e={}){const{checksum:r=!1}=e;return fO(t),r?pO(t):t}function eQ(t,e={}){const r=uO(`0x${KJ(t).slice(4)}`).substring(26);return QJ(`0x${r}`,e)}class hS extends rr{constructor({address:e,cause:r}){super(`Address "${e}" is invalid.`,{cause:r}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Address.InvalidAddressError"})}}class tQ extends rr{constructor(){super("Address is not a 20 byte (40 hexadecimal character) value."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Address.InvalidInputError"})}}class rQ extends rr{constructor(){super("Address does not match its checksum counterpart."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Address.InvalidChecksumError"})}}class gO extends uv{constructor(e,r){super(),this.finished=!1,this.destroyed=!1,MZ(e);const n=cy(r);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const s=this.blockLen,i=new Uint8Array(s);i.set(n.length>s?e.create().update(n).digest():n);for(let o=0;o<i.length;o++)i[o]^=54;this.iHash.update(i),this.oHash=e.create();for(let o=0;o<i.length;o++)i[o]^=106;this.oHash.update(i),ou(i)}update(e){return iu(this),this.iHash.update(e),this}digestInto(e){iu(this),Lc(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:r,iHash:n,finished:s,destroyed:i,blockLen:o,outputLen:a}=this;return e=e,e.finished=s,e.destroyed=i,e.blockLen=o,e.outputLen=a,e.oHash=r._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const yO=(t,e,r)=>new gO(t,e).update(r).digest();yO.create=(t,e)=>new gO(t,e);const rs=BigInt(0),Rn=BigInt(1),wc=BigInt(2),nQ=BigInt(3),mO=BigInt(4),wO=BigInt(5),bO=BigInt(8);function Zn(t,e){const r=t%e;return r>=rs?r:e+r}function Ds(t,e,r){let n=t;for(;e-- >rs;)n*=n,n%=r;return n}function fb(t,e){if(t===rs)throw new Error("invert: expected non-zero number");if(e<=rs)throw new Error("invert: expected positive modulus, got "+e);let r=Zn(t,e),n=e,s=rs,i=Rn;for(;r!==rs;){const a=n/r,c=n%r,l=s-i*a;n=r,r=c,s=i,i=l}if(n!==Rn)throw new Error("invert: does not exist");return Zn(s,e)}function vO(t,e){const r=(t.ORDER+Rn)/mO,n=t.pow(e,r);if(!t.eql(t.sqr(n),e))throw new Error("Cannot find square root");return n}function sQ(t,e){const r=(t.ORDER-wO)/bO,n=t.mul(e,wc),s=t.pow(n,r),i=t.mul(e,s),o=t.mul(t.mul(i,wc),s),a=t.mul(i,t.sub(o,t.ONE));if(!t.eql(t.sqr(a),e))throw new Error("Cannot find square root");return a}function iQ(t){if(t<BigInt(3))throw new Error("sqrt is not defined for small field");let e=t-Rn,r=0;for(;e%wc===rs;)e/=wc,r++;let n=wc;const s=mv(t);for(;fS(s,n)===1;)if(n++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(r===1)return vO;let i=s.pow(n,e);const o=(e+Rn)/wc;return function(c,l){if(c.is0(l))return l;if(fS(c,l)!==1)throw new Error("Cannot find square root");let u=r,d=c.mul(c.ONE,i),h=c.pow(l,e),p=c.pow(l,o);for(;!c.eql(h,c.ONE);){if(c.is0(h))return c.ZERO;let y=1,g=c.sqr(h);for(;!c.eql(g,c.ONE);)if(y++,g=c.sqr(g),y===u)throw new Error("Cannot find square root");const w=Rn<<BigInt(u-y-1),S=c.pow(d,w);u=y,d=c.sqr(S),h=c.mul(h,d),p=c.mul(p,S)}return p}}function oQ(t){return t%mO===nQ?vO:t%bO===wO?sQ:iQ(t)}const aQ=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function cQ(t){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},r=aQ.reduce((n,s)=>(n[s]="function",n),e);return uy(t,r)}function lQ(t,e,r){if(r<rs)throw new Error("invalid exponent, negatives unsupported");if(r===rs)return t.ONE;if(r===Rn)return e;let n=t.ONE,s=e;for(;r>rs;)r&Rn&&(n=t.mul(n,s)),s=t.sqr(s),r>>=Rn;return n}function EO(t,e,r=!1){const n=new Array(e.length).fill(r?t.ZERO:void 0),s=e.reduce((o,a,c)=>t.is0(a)?o:(n[c]=o,t.mul(o,a)),t.ONE),i=t.inv(s);return e.reduceRight((o,a,c)=>t.is0(a)?o:(n[c]=t.mul(o,n[c]),t.mul(o,a)),i),n}function fS(t,e){const r=(t.ORDER-Rn)/wc,n=t.pow(e,r),s=t.eql(n,t.ONE),i=t.eql(n,t.ZERO),o=t.eql(n,t.neg(t.ONE));if(!s&&!i&&!o)throw new Error("invalid Legendre symbol result");return s?1:i?0:-1}function _O(t,e){e!==void 0&&fh(e);const r=e!==void 0?e:t.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}function mv(t,e,r=!1,n={}){if(t<=rs)throw new Error("invalid field: expected ORDER > 0, got "+t);const{nBitLength:s,nByteLength:i}=_O(t,e);if(i>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let o;const a=Object.freeze({ORDER:t,isLE:r,BITS:s,BYTES:i,MASK:ly(s),ZERO:rs,ONE:Rn,create:c=>Zn(c,t),isValid:c=>{if(typeof c!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof c);return rs<=c&&c<t},is0:c=>c===rs,isOdd:c=>(c&Rn)===Rn,neg:c=>Zn(-c,t),eql:(c,l)=>c===l,sqr:c=>Zn(c*c,t),add:(c,l)=>Zn(c+l,t),sub:(c,l)=>Zn(c-l,t),mul:(c,l)=>Zn(c*l,t),pow:(c,l)=>lQ(a,c,l),div:(c,l)=>Zn(c*fb(l,t),t),sqrN:c=>c*c,addN:(c,l)=>c+l,subN:(c,l)=>c-l,mulN:(c,l)=>c*l,inv:c=>fb(c,t),sqrt:n.sqrt||(c=>(o||(o=oQ(t)),o(a,c))),toBytes:c=>r?iO(c,i):Wh(c,i),fromBytes:c=>{if(c.length!==i)throw new Error("Field.fromBytes: expected "+i+" bytes, got "+c.length);return r?sO(c):Nc(c)},invertBatch:c=>EO(a,c),cmov:(c,l,u)=>u?l:c});return Object.freeze(a)}function xO(t){if(typeof t!="bigint")throw new Error("field order must be bigint");const e=t.toString(2).length;return Math.ceil(e/8)}function SO(t){const e=xO(t);return e+Math.ceil(e/2)}function uQ(t,e,r=!1){const n=t.length,s=xO(e),i=SO(e);if(n<16||n<i||n>1024)throw new Error("expected "+i+"-1024 bytes of input, got "+n);const o=r?sO(t):Nc(t),a=Zn(o,e-Rn)+Rn;return r?iO(a,s):Wh(a,s)}const pS=BigInt(0),pb=BigInt(1);function uw(t,e){const r=e.negate();return t?r:e}function AO(t,e){if(!Number.isSafeInteger(t)||t<=0||t>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+t)}function dw(t,e){AO(t,e);const r=Math.ceil(e/t)+1,n=2**(t-1),s=2**t,i=ly(t),o=BigInt(t);return{windows:r,windowSize:n,mask:i,maxNumber:s,shiftBy:o}}function gS(t,e,r){const{windowSize:n,mask:s,maxNumber:i,shiftBy:o}=r;let a=Number(t&s),c=t>>o;a>n&&(a-=i,c+=pb);const l=e*n,u=l+Math.abs(a)-1,d=a===0,h=a<0,p=e%2!==0;return{nextN:c,offset:u,isZero:d,isNeg:h,isNegF:p,offsetF:l}}function dQ(t,e){if(!Array.isArray(t))throw new Error("array expected");t.forEach((r,n)=>{if(!(r instanceof e))throw new Error("invalid point at index "+n)})}function hQ(t,e){if(!Array.isArray(t))throw new Error("array of scalars expected");t.forEach((r,n)=>{if(!e.isValid(r))throw new Error("invalid scalar at index "+n)})}const hw=new WeakMap,IO=new WeakMap;function fw(t){return IO.get(t)||1}function fQ(t,e){return{constTimeNegate:uw,hasPrecomputes(r){return fw(r)!==1},unsafeLadder(r,n,s=t.ZERO){let i=r;for(;n>pS;)n&pb&&(s=s.add(i)),i=i.double(),n>>=pb;return s},precomputeWindow(r,n){const{windows:s,windowSize:i}=dw(n,e),o=[];let a=r,c=a;for(let l=0;l<s;l++){c=a,o.push(c);for(let u=1;u<i;u++)c=c.add(a),o.push(c);a=c.double()}return o},wNAF(r,n,s){let i=t.ZERO,o=t.BASE;const a=dw(r,e);for(let c=0;c<a.windows;c++){const{nextN:l,offset:u,isZero:d,isNeg:h,isNegF:p,offsetF:y}=gS(s,c,a);s=l,d?o=o.add(uw(p,n[y])):i=i.add(uw(h,n[u]))}return{p:i,f:o}},wNAFUnsafe(r,n,s,i=t.ZERO){const o=dw(r,e);for(let a=0;a<o.windows&&s!==pS;a++){const{nextN:c,offset:l,isZero:u,isNeg:d}=gS(s,a,o);if(s=c,!u){const h=n[l];i=i.add(d?h.negate():h)}}return i},getPrecomputes(r,n,s){let i=hw.get(n);return i||(i=this.precomputeWindow(n,r),r!==1&&hw.set(n,s(i))),i},wNAFCached(r,n,s){const i=fw(r);return this.wNAF(i,this.getPrecomputes(i,r,s),n)},wNAFCachedUnsafe(r,n,s,i){const o=fw(r);return o===1?this.unsafeLadder(r,n,i):this.wNAFUnsafe(o,this.getPrecomputes(o,r,s),n,i)},setWindowSize(r,n){AO(n,e),IO.set(r,n),hw.delete(r)}}}function pQ(t,e,r,n){dQ(r,t),hQ(n,e);const s=r.length,i=n.length;if(s!==i)throw new Error("arrays of points and scalars must have equal length");const o=t.ZERO,a=mJ(BigInt(s));let c=1;a>12?c=a-3:a>4?c=a-2:a>0&&(c=2);const l=ly(c),u=new Array(Number(l)+1).fill(o),d=Math.floor((e.BITS-1)/c)*c;let h=o;for(let p=d;p>=0;p-=c){u.fill(o);for(let g=0;g<i;g++){const w=n[g],S=Number(w>>BigInt(p)&l);u[S]=u[S].add(r[g])}let y=o;for(let g=u.length-1,w=o;g>0;g--)w=w.add(u[g]),y=y.add(w);if(h=h.add(y),p!==0)for(let g=0;g<c;g++)h=h.double()}return h}function CO(t){return cQ(t.Fp),uy(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({..._O(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}function yS(t){t.lowS!==void 0&&ph("lowS",t.lowS),t.prehash!==void 0&&ph("prehash",t.prehash)}function gQ(t){const e=CO(t);uy(e,{a:"field",b:"field"},{allowInfinityPoint:"boolean",allowedPrivateKeyLengths:"array",clearCofactor:"function",fromBytes:"function",isTorsionFree:"function",toBytes:"function",wrapPrivateKey:"boolean"});const{endo:r,Fp:n,a:s}=e;if(r){if(!n.eql(s,n.ZERO))throw new Error("invalid endo: CURVE.a must be 0");if(typeof r!="object"||typeof r.beta!="bigint"||typeof r.splitScalar!="function")throw new Error('invalid endo: expected "beta": bigint and "splitScalar": function')}return Object.freeze({...e})}class yQ extends Error{constructor(e=""){super(e)}}const bo={Err:yQ,_tlv:{encode:(t,e)=>{const{Err:r}=bo;if(t<0||t>256)throw new r("tlv.encode: wrong tag");if(e.length&1)throw new r("tlv.encode: unpadded data");const n=e.length/2,s=Bf(n);if(s.length/2&128)throw new r("tlv.encode: long form length too big");const i=n>127?Bf(s.length/2|128):"";return Bf(t)+i+s+e},decode(t,e){const{Err:r}=bo;let n=0;if(t<0||t>256)throw new r("tlv.encode: wrong tag");if(e.length<2||e[n++]!==t)throw new r("tlv.decode: wrong tlv");const s=e[n++],i=!!(s&128);let o=0;if(!i)o=s;else{const c=s&127;if(!c)throw new r("tlv.decode(long): indefinite length not supported");if(c>4)throw new r("tlv.decode(long): byte length is too big");const l=e.subarray(n,n+c);if(l.length!==c)throw new r("tlv.decode: length bytes not complete");if(l[0]===0)throw new r("tlv.decode(long): zero leftmost byte");for(const u of l)o=o<<8|u;if(n+=c,o<128)throw new r("tlv.decode(long): not minimal encoding")}const a=e.subarray(n,n+o);if(a.length!==o)throw new r("tlv.decode: wrong value length");return{v:a,l:e.subarray(n+o)}}},_int:{encode(t){const{Err:e}=bo;if(t<So)throw new e("integer: negative integers are not allowed");let r=Bf(t);if(Number.parseInt(r[0],16)&8&&(r="00"+r),r.length&1)throw new e("unexpected DER parsing assertion: unpadded hex");return r},decode(t){const{Err:e}=bo;if(t[0]&128)throw new e("invalid signature integer: negative");if(t[0]===0&&!(t[1]&128))throw new e("invalid signature integer: unnecessary leading zero");return Nc(t)}},toSig(t){const{Err:e,_int:r,_tlv:n}=bo,s=Ws("signature",t),{v:i,l:o}=n.decode(48,s);if(o.length)throw new e("invalid signature: left bytes after parsing");const{v:a,l:c}=n.decode(2,i),{v:l,l:u}=n.decode(2,c);if(u.length)throw new e("invalid signature: left bytes after parsing");return{r:r.decode(a),s:r.decode(l)}},hexFromSig(t){const{_tlv:e,_int:r}=bo,n=e.encode(2,r.encode(t.r)),s=e.encode(2,r.encode(t.s)),i=n+s;return e.encode(48,i)}};function pw(t,e){return gh(Wh(t,e))}const So=BigInt(0),Wr=BigInt(1);BigInt(2);const gw=BigInt(3),mQ=BigInt(4);function wQ(t){const e=gQ(t),{Fp:r}=e,n=mv(e.n,e.nBitLength),s=e.toBytes||((E,v,C)=>{const O=v.toAffine();return hg(Uint8Array.from([4]),r.toBytes(O.x),r.toBytes(O.y))}),i=e.fromBytes||(E=>{const v=E.subarray(1),C=r.fromBytes(v.subarray(0,r.BYTES)),O=r.fromBytes(v.subarray(r.BYTES,2*r.BYTES));return{x:C,y:O}});function o(E){const{a:v,b:C}=e,O=r.sqr(E),L=r.mul(O,E);return r.add(r.add(L,r.mul(E,v)),C)}function a(E,v){const C=r.sqr(v),O=o(E);return r.eql(C,O)}if(!a(e.Gx,e.Gy))throw new Error("bad curve params: generator point");const c=r.mul(r.pow(e.a,gw),mQ),l=r.mul(r.sqr(e.b),BigInt(27));if(r.is0(r.add(c,l)))throw new Error("bad curve params: a or b");function u(E){return pv(E,Wr,e.n)}function d(E){const{allowedPrivateKeyLengths:v,nByteLength:C,wrapPrivateKey:O,n:L}=e;if(v&&typeof E!="bigint"){if(Hh(E)&&(E=gh(E)),typeof E!="string"||!v.includes(E.length))throw new Error("invalid private key");E=E.padStart(C*2,"0")}let j;try{j=typeof E=="bigint"?E:Nc(Ws("private key",E,C))}catch{throw new Error("invalid private key, expected hex or "+C+" bytes, got "+typeof E)}return O&&(j=Zn(j,L)),jl("private key",j,Wr,L),j}function h(E){if(!(E instanceof g))throw new Error("ProjectivePoint expected")}const p=oS((E,v)=>{const{px:C,py:O,pz:L}=E;if(r.eql(L,r.ONE))return{x:C,y:O};const j=E.is0();v==null&&(v=j?r.ONE:r.inv(L));const D=r.mul(C,v),W=r.mul(O,v),P=r.mul(L,v);if(j)return{x:r.ZERO,y:r.ZERO};if(!r.eql(P,r.ONE))throw new Error("invZ was invalid");return{x:D,y:W}}),y=oS(E=>{if(E.is0()){if(e.allowInfinityPoint&&!r.is0(E.py))return;throw new Error("bad point: ZERO")}const{x:v,y:C}=E.toAffine();if(!r.isValid(v)||!r.isValid(C))throw new Error("bad point: x or y not FE");if(!a(v,C))throw new Error("bad point: equation left != right");if(!E.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});class g{constructor(v,C,O){if(v==null||!r.isValid(v))throw new Error("x required");if(C==null||!r.isValid(C)||r.is0(C))throw new Error("y required");if(O==null||!r.isValid(O))throw new Error("z required");this.px=v,this.py=C,this.pz=O,Object.freeze(this)}static fromAffine(v){const{x:C,y:O}=v||{};if(!v||!r.isValid(C)||!r.isValid(O))throw new Error("invalid affine point");if(v instanceof g)throw new Error("projective point not allowed");const L=j=>r.eql(j,r.ZERO);return L(C)&&L(O)?g.ZERO:new g(C,O,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(v){const C=EO(r,v.map(O=>O.pz));return v.map((O,L)=>O.toAffine(C[L])).map(g.fromAffine)}static fromHex(v){const C=g.fromAffine(i(Ws("pointHex",v)));return C.assertValidity(),C}static fromPrivateKey(v){return g.BASE.multiply(d(v))}static msm(v,C){return pQ(g,n,v,C)}_setWindowSize(v){A.setWindowSize(this,v)}assertValidity(){y(this)}hasEvenY(){const{y:v}=this.toAffine();if(r.isOdd)return!r.isOdd(v);throw new Error("Field doesn't support isOdd")}equals(v){h(v);const{px:C,py:O,pz:L}=this,{px:j,py:D,pz:W}=v,P=r.eql(r.mul(C,W),r.mul(j,L)),R=r.eql(r.mul(O,W),r.mul(D,L));return P&&R}negate(){return new g(this.px,r.neg(this.py),this.pz)}double(){const{a:v,b:C}=e,O=r.mul(C,gw),{px:L,py:j,pz:D}=this;let W=r.ZERO,P=r.ZERO,R=r.ZERO,T=r.mul(L,L),k=r.mul(j,j),f=r.mul(D,D),m=r.mul(L,j);return m=r.add(m,m),R=r.mul(L,D),R=r.add(R,R),W=r.mul(v,R),P=r.mul(O,f),P=r.add(W,P),W=r.sub(k,P),P=r.add(k,P),P=r.mul(W,P),W=r.mul(m,W),R=r.mul(O,R),f=r.mul(v,f),m=r.sub(T,f),m=r.mul(v,m),m=r.add(m,R),R=r.add(T,T),T=r.add(R,T),T=r.add(T,f),T=r.mul(T,m),P=r.add(P,T),f=r.mul(j,D),f=r.add(f,f),T=r.mul(f,m),W=r.sub(W,T),R=r.mul(f,k),R=r.add(R,R),R=r.add(R,R),new g(W,P,R)}add(v){h(v);const{px:C,py:O,pz:L}=this,{px:j,py:D,pz:W}=v;let P=r.ZERO,R=r.ZERO,T=r.ZERO;const k=e.a,f=r.mul(e.b,gw);let m=r.mul(C,j),_=r.mul(O,D),$=r.mul(L,W),x=r.add(C,O),N=r.add(j,D);x=r.mul(x,N),N=r.add(m,_),x=r.sub(x,N),N=r.add(C,L);let H=r.add(j,W);return N=r.mul(N,H),H=r.add(m,$),N=r.sub(N,H),H=r.add(O,L),P=r.add(D,W),H=r.mul(H,P),P=r.add(_,$),H=r.sub(H,P),T=r.mul(k,N),P=r.mul(f,$),T=r.add(P,T),P=r.sub(_,T),T=r.add(_,T),R=r.mul(P,T),_=r.add(m,m),_=r.add(_,m),$=r.mul(k,$),N=r.mul(f,N),_=r.add(_,$),$=r.sub(m,$),$=r.mul(k,$),N=r.add(N,$),m=r.mul(_,N),R=r.add(R,m),m=r.mul(H,N),P=r.mul(x,P),P=r.sub(P,m),m=r.mul(x,_),T=r.mul(H,T),T=r.add(T,m),new g(P,R,T)}subtract(v){return this.add(v.negate())}is0(){return this.equals(g.ZERO)}wNAF(v){return A.wNAFCached(this,v,g.normalizeZ)}multiplyUnsafe(v){const{endo:C,n:O}=e;jl("scalar",v,So,O);const L=g.ZERO;if(v===So)return L;if(this.is0()||v===Wr)return this;if(!C||A.hasPrecomputes(this))return A.wNAFCachedUnsafe(this,v,g.normalizeZ);let{k1neg:j,k1:D,k2neg:W,k2:P}=C.splitScalar(v),R=L,T=L,k=this;for(;D>So||P>So;)D&Wr&&(R=R.add(k)),P&Wr&&(T=T.add(k)),k=k.double(),D>>=Wr,P>>=Wr;return j&&(R=R.negate()),W&&(T=T.negate()),T=new g(r.mul(T.px,C.beta),T.py,T.pz),R.add(T)}multiply(v){const{endo:C,n:O}=e;jl("scalar",v,Wr,O);let L,j;if(C){const{k1neg:D,k1:W,k2neg:P,k2:R}=C.splitScalar(v);let{p:T,f:k}=this.wNAF(W),{p:f,f:m}=this.wNAF(R);T=A.constTimeNegate(D,T),f=A.constTimeNegate(P,f),f=new g(r.mul(f.px,C.beta),f.py,f.pz),L=T.add(f),j=k.add(m)}else{const{p:D,f:W}=this.wNAF(v);L=D,j=W}return g.normalizeZ([L,j])[0]}multiplyAndAddUnsafe(v,C,O){const L=g.BASE,j=(W,P)=>P===So||P===Wr||!W.equals(L)?W.multiplyUnsafe(P):W.multiply(P),D=j(this,C).add(j(v,O));return D.is0()?void 0:D}toAffine(v){return p(this,v)}isTorsionFree(){const{h:v,isTorsionFree:C}=e;if(v===Wr)return!0;if(C)return C(g,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:v,clearCofactor:C}=e;return v===Wr?this:C?C(g,this):this.multiplyUnsafe(e.h)}toRawBytes(v=!0){return ph("isCompressed",v),this.assertValidity(),s(g,this,v)}toHex(v=!0){return ph("isCompressed",v),gh(this.toRawBytes(v))}}g.BASE=new g(e.Gx,e.Gy,r.ONE),g.ZERO=new g(r.ZERO,r.ONE,r.ZERO);const{endo:w,nBitLength:S}=e,A=fQ(g,w?Math.ceil(S/2):S);return{CURVE:e,ProjectivePoint:g,normPrivateKeyToScalar:d,weierstrassEquation:o,isWithinCurveOrder:u}}function bQ(t){const e=CO(t);return uy(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}function vQ(t){const e=bQ(t),{Fp:r,n,nByteLength:s,nBitLength:i}=e,o=r.BYTES+1,a=2*r.BYTES+1;function c(f){return Zn(f,n)}function l(f){return fb(f,n)}const{ProjectivePoint:u,normPrivateKeyToScalar:d,weierstrassEquation:h,isWithinCurveOrder:p}=wQ({...e,toBytes(f,m,_){const $=m.toAffine(),x=r.toBytes($.x),N=hg;return ph("isCompressed",_),_?N(Uint8Array.from([m.hasEvenY()?2:3]),x):N(Uint8Array.from([4]),x,r.toBytes($.y))},fromBytes(f){const m=f.length,_=f[0],$=f.subarray(1);if(m===o&&(_===2||_===3)){const x=Nc($);if(!pv(x,Wr,r.ORDER))throw new Error("Point is not on curve");const N=h(x);let H;try{H=r.sqrt(N)}catch(M){const V=M instanceof Error?": "+M.message:"";throw new Error("Point is not on curve"+V)}const z=(H&Wr)===Wr;return(_&1)===1!==z&&(H=r.neg(H)),{x,y:H}}else if(m===a&&_===4){const x=r.fromBytes($.subarray(0,r.BYTES)),N=r.fromBytes($.subarray(r.BYTES,2*r.BYTES));return{x,y:N}}else{const x=o,N=a;throw new Error("invalid Point, expected length of "+x+", or uncompressed "+N+", got "+m)}}});function y(f){const m=n>>Wr;return f>m}function g(f){return y(f)?c(-f):f}const w=(f,m,_)=>Nc(f.slice(m,_));class S{constructor(m,_,$){jl("r",m,Wr,n),jl("s",_,Wr,n),this.r=m,this.s=_,$!=null&&(this.recovery=$),Object.freeze(this)}static fromCompact(m){const _=s;return m=Ws("compactSignature",m,_*2),new S(w(m,0,_),w(m,_,2*_))}static fromDER(m){const{r:_,s:$}=bo.toSig(Ws("DER",m));return new S(_,$)}assertValidity(){}addRecoveryBit(m){return new S(this.r,this.s,m)}recoverPublicKey(m){const{r:_,s:$,recovery:x}=this,N=L(Ws("msgHash",m));if(x==null||![0,1,2,3].includes(x))throw new Error("recovery id invalid");const H=x===2||x===3?_+e.n:_;if(H>=r.ORDER)throw new Error("recovery id 2 or 3 invalid");const z=(x&1)===0?"02":"03",G=u.fromHex(z+pw(H,r.BYTES)),M=l(H),V=c(-N*M),J=c($*M),re=u.BASE.multiplyAndAddUnsafe(G,V,J);if(!re)throw new Error("point at infinify");return re.assertValidity(),re}hasHighS(){return y(this.s)}normalizeS(){return this.hasHighS()?new S(this.r,c(-this.s),this.recovery):this}toDERRawBytes(){return dg(this.toDERHex())}toDERHex(){return bo.hexFromSig(this)}toCompactRawBytes(){return dg(this.toCompactHex())}toCompactHex(){const m=s;return pw(this.r,m)+pw(this.s,m)}}const A={isValidPrivateKey(f){try{return d(f),!0}catch{return!1}},normPrivateKeyToScalar:d,randomPrivateKey:()=>{const f=SO(e.n);return uQ(e.randomBytes(f),e.n)},precompute(f=8,m=u.BASE){return m._setWindowSize(f),m.multiply(BigInt(3)),m}};function E(f,m=!0){return u.fromPrivateKey(f).toRawBytes(m)}function v(f){if(typeof f=="bigint")return!1;if(f instanceof u)return!0;const _=Ws("key",f).length,$=r.BYTES,x=$+1,N=2*$+1;if(!(e.allowedPrivateKeyLengths||s===x))return _===x||_===N}function C(f,m,_=!0){if(v(f)===!0)throw new Error("first arg must be private key");if(v(m)===!1)throw new Error("second arg must be public key");return u.fromHex(m).multiply(d(f)).toRawBytes(_)}const O=e.bits2int||function(f){if(f.length>8192)throw new Error("input is too large");const m=Nc(f),_=f.length*8-i;return _>0?m>>BigInt(_):m},L=e.bits2int_modN||function(f){return c(O(f))},j=ly(i);function D(f){return jl("num < 2^"+i,f,So,j),Wh(f,s)}function W(f,m,_=P){if(["recovered","canonical"].some(ne=>ne in _))throw new Error("sign() legacy options not supported");const{hash:$,randomBytes:x}=e;let{lowS:N,prehash:H,extraEntropy:z}=_;N==null&&(N=!0),f=Ws("msgHash",f),yS(_),H&&(f=Ws("prehashed msgHash",$(f)));const G=L(f),M=d(m),V=[D(M),D(G)];if(z!=null&&z!==!1){const ne=z===!0?x(r.BYTES):z;V.push(Ws("extraEntropy",ne))}const J=hg(...V),re=G;function ye(ne){const se=O(ne);if(!p(se))return;const Ie=l(se),Me=u.BASE.multiply(se).toAffine(),Ve=c(Me.x);if(Ve===So)return;const Ze=c(Ie*c(re+Ve*M));if(Ze===So)return;let Nt=(Me.x===Ve?0:2)|Number(Me.y&Wr),Br=Ze;return N&&y(Ze)&&(Br=g(Ze),Nt^=1),new S(Ve,Br,Nt)}return{seed:J,k2sig:ye}}const P={lowS:e.lowS,prehash:!1},R={lowS:e.lowS,prehash:!1};function T(f,m,_=P){const{seed:$,k2sig:x}=W(f,m,_),N=e;return wJ(N.hash.outputLen,N.nByteLength,N.hmac)($,x)}u.BASE._setWindowSize(8);function k(f,m,_,$=R){const x=f;m=Ws("msgHash",m),_=Ws("publicKey",_);const{lowS:N,prehash:H,format:z}=$;if(yS($),"strict"in $)throw new Error("options.strict was renamed to lowS");if(z!==void 0&&z!=="compact"&&z!=="der")throw new Error("format must be compact or der");const G=typeof x=="string"||Hh(x),M=!G&&!z&&typeof x=="object"&&x!==null&&typeof x.r=="bigint"&&typeof x.s=="bigint";if(!G&&!M)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");let V,J;try{if(M&&(V=new S(x.r,x.s)),G){try{z!=="compact"&&(V=S.fromDER(x))}catch(Nt){if(!(Nt instanceof bo.Err))throw Nt}!V&&z!=="der"&&(V=S.fromCompact(x))}J=u.fromHex(_)}catch{return!1}if(!V||N&&V.hasHighS())return!1;H&&(m=e.hash(m));const{r:re,s:ye}=V,ne=L(m),se=l(ye),Ie=c(ne*se),Me=c(re*se),Ve=u.BASE.multiplyAndAddUnsafe(J,Ie,Me)?.toAffine();return Ve?c(Ve.x)===re:!1}return{CURVE:e,getPublicKey:E,getSharedSecret:C,sign:T,verify:k,ProjectivePoint:u,Signature:S,utils:A}}function EQ(t){return{hash:t,hmac:(e,...r)=>yO(t,e,WZ(...r)),randomBytes:VZ}}function _Q(t,e){const r=n=>vQ({...t,...EQ(n)});return{...r(e),create:r}}const $O=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),mS=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),xQ=BigInt(0),SQ=BigInt(1),gb=BigInt(2),wS=(t,e)=>(t+e/gb)/e;function AQ(t){const e=$O,r=BigInt(3),n=BigInt(6),s=BigInt(11),i=BigInt(22),o=BigInt(23),a=BigInt(44),c=BigInt(88),l=t*t*t%e,u=l*l*t%e,d=Ds(u,r,e)*u%e,h=Ds(d,r,e)*u%e,p=Ds(h,gb,e)*l%e,y=Ds(p,s,e)*p%e,g=Ds(y,i,e)*y%e,w=Ds(g,a,e)*g%e,S=Ds(w,c,e)*w%e,A=Ds(S,a,e)*g%e,E=Ds(A,r,e)*u%e,v=Ds(E,o,e)*y%e,C=Ds(v,n,e)*l%e,O=Ds(C,gb,e);if(!yb.eql(yb.sqr(O),t))throw new Error("Cannot find square root");return O}const yb=mv($O,void 0,void 0,{sqrt:AQ}),IQ=_Q({a:xQ,b:BigInt(7),Fp:yb,n:mS,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:t=>{const e=mS,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-SQ*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),s=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),i=r,o=BigInt("0x100000000000000000000000000000000"),a=wS(i*t,e),c=wS(-n*t,e);let l=Zn(t-a*r-c*s,e),u=Zn(-a*n-c*i,e);const d=l>o,h=u>o;if(d&&(l=e-l),h&&(u=e-u),l>o||u>o)throw new Error("splitScalar: Endomorphism failed, k="+t);return{k1neg:d,k1:l,k2neg:h,k2:u}}}},gJ);function CQ(t){if(t.length!==130&&t.length!==132)throw new TQ({signature:t});const e=BigInt(po(t,0,32)),r=BigInt(po(t,32,64)),n=(()=>{const s=+`0x${t.slice(130)}`;if(!Number.isNaN(s))try{return $Q(s)}catch{throw new NQ({value:s})}})();return typeof n>"u"?{r:e,s:r}:{r:e,s:r,yParity:n}}function $Q(t){if(t===0||t===27)return 0;if(t===1||t===28)return 1;if(t>=35)return t%2===0?1:0;throw new OQ({value:t})}class TQ extends rr{constructor({signature:e}){super(`Value \`${e}\` is an invalid signature size.`,{metaMessages:["Expected: 64 bytes or 65 bytes.",`Received ${Oa(yv(e))} bytes.`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.InvalidSerializedSizeError"})}}class NQ extends rr{constructor({value:e}){super(`Value \`${e}\` is an invalid y-parity value. Y-parity must be 0 or 1.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.InvalidYParityError"})}}class OQ extends rr{constructor({value:e}){super(`Value \`${e}\` is an invalid v value. v must be 27, 28 or >=35.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.InvalidVError"})}}function kQ(t){return eQ(PQ(t))}function PQ(t){const{payload:e,signature:r}=t,{r:n,s,yParity:i}=r,a=new IQ.Signature(BigInt(n),BigInt(s)).addRecoveryBit(i).recoverPublicKey(yv(e).substring(2));return WJ(a)}function RQ(t){if(t.length>=255)throw new TypeError("Alphabet too long");const e=new Uint8Array(256);for(let l=0;l<e.length;l++)e[l]=255;for(let l=0;l<t.length;l++){const u=t.charAt(l),d=u.charCodeAt(0);if(e[d]!==255)throw new TypeError(u+" is ambiguous");e[d]=l}const r=t.length,n=t.charAt(0),s=Math.log(r)/Math.log(256),i=Math.log(256)/Math.log(r);function o(l){if(l instanceof Uint8Array||(ArrayBuffer.isView(l)?l=new Uint8Array(l.buffer,l.byteOffset,l.byteLength):Array.isArray(l)&&(l=Uint8Array.from(l))),!(l instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(l.length===0)return"";let u=0,d=0,h=0;const p=l.length;for(;h!==p&&l[h]===0;)h++,u++;const y=(p-h)*i+1>>>0,g=new Uint8Array(y);for(;h!==p;){let A=l[h],E=0;for(let v=y-1;(A!==0||E<d)&&v!==-1;v--,E++)A+=256*g[v]>>>0,g[v]=A%r>>>0,A=A/r>>>0;if(A!==0)throw new Error("Non-zero carry");d=E,h++}let w=y-d;for(;w!==y&&g[w]===0;)w++;let S=n.repeat(u);for(;w<y;++w)S+=t.charAt(g[w]);return S}function a(l){if(typeof l!="string")throw new TypeError("Expected String");if(l.length===0)return new Uint8Array;let u=0,d=0,h=0;for(;l[u]===n;)d++,u++;const p=(l.length-u)*s+1>>>0,y=new Uint8Array(p);for(;u<l.length;){const A=l.charCodeAt(u);if(A>255)return;let E=e[A];if(E===255)return;let v=0;for(let C=p-1;(E!==0||v<h)&&C!==-1;C--,v++)E+=r*y[C]>>>0,y[C]=E%256>>>0,E=E/256>>>0;if(E!==0)throw new Error("Non-zero carry");h=v,u++}let g=p-h;for(;g!==p&&y[g]===0;)g++;const w=new Uint8Array(d+(p-g));let S=d;for(;g!==p;)w[S++]=y[g++];return w}function c(l){const u=a(l);if(u)return u;throw new Error("Non-base"+r+" character")}return{encode:o,decodeUnsafe:a,decode:c}}var DQ="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";const Vh=RQ(DQ);var UQ={};const BQ=":";function Oo(t){const[e,r]=t.split(BQ);return{namespace:e,reference:r}}function TO(t,e){return t.includes(":")?[t]:e.chains||[]}var LQ=Object.defineProperty,MQ=Object.defineProperties,jQ=Object.getOwnPropertyDescriptors,bS=Object.getOwnPropertySymbols,FQ=Object.prototype.hasOwnProperty,qQ=Object.prototype.propertyIsEnumerable,mb=(t,e,r)=>e in t?LQ(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,vS=(t,e)=>{for(var r in e||(e={}))FQ.call(e,r)&&mb(t,r,e[r]);if(bS)for(var r of bS(e))qQ.call(e,r)&&mb(t,r,e[r]);return t},zQ=(t,e)=>MQ(t,jQ(e)),ES=(t,e,r)=>mb(t,typeof e!="symbol"?e+"":e,r);const HQ="ReactNative",Is={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},WQ="js";function pg(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function Ba(){return!Xr.getDocument()&&!!Xr.getNavigator()&&navigator.product===HQ}function VQ(){return Ba()&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"&&(global==null?void 0:global.Platform.OS)==="android"}function KQ(){return Ba()&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"&&(global==null?void 0:global.Platform.OS)==="ios"}function mu(){return!pg()&&!!Xr.getNavigator()&&!!Xr.getDocument()}function Kh(){return Ba()?Is.reactNative:pg()?Is.node:mu()?Is.browser:Is.unknown}function _S(){var t;try{return Ba()&&typeof global<"u"&&typeof(global==null?void 0:global.Application)<"u"?(t=global.Application)==null?void 0:t.applicationId:void 0}catch{return}}function GQ(t,e){const r=new URLSearchParams(t);return Object.entries(e).sort(([n],[s])=>n.localeCompare(s)).forEach(([n,s])=>{s!=null&&r.set(n,String(s))}),r.toString()}function YQ(t){var e,r;const n=NO();try{return t!=null&&t.url&&n.url&&new URL(t.url).host!==new URL(n.url).host&&(console.warn(`The configured WalletConnect 'metadata.url':${t.url} differs from the actual page url:${n.url}. This is probably unintended and can lead to issues.`),t.url=n.url),(e=t?.icons)!=null&&e.length&&t.icons.length>0&&(t.icons=t.icons.filter(s=>s!=="")),zQ(vS(vS({},n),t),{url:t?.url||n.url,name:t?.name||n.name,description:t?.description||n.description,icons:(r=t?.icons)!=null&&r.length&&t.icons.length>0?t.icons:n.icons})}catch(s){return console.warn("Error populating app metadata",s),t||n}}function NO(){return M3.getWindowMetadata()||{name:"",description:"",url:"",icons:[""]}}function XQ(){if(Kh()===Is.reactNative&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"){const{OS:r,Version:n}=global.Platform;return[r,n].join("-")}const t=B3();if(t===null)return"unknown";const e=t.os?t.os.replace(" ","").toLowerCase():"unknown";return t.type==="browser"?[e,t.name,t.version].join("-"):[e,t.version].join("-")}function ZQ(){var t;const e=Kh();return e===Is.browser?[e,((t=Xr.getLocation())==null?void 0:t.host)||"unknown"].join(":"):e}function OO(t,e,r){const n=XQ(),s=ZQ();return[[t,e].join("-"),[WQ,r].join("-"),n,s].join("/")}function JQ({protocol:t,version:e,relayUrl:r,sdkVersion:n,auth:s,projectId:i,useOnCloseEvent:o,bundleId:a,packageName:c}){const l=r.split("?"),u=OO(t,e,n),d={auth:s,ua:u,projectId:i,useOnCloseEvent:o,packageName:c||void 0,bundleId:a||void 0},h=GQ(l[1]||"",d);return l[0]+"?"+h}function bc(t,e){return t.filter(r=>e.includes(r)).length===t.length}function wb(t){return Object.fromEntries(t.entries())}function bb(t){return new Map(Object.entries(t))}function rc(t=X.FIVE_MINUTES,e){const r=X.toMiliseconds(t||X.FIVE_MINUTES);let n,s,i,o;return{resolve:a=>{i&&n&&(clearTimeout(i),n(a),o=Promise.resolve(a))},reject:a=>{i&&s&&(clearTimeout(i),s(a))},done:()=>new Promise((a,c)=>{if(o)return a(o);i=setTimeout(()=>{const l=new Error(e);o=Promise.reject(l),c(l)},r),n=a,s=c})}}function Mi(t,e,r){return new Promise(async(n,s)=>{const i=setTimeout(()=>s(new Error(r)),e);try{const o=await t;n(o)}catch(o){s(o)}clearTimeout(i)})}function kO(t,e){if(typeof e=="string"&&e.startsWith(`${t}:`))return e;if(t.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(t.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${t}`)}function QQ(t){return kO("topic",t)}function eee(t){return kO("id",t)}function PO(t){const[e,r]=t.split(":"),n={id:void 0,topic:void 0};if(e==="topic"&&typeof r=="string")n.topic=r;else if(e==="id"&&Number.isInteger(Number(r)))n.id=Number(r);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${r}`);return n}function vr(t,e){return X.fromMiliseconds(Date.now()+X.toMiliseconds(t))}function Ui(t){return Date.now()>=X.toMiliseconds(t)}function kt(t,e){return`${t}${e?`:${e}`:""}`}function zi(t=[],e=[]){return[...new Set([...t,...e])]}async function tee({id:t,topic:e,wcDeepLink:r}){var n;try{if(!r)return;const s=typeof r=="string"?JSON.parse(r):r,i=s?.href;if(typeof i!="string")return;const o=ree(i,t,e),a=Kh();if(a===Is.browser){if(!((n=Xr.getDocument())!=null&&n.hasFocus())){console.warn("Document does not have focus, skipping deeplink.");return}nee(o)}else a===Is.reactNative&&typeof(global==null?void 0:global.Linking)<"u"&&await global.Linking.openURL(o)}catch(s){console.error(s)}}function ree(t,e,r){const n=`requestId=${e}&sessionTopic=${r}`;t.endsWith("/")&&(t=t.slice(0,-1));let s=`${t}`;if(t.startsWith("https://t.me")){const i=t.includes("?")?"&startapp=":"?startapp=";s=`${s}${i}${aee(n,!0)}`}else s=`${s}/wc?${n}`;return s}function nee(t){let e="_self";oee()?e="_top":(iee()||t.startsWith("https://")||t.startsWith("http://"))&&(e="_blank"),window.open(t,e,"noreferrer noopener")}async function see(t,e){let r="";try{if(mu()&&(r=localStorage.getItem(e),r))return r;r=await t.getItem(e)}catch(n){console.error(n)}return r}function xS(t,e){if(!t.includes(e))return null;const r=t.split(/([&,?,=])/),n=r.indexOf(e);return r[n+2]}function SS(){return typeof crypto<"u"&&crypto!=null&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,t=>{const e=Math.random()*16|0;return(t==="x"?e:e&3|8).toString(16)})}function wv(){return typeof process<"u"&&UQ.IS_VITEST==="true"}function iee(){return typeof window<"u"&&(!!window.TelegramWebviewProxy||!!window.Telegram||!!window.TelegramWebviewProxyProto)}function oee(){try{return window.self!==window.top}catch{return!1}}function aee(t,e=!1){const r=Buffer.from(t).toString("base64");return e?r.replace(/[=]/g,""):r}function RO(t){return Buffer.from(t,"base64").toString("utf-8")}function cee(t){return new Promise(e=>setTimeout(e,t))}let lee=class{constructor({limit:e}){ES(this,"limit"),ES(this,"set"),this.limit=e,this.set=new Set}add(e){if(!this.set.has(e)){if(this.set.size>=this.limit){const r=this.set.values().next().value;r&&this.set.delete(r)}this.set.add(e)}}has(e){return this.set.has(e)}};const Mf=BigInt(2**32-1),AS=BigInt(32);function DO(t,e=!1){return e?{h:Number(t&Mf),l:Number(t>>AS&Mf)}:{h:Number(t>>AS&Mf)|0,l:Number(t&Mf)|0}}function UO(t,e=!1){const r=t.length;let n=new Uint32Array(r),s=new Uint32Array(r);for(let i=0;i<r;i++){const{h:o,l:a}=DO(t[i],e);[n[i],s[i]]=[o,a]}return[n,s]}const IS=(t,e,r)=>t>>>r,CS=(t,e,r)=>t<<32-r|e>>>r,la=(t,e,r)=>t>>>r|e<<32-r,ua=(t,e,r)=>t<<32-r|e>>>r,cd=(t,e,r)=>t<<64-r|e>>>r-32,ld=(t,e,r)=>t>>>r-32|e<<64-r,uee=(t,e)=>e,dee=(t,e)=>t,hee=(t,e,r)=>t<<r|e>>>32-r,fee=(t,e,r)=>e<<r|t>>>32-r,pee=(t,e,r)=>e<<r-32|t>>>64-r,gee=(t,e,r)=>t<<r-32|e>>>64-r;function ui(t,e,r,n){const s=(e>>>0)+(n>>>0);return{h:t+r+(s/2**32|0)|0,l:s|0}}const bv=(t,e,r)=>(t>>>0)+(e>>>0)+(r>>>0),vv=(t,e,r,n)=>e+r+n+(t/2**32|0)|0,yee=(t,e,r,n)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0),mee=(t,e,r,n,s)=>e+r+n+s+(t/2**32|0)|0,wee=(t,e,r,n,s)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0)+(s>>>0),bee=(t,e,r,n,s,i)=>e+r+n+s+i+(t/2**32|0)|0,wl=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function dy(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function Uo(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function vi(t,...e){if(!dy(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function hy(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");Uo(t.outputLen),Uo(t.blockLen)}function ka(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function Ev(t,e){vi(t);const r=e.outputLen;if(t.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}function yh(t){return new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4))}function Zs(...t){for(let e=0;e<t.length;e++)t[e].fill(0)}function yw(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function $i(t,e){return t<<32-e|t>>>e}const BO=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function LO(t){return t<<24&4278190080|t<<8&16711680|t>>>8&65280|t>>>24&255}const co=BO?t=>t:t=>LO(t);function vee(t){for(let e=0;e<t.length;e++)t[e]=LO(t[e]);return t}const da=BO?t=>t:vee,MO=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",Eee=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Fl(t){if(vi(t),MO)return t.toHex();let e="";for(let r=0;r<t.length;r++)e+=Eee[t[r]];return e}const io={_0:48,_9:57,A:65,F:70,a:97,f:102};function $S(t){if(t>=io._0&&t<=io._9)return t-io._0;if(t>=io.A&&t<=io.F)return t-(io.A-10);if(t>=io.a&&t<=io.f)return t-(io.a-10)}function gg(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);if(MO)return Uint8Array.fromHex(t);const e=t.length,r=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(r);for(let s=0,i=0;s<r;s++,i+=2){const o=$S(t.charCodeAt(i)),a=$S(t.charCodeAt(i+1));if(o===void 0||a===void 0){const c=t[i]+t[i+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+i)}n[s]=o*16+a}return n}function jO(t){if(typeof t!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(t))}function mi(t){return typeof t=="string"&&(t=jO(t)),vi(t),t}function ya(...t){let e=0;for(let n=0;n<t.length;n++){const s=t[n];vi(s),e+=s.length}const r=new Uint8Array(e);for(let n=0,s=0;n<t.length;n++){const i=t[n];r.set(i,s),s+=i.length}return r}class fy{}function Gh(t){const e=n=>t().update(mi(n)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function _ee(t){const e=(n,s)=>t(s).update(mi(n)).digest(),r=t({});return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=n=>t(n),e}function Jc(t=32){if(wl&&typeof wl.getRandomValues=="function")return wl.getRandomValues(new Uint8Array(t));if(wl&&typeof wl.randomBytes=="function")return Uint8Array.from(wl.randomBytes(t));throw new Error("crypto.getRandomValues must be defined")}const xee=BigInt(0),Gu=BigInt(1),See=BigInt(2),Aee=BigInt(7),Iee=BigInt(256),Cee=BigInt(113),FO=[],qO=[],zO=[];for(let t=0,e=Gu,r=1,n=0;t<24;t++){[r,n]=[n,(2*r+3*n)%5],FO.push(2*(5*n+r)),qO.push((t+1)*(t+2)/2%64);let s=xee;for(let i=0;i<7;i++)e=(e<<Gu^(e>>Aee)*Cee)%Iee,e&See&&(s^=Gu<<(Gu<<BigInt(i))-Gu);zO.push(s)}const HO=UO(zO,!0),$ee=HO[0],Tee=HO[1],TS=(t,e,r)=>r>32?pee(t,e,r):hee(t,e,r),NS=(t,e,r)=>r>32?gee(t,e,r):fee(t,e,r);function Nee(t,e=24){const r=new Uint32Array(10);for(let n=24-e;n<24;n++){for(let o=0;o<10;o++)r[o]=t[o]^t[o+10]^t[o+20]^t[o+30]^t[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,c=(o+2)%10,l=r[c],u=r[c+1],d=TS(l,u,1)^r[a],h=NS(l,u,1)^r[a+1];for(let p=0;p<50;p+=10)t[o+p]^=d,t[o+p+1]^=h}let s=t[2],i=t[3];for(let o=0;o<24;o++){const a=qO[o],c=TS(s,i,a),l=NS(s,i,a),u=FO[o];s=t[u],i=t[u+1],t[u]=c,t[u+1]=l}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)r[a]=t[o+a];for(let a=0;a<10;a++)t[o+a]^=~r[(a+2)%10]&r[(a+4)%10]}t[0]^=$ee[n],t[1]^=Tee[n]}Zs(r)}let Oee=class WO extends fy{constructor(e,r,n,s=!1,i=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=e,this.suffix=r,this.outputLen=n,this.enableXOF=s,this.rounds=i,Uo(n),!(0<e&&e<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=yh(this.state)}clone(){return this._cloneInto()}keccak(){da(this.state32),Nee(this.state32,this.rounds),da(this.state32),this.posOut=0,this.pos=0}update(e){ka(this),e=mi(e),vi(e);const{blockLen:r,state:n}=this,s=e.length;for(let i=0;i<s;){const o=Math.min(r-this.pos,s-i);for(let a=0;a<o;a++)n[this.pos++]^=e[i++];this.pos===r&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:r,pos:n,blockLen:s}=this;e[n]^=r,(r&128)!==0&&n===s-1&&this.keccak(),e[s-1]^=128,this.keccak()}writeInto(e){ka(this,!1),vi(e),this.finish();const r=this.state,{blockLen:n}=this;for(let s=0,i=e.length;s<i;){this.posOut>=n&&this.keccak();const o=Math.min(n-this.posOut,i-s);e.set(r.subarray(this.posOut,this.posOut+o),s),this.posOut+=o,s+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return Uo(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(Ev(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,Zs(this.state)}_cloneInto(e){const{blockLen:r,suffix:n,outputLen:s,rounds:i,enableXOF:o}=this;return e||(e=new WO(r,n,s,o,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=n,e.outputLen=s,e.enableXOF=o,e.destroyed=this.destroyed,e}};const kee=(t,e,r)=>Gh(()=>new Oee(e,t,r)),Pee=kee(1,136,256/8);function Ree(t,e,r,n){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,n);const s=BigInt(32),i=BigInt(4294967295),o=Number(r>>s&i),a=Number(r&i),c=n?4:0,l=n?0:4;t.setUint32(e+c,o,n),t.setUint32(e+l,a,n)}function Dee(t,e,r){return t&e^~t&r}function Uee(t,e,r){return t&e^t&r^e&r}let VO=class extends fy{constructor(e,r,n,s){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=e,this.outputLen=r,this.padOffset=n,this.isLE=s,this.buffer=new Uint8Array(e),this.view=yw(this.buffer)}update(e){ka(this),e=mi(e),vi(e);const{view:r,buffer:n,blockLen:s}=this,i=e.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const c=yw(e);for(;s<=i-o;o+=s)this.process(c,o);continue}n.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){ka(this),Ev(e,this),this.finished=!0;const{buffer:r,view:n,blockLen:s,isLE:i}=this;let{pos:o}=this;r[o++]=128,Zs(this.buffer.subarray(o)),this.padOffset>s-o&&(this.process(n,0),o=0);for(let d=o;d<s;d++)r[d]=0;Ree(n,s-8,BigInt(this.length*8),i),this.process(n,0);const a=yw(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=c/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<l;d++)a.setUint32(4*d,u[d],i)}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const n=e.slice(0,r);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:r,buffer:n,length:s,finished:i,destroyed:o,pos:a}=this;return e.destroyed=o,e.finished=i,e.length=s,e.pos=a,s%r&&e.buffer.set(n),e}clone(){return this._cloneInto()}};const Jo=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),En=Uint32Array.from([3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]),_n=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]),Bee=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Qo=new Uint32Array(64);class Lee extends VO{constructor(e=32){super(64,e,8,!1),this.A=Jo[0]|0,this.B=Jo[1]|0,this.C=Jo[2]|0,this.D=Jo[3]|0,this.E=Jo[4]|0,this.F=Jo[5]|0,this.G=Jo[6]|0,this.H=Jo[7]|0}get(){const{A:e,B:r,C:n,D:s,E:i,F:o,G:a,H:c}=this;return[e,r,n,s,i,o,a,c]}set(e,r,n,s,i,o,a,c){this.A=e|0,this.B=r|0,this.C=n|0,this.D=s|0,this.E=i|0,this.F=o|0,this.G=a|0,this.H=c|0}process(e,r){for(let d=0;d<16;d++,r+=4)Qo[d]=e.getUint32(r,!1);for(let d=16;d<64;d++){const h=Qo[d-15],p=Qo[d-2],y=$i(h,7)^$i(h,18)^h>>>3,g=$i(p,17)^$i(p,19)^p>>>10;Qo[d]=g+Qo[d-7]+y+Qo[d-16]|0}let{A:n,B:s,C:i,D:o,E:a,F:c,G:l,H:u}=this;for(let d=0;d<64;d++){const h=$i(a,6)^$i(a,11)^$i(a,25),p=u+h+Dee(a,c,l)+Bee[d]+Qo[d]|0,y=($i(n,2)^$i(n,13)^$i(n,22))+Uee(n,s,i)|0;u=l,l=c,c=a,a=o+p|0,o=i,i=s,s=n,n=p+y|0}n=n+this.A|0,s=s+this.B|0,i=i+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,l=l+this.G|0,u=u+this.H|0,this.set(n,s,i,o,a,c,l,u)}roundClean(){Zs(Qo)}destroy(){this.set(0,0,0,0,0,0,0,0),Zs(this.buffer)}}const KO=UO(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),Mee=KO[0],jee=KO[1],ea=new Uint32Array(80),ta=new Uint32Array(80);let _v=class extends VO{constructor(e=64){super(128,e,16,!1),this.Ah=_n[0]|0,this.Al=_n[1]|0,this.Bh=_n[2]|0,this.Bl=_n[3]|0,this.Ch=_n[4]|0,this.Cl=_n[5]|0,this.Dh=_n[6]|0,this.Dl=_n[7]|0,this.Eh=_n[8]|0,this.El=_n[9]|0,this.Fh=_n[10]|0,this.Fl=_n[11]|0,this.Gh=_n[12]|0,this.Gl=_n[13]|0,this.Hh=_n[14]|0,this.Hl=_n[15]|0}get(){const{Ah:e,Al:r,Bh:n,Bl:s,Ch:i,Cl:o,Dh:a,Dl:c,Eh:l,El:u,Fh:d,Fl:h,Gh:p,Gl:y,Hh:g,Hl:w}=this;return[e,r,n,s,i,o,a,c,l,u,d,h,p,y,g,w]}set(e,r,n,s,i,o,a,c,l,u,d,h,p,y,g,w){this.Ah=e|0,this.Al=r|0,this.Bh=n|0,this.Bl=s|0,this.Ch=i|0,this.Cl=o|0,this.Dh=a|0,this.Dl=c|0,this.Eh=l|0,this.El=u|0,this.Fh=d|0,this.Fl=h|0,this.Gh=p|0,this.Gl=y|0,this.Hh=g|0,this.Hl=w|0}process(e,r){for(let E=0;E<16;E++,r+=4)ea[E]=e.getUint32(r),ta[E]=e.getUint32(r+=4);for(let E=16;E<80;E++){const v=ea[E-15]|0,C=ta[E-15]|0,O=la(v,C,1)^la(v,C,8)^IS(v,C,7),L=ua(v,C,1)^ua(v,C,8)^CS(v,C,7),j=ea[E-2]|0,D=ta[E-2]|0,W=la(j,D,19)^cd(j,D,61)^IS(j,D,6),P=ua(j,D,19)^ld(j,D,61)^CS(j,D,6),R=yee(L,P,ta[E-7],ta[E-16]),T=mee(R,O,W,ea[E-7],ea[E-16]);ea[E]=T|0,ta[E]=R|0}let{Ah:n,Al:s,Bh:i,Bl:o,Ch:a,Cl:c,Dh:l,Dl:u,Eh:d,El:h,Fh:p,Fl:y,Gh:g,Gl:w,Hh:S,Hl:A}=this;for(let E=0;E<80;E++){const v=la(d,h,14)^la(d,h,18)^cd(d,h,41),C=ua(d,h,14)^ua(d,h,18)^ld(d,h,41),O=d&p^~d&g,L=h&y^~h&w,j=wee(A,C,L,jee[E],ta[E]),D=bee(j,S,v,O,Mee[E],ea[E]),W=j|0,P=la(n,s,28)^cd(n,s,34)^cd(n,s,39),R=ua(n,s,28)^ld(n,s,34)^ld(n,s,39),T=n&i^n&a^i&a,k=s&o^s&c^o&c;S=g|0,A=w|0,g=p|0,w=y|0,p=d|0,y=h|0,{h:d,l:h}=ui(l|0,u|0,D|0,W|0),l=a|0,u=c|0,a=i|0,c=o|0,i=n|0,o=s|0;const f=bv(W,R,k);n=vv(f,D,P,T),s=f|0}({h:n,l:s}=ui(this.Ah|0,this.Al|0,n|0,s|0)),{h:i,l:o}=ui(this.Bh|0,this.Bl|0,i|0,o|0),{h:a,l:c}=ui(this.Ch|0,this.Cl|0,a|0,c|0),{h:l,l:u}=ui(this.Dh|0,this.Dl|0,l|0,u|0),{h:d,l:h}=ui(this.Eh|0,this.El|0,d|0,h|0),{h:p,l:y}=ui(this.Fh|0,this.Fl|0,p|0,y|0),{h:g,l:w}=ui(this.Gh|0,this.Gl|0,g|0,w|0),{h:S,l:A}=ui(this.Hh|0,this.Hl|0,S|0,A|0),this.set(n,s,i,o,a,c,l,u,d,h,p,y,g,w,S,A)}roundClean(){Zs(ea,ta)}destroy(){Zs(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};class Fee extends _v{constructor(){super(48),this.Ah=En[0]|0,this.Al=En[1]|0,this.Bh=En[2]|0,this.Bl=En[3]|0,this.Ch=En[4]|0,this.Cl=En[5]|0,this.Dh=En[6]|0,this.Dl=En[7]|0,this.Eh=En[8]|0,this.El=En[9]|0,this.Fh=En[10]|0,this.Fl=En[11]|0,this.Gh=En[12]|0,this.Gl=En[13]|0,this.Hh=En[14]|0,this.Hl=En[15]|0}}const xn=Uint32Array.from([573645204,4230739756,2673172387,3360449730,596883563,1867755857,2520282905,1497426621,2519219938,2827943907,3193839141,1401305490,721525244,746961066,246885852,2177182882]);class qee extends _v{constructor(){super(32),this.Ah=xn[0]|0,this.Al=xn[1]|0,this.Bh=xn[2]|0,this.Bl=xn[3]|0,this.Ch=xn[4]|0,this.Cl=xn[5]|0,this.Dh=xn[6]|0,this.Dl=xn[7]|0,this.Eh=xn[8]|0,this.El=xn[9]|0,this.Fh=xn[10]|0,this.Fl=xn[11]|0,this.Gh=xn[12]|0,this.Gl=xn[13]|0,this.Hh=xn[14]|0,this.Hl=xn[15]|0}}const py=Gh(()=>new Lee),zee=Gh(()=>new _v),Hee=Gh(()=>new Fee),Wee=Gh(()=>new qee),Vee=Uint8Array.from([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9]),Nr=Uint32Array.from([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),Ae=new Uint32Array(32);function ra(t,e,r,n,s,i){const o=s[i],a=s[i+1];let c=Ae[2*t],l=Ae[2*t+1],u=Ae[2*e],d=Ae[2*e+1],h=Ae[2*r],p=Ae[2*r+1],y=Ae[2*n],g=Ae[2*n+1],w=bv(c,u,o);l=vv(w,l,d,a),c=w|0,{Dh:g,Dl:y}={Dh:g^l,Dl:y^c},{Dh:g,Dl:y}={Dh:uee(g,y),Dl:dee(g)},{h:p,l:h}=ui(p,h,g,y),{Bh:d,Bl:u}={Bh:d^p,Bl:u^h},{Bh:d,Bl:u}={Bh:la(d,u,24),Bl:ua(d,u,24)},Ae[2*t]=c,Ae[2*t+1]=l,Ae[2*e]=u,Ae[2*e+1]=d,Ae[2*r]=h,Ae[2*r+1]=p,Ae[2*n]=y,Ae[2*n+1]=g}function na(t,e,r,n,s,i){const o=s[i],a=s[i+1];let c=Ae[2*t],l=Ae[2*t+1],u=Ae[2*e],d=Ae[2*e+1],h=Ae[2*r],p=Ae[2*r+1],y=Ae[2*n],g=Ae[2*n+1],w=bv(c,u,o);l=vv(w,l,d,a),c=w|0,{Dh:g,Dl:y}={Dh:g^l,Dl:y^c},{Dh:g,Dl:y}={Dh:la(g,y,16),Dl:ua(g,y,16)},{h:p,l:h}=ui(p,h,g,y),{Bh:d,Bl:u}={Bh:d^p,Bl:u^h},{Bh:d,Bl:u}={Bh:cd(d,u,63),Bl:ld(d,u,63)},Ae[2*t]=c,Ae[2*t+1]=l,Ae[2*e]=u,Ae[2*e+1]=d,Ae[2*r]=h,Ae[2*r+1]=p,Ae[2*n]=y,Ae[2*n+1]=g}function Kee(t,e={},r,n,s){if(Uo(r),t<0||t>r)throw new Error("outputLen bigger than keyLen");const{key:i,salt:o,personalization:a}=e;if(i!==void 0&&(i.length<1||i.length>r))throw new Error("key length must be undefined or 1.."+r);if(o!==void 0&&o.length!==n)throw new Error("salt must be undefined or "+n);if(a!==void 0&&a.length!==s)throw new Error("personalization must be undefined or "+s)}class Gee extends fy{constructor(e,r){super(),this.finished=!1,this.destroyed=!1,this.length=0,this.pos=0,Uo(e),Uo(r),this.blockLen=e,this.outputLen=r,this.buffer=new Uint8Array(e),this.buffer32=yh(this.buffer)}update(e){ka(this),e=mi(e),vi(e);const{blockLen:r,buffer:n,buffer32:s}=this,i=e.length,o=e.byteOffset,a=e.buffer;for(let c=0;c<i;){this.pos===r&&(da(s),this.compress(s,0,!1),da(s),this.pos=0);const l=Math.min(r-this.pos,i-c),u=o+c;if(l===r&&!(u%4)&&c+l<i){const d=new Uint32Array(a,u,Math.floor((i-c)/4));da(d);for(let h=0;c+r<i;h+=s.length,c+=r)this.length+=r,this.compress(d,h,!1);da(d);continue}n.set(e.subarray(c,c+l),this.pos),this.pos+=l,this.length+=l,c+=l}return this}digestInto(e){ka(this),Ev(e,this);const{pos:r,buffer32:n}=this;this.finished=!0,Zs(this.buffer.subarray(r)),da(n),this.compress(n,0,!0),da(n);const s=yh(e);this.get().forEach((i,o)=>s[o]=co(i))}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const n=e.slice(0,r);return this.destroy(),n}_cloneInto(e){const{buffer:r,length:n,finished:s,destroyed:i,outputLen:o,pos:a}=this;return e||(e=new this.constructor({dkLen:o})),e.set(...this.get()),e.buffer.set(r),e.destroyed=i,e.finished=s,e.length=n,e.pos=a,e.outputLen=o,e}clone(){return this._cloneInto()}}class Yee extends Gee{constructor(e={}){const r=e.dkLen===void 0?64:e.dkLen;super(128,r),this.v0l=Nr[0]|0,this.v0h=Nr[1]|0,this.v1l=Nr[2]|0,this.v1h=Nr[3]|0,this.v2l=Nr[4]|0,this.v2h=Nr[5]|0,this.v3l=Nr[6]|0,this.v3h=Nr[7]|0,this.v4l=Nr[8]|0,this.v4h=Nr[9]|0,this.v5l=Nr[10]|0,this.v5h=Nr[11]|0,this.v6l=Nr[12]|0,this.v6h=Nr[13]|0,this.v7l=Nr[14]|0,this.v7h=Nr[15]|0,Kee(r,e,64,16,16);let{key:n,personalization:s,salt:i}=e,o=0;if(n!==void 0&&(n=mi(n),o=n.length),this.v0l^=this.outputLen|o<<8|65536|1<<24,i!==void 0){i=mi(i);const a=yh(i);this.v4l^=co(a[0]),this.v4h^=co(a[1]),this.v5l^=co(a[2]),this.v5h^=co(a[3])}if(s!==void 0){s=mi(s);const a=yh(s);this.v6l^=co(a[0]),this.v6h^=co(a[1]),this.v7l^=co(a[2]),this.v7h^=co(a[3])}if(n!==void 0){const a=new Uint8Array(this.blockLen);a.set(n),this.update(a)}}get(){let{v0l:e,v0h:r,v1l:n,v1h:s,v2l:i,v2h:o,v3l:a,v3h:c,v4l:l,v4h:u,v5l:d,v5h:h,v6l:p,v6h:y,v7l:g,v7h:w}=this;return[e,r,n,s,i,o,a,c,l,u,d,h,p,y,g,w]}set(e,r,n,s,i,o,a,c,l,u,d,h,p,y,g,w){this.v0l=e|0,this.v0h=r|0,this.v1l=n|0,this.v1h=s|0,this.v2l=i|0,this.v2h=o|0,this.v3l=a|0,this.v3h=c|0,this.v4l=l|0,this.v4h=u|0,this.v5l=d|0,this.v5h=h|0,this.v6l=p|0,this.v6h=y|0,this.v7l=g|0,this.v7h=w|0}compress(e,r,n){this.get().forEach((c,l)=>Ae[l]=c),Ae.set(Nr,16);let{h:s,l:i}=DO(BigInt(this.length));Ae[24]=Nr[8]^i,Ae[25]=Nr[9]^s,n&&(Ae[28]=~Ae[28],Ae[29]=~Ae[29]);let o=0;const a=Vee;for(let c=0;c<12;c++)ra(0,4,8,12,e,r+2*a[o++]),na(0,4,8,12,e,r+2*a[o++]),ra(1,5,9,13,e,r+2*a[o++]),na(1,5,9,13,e,r+2*a[o++]),ra(2,6,10,14,e,r+2*a[o++]),na(2,6,10,14,e,r+2*a[o++]),ra(3,7,11,15,e,r+2*a[o++]),na(3,7,11,15,e,r+2*a[o++]),ra(0,5,10,15,e,r+2*a[o++]),na(0,5,10,15,e,r+2*a[o++]),ra(1,6,11,12,e,r+2*a[o++]),na(1,6,11,12,e,r+2*a[o++]),ra(2,7,8,13,e,r+2*a[o++]),na(2,7,8,13,e,r+2*a[o++]),ra(3,4,9,14,e,r+2*a[o++]),na(3,4,9,14,e,r+2*a[o++]);this.v0l^=Ae[0]^Ae[16],this.v0h^=Ae[1]^Ae[17],this.v1l^=Ae[2]^Ae[18],this.v1h^=Ae[3]^Ae[19],this.v2l^=Ae[4]^Ae[20],this.v2h^=Ae[5]^Ae[21],this.v3l^=Ae[6]^Ae[22],this.v3h^=Ae[7]^Ae[23],this.v4l^=Ae[8]^Ae[24],this.v4h^=Ae[9]^Ae[25],this.v5l^=Ae[10]^Ae[26],this.v5h^=Ae[11]^Ae[27],this.v6l^=Ae[12]^Ae[28],this.v6h^=Ae[13]^Ae[29],this.v7l^=Ae[14]^Ae[30],this.v7h^=Ae[15]^Ae[31],Zs(Ae)}destroy(){this.destroyed=!0,Zs(this.buffer32),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const Xee=_ee(t=>new Yee(t)),Zee="https://rpc.walletconnect.org/v1";function GO(t){const e=`Ethereum Signed Message:
${t.length}`,r=new TextEncoder().encode(e+t);return"0x"+Buffer.from(Pee(r)).toString("hex")}async function Jee(t,e,r,n,s,i){switch(r.t){case"eip191":return await Qee(t,e,r.s);case"eip1271":return await ete(t,e,r.s,n,s,i);default:throw new Error(`verifySignature failed: Attempted to verify CacaoSignature with unknown type: ${r.t}`)}}function Qee(t,e,r){const n=CQ(r);return kQ({payload:GO(e),signature:n}).toLowerCase()===t.toLowerCase()}async function ete(t,e,r,n,s,i){const o=Oo(n);if(!o.namespace||!o.reference)throw new Error(`isValidEip1271Signature failed: chainId must be in CAIP-2 format, received: ${n}`);try{const a="0x1626ba7e",c="0000000000000000000000000000000000000000000000000000000000000040",l=r.substring(2),u=(l.length/2).toString(16).padStart(64,"0"),d=(e.startsWith("0x")?e:GO(e)).substring(2),h=a+d+c+u+l,p=await fetch(`${i||Zee}/?chainId=${n}&projectId=${s}`,{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify({id:tte(),jsonrpc:"2.0",method:"eth_call",params:[{to:t,data:h},"latest"]})}),{result:y}=await p.json();return y?y.slice(0,a.length).toLowerCase()===a.toLowerCase():!1}catch(a){return console.error("isValidEip1271Signature: ",a),!1}}function tte(){return Date.now()+Math.floor(Math.random()*1e3)}function rte(t){const e=atob(t),r=new Uint8Array(e.length);for(let o=0;o<e.length;o++)r[o]=e.charCodeAt(o);const n=r[0];if(n===0)throw new Error("No signatures found");const s=1+n*64;if(r.length<s)throw new Error("Transaction data too short for claimed signature count");if(r.length<100)throw new Error("Transaction too short");const i=Buffer.from(t,"base64").slice(1,65);return Vh.encode(i)}function nte(t){const e=new Uint8Array(Buffer.from(t,"base64")),r=Array.from("TransactionData::").map(i=>i.charCodeAt(0)),n=new Uint8Array(r.length+e.length);n.set(r),n.set(e,r.length);const s=Xee(n,{dkLen:32});return Vh.encode(s)}function OS(t){const e=new Uint8Array(py(ste(t)));return Vh.encode(e)}function ste(t){if(t instanceof Uint8Array)return t;if(Array.isArray(t))return new Uint8Array(t);if(typeof t=="object"&&t!=null&&t.data)return new Uint8Array(Object.values(t.data));if(typeof t=="object"&&t)return new Uint8Array(Object.values(t));throw new Error("getNearUint8ArrayFromBytes: Unexpected result type from bytes array")}function kS(t){const e=Buffer.from(t,"base64"),r=O$(e).txn;if(!r)throw new Error("Invalid signed transaction: missing 'txn' field");const n=$$(r),s=Buffer.from("TX"),i=Buffer.concat([s,Buffer.from(n)]),o=Wee(i);return x$.encode(o).replace(/=+$/,"")}function mw(t){const e=[];let r=BigInt(t);for(;r>=BigInt(128);)e.push(Number(r&BigInt(127)|BigInt(128))),r>>=BigInt(7);return e.push(Number(r)),Buffer.from(e)}function ite(t){const e=Buffer.from(t.signed.bodyBytes,"base64"),r=Buffer.from(t.signed.authInfoBytes,"base64"),n=Buffer.from(t.signature.signature,"base64"),s=[];s.push(Buffer.from([10])),s.push(mw(e.length)),s.push(e),s.push(Buffer.from([18])),s.push(mw(r.length)),s.push(r),s.push(Buffer.from([26])),s.push(mw(n.length)),s.push(n);const i=Buffer.concat(s),o=py(i);return Buffer.from(o).toString("hex").toUpperCase()}function ote(t){var e,r;const n=[];try{if(typeof t=="string")return n.push(t),n;if(typeof t!="object")return n;t!=null&&t.id&&n.push(t.id);const s=(r=(e=t?.capabilities)==null?void 0:e.caip345)==null?void 0:r.transactionHashes;s&&n.push(...s)}catch(s){console.warn("getWalletSendCallsHashes failed: ",s)}return n}var ate=Object.defineProperty,cte=Object.defineProperties,lte=Object.getOwnPropertyDescriptors,PS=Object.getOwnPropertySymbols,ute=Object.prototype.hasOwnProperty,dte=Object.prototype.propertyIsEnumerable,RS=(t,e,r)=>e in t?ate(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,hte=(t,e)=>{for(var r in e||(e={}))ute.call(e,r)&&RS(t,r,e[r]);if(PS)for(var r of PS(e))dte.call(e,r)&&RS(t,r,e[r]);return t},fte=(t,e)=>cte(t,lte(e));const pte="did:pkh:",xv=t=>t?.split(":"),gte=t=>{const e=t&&xv(t);if(e)return t.includes(pte)?e[3]:e[1]},vb=t=>{const e=t&&xv(t);if(e)return e[2]+":"+e[3]},yg=t=>{const e=t&&xv(t);if(e)return e.pop()};async function DS(t){const{cacao:e,projectId:r}=t,{s:n,p:s}=e,i=YO(s,s.iss),o=yg(s.iss);return await Jee(o,i,n,vb(s.iss),r)}const YO=(t,e)=>{const r=`${t.domain} wants you to sign in with your Ethereum account:`,n=yg(e);if(!t.aud&&!t.uri)throw new Error("Either `aud` or `uri` is required to construct the message");let s=t.statement||void 0;const i=`URI: ${t.aud||t.uri}`,o=`Version: ${t.version}`,a=`Chain ID: ${gte(e)}`,c=`Nonce: ${t.nonce}`,l=`Issued At: ${t.iat}`,u=t.exp?`Expiration Time: ${t.exp}`:void 0,d=t.nbf?`Not Before: ${t.nbf}`:void 0,h=t.requestId?`Request ID: ${t.requestId}`:void 0,p=t.resources?`Resources:${t.resources.map(g=>`
- ${g}`).join("")}`:void 0,y=mp(t.resources);if(y){const g=mh(y);s=Ste(s,g)}return[r,n,"",s,"",i,o,a,c,l,u,d,h,p].filter(g=>g!=null).join(`
`)};function yte(t){return Buffer.from(JSON.stringify(t)).toString("base64")}function mte(t){return JSON.parse(Buffer.from(t,"base64").toString("utf-8"))}function Mc(t){if(!t)throw new Error("No recap provided, value is undefined");if(!t.att)throw new Error("No `att` property found");const e=Object.keys(t.att);if(!(e!=null&&e.length))throw new Error("No resources found in `att` property");e.forEach(r=>{const n=t.att[r];if(Array.isArray(n))throw new Error(`Resource must be an object: ${r}`);if(typeof n!="object")throw new Error(`Resource must be an object: ${r}`);if(!Object.keys(n).length)throw new Error(`Resource object is empty: ${r}`);Object.keys(n).forEach(s=>{const i=n[s];if(!Array.isArray(i))throw new Error(`Ability limits ${s} must be an array of objects, found: ${i}`);if(!i.length)throw new Error(`Value of ${s} is empty array, must be an array with objects`);i.forEach(o=>{if(typeof o!="object")throw new Error(`Ability limits (${s}) must be an array of objects, found: ${o}`)})})})}function wte(t,e,r,n={}){return r?.sort((s,i)=>s.localeCompare(i)),{att:{[t]:bte(e,r,n)}}}function bte(t,e,r={}){e=e?.sort((s,i)=>s.localeCompare(i));const n=e.map(s=>({[`${t}/${s}`]:[r]}));return Object.assign({},...n)}function XO(t){return Mc(t),`urn:recap:${yte(t).replace(/=/g,"")}`}function mh(t){const e=mte(t.replace("urn:recap:",""));return Mc(e),e}function vte(t,e,r){const n=wte(t,e,r);return XO(n)}function Ete(t){return t&&t.includes("urn:recap:")}function _te(t,e){const r=mh(t),n=mh(e),s=xte(r,n);return XO(s)}function xte(t,e){Mc(t),Mc(e);const r=Object.keys(t.att).concat(Object.keys(e.att)).sort((s,i)=>s.localeCompare(i)),n={att:{}};return r.forEach(s=>{var i,o;Object.keys(((i=t.att)==null?void 0:i[s])||{}).concat(Object.keys(((o=e.att)==null?void 0:o[s])||{})).sort((a,c)=>a.localeCompare(c)).forEach(a=>{var c,l;n.att[s]=fte(hte({},n.att[s]),{[a]:((c=t.att[s])==null?void 0:c[a])||((l=e.att[s])==null?void 0:l[a])})})}),n}function Ste(t="",e){Mc(e);const r="I further authorize the stated URI to perform the following actions on my behalf: ";if(t.includes(r))return t;const n=[];let s=0;Object.keys(e.att).forEach(a=>{const c=Object.keys(e.att[a]).map(d=>({ability:d.split("/")[0],action:d.split("/")[1]}));c.sort((d,h)=>d.action.localeCompare(h.action));const l={};c.forEach(d=>{l[d.ability]||(l[d.ability]=[]),l[d.ability].push(d.action)});const u=Object.keys(l).map(d=>(s++,`(${s}) '${d}': '${l[d].join("', '")}' for '${a}'.`));n.push(u.join(", ").replace(".,","."))});const i=n.join(" "),o=`${r}${i}`;return`${t?t+" ":""}${o}`}function US(t){var e;const r=mh(t);Mc(r);const n=(e=r.att)==null?void 0:e.eip155;return n?Object.keys(n).map(s=>s.split("/")[1]):[]}function BS(t){const e=mh(t);Mc(e);const r=[];return Object.values(e.att).forEach(n=>{Object.values(n).forEach(s=>{var i;(i=s?.[0])!=null&&i.chains&&r.push(s[0].chains)})}),[...new Set(r.flat())]}function mp(t){if(!t)return;const e=t?.[t.length-1];return Ete(e)?e:void 0}function ZO(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function Eb(t){if(typeof t!="boolean")throw new Error(`boolean expected, not ${t}`)}function ww(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function Jn(t,...e){if(!ZO(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function LS(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function Ate(t,e){Jn(t);const r=e.outputLen;if(t.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}function Ia(t){return new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4))}function au(...t){for(let e=0;e<t.length;e++)t[e].fill(0)}function Ite(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}const Cte=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function $te(t){if(typeof t!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(t))}function _b(t){if(typeof t=="string")t=$te(t);else if(ZO(t))t=xb(t);else throw new Error("Uint8Array expected, got "+typeof t);return t}function Tte(t,e){if(e==null||typeof e!="object")throw new Error("options must be defined");return Object.assign(t,e)}function Nte(t,e){if(t.length!==e.length)return!1;let r=0;for(let n=0;n<t.length;n++)r|=t[n]^e[n];return r===0}const Ote=(t,e)=>{function r(n,...s){if(Jn(n),!Cte)throw new Error("Non little-endian hardware is not yet supported");if(t.nonceLength!==void 0){const l=s[0];if(!l)throw new Error("nonce / iv required");t.varSizeNonce?Jn(l):Jn(l,t.nonceLength)}const i=t.tagLength;i&&s[1]!==void 0&&Jn(s[1]);const o=e(n,...s),a=(l,u)=>{if(u!==void 0){if(l!==2)throw new Error("cipher output not supported");Jn(u)}};let c=!1;return{encrypt(l,u){if(c)throw new Error("cannot encrypt() twice with same key + nonce");return c=!0,Jn(l),a(o.encrypt.length,u),o.encrypt(l,u)},decrypt(l,u){if(Jn(l),i&&l.length<i)throw new Error("invalid ciphertext length: smaller than tagLength="+i);return a(o.decrypt.length,u),o.decrypt(l,u)}}}return Object.assign(r,t),r};function MS(t,e,r=!0){if(e===void 0)return new Uint8Array(t);if(e.length!==t)throw new Error("invalid output length, expected "+t+", got: "+e.length);if(r&&!Pte(e))throw new Error("invalid output, must be aligned");return e}function jS(t,e,r,n){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,n);const s=BigInt(32),i=BigInt(4294967295),o=Number(r>>s&i),a=Number(r&i);t.setUint32(e+4,o,n),t.setUint32(e+0,a,n)}function kte(t,e,r){Eb(r);const n=new Uint8Array(16),s=Ite(n);return jS(s,0,BigInt(e),r),jS(s,8,BigInt(t),r),n}function Pte(t){return t.byteOffset%4===0}function xb(t){return Uint8Array.from(t)}const JO=t=>Uint8Array.from(t.split("").map(e=>e.charCodeAt(0))),Rte=JO("expand 16-byte k"),Dte=JO("expand 32-byte k"),Ute=Ia(Rte),Bte=Ia(Dte);function Ct(t,e){return t<<e|t>>>32-e}function Sb(t){return t.byteOffset%4===0}const jf=64,Lte=16,QO=2**32-1,FS=new Uint32Array;function Mte(t,e,r,n,s,i,o,a){const c=s.length,l=new Uint8Array(jf),u=Ia(l),d=Sb(s)&&Sb(i),h=d?Ia(s):FS,p=d?Ia(i):FS;for(let y=0;y<c;o++){if(t(e,r,n,u,o,a),o>=QO)throw new Error("arx: counter overflow");const g=Math.min(jf,c-y);if(d&&g===jf){const w=y/4;if(y%4!==0)throw new Error("arx: invalid block position");for(let S=0,A;S<Lte;S++)A=w+S,p[A]=h[A]^u[S];y+=jf;continue}for(let w=0,S;w<g;w++)S=y+w,i[S]=s[S]^l[w];y+=g}}function jte(t,e){const{allowShortKeys:r,extendNonceFn:n,counterLength:s,counterRight:i,rounds:o}=Tte({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},e);if(typeof t!="function")throw new Error("core must be a function");return ww(s),ww(o),Eb(i),Eb(r),(a,c,l,u,d=0)=>{Jn(a),Jn(c),Jn(l);const h=l.length;if(u===void 0&&(u=new Uint8Array(h)),Jn(u),ww(d),d<0||d>=QO)throw new Error("arx: counter overflow");if(u.length<h)throw new Error(`arx: output (${u.length}) is shorter than data (${h})`);const p=[];let y=a.length,g,w;if(y===32)p.push(g=xb(a)),w=Bte;else if(y===16&&r)g=new Uint8Array(32),g.set(a),g.set(a,16),w=Ute,p.push(g);else throw new Error(`arx: invalid 32-byte key, got length=${y}`);Sb(c)||p.push(c=xb(c));const S=Ia(g);if(n){if(c.length!==24)throw new Error("arx: extended nonce must be 24 bytes");n(w,S,Ia(c.subarray(0,16)),S),c=c.subarray(16)}const A=16-s;if(A!==c.length)throw new Error(`arx: nonce must be ${A} or 16 bytes`);if(A!==12){const v=new Uint8Array(12);v.set(c,i?0:12-c.length),c=v,p.push(c)}const E=Ia(c);return Mte(t,w,S,E,l,u,d,o),au(...p),u}}const tn=(t,e)=>t[e++]&255|(t[e++]&255)<<8;class Fte{constructor(e){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,e=_b(e),Jn(e,32);const r=tn(e,0),n=tn(e,2),s=tn(e,4),i=tn(e,6),o=tn(e,8),a=tn(e,10),c=tn(e,12),l=tn(e,14);this.r[0]=r&8191,this.r[1]=(r>>>13|n<<3)&8191,this.r[2]=(n>>>10|s<<6)&7939,this.r[3]=(s>>>7|i<<9)&8191,this.r[4]=(i>>>4|o<<12)&255,this.r[5]=o>>>1&8190,this.r[6]=(o>>>14|a<<2)&8191,this.r[7]=(a>>>11|c<<5)&8065,this.r[8]=(c>>>8|l<<8)&8191,this.r[9]=l>>>5&127;for(let u=0;u<8;u++)this.pad[u]=tn(e,16+2*u)}process(e,r,n=!1){const s=n?0:2048,{h:i,r:o}=this,a=o[0],c=o[1],l=o[2],u=o[3],d=o[4],h=o[5],p=o[6],y=o[7],g=o[8],w=o[9],S=tn(e,r+0),A=tn(e,r+2),E=tn(e,r+4),v=tn(e,r+6),C=tn(e,r+8),O=tn(e,r+10),L=tn(e,r+12),j=tn(e,r+14);let D=i[0]+(S&8191),W=i[1]+((S>>>13|A<<3)&8191),P=i[2]+((A>>>10|E<<6)&8191),R=i[3]+((E>>>7|v<<9)&8191),T=i[4]+((v>>>4|C<<12)&8191),k=i[5]+(C>>>1&8191),f=i[6]+((C>>>14|O<<2)&8191),m=i[7]+((O>>>11|L<<5)&8191),_=i[8]+((L>>>8|j<<8)&8191),$=i[9]+(j>>>5|s),x=0,N=x+D*a+W*(5*w)+P*(5*g)+R*(5*y)+T*(5*p);x=N>>>13,N&=8191,N+=k*(5*h)+f*(5*d)+m*(5*u)+_*(5*l)+$*(5*c),x+=N>>>13,N&=8191;let H=x+D*c+W*a+P*(5*w)+R*(5*g)+T*(5*y);x=H>>>13,H&=8191,H+=k*(5*p)+f*(5*h)+m*(5*d)+_*(5*u)+$*(5*l),x+=H>>>13,H&=8191;let z=x+D*l+W*c+P*a+R*(5*w)+T*(5*g);x=z>>>13,z&=8191,z+=k*(5*y)+f*(5*p)+m*(5*h)+_*(5*d)+$*(5*u),x+=z>>>13,z&=8191;let G=x+D*u+W*l+P*c+R*a+T*(5*w);x=G>>>13,G&=8191,G+=k*(5*g)+f*(5*y)+m*(5*p)+_*(5*h)+$*(5*d),x+=G>>>13,G&=8191;let M=x+D*d+W*u+P*l+R*c+T*a;x=M>>>13,M&=8191,M+=k*(5*w)+f*(5*g)+m*(5*y)+_*(5*p)+$*(5*h),x+=M>>>13,M&=8191;let V=x+D*h+W*d+P*u+R*l+T*c;x=V>>>13,V&=8191,V+=k*a+f*(5*w)+m*(5*g)+_*(5*y)+$*(5*p),x+=V>>>13,V&=8191;let J=x+D*p+W*h+P*d+R*u+T*l;x=J>>>13,J&=8191,J+=k*c+f*a+m*(5*w)+_*(5*g)+$*(5*y),x+=J>>>13,J&=8191;let re=x+D*y+W*p+P*h+R*d+T*u;x=re>>>13,re&=8191,re+=k*l+f*c+m*a+_*(5*w)+$*(5*g),x+=re>>>13,re&=8191;let ye=x+D*g+W*y+P*p+R*h+T*d;x=ye>>>13,ye&=8191,ye+=k*u+f*l+m*c+_*a+$*(5*w),x+=ye>>>13,ye&=8191;let ne=x+D*w+W*g+P*y+R*p+T*h;x=ne>>>13,ne&=8191,ne+=k*d+f*u+m*l+_*c+$*a,x+=ne>>>13,ne&=8191,x=(x<<2)+x|0,x=x+N|0,N=x&8191,x=x>>>13,H+=x,i[0]=N,i[1]=H,i[2]=z,i[3]=G,i[4]=M,i[5]=V,i[6]=J,i[7]=re,i[8]=ye,i[9]=ne}finalize(){const{h:e,pad:r}=this,n=new Uint16Array(10);let s=e[1]>>>13;e[1]&=8191;for(let a=2;a<10;a++)e[a]+=s,s=e[a]>>>13,e[a]&=8191;e[0]+=s*5,s=e[0]>>>13,e[0]&=8191,e[1]+=s,s=e[1]>>>13,e[1]&=8191,e[2]+=s,n[0]=e[0]+5,s=n[0]>>>13,n[0]&=8191;for(let a=1;a<10;a++)n[a]=e[a]+s,s=n[a]>>>13,n[a]&=8191;n[9]-=8192;let i=(s^1)-1;for(let a=0;a<10;a++)n[a]&=i;i=~i;for(let a=0;a<10;a++)e[a]=e[a]&i|n[a];e[0]=(e[0]|e[1]<<13)&65535,e[1]=(e[1]>>>3|e[2]<<10)&65535,e[2]=(e[2]>>>6|e[3]<<7)&65535,e[3]=(e[3]>>>9|e[4]<<4)&65535,e[4]=(e[4]>>>12|e[5]<<1|e[6]<<14)&65535,e[5]=(e[6]>>>2|e[7]<<11)&65535,e[6]=(e[7]>>>5|e[8]<<8)&65535,e[7]=(e[8]>>>8|e[9]<<5)&65535;let o=e[0]+r[0];e[0]=o&65535;for(let a=1;a<8;a++)o=(e[a]+r[a]|0)+(o>>>16)|0,e[a]=o&65535;au(n)}update(e){LS(this),e=_b(e),Jn(e);const{buffer:r,blockLen:n}=this,s=e.length;for(let i=0;i<s;){const o=Math.min(n-this.pos,s-i);if(o===n){for(;n<=s-i;i+=n)this.process(e,i);continue}r.set(e.subarray(i,i+o),this.pos),this.pos+=o,i+=o,this.pos===n&&(this.process(r,0,!1),this.pos=0)}return this}destroy(){au(this.h,this.r,this.buffer,this.pad)}digestInto(e){LS(this),Ate(e,this),this.finished=!0;const{buffer:r,h:n}=this;let{pos:s}=this;if(s){for(r[s++]=1;s<16;s++)r[s]=0;this.process(r,0,!0)}this.finalize();let i=0;for(let o=0;o<8;o++)e[i++]=n[o]>>>0,e[i++]=n[o]>>>8;return e}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const n=e.slice(0,r);return this.destroy(),n}}function qte(t){const e=(n,s)=>t(s).update(_b(n)).digest(),r=t(new Uint8Array(32));return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=n=>t(n),e}const zte=qte(t=>new Fte(t));function Hte(t,e,r,n,s,i=20){let o=t[0],a=t[1],c=t[2],l=t[3],u=e[0],d=e[1],h=e[2],p=e[3],y=e[4],g=e[5],w=e[6],S=e[7],A=s,E=r[0],v=r[1],C=r[2],O=o,L=a,j=c,D=l,W=u,P=d,R=h,T=p,k=y,f=g,m=w,_=S,$=A,x=E,N=v,H=C;for(let G=0;G<i;G+=2)O=O+W|0,$=Ct($^O,16),k=k+$|0,W=Ct(W^k,12),O=O+W|0,$=Ct($^O,8),k=k+$|0,W=Ct(W^k,7),L=L+P|0,x=Ct(x^L,16),f=f+x|0,P=Ct(P^f,12),L=L+P|0,x=Ct(x^L,8),f=f+x|0,P=Ct(P^f,7),j=j+R|0,N=Ct(N^j,16),m=m+N|0,R=Ct(R^m,12),j=j+R|0,N=Ct(N^j,8),m=m+N|0,R=Ct(R^m,7),D=D+T|0,H=Ct(H^D,16),_=_+H|0,T=Ct(T^_,12),D=D+T|0,H=Ct(H^D,8),_=_+H|0,T=Ct(T^_,7),O=O+P|0,H=Ct(H^O,16),m=m+H|0,P=Ct(P^m,12),O=O+P|0,H=Ct(H^O,8),m=m+H|0,P=Ct(P^m,7),L=L+R|0,$=Ct($^L,16),_=_+$|0,R=Ct(R^_,12),L=L+R|0,$=Ct($^L,8),_=_+$|0,R=Ct(R^_,7),j=j+T|0,x=Ct(x^j,16),k=k+x|0,T=Ct(T^k,12),j=j+T|0,x=Ct(x^j,8),k=k+x|0,T=Ct(T^k,7),D=D+W|0,N=Ct(N^D,16),f=f+N|0,W=Ct(W^f,12),D=D+W|0,N=Ct(N^D,8),f=f+N|0,W=Ct(W^f,7);let z=0;n[z++]=o+O|0,n[z++]=a+L|0,n[z++]=c+j|0,n[z++]=l+D|0,n[z++]=u+W|0,n[z++]=d+P|0,n[z++]=h+R|0,n[z++]=p+T|0,n[z++]=y+k|0,n[z++]=g+f|0,n[z++]=w+m|0,n[z++]=S+_|0,n[z++]=A+$|0,n[z++]=E+x|0,n[z++]=v+N|0,n[z++]=C+H|0}const Wte=jte(Hte,{counterRight:!1,counterLength:4,allowShortKeys:!1}),Vte=new Uint8Array(16),qS=(t,e)=>{t.update(e);const r=e.length%16;r&&t.update(Vte.subarray(r))},Kte=new Uint8Array(32);function zS(t,e,r,n,s){const i=t(e,r,Kte),o=zte.create(i);s&&qS(o,s),qS(o,n);const a=kte(n.length,s?s.length:0,!0);o.update(a);const c=o.digest();return au(i,a),c}const Gte=t=>(e,r,n)=>({encrypt(s,i){const o=s.length;i=MS(o+16,i,!1),i.set(s);const a=i.subarray(0,-16);t(e,r,a,a,1);const c=zS(t,e,r,a,n);return i.set(c,o),au(c),i},decrypt(s,i){i=MS(s.length-16,i,!1);const o=s.subarray(0,-16),a=s.subarray(-16),c=zS(t,e,r,o,n);if(!Nte(a,c))throw new Error("invalid tag");return i.set(s.subarray(0,-16)),t(e,r,i,i,1),au(c),i}}),e5=Ote({blockSize:64,nonceLength:12,tagLength:16},Gte(Wte));let t5=class extends fy{constructor(e,r){super(),this.finished=!1,this.destroyed=!1,hy(e);const n=mi(r);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const s=this.blockLen,i=new Uint8Array(s);i.set(n.length>s?e.create().update(n).digest():n);for(let o=0;o<i.length;o++)i[o]^=54;this.iHash.update(i),this.oHash=e.create();for(let o=0;o<i.length;o++)i[o]^=106;this.oHash.update(i),Zs(i)}update(e){return ka(this),this.iHash.update(e),this}digestInto(e){ka(this),vi(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:r,iHash:n,finished:s,destroyed:i,blockLen:o,outputLen:a}=this;return e=e,e.finished=s,e.destroyed=i,e.blockLen=o,e.outputLen=a,e.oHash=r._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};const gy=(t,e,r)=>new t5(t,e).update(r).digest();gy.create=(t,e)=>new t5(t,e);function Yte(t,e,r){return hy(t),r===void 0&&(r=new Uint8Array(t.outputLen)),gy(t,mi(r),mi(e))}const bw=Uint8Array.from([0]),HS=Uint8Array.of();function Xte(t,e,r,n=32){hy(t),Uo(n);const s=t.outputLen;if(n>255*s)throw new Error("Length should be <= 255*HashLen");const i=Math.ceil(n/s);r===void 0&&(r=HS);const o=new Uint8Array(i*s),a=gy.create(t,e),c=a._cloneInto(),l=new Uint8Array(a.outputLen);for(let u=0;u<i;u++)bw[0]=u+1,c.update(u===0?HS:l).update(r).update(bw).digestInto(l),o.set(l,s*u),a._cloneInto(c);return a.destroy(),c.destroy(),Zs(l,bw),o.slice(0,n)}const Zte=(t,e,r,n,s)=>Xte(t,Yte(t,e,r),n,s),yy=py,Sv=BigInt(0),Ab=BigInt(1);function mg(t,e=""){if(typeof t!="boolean"){const r=e&&`"${e}"`;throw new Error(r+"expected boolean, got type="+typeof t)}return t}function vc(t,e,r=""){const n=dy(t),s=t?.length,i=e!==void 0;if(!n||i&&s!==e){const o=r&&`"${r}" `,a=i?` of length ${e}`:"",c=n?`length=${s}`:`type=${typeof t}`;throw new Error(o+"expected Uint8Array"+a+", got "+c)}return t}function Ff(t){const e=t.toString(16);return e.length&1?"0"+e:e}function r5(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return t===""?Sv:BigInt("0x"+t)}function my(t){return r5(Fl(t))}function wg(t){return vi(t),r5(Fl(Uint8Array.from(t).reverse()))}function Av(t,e){return gg(t.toString(16).padStart(e*2,"0"))}function Iv(t,e){return Av(t,e).reverse()}function $n(t,e,r){let n;if(typeof e=="string")try{n=gg(e)}catch(i){throw new Error(t+" must be hex string or Uint8Array, cause: "+i)}else if(dy(e))n=Uint8Array.from(e);else throw new Error(t+" must be hex string or Uint8Array");const s=n.length;if(typeof r=="number"&&s!==r)throw new Error(t+" of length "+r+" expected, got "+s);return n}const vw=t=>typeof t=="bigint"&&Sv<=t;function Jte(t,e,r){return vw(t)&&vw(e)&&vw(r)&&e<=t&&t<r}function Ib(t,e,r,n){if(!Jte(e,r,n))throw new Error("expected valid "+t+": "+r+" <= n < "+n+", got "+e)}function n5(t){let e;for(e=0;t>Sv;t>>=Ab,e+=1);return e}const Yh=t=>(Ab<<BigInt(t))-Ab;function Qte(t,e,r){if(typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof r!="function")throw new Error("hmacFn must be a function");const n=h=>new Uint8Array(h),s=h=>Uint8Array.of(h);let i=n(t),o=n(t),a=0;const c=()=>{i.fill(1),o.fill(0),a=0},l=(...h)=>r(o,i,...h),u=(h=n(0))=>{o=l(s(0),h),i=l(),h.length!==0&&(o=l(s(1),h),i=l())},d=()=>{if(a++>=1e3)throw new Error("drbg: tried 1000 values");let h=0;const p=[];for(;h<e;){i=l();const y=i.slice();p.push(y),h+=i.length}return ya(...p)};return(h,p)=>{c(),u(h);let y;for(;!(y=p(d()));)u();return c(),y}}function wy(t,e,r={}){if(!t||typeof t!="object")throw new Error("expected valid options object");function n(s,i,o){const a=t[s];if(o&&a===void 0)return;const c=typeof a;if(c!==i||a===null)throw new Error(`param "${s}" is invalid: expected ${i}, got ${c}`)}Object.entries(e).forEach(([s,i])=>n(s,i,!1)),Object.entries(r).forEach(([s,i])=>n(s,i,!0))}function WS(t){const e=new WeakMap;return(r,...n)=>{const s=e.get(r);if(s!==void 0)return s;const i=t(r,...n);return e.set(r,i),i}}const ns=BigInt(0),Dn=BigInt(1),Ec=BigInt(2),s5=BigInt(3),i5=BigInt(4),o5=BigInt(5),ere=BigInt(7),a5=BigInt(8),tre=BigInt(9),c5=BigInt(16);function Es(t,e){const r=t%e;return r>=ns?r:e+r}function ci(t,e,r){let n=t;for(;e-- >ns;)n*=n,n%=r;return n}function VS(t,e){if(t===ns)throw new Error("invert: expected non-zero number");if(e<=ns)throw new Error("invert: expected positive modulus, got "+e);let r=Es(t,e),n=e,s=ns,i=Dn;for(;r!==ns;){const o=n/r,a=n%r,c=s-i*o;n=r,r=a,s=i,i=c}if(n!==Dn)throw new Error("invert: does not exist");return Es(s,e)}function Cv(t,e,r){if(!t.eql(t.sqr(e),r))throw new Error("Cannot find square root")}function l5(t,e){const r=(t.ORDER+Dn)/i5,n=t.pow(e,r);return Cv(t,n,e),n}function rre(t,e){const r=(t.ORDER-o5)/a5,n=t.mul(e,Ec),s=t.pow(n,r),i=t.mul(e,s),o=t.mul(t.mul(i,Ec),s),a=t.mul(i,t.sub(o,t.ONE));return Cv(t,a,e),a}function nre(t){const e=La(t),r=u5(t),n=r(e,e.neg(e.ONE)),s=r(e,n),i=r(e,e.neg(n)),o=(t+ere)/c5;return(a,c)=>{let l=a.pow(c,o),u=a.mul(l,n);const d=a.mul(l,s),h=a.mul(l,i),p=a.eql(a.sqr(u),c),y=a.eql(a.sqr(d),c);l=a.cmov(l,u,p),u=a.cmov(h,d,y);const g=a.eql(a.sqr(u),c),w=a.cmov(l,u,g);return Cv(a,w,c),w}}function u5(t){if(t<s5)throw new Error("sqrt is not defined for small field");let e=t-Dn,r=0;for(;e%Ec===ns;)e/=Ec,r++;let n=Ec;const s=La(t);for(;KS(s,n)===1;)if(n++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(r===1)return l5;let i=s.pow(n,e);const o=(e+Dn)/Ec;return function(a,c){if(a.is0(c))return c;if(KS(a,c)!==1)throw new Error("Cannot find square root");let l=r,u=a.mul(a.ONE,i),d=a.pow(c,e),h=a.pow(c,o);for(;!a.eql(d,a.ONE);){if(a.is0(d))return a.ZERO;let p=1,y=a.sqr(d);for(;!a.eql(y,a.ONE);)if(p++,y=a.sqr(y),p===l)throw new Error("Cannot find square root");const g=Dn<<BigInt(l-p-1),w=a.pow(u,g);l=p,u=a.sqr(w),d=a.mul(d,u),h=a.mul(h,w)}return h}}function sre(t){return t%i5===s5?l5:t%a5===o5?rre:t%c5===tre?nre(t):u5(t)}const ire=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function ore(t){const e={ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"},r=ire.reduce((n,s)=>(n[s]="function",n),e);return wy(t,r),t}function are(t,e,r){if(r<ns)throw new Error("invalid exponent, negatives unsupported");if(r===ns)return t.ONE;if(r===Dn)return e;let n=t.ONE,s=e;for(;r>ns;)r&Dn&&(n=t.mul(n,s)),s=t.sqr(s),r>>=Dn;return n}function d5(t,e,r=!1){const n=new Array(e.length).fill(r?t.ZERO:void 0),s=e.reduce((o,a,c)=>t.is0(a)?o:(n[c]=o,t.mul(o,a)),t.ONE),i=t.inv(s);return e.reduceRight((o,a,c)=>t.is0(a)?o:(n[c]=t.mul(o,n[c]),t.mul(o,a)),i),n}function KS(t,e){const r=(t.ORDER-Dn)/Ec,n=t.pow(e,r),s=t.eql(n,t.ONE),i=t.eql(n,t.ZERO),o=t.eql(n,t.neg(t.ONE));if(!s&&!i&&!o)throw new Error("invalid Legendre symbol result");return s?1:i?0:-1}function h5(t,e){e!==void 0&&Uo(e);const r=e!==void 0?e:t.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}function La(t,e,r=!1,n={}){if(t<=ns)throw new Error("invalid field: expected ORDER > 0, got "+t);let s,i,o=!1,a;if(typeof e=="object"&&e!=null){if(n.sqrt||r)throw new Error("cannot specify opts in two arguments");const h=e;h.BITS&&(s=h.BITS),h.sqrt&&(i=h.sqrt),typeof h.isLE=="boolean"&&(r=h.isLE),typeof h.modFromBytes=="boolean"&&(o=h.modFromBytes),a=h.allowedLengths}else typeof e=="number"&&(s=e),n.sqrt&&(i=n.sqrt);const{nBitLength:c,nByteLength:l}=h5(t,s);if(l>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let u;const d=Object.freeze({ORDER:t,isLE:r,BITS:c,BYTES:l,MASK:Yh(c),ZERO:ns,ONE:Dn,allowedLengths:a,create:h=>Es(h,t),isValid:h=>{if(typeof h!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof h);return ns<=h&&h<t},is0:h=>h===ns,isValidNot0:h=>!d.is0(h)&&d.isValid(h),isOdd:h=>(h&Dn)===Dn,neg:h=>Es(-h,t),eql:(h,p)=>h===p,sqr:h=>Es(h*h,t),add:(h,p)=>Es(h+p,t),sub:(h,p)=>Es(h-p,t),mul:(h,p)=>Es(h*p,t),pow:(h,p)=>are(d,h,p),div:(h,p)=>Es(h*VS(p,t),t),sqrN:h=>h*h,addN:(h,p)=>h+p,subN:(h,p)=>h-p,mulN:(h,p)=>h*p,inv:h=>VS(h,t),sqrt:i||(h=>(u||(u=sre(t)),u(d,h))),toBytes:h=>r?Iv(h,l):Av(h,l),fromBytes:(h,p=!0)=>{if(a){if(!a.includes(h.length)||h.length>l)throw new Error("Field.fromBytes: expected "+a+" bytes, got "+h.length);const g=new Uint8Array(l);g.set(h,r?0:g.length-h.length),h=g}if(h.length!==l)throw new Error("Field.fromBytes: expected "+l+" bytes, got "+h.length);let y=r?wg(h):my(h);if(o&&(y=Es(y,t)),!p&&!d.isValid(y))throw new Error("invalid field element: outside of range 0..ORDER");return y},invertBatch:h=>d5(d,h),cmov:(h,p,y)=>y?p:h});return Object.freeze(d)}function f5(t){if(typeof t!="bigint")throw new Error("field order must be bigint");const e=t.toString(2).length;return Math.ceil(e/8)}function p5(t){const e=f5(t);return e+Math.ceil(e/2)}function cre(t,e,r=!1){const n=t.length,s=f5(e),i=p5(e);if(n<16||n<i||n>1024)throw new Error("expected "+i+"-1024 bytes of input, got "+n);const o=r?wg(t):my(t),a=Es(o,e-Dn)+Dn;return r?Iv(a,s):Av(a,s)}const cu=BigInt(0),_c=BigInt(1);function bg(t,e){const r=e.negate();return t?r:e}function Ew(t,e){const r=d5(t.Fp,e.map(n=>n.Z));return e.map((n,s)=>t.fromAffine(n.toAffine(r[s])))}function g5(t,e){if(!Number.isSafeInteger(t)||t<=0||t>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+t)}function _w(t,e){g5(t,e);const r=Math.ceil(e/t)+1,n=2**(t-1),s=2**t,i=Yh(t),o=BigInt(t);return{windows:r,windowSize:n,mask:i,maxNumber:s,shiftBy:o}}function GS(t,e,r){const{windowSize:n,mask:s,maxNumber:i,shiftBy:o}=r;let a=Number(t&s),c=t>>o;a>n&&(a-=i,c+=_c);const l=e*n,u=l+Math.abs(a)-1,d=a===0,h=a<0,p=e%2!==0;return{nextN:c,offset:u,isZero:d,isNeg:h,isNegF:p,offsetF:l}}function lre(t,e){if(!Array.isArray(t))throw new Error("array expected");t.forEach((r,n)=>{if(!(r instanceof e))throw new Error("invalid point at index "+n)})}function ure(t,e){if(!Array.isArray(t))throw new Error("array of scalars expected");t.forEach((r,n)=>{if(!e.isValid(r))throw new Error("invalid scalar at index "+n)})}const xw=new WeakMap,y5=new WeakMap;function Sw(t){return y5.get(t)||1}function YS(t){if(t!==cu)throw new Error("invalid wNAF")}class dre{constructor(e,r){this.BASE=e.BASE,this.ZERO=e.ZERO,this.Fn=e.Fn,this.bits=r}_unsafeLadder(e,r,n=this.ZERO){let s=e;for(;r>cu;)r&_c&&(n=n.add(s)),s=s.double(),r>>=_c;return n}precomputeWindow(e,r){const{windows:n,windowSize:s}=_w(r,this.bits),i=[];let o=e,a=o;for(let c=0;c<n;c++){a=o,i.push(a);for(let l=1;l<s;l++)a=a.add(o),i.push(a);o=a.double()}return i}wNAF(e,r,n){if(!this.Fn.isValid(n))throw new Error("invalid scalar");let s=this.ZERO,i=this.BASE;const o=_w(e,this.bits);for(let a=0;a<o.windows;a++){const{nextN:c,offset:l,isZero:u,isNeg:d,isNegF:h,offsetF:p}=GS(n,a,o);n=c,u?i=i.add(bg(h,r[p])):s=s.add(bg(d,r[l]))}return YS(n),{p:s,f:i}}wNAFUnsafe(e,r,n,s=this.ZERO){const i=_w(e,this.bits);for(let o=0;o<i.windows&&n!==cu;o++){const{nextN:a,offset:c,isZero:l,isNeg:u}=GS(n,o,i);if(n=a,!l){const d=r[c];s=s.add(u?d.negate():d)}}return YS(n),s}getPrecomputes(e,r,n){let s=xw.get(r);return s||(s=this.precomputeWindow(r,e),e!==1&&(typeof n=="function"&&(s=n(s)),xw.set(r,s))),s}cached(e,r,n){const s=Sw(e);return this.wNAF(s,this.getPrecomputes(s,e,n),r)}unsafe(e,r,n,s){const i=Sw(e);return i===1?this._unsafeLadder(e,r,s):this.wNAFUnsafe(i,this.getPrecomputes(i,e,n),r,s)}createCache(e,r){g5(r,this.bits),y5.set(e,r),xw.delete(e)}hasCache(e){return Sw(e)!==1}}function hre(t,e,r,n){let s=e,i=t.ZERO,o=t.ZERO;for(;r>cu||n>cu;)r&_c&&(i=i.add(s)),n&_c&&(o=o.add(s)),s=s.double(),r>>=_c,n>>=_c;return{p1:i,p2:o}}function fre(t,e,r,n){lre(r,t),ure(n,e);const s=r.length,i=n.length;if(s!==i)throw new Error("arrays of points and scalars must have equal length");const o=t.ZERO,a=n5(BigInt(s));let c=1;a>12?c=a-3:a>4?c=a-2:a>0&&(c=2);const l=Yh(c),u=new Array(Number(l)+1).fill(o),d=Math.floor((e.BITS-1)/c)*c;let h=o;for(let p=d;p>=0;p-=c){u.fill(o);for(let g=0;g<i;g++){const w=n[g],S=Number(w>>BigInt(p)&l);u[S]=u[S].add(r[g])}let y=o;for(let g=u.length-1,w=o;g>0;g--)w=w.add(u[g]),y=y.add(w);if(h=h.add(y),p!==0)for(let g=0;g<c;g++)h=h.double()}return h}function XS(t,e,r){if(e){if(e.ORDER!==t)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return ore(e),e}else return La(t,{isLE:r})}function pre(t,e,r={},n){if(n===void 0&&(n=t==="edwards"),!e||typeof e!="object")throw new Error(`expected valid ${t} CURVE object`);for(const a of["p","n","h"]){const c=e[a];if(!(typeof c=="bigint"&&c>cu))throw new Error(`CURVE.${a} must be positive bigint`)}const s=XS(e.p,r.Fp,n),i=XS(e.n,r.Fn,n),o=["Gx","Gy","a","b"];for(const a of o)if(!s.isValid(e[a]))throw new Error(`CURVE.${a} must be valid field element of CURVE.Fp`);return e=Object.freeze(Object.assign({},e)),{CURVE:e,Fp:s,Fn:i}}BigInt(0),BigInt(1),BigInt(2),BigInt(8),jO("HashToScalar-");const Yu=BigInt(0),bl=BigInt(1),qf=BigInt(2);function gre(t){return wy(t,{adjustScalarBytes:"function",powPminus2:"function"}),Object.freeze({...t})}function yre(t){const e=gre(t),{P:r,type:n,adjustScalarBytes:s,powPminus2:i,randomBytes:o}=e,a=n==="x25519";if(!a&&n!=="x448")throw new Error("invalid type");const c=o||Jc,l=a?255:448,u=a?32:56,d=BigInt(a?9:5),h=BigInt(a?121665:39081),p=a?qf**BigInt(254):qf**BigInt(447),y=a?BigInt(8)*qf**BigInt(251)-bl:BigInt(4)*qf**BigInt(445)-bl,g=p+y+bl,w=R=>Es(R,r),S=A(d);function A(R){return Iv(w(R),u)}function E(R){const T=$n("u coordinate",R,u);return a&&(T[31]&=127),w(wg(T))}function v(R){return wg(s($n("scalar",R,u)))}function C(R,T){const k=j(E(T),v(R));if(k===Yu)throw new Error("invalid private or public key received");return A(k)}function O(R){return C(R,S)}function L(R,T,k){const f=w(R*(T-k));return T=w(T-f),k=w(k+f),{x_2:T,x_3:k}}function j(R,T){Ib("u",R,Yu,r),Ib("scalar",T,p,g);const k=T,f=R;let m=bl,_=Yu,$=R,x=bl,N=Yu;for(let z=BigInt(l-1);z>=Yu;z--){const G=k>>z&bl;N^=G,{x_2:m,x_3:$}=L(N,m,$),{x_2:_,x_3:x}=L(N,_,x),N=G;const M=m+_,V=w(M*M),J=m-_,re=w(J*J),ye=V-re,ne=$+x,se=$-x,Ie=w(se*M),Me=w(ne*J),Ve=Ie+Me,Ze=Ie-Me;$=w(Ve*Ve),x=w(f*w(Ze*Ze)),m=w(V*re),_=w(ye*(V+w(h*ye)))}({x_2:m,x_3:$}=L(N,m,$)),{x_2:_,x_3:x}=L(N,_,x);const H=i(_);return w(m*H)}const D={secretKey:u,publicKey:u,seed:u},W=(R=c(u))=>(vi(R,D.seed),R);function P(R){const T=W(R);return{secretKey:T,publicKey:O(T)}}return{keygen:P,getSharedSecret:(R,T)=>C(R,T),getPublicKey:R=>O(R),scalarMult:C,scalarMultBase:O,utils:{randomSecretKey:W,randomPrivateKey:W},GuBytes:S.slice(),lengths:D}}const mre=BigInt(1),ZS=BigInt(2),wre=BigInt(3),bre=BigInt(5);BigInt(8);const m5=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffed"),vre={p:m5,n:BigInt("0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3ed"),a:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffec"),d:BigInt("0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3"),Gx:BigInt("0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a"),Gy:BigInt("0x6666666666666666666666666666666666666666666666666666666666666658")};function Ere(t){const e=BigInt(10),r=BigInt(20),n=BigInt(40),s=BigInt(80),i=m5,o=t*t%i*t%i,a=ci(o,ZS,i)*o%i,c=ci(a,mre,i)*t%i,l=ci(c,bre,i)*c%i,u=ci(l,e,i)*l%i,d=ci(u,r,i)*u%i,h=ci(d,n,i)*d%i,p=ci(h,s,i)*h%i,y=ci(p,s,i)*h%i,g=ci(y,e,i)*l%i;return{pow_p_5_8:ci(g,ZS,i)*t%i,b2:o}}function _re(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}const xre=La(vre.p,{isLE:!0}),Cb=(()=>{const t=xre.ORDER;return yre({P:t,type:"x25519",powPminus2:e=>{const{pow_p_5_8:r,b2:n}=Ere(e);return Es(ci(r,wre,t)*n,t)},adjustScalarBytes:_re})})(),JS=(t,e)=>(t+(t>=0?e:-e)/w5)/e;function Sre(t,e,r){const[[n,s],[i,o]]=e,a=JS(o*t,r),c=JS(-s*t,r);let l=t-a*n-c*i,u=-a*s-c*o;const d=l<To,h=u<To;d&&(l=-l),h&&(u=-u);const p=Yh(Math.ceil(n5(r)/2))+ql;if(l<To||l>=p||u<To||u>=p)throw new Error("splitScalar (endomorphism): failed, k="+t);return{k1neg:d,k1:l,k2neg:h,k2:u}}function $b(t){if(!["compact","recovered","der"].includes(t))throw new Error('Signature format must be "compact", "recovered", or "der"');return t}function Aw(t,e){const r={};for(let n of Object.keys(e))r[n]=t[n]===void 0?e[n]:t[n];return mg(r.lowS,"lowS"),mg(r.prehash,"prehash"),r.format!==void 0&&$b(r.format),r}class Are extends Error{constructor(e=""){super(e)}}const vo={Err:Are,_tlv:{encode:(t,e)=>{const{Err:r}=vo;if(t<0||t>256)throw new r("tlv.encode: wrong tag");if(e.length&1)throw new r("tlv.encode: unpadded data");const n=e.length/2,s=Ff(n);if(s.length/2&128)throw new r("tlv.encode: long form length too big");const i=n>127?Ff(s.length/2|128):"";return Ff(t)+i+s+e},decode(t,e){const{Err:r}=vo;let n=0;if(t<0||t>256)throw new r("tlv.encode: wrong tag");if(e.length<2||e[n++]!==t)throw new r("tlv.decode: wrong tlv");const s=e[n++],i=!!(s&128);let o=0;if(!i)o=s;else{const c=s&127;if(!c)throw new r("tlv.decode(long): indefinite length not supported");if(c>4)throw new r("tlv.decode(long): byte length is too big");const l=e.subarray(n,n+c);if(l.length!==c)throw new r("tlv.decode: length bytes not complete");if(l[0]===0)throw new r("tlv.decode(long): zero leftmost byte");for(const u of l)o=o<<8|u;if(n+=c,o<128)throw new r("tlv.decode(long): not minimal encoding")}const a=e.subarray(n,n+o);if(a.length!==o)throw new r("tlv.decode: wrong value length");return{v:a,l:e.subarray(n+o)}}},_int:{encode(t){const{Err:e}=vo;if(t<To)throw new e("integer: negative integers are not allowed");let r=Ff(t);if(Number.parseInt(r[0],16)&8&&(r="00"+r),r.length&1)throw new e("unexpected DER parsing assertion: unpadded hex");return r},decode(t){const{Err:e}=vo;if(t[0]&128)throw new e("invalid signature integer: negative");if(t[0]===0&&!(t[1]&128))throw new e("invalid signature integer: unnecessary leading zero");return my(t)}},toSig(t){const{Err:e,_int:r,_tlv:n}=vo,s=$n("signature",t),{v:i,l:o}=n.decode(48,s);if(o.length)throw new e("invalid signature: left bytes after parsing");const{v:a,l:c}=n.decode(2,i),{v:l,l:u}=n.decode(2,c);if(u.length)throw new e("invalid signature: left bytes after parsing");return{r:r.decode(a),s:r.decode(l)}},hexFromSig(t){const{_tlv:e,_int:r}=vo,n=e.encode(2,r.encode(t.r)),s=e.encode(2,r.encode(t.s)),i=n+s;return e.encode(48,i)}},To=BigInt(0),ql=BigInt(1),w5=BigInt(2),zf=BigInt(3),Ire=BigInt(4);function Ol(t,e){const{BYTES:r}=t;let n;if(typeof e=="bigint")n=e;else{let s=$n("private key",e);try{n=t.fromBytes(s)}catch{throw new Error(`invalid private key: expected ui8a of size ${r}, got ${typeof e}`)}}if(!t.isValidNot0(n))throw new Error("invalid private key: out of range [1..N-1]");return n}function Cre(t,e={}){const r=pre("weierstrass",t,e),{Fp:n,Fn:s}=r;let i=r.CURVE;const{h:o,n:a}=i;wy(e,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});const{endo:c}=e;if(c&&(!n.is0(i.a)||typeof c.beta!="bigint"||!Array.isArray(c.basises)))throw new Error('invalid endo: expected "beta": bigint and "basises": array');const l=v5(n,s);function u(){if(!n.isOdd)throw new Error("compression is not supported: Field does not have .isOdd()")}function d(R,T,k){const{x:f,y:m}=T.toAffine(),_=n.toBytes(f);if(mg(k,"isCompressed"),k){u();const $=!n.isOdd(m);return ya(b5($),_)}else return ya(Uint8Array.of(4),_,n.toBytes(m))}function h(R){vc(R,void 0,"Point");const{publicKey:T,publicKeyUncompressed:k}=l,f=R.length,m=R[0],_=R.subarray(1);if(f===T&&(m===2||m===3)){const $=n.fromBytes(_);if(!n.isValid($))throw new Error("bad point: is not on curve, wrong x");const x=g($);let N;try{N=n.sqrt(x)}catch(z){const G=z instanceof Error?": "+z.message:"";throw new Error("bad point: is not on curve, sqrt error"+G)}u();const H=n.isOdd(N);return(m&1)===1!==H&&(N=n.neg(N)),{x:$,y:N}}else if(f===k&&m===4){const $=n.BYTES,x=n.fromBytes(_.subarray(0,$)),N=n.fromBytes(_.subarray($,$*2));if(!w(x,N))throw new Error("bad point: is not on curve");return{x,y:N}}else throw new Error(`bad point: got length ${f}, expected compressed=${T} or uncompressed=${k}`)}const p=e.toBytes||d,y=e.fromBytes||h;function g(R){const T=n.sqr(R),k=n.mul(T,R);return n.add(n.add(k,n.mul(R,i.a)),i.b)}function w(R,T){const k=n.sqr(T),f=g(R);return n.eql(k,f)}if(!w(i.Gx,i.Gy))throw new Error("bad curve params: generator point");const S=n.mul(n.pow(i.a,zf),Ire),A=n.mul(n.sqr(i.b),BigInt(27));if(n.is0(n.add(S,A)))throw new Error("bad curve params: a or b");function E(R,T,k=!1){if(!n.isValid(T)||k&&n.is0(T))throw new Error(`bad point coordinate ${R}`);return T}function v(R){if(!(R instanceof D))throw new Error("ProjectivePoint expected")}function C(R){if(!c||!c.basises)throw new Error("no endo");return Sre(R,c.basises,s.ORDER)}const O=WS((R,T)=>{const{X:k,Y:f,Z:m}=R;if(n.eql(m,n.ONE))return{x:k,y:f};const _=R.is0();T==null&&(T=_?n.ONE:n.inv(m));const $=n.mul(k,T),x=n.mul(f,T),N=n.mul(m,T);if(_)return{x:n.ZERO,y:n.ZERO};if(!n.eql(N,n.ONE))throw new Error("invZ was invalid");return{x:$,y:x}}),L=WS(R=>{if(R.is0()){if(e.allowInfinityPoint&&!n.is0(R.Y))return;throw new Error("bad point: ZERO")}const{x:T,y:k}=R.toAffine();if(!n.isValid(T)||!n.isValid(k))throw new Error("bad point: x or y not field elements");if(!w(T,k))throw new Error("bad point: equation left != right");if(!R.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});function j(R,T,k,f,m){return k=new D(n.mul(k.X,R),k.Y,k.Z),T=bg(f,T),k=bg(m,k),T.add(k)}class D{constructor(T,k,f){this.X=E("x",T),this.Y=E("y",k,!0),this.Z=E("z",f),Object.freeze(this)}static CURVE(){return i}static fromAffine(T){const{x:k,y:f}=T||{};if(!T||!n.isValid(k)||!n.isValid(f))throw new Error("invalid affine point");if(T instanceof D)throw new Error("projective point not allowed");return n.is0(k)&&n.is0(f)?D.ZERO:new D(k,f,n.ONE)}static fromBytes(T){const k=D.fromAffine(y(vc(T,void 0,"point")));return k.assertValidity(),k}static fromHex(T){return D.fromBytes($n("pointHex",T))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(T=8,k=!0){return P.createCache(this,T),k||this.multiply(zf),this}assertValidity(){L(this)}hasEvenY(){const{y:T}=this.toAffine();if(!n.isOdd)throw new Error("Field doesn't support isOdd");return!n.isOdd(T)}equals(T){v(T);const{X:k,Y:f,Z:m}=this,{X:_,Y:$,Z:x}=T,N=n.eql(n.mul(k,x),n.mul(_,m)),H=n.eql(n.mul(f,x),n.mul($,m));return N&&H}negate(){return new D(this.X,n.neg(this.Y),this.Z)}double(){const{a:T,b:k}=i,f=n.mul(k,zf),{X:m,Y:_,Z:$}=this;let x=n.ZERO,N=n.ZERO,H=n.ZERO,z=n.mul(m,m),G=n.mul(_,_),M=n.mul($,$),V=n.mul(m,_);return V=n.add(V,V),H=n.mul(m,$),H=n.add(H,H),x=n.mul(T,H),N=n.mul(f,M),N=n.add(x,N),x=n.sub(G,N),N=n.add(G,N),N=n.mul(x,N),x=n.mul(V,x),H=n.mul(f,H),M=n.mul(T,M),V=n.sub(z,M),V=n.mul(T,V),V=n.add(V,H),H=n.add(z,z),z=n.add(H,z),z=n.add(z,M),z=n.mul(z,V),N=n.add(N,z),M=n.mul(_,$),M=n.add(M,M),z=n.mul(M,V),x=n.sub(x,z),H=n.mul(M,G),H=n.add(H,H),H=n.add(H,H),new D(x,N,H)}add(T){v(T);const{X:k,Y:f,Z:m}=this,{X:_,Y:$,Z:x}=T;let N=n.ZERO,H=n.ZERO,z=n.ZERO;const G=i.a,M=n.mul(i.b,zf);let V=n.mul(k,_),J=n.mul(f,$),re=n.mul(m,x),ye=n.add(k,f),ne=n.add(_,$);ye=n.mul(ye,ne),ne=n.add(V,J),ye=n.sub(ye,ne),ne=n.add(k,m);let se=n.add(_,x);return ne=n.mul(ne,se),se=n.add(V,re),ne=n.sub(ne,se),se=n.add(f,m),N=n.add($,x),se=n.mul(se,N),N=n.add(J,re),se=n.sub(se,N),z=n.mul(G,ne),N=n.mul(M,re),z=n.add(N,z),N=n.sub(J,z),z=n.add(J,z),H=n.mul(N,z),J=n.add(V,V),J=n.add(J,V),re=n.mul(G,re),ne=n.mul(M,ne),J=n.add(J,re),re=n.sub(V,re),re=n.mul(G,re),ne=n.add(ne,re),V=n.mul(J,ne),H=n.add(H,V),V=n.mul(se,ne),N=n.mul(ye,N),N=n.sub(N,V),V=n.mul(ye,J),z=n.mul(se,z),z=n.add(z,V),new D(N,H,z)}subtract(T){return this.add(T.negate())}is0(){return this.equals(D.ZERO)}multiply(T){const{endo:k}=e;if(!s.isValidNot0(T))throw new Error("invalid scalar: out of range");let f,m;const _=$=>P.cached(this,$,x=>Ew(D,x));if(k){const{k1neg:$,k1:x,k2neg:N,k2:H}=C(T),{p:z,f:G}=_(x),{p:M,f:V}=_(H);m=G.add(V),f=j(k.beta,z,M,$,N)}else{const{p:$,f:x}=_(T);f=$,m=x}return Ew(D,[f,m])[0]}multiplyUnsafe(T){const{endo:k}=e,f=this;if(!s.isValid(T))throw new Error("invalid scalar: out of range");if(T===To||f.is0())return D.ZERO;if(T===ql)return f;if(P.hasCache(this))return this.multiply(T);if(k){const{k1neg:m,k1:_,k2neg:$,k2:x}=C(T),{p1:N,p2:H}=hre(D,f,_,x);return j(k.beta,N,H,m,$)}else return P.unsafe(f,T)}multiplyAndAddUnsafe(T,k,f){const m=this.multiplyUnsafe(k).add(T.multiplyUnsafe(f));return m.is0()?void 0:m}toAffine(T){return O(this,T)}isTorsionFree(){const{isTorsionFree:T}=e;return o===ql?!0:T?T(D,this):P.unsafe(this,a).is0()}clearCofactor(){const{clearCofactor:T}=e;return o===ql?this:T?T(D,this):this.multiplyUnsafe(o)}isSmallOrder(){return this.multiplyUnsafe(o).is0()}toBytes(T=!0){return mg(T,"isCompressed"),this.assertValidity(),p(D,this,T)}toHex(T=!0){return Fl(this.toBytes(T))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}get px(){return this.X}get py(){return this.X}get pz(){return this.Z}toRawBytes(T=!0){return this.toBytes(T)}_setWindowSize(T){this.precompute(T)}static normalizeZ(T){return Ew(D,T)}static msm(T,k){return fre(D,s,T,k)}static fromPrivateKey(T){return D.BASE.multiply(Ol(s,T))}}D.BASE=new D(i.Gx,i.Gy,n.ONE),D.ZERO=new D(n.ZERO,n.ONE,n.ZERO),D.Fp=n,D.Fn=s;const W=s.BITS,P=new dre(D,e.endo?Math.ceil(W/2):W);return D.BASE.precompute(8),D}function b5(t){return Uint8Array.of(t?2:3)}function v5(t,e){return{secretKey:e.BYTES,publicKey:1+t.BYTES,publicKeyUncompressed:1+2*t.BYTES,publicKeyHasPrefix:!0,signature:2*e.BYTES}}function $re(t,e={}){const{Fn:r}=t,n=e.randomBytes||Jc,s=Object.assign(v5(t.Fp,r),{seed:p5(r.ORDER)});function i(h){try{return!!Ol(r,h)}catch{return!1}}function o(h,p){const{publicKey:y,publicKeyUncompressed:g}=s;try{const w=h.length;return p===!0&&w!==y||p===!1&&w!==g?!1:!!t.fromBytes(h)}catch{return!1}}function a(h=n(s.seed)){return cre(vc(h,s.seed,"seed"),r.ORDER)}function c(h,p=!0){return t.BASE.multiply(Ol(r,h)).toBytes(p)}function l(h){const p=a(h);return{secretKey:p,publicKey:c(p)}}function u(h){if(typeof h=="bigint")return!1;if(h instanceof t)return!0;const{secretKey:p,publicKey:y,publicKeyUncompressed:g}=s;if(r.allowedLengths||p===y)return;const w=$n("key",h).length;return w===y||w===g}function d(h,p,y=!0){if(u(h)===!0)throw new Error("first arg must be private key");if(u(p)===!1)throw new Error("second arg must be public key");const g=Ol(r,h);return t.fromHex(p).multiply(g).toBytes(y)}return Object.freeze({getPublicKey:c,getSharedSecret:d,keygen:l,Point:t,utils:{isValidSecretKey:i,isValidPublicKey:o,randomSecretKey:a,isValidPrivateKey:i,randomPrivateKey:a,normPrivateKeyToScalar:h=>Ol(r,h),precompute(h=8,p=t.BASE){return p.precompute(h,!1)}},lengths:s})}function Tre(t,e,r={}){hy(e),wy(r,{},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"});const n=r.randomBytes||Jc,s=r.hmac||((k,...f)=>gy(e,k,ya(...f))),{Fp:i,Fn:o}=t,{ORDER:a,BITS:c}=o,{keygen:l,getPublicKey:u,getSharedSecret:d,utils:h,lengths:p}=$re(t,r),y={prehash:!1,lowS:typeof r.lowS=="boolean"?r.lowS:!1,format:void 0,extraEntropy:!1},g="compact";function w(k){const f=a>>ql;return k>f}function S(k,f){if(!o.isValidNot0(f))throw new Error(`invalid signature ${k}: out of range 1..Point.Fn.ORDER`);return f}function A(k,f){$b(f);const m=p.signature,_=f==="compact"?m:f==="recovered"?m+1:void 0;return vc(k,_,`${f} signature`)}class E{constructor(f,m,_){this.r=S("r",f),this.s=S("s",m),_!=null&&(this.recovery=_),Object.freeze(this)}static fromBytes(f,m=g){A(f,m);let _;if(m==="der"){const{r:H,s:z}=vo.toSig(vc(f));return new E(H,z)}m==="recovered"&&(_=f[0],m="compact",f=f.subarray(1));const $=o.BYTES,x=f.subarray(0,$),N=f.subarray($,$*2);return new E(o.fromBytes(x),o.fromBytes(N),_)}static fromHex(f,m){return this.fromBytes(gg(f),m)}addRecoveryBit(f){return new E(this.r,this.s,f)}recoverPublicKey(f){const m=i.ORDER,{r:_,s:$,recovery:x}=this;if(x==null||![0,1,2,3].includes(x))throw new Error("recovery id invalid");if(a*w5<m&&x>1)throw new Error("recovery id is ambiguous for h>1 curve");const N=x===2||x===3?_+a:_;if(!i.isValid(N))throw new Error("recovery id 2 or 3 invalid");const H=i.toBytes(N),z=t.fromBytes(ya(b5((x&1)===0),H)),G=o.inv(N),M=C($n("msgHash",f)),V=o.create(-M*G),J=o.create($*G),re=t.BASE.multiplyUnsafe(V).add(z.multiplyUnsafe(J));if(re.is0())throw new Error("point at infinify");return re.assertValidity(),re}hasHighS(){return w(this.s)}toBytes(f=g){if($b(f),f==="der")return gg(vo.hexFromSig(this));const m=o.toBytes(this.r),_=o.toBytes(this.s);if(f==="recovered"){if(this.recovery==null)throw new Error("recovery bit must be present");return ya(Uint8Array.of(this.recovery),m,_)}return ya(m,_)}toHex(f){return Fl(this.toBytes(f))}assertValidity(){}static fromCompact(f){return E.fromBytes($n("sig",f),"compact")}static fromDER(f){return E.fromBytes($n("sig",f),"der")}normalizeS(){return this.hasHighS()?new E(this.r,o.neg(this.s),this.recovery):this}toDERRawBytes(){return this.toBytes("der")}toDERHex(){return Fl(this.toBytes("der"))}toCompactRawBytes(){return this.toBytes("compact")}toCompactHex(){return Fl(this.toBytes("compact"))}}const v=r.bits2int||function(k){if(k.length>8192)throw new Error("input is too large");const f=my(k),m=k.length*8-c;return m>0?f>>BigInt(m):f},C=r.bits2int_modN||function(k){return o.create(v(k))},O=Yh(c);function L(k){return Ib("num < 2^"+c,k,To,O),o.toBytes(k)}function j(k,f){return vc(k,void 0,"message"),f?vc(e(k),void 0,"prehashed message"):k}function D(k,f,m){if(["recovered","canonical"].some(J=>J in m))throw new Error("sign() legacy options not supported");const{lowS:_,prehash:$,extraEntropy:x}=Aw(m,y);k=j(k,$);const N=C(k),H=Ol(o,f),z=[L(H),L(N)];if(x!=null&&x!==!1){const J=x===!0?n(p.secretKey):x;z.push($n("extraEntropy",J))}const G=ya(...z),M=N;function V(J){const re=v(J);if(!o.isValidNot0(re))return;const ye=o.inv(re),ne=t.BASE.multiply(re).toAffine(),se=o.create(ne.x);if(se===To)return;const Ie=o.create(ye*o.create(M+se*H));if(Ie===To)return;let Me=(ne.x===se?0:2)|Number(ne.y&ql),Ve=Ie;return _&&w(Ie)&&(Ve=o.neg(Ie),Me^=1),new E(se,Ve,Me)}return{seed:G,k2sig:V}}function W(k,f,m={}){k=$n("message",k);const{seed:_,k2sig:$}=D(k,f,m);return Qte(e.outputLen,o.BYTES,s)(_,$)}function P(k){let f;const m=typeof k=="string"||dy(k),_=!m&&k!==null&&typeof k=="object"&&typeof k.r=="bigint"&&typeof k.s=="bigint";if(!m&&!_)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");if(_)f=new E(k.r,k.s);else if(m){try{f=E.fromBytes($n("sig",k),"der")}catch($){if(!($ instanceof vo.Err))throw $}if(!f)try{f=E.fromBytes($n("sig",k),"compact")}catch{return!1}}return f||!1}function R(k,f,m,_={}){const{lowS:$,prehash:x,format:N}=Aw(_,y);if(m=$n("publicKey",m),f=j($n("message",f),x),"strict"in _)throw new Error("options.strict was renamed to lowS");const H=N===void 0?P(k):E.fromBytes($n("sig",k),N);if(H===!1)return!1;try{const z=t.fromBytes(m);if($&&H.hasHighS())return!1;const{r:G,s:M}=H,V=C(f),J=o.inv(M),re=o.create(V*J),ye=o.create(G*J),ne=t.BASE.multiplyUnsafe(re).add(z.multiplyUnsafe(ye));return ne.is0()?!1:o.create(ne.x)===G}catch{return!1}}function T(k,f,m={}){const{prehash:_}=Aw(m,y);return f=j(f,_),E.fromBytes(k,"recovered").recoverPublicKey(f).toBytes()}return Object.freeze({keygen:l,getPublicKey:u,getSharedSecret:d,utils:h,lengths:p,Point:t,sign:W,verify:R,recoverPublicKey:T,Signature:E,hash:e})}function Nre(t){const e={a:t.a,b:t.b,p:t.Fp.ORDER,n:t.n,h:t.h,Gx:t.Gx,Gy:t.Gy},r=t.Fp;let n=t.allowedPrivateKeyLengths?Array.from(new Set(t.allowedPrivateKeyLengths.map(o=>Math.ceil(o/2)))):void 0;const s=La(e.n,{BITS:t.nBitLength,allowedLengths:n,modFromBytes:t.wrapPrivateKey}),i={Fp:r,Fn:s,allowInfinityPoint:t.allowInfinityPoint,endo:t.endo,isTorsionFree:t.isTorsionFree,clearCofactor:t.clearCofactor,fromBytes:t.fromBytes,toBytes:t.toBytes};return{CURVE:e,curveOpts:i}}function Ore(t){const{CURVE:e,curveOpts:r}=Nre(t),n={hmac:t.hmac,randomBytes:t.randomBytes,lowS:t.lowS,bits2int:t.bits2int,bits2int_modN:t.bits2int_modN};return{CURVE:e,curveOpts:r,hash:t.hash,ecdsaOpts:n}}function kre(t,e){const r=e.Point;return Object.assign({},e,{ProjectivePoint:r,CURVE:Object.assign({},t,h5(r.Fn.ORDER,r.Fn.BITS))})}function Pre(t){const{CURVE:e,curveOpts:r,hash:n,ecdsaOpts:s}=Ore(t),i=Cre(e,r),o=Tre(i,n,s);return kre(t,o)}function Tb(t,e){const r=n=>Pre({...t,hash:n});return{...r(e),create:r}}const E5={p:BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff"),n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),h:BigInt(1),a:BigInt("0xffffffff00000001000000000000000000000000fffffffffffffffffffffffc"),b:BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5")},_5={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000ffffffff"),n:BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973"),h:BigInt(1),a:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000fffffffc"),b:BigInt("0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef"),Gx:BigInt("0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7"),Gy:BigInt("0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f")},x5={p:BigInt("0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),n:BigInt("0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa51868783bf2f966b7fcc0148f709a5d03bb5c9b8899c47aebb6fb71e91386409"),h:BigInt(1),a:BigInt("0x1fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc"),b:BigInt("0x0051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00"),Gx:BigInt("0x00c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66"),Gy:BigInt("0x011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650")},Rre=La(E5.p),Dre=La(_5.p),Ure=La(x5.p),Bre=Tb({...E5,Fp:Rre,lowS:!1},py);Tb({..._5,Fp:Dre,lowS:!1},Hee),Tb({...x5,Fp:Ure,lowS:!1,allowedPrivateKeyLengths:[130,131,132]},zee);const Lre=Bre,S5="base10",Un="base16",Qn="base64pad",ma="base64url",Xh="utf8",A5=0,ko=1,Zh=2,Mre=0,QS=1,_d=12,$v=32;function jre(){const t=Cb.utils.randomPrivateKey(),e=Cb.getPublicKey(t);return{privateKey:jt(t,Un),publicKey:jt(e,Un)}}function Nb(){const t=Jc($v);return jt(t,Un)}function Fre(t,e){const r=Cb.getSharedSecret(tr(t,Un),tr(e,Un)),n=Zte(yy,r,void 0,void 0,$v);return jt(n,Un)}function wp(t){const e=yy(tr(t,Un));return jt(e,Un)}function Ks(t){const e=yy(tr(t,Xh));return jt(e,Un)}function I5(t){return tr(`${t}`,S5)}function jc(t){return Number(jt(t,S5))}function C5(t){return t.replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function $5(t){const e=t.replace(/-/g,"+").replace(/_/g,"/"),r=(4-e.length%4)%4;return e+"=".repeat(r)}function qre(t){const e=I5(typeof t.type<"u"?t.type:A5);if(jc(e)===ko&&typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const r=typeof t.senderPublicKey<"u"?tr(t.senderPublicKey,Un):void 0,n=typeof t.iv<"u"?tr(t.iv,Un):Jc(_d),s=tr(t.symKey,Un),i=e5(s,n).encrypt(tr(t.message,Xh)),o=T5({type:e,sealed:i,iv:n,senderPublicKey:r});return t.encoding===ma?C5(o):o}function zre(t){const e=tr(t.symKey,Un),{sealed:r,iv:n}=wh({encoded:t.encoded,encoding:t.encoding}),s=e5(e,n).decrypt(r);if(s===null)throw new Error("Failed to decrypt");return jt(s,Xh)}function Hre(t,e){const r=I5(Zh),n=Jc(_d),s=tr(t,Xh),i=T5({type:r,sealed:s,iv:n});return e===ma?C5(i):i}function Wre(t,e){const{sealed:r}=wh({encoded:t,encoding:e});return jt(r,Xh)}function T5(t){if(jc(t.type)===Zh)return jt(Fi([t.type,t.sealed]),Qn);if(jc(t.type)===ko){if(typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return jt(Fi([t.type,t.senderPublicKey,t.iv,t.sealed]),Qn)}return jt(Fi([t.type,t.iv,t.sealed]),Qn)}function wh(t){const e=(t.encoding||Qn)===ma?$5(t.encoded):t.encoded,r=tr(e,Qn),n=r.slice(Mre,QS),s=QS;if(jc(n)===ko){const c=s+$v,l=c+_d,u=r.slice(s,c),d=r.slice(c,l),h=r.slice(l);return{type:n,sealed:h,iv:d,senderPublicKey:u}}if(jc(n)===Zh){const c=r.slice(s),l=Jc(_d);return{type:n,sealed:c,iv:l}}const i=s+_d,o=r.slice(s,i),a=r.slice(i);return{type:n,sealed:a,iv:o}}function Vre(t,e){const r=wh({encoded:t,encoding:e?.encoding});return N5({type:jc(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?jt(r.senderPublicKey,Un):void 0,receiverPublicKey:e?.receiverPublicKey})}function N5(t){const e=t?.type||A5;if(e===ko){if(typeof t?.senderPublicKey>"u")throw new Error("missing sender public key");if(typeof t?.receiverPublicKey>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:t?.senderPublicKey,receiverPublicKey:t?.receiverPublicKey}}function eA(t){return t.type===ko&&typeof t.senderPublicKey=="string"&&typeof t.receiverPublicKey=="string"}function tA(t){return t.type===Zh}function Kre(t){const e=Buffer.from(t.x,"base64"),r=Buffer.from(t.y,"base64");return Fi([new Uint8Array([4]),e,r])}function Gre(t,e){const[r,n,s]=t.split("."),i=Buffer.from($5(s),"base64");if(i.length!==64)throw new Error("Invalid signature length");const o=i.slice(0,32),a=i.slice(32,64),c=`${r}.${n}`,l=yy(c),u=Kre(e);if(!Lre.verify(Fi([o,a]),l,u))throw new Error("Invalid signature");return Xl(t).payload}const Yre="irn";function vg(t){return t?.relay||{protocol:Yre}}function kl(t){const e=B$[t];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${t}`);return e}var Xre=Object.defineProperty,Zre=Object.defineProperties,Jre=Object.getOwnPropertyDescriptors,rA=Object.getOwnPropertySymbols,Qre=Object.prototype.hasOwnProperty,ene=Object.prototype.propertyIsEnumerable,nA=(t,e,r)=>e in t?Xre(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Iw=(t,e)=>{for(var r in e||(e={}))Qre.call(e,r)&&nA(t,r,e[r]);if(rA)for(var r of rA(e))ene.call(e,r)&&nA(t,r,e[r]);return t},tne=(t,e)=>Zre(t,Jre(e));function rne(t,e="-"){const r={},n="relay"+e;return Object.keys(t).forEach(s=>{if(s.startsWith(n)){const i=s.replace(n,""),o=t[s];r[i]=o}}),r}function sA(t){if(!t.includes("wc:")){const l=RO(t);l!=null&&l.includes("wc:")&&(t=l)}t=t.includes("wc://")?t.replace("wc://",""):t,t=t.includes("wc:")?t.replace("wc:",""):t;const e=t.indexOf(":"),r=t.indexOf("?")!==-1?t.indexOf("?"):void 0,n=t.substring(0,e),s=t.substring(e+1,r).split("@"),i=typeof r<"u"?t.substring(r):"",o=new URLSearchParams(i),a=Object.fromEntries(o.entries()),c=typeof a.methods=="string"?a.methods.split(","):void 0;return{protocol:n,topic:nne(s[0]),version:parseInt(s[1],10),symKey:a.symKey,relay:rne(a),methods:c,expiryTimestamp:a.expiryTimestamp?parseInt(a.expiryTimestamp,10):void 0}}function nne(t){return t.startsWith("//")?t.substring(2):t}function sne(t,e="-"){const r="relay",n={};return Object.keys(t).forEach(s=>{const i=s,o=r+e+i;t[i]&&(n[o]=t[i])}),n}function iA(t){const e=new URLSearchParams,r=Iw(Iw(tne(Iw({},sne(t.relay)),{symKey:t.symKey}),t.expiryTimestamp&&{expiryTimestamp:t.expiryTimestamp.toString()}),t.methods&&{methods:t.methods.join(",")});return Object.entries(r).sort(([n],[s])=>n.localeCompare(s)).forEach(([n,s])=>{s!==void 0&&e.append(n,String(s))}),`${t.protocol}:${t.topic}@${t.version}?${e}`}function Hf(t,e,r){return`${t}?wc_ev=${r}&topic=${e}`}var ine=Object.defineProperty,one=Object.defineProperties,ane=Object.getOwnPropertyDescriptors,oA=Object.getOwnPropertySymbols,cne=Object.prototype.hasOwnProperty,lne=Object.prototype.propertyIsEnumerable,aA=(t,e,r)=>e in t?ine(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,une=(t,e)=>{for(var r in e||(e={}))cne.call(e,r)&&aA(t,r,e[r]);if(oA)for(var r of oA(e))lne.call(e,r)&&aA(t,r,e[r]);return t},dne=(t,e)=>one(t,ane(e));function wu(t){const e=[];return t.forEach(r=>{const[n,s]=r.split(":");e.push(`${n}:${s}`)}),e}function hne(t){const e=[];return Object.values(t).forEach(r=>{e.push(...wu(r.accounts))}),e}function fne(t,e){const r=[];return Object.values(t).forEach(n=>{wu(n.accounts).includes(e)&&r.push(...n.methods)}),r}function pne(t,e){const r=[];return Object.values(t).forEach(n=>{wu(n.accounts).includes(e)&&r.push(...n.events)}),r}function by(t){return t.includes(":")}function Pl(t){return by(t)?t.split(":")[0]:t}function cA(t){var e,r,n;const s={};if(!Hi(t))return s;for(const[i,o]of Object.entries(t)){const a=by(i)?[i]:o.chains,c=o.methods||[],l=o.events||[],u=Pl(i);s[u]=dne(une({},s[u]),{chains:zi(a,(e=s[u])==null?void 0:e.chains),methods:zi(c,(r=s[u])==null?void 0:r.methods),events:zi(l,(n=s[u])==null?void 0:n.events)})}return s}function gne(t){const e={};return t?.forEach(r=>{var n;const[s,i]=r.split(":");e[s]||(e[s]={accounts:[],chains:[],events:[],methods:[]}),e[s].accounts.push(r),(n=e[s].chains)==null||n.push(`${s}:${i}`)}),e}function lA(t,e){e=e.map(n=>n.replace("did:pkh:",""));const r=gne(e);for(const[n,s]of Object.entries(r))s.methods?s.methods=zi(s.methods,t):s.methods=t,s.events=["chainChanged","accountsChanged"];return r}function yne(t,e){var r,n,s,i,o,a;const c=cA(t),l=cA(e),u={},d=Object.keys(c).concat(Object.keys(l));for(const h of d)u[h]={chains:zi((r=c[h])==null?void 0:r.chains,(n=l[h])==null?void 0:n.chains),methods:zi((s=c[h])==null?void 0:s.methods,(i=l[h])==null?void 0:i.methods),events:zi((o=c[h])==null?void 0:o.events,(a=l[h])==null?void 0:a.events)};return u}const mne={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},wne={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function be(t,e){const{message:r,code:n}=wne[t];return{message:e?`${r} ${e}`:r,code:n}}function er(t,e){const{message:r,code:n}=mne[t];return{message:e?`${r} ${e}`:r,code:n}}function Po(t,e){return!!Array.isArray(t)}function Hi(t){return Object.getPrototypeOf(t)===Object.prototype&&Object.keys(t).length}function Dr(t){return typeof t>"u"}function Sr(t,e){return e&&Dr(t)?!0:typeof t=="string"&&!!t.trim().length}function Tv(t,e){return e&&Dr(t)?!0:typeof t=="number"&&!isNaN(t)}function bne(t,e){const{requiredNamespaces:r}=e,n=Object.keys(t.namespaces),s=Object.keys(r);let i=!0;return bc(s,n)?(n.forEach(o=>{const{accounts:a,methods:c,events:l}=t.namespaces[o],u=wu(a),d=r[o];(!bc(TO(o,d),u)||!bc(d.methods,c)||!bc(d.events,l))&&(i=!1)}),i):!1}function Eg(t){return Sr(t,!1)&&t.includes(":")?t.split(":").length===2:!1}function vne(t){if(Sr(t,!1)&&t.includes(":")){const e=t.split(":");if(e.length===3){const r=e[0]+":"+e[1];return!!e[2]&&Eg(r)}}return!1}function Ene(t){function e(r){try{return typeof new URL(r)<"u"}catch{return!1}}try{if(Sr(t,!1)){if(e(t))return!0;const r=RO(t);return e(r)}}catch{}return!1}function _ne(t){var e;return(e=t?.proposer)==null?void 0:e.publicKey}function xne(t){return t?.topic}function Sne(t,e){let r=null;return Sr(t?.publicKey,!1)||(r=be("MISSING_OR_INVALID",`${e} controller public key should be a string`)),r}function uA(t){let e=!0;return Po(t)?t.length&&(e=t.every(r=>Sr(r,!1))):e=!1,e}function Ane(t,e,r){let n=null;return Po(e)&&e.length?e.forEach(s=>{n||Eg(s)||(n=er("UNSUPPORTED_CHAINS",`${r}, chain ${s} should be a string and conform to "namespace:chainId" format`))}):Eg(t)||(n=er("UNSUPPORTED_CHAINS",`${r}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),n}function Ine(t,e,r){let n=null;return Object.entries(t).forEach(([s,i])=>{if(n)return;const o=Ane(s,TO(s,i),`${e} ${r}`);o&&(n=o)}),n}function Cne(t,e){let r=null;return Po(t)?t.forEach(n=>{r||vne(n)||(r=er("UNSUPPORTED_ACCOUNTS",`${e}, account ${n} should be a string and conform to "namespace:chainId:address" format`))}):r=er("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),r}function $ne(t,e){let r=null;return Object.values(t).forEach(n=>{if(r)return;const s=Cne(n?.accounts,`${e} namespace`);s&&(r=s)}),r}function Tne(t,e){let r=null;return uA(t?.methods)?uA(t?.events)||(r=er("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):r=er("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),r}function O5(t,e){let r=null;return Object.values(t).forEach(n=>{if(r)return;const s=Tne(n,`${e}, namespace`);s&&(r=s)}),r}function Nne(t,e,r){let n=null;if(t&&Hi(t)){const s=O5(t,e);s&&(n=s);const i=Ine(t,e,r);i&&(n=i)}else n=be("MISSING_OR_INVALID",`${e}, ${r} should be an object with data`);return n}function Cw(t,e){let r=null;if(t&&Hi(t)){const n=O5(t,e);n&&(r=n);const s=$ne(t,e);s&&(r=s)}else r=be("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return r}function k5(t){return Sr(t.protocol,!0)}function One(t,e){let r=!1;return t?t&&Po(t)&&t.length&&t.forEach(n=>{r=k5(n)}):r=!0,r}function kne(t){return typeof t=="number"}function Vn(t){return typeof t<"u"&&typeof t!==null}function Pne(t){return!(!t||typeof t!="object"||!t.code||!Tv(t.code,!1)||!t.message||!Sr(t.message,!1))}function Rne(t){return!(Dr(t)||!Sr(t.method,!1))}function Dne(t){return!(Dr(t)||Dr(t.result)&&Dr(t.error)||!Tv(t.id,!1)||!Sr(t.jsonrpc,!1))}function Une(t){return!(Dr(t)||!Sr(t.name,!1))}function dA(t,e){return!(!Eg(e)||!hne(t).includes(e))}function Bne(t,e,r){return Sr(r,!1)?fne(t,e).includes(r):!1}function Lne(t,e,r){return Sr(r,!1)?pne(t,e).includes(r):!1}function hA(t,e,r){let n=null;const s=Mne(t),i=jne(e),o=Object.keys(s),a=Object.keys(i),c=fA(Object.keys(t)),l=fA(Object.keys(e)),u=c.filter(d=>!l.includes(d));return u.length&&(n=be("NON_CONFORMING_NAMESPACES",`${r} namespaces keys don't satisfy requiredNamespaces.
      Required: ${u.toString()}
      Received: ${Object.keys(e).toString()}`)),bc(o,a)||(n=be("NON_CONFORMING_NAMESPACES",`${r} namespaces chains don't satisfy required namespaces.
      Required: ${o.toString()}
      Approved: ${a.toString()}`)),Object.keys(e).forEach(d=>{if(!d.includes(":")||n)return;const h=wu(e[d].accounts);h.includes(d)||(n=be("NON_CONFORMING_NAMESPACES",`${r} namespaces accounts don't satisfy namespace accounts for ${d}
        Required: ${d}
        Approved: ${h.toString()}`))}),o.forEach(d=>{n||(bc(s[d].methods,i[d].methods)?bc(s[d].events,i[d].events)||(n=be("NON_CONFORMING_NAMESPACES",`${r} namespaces events don't satisfy namespace events for ${d}`)):n=be("NON_CONFORMING_NAMESPACES",`${r} namespaces methods don't satisfy namespace methods for ${d}`))}),n}function Mne(t){const e={};return Object.keys(t).forEach(r=>{var n;r.includes(":")?e[r]=t[r]:(n=t[r].chains)==null||n.forEach(s=>{e[s]={methods:t[r].methods,events:t[r].events}})}),e}function fA(t){return[...new Set(t.map(e=>e.includes(":")?e.split(":")[0]:e))]}function jne(t){const e={};return Object.keys(t).forEach(r=>{r.includes(":")?e[r]=t[r]:wu(t[r].accounts)?.forEach(s=>{e[s]={accounts:t[r].accounts.filter(i=>i.includes(`${s}:`)),methods:t[r].methods,events:t[r].events}})}),e}function Fne(t,e){return Tv(t,!1)&&t<=e.max&&t>=e.min}function pA(){const t=Kh();return new Promise(e=>{switch(t){case Is.browser:e(qne());break;case Is.reactNative:e(zne());break;case Is.node:e(Hne());break;default:e(!0)}})}function qne(){return mu()&&navigator?.onLine}async function zne(){return Ba()&&typeof global<"u"&&global!=null&&global.NetInfo?(await(global==null?void 0:global.NetInfo.fetch()))?.isConnected:!0}function Hne(){return!0}function Wne(t){switch(Kh()){case Is.browser:Vne(t);break;case Is.reactNative:Kne(t);break}}function Vne(t){!Ba()&&mu()&&(window.addEventListener("online",()=>t(!0)),window.addEventListener("offline",()=>t(!1)))}function Kne(t){Ba()&&typeof global<"u"&&global!=null&&global.NetInfo&&global?.NetInfo.addEventListener(e=>t(e?.isConnected))}function Gne(){var t;return mu()&&Xr.getDocument()?((t=Xr.getDocument())==null?void 0:t.visibilityState)==="visible":!0}const $w={};class Xu{static get(e){return $w[e]}static set(e,r){$w[e]=r}static delete(e){delete $w[e]}}function Yne(t){const e=Vh.decode(t);if(e.length<33)throw new Error("Too short to contain a public key");return e.slice(1,33)}function Xne({publicKey:t,signature:e,payload:r}){var n;const s=Ob(r.method),i=128|parseInt(((n=r.version)==null?void 0:n.toString())||"4"),o=Qne(r.address),a=r.era==="00"?new Uint8Array([0]):Ob(r.era);if(a.length!==1&&a.length!==2)throw new Error("Invalid era length");const c=parseInt(r.nonce,16),l=new Uint8Array([c&255,c>>8&255]),u=BigInt(`0x${Jne(r.tip)}`),d=tse(u),h=new Uint8Array([0,...t,o,...e,...a,...l,...d,...s]),p=ese(h.length+1);return new Uint8Array([...p,i,...h])}function Zne(t){const e=Ob(t),r=M$.blake2b(e,void 0,32);return"0x"+Buffer.from(r).toString("hex")}function Ob(t){return new Uint8Array(t.replace(/^0x/,"").match(/.{1,2}/g).map(e=>parseInt(e,16)))}function Jne(t){return t.startsWith("0x")?t.slice(2):t}function Qne(t){const e=Vh.decode(t)[0];return e===42?0:e===60?2:1}function ese(t){if(t<64)return new Uint8Array([t<<2]);if(t<16384){const e=t<<2|1;return new Uint8Array([e&255,e>>8&255])}else if(t<1<<30){const e=t<<2|2;return new Uint8Array([e&255,e>>8&255,e>>16&255,e>>24&255])}else throw new Error("Compact encoding > 2^30 not supported")}function tse(t){if(t<BigInt(1)<<BigInt(6))return new Uint8Array([Number(t<<BigInt(2))]);if(t<BigInt(1)<<BigInt(14)){const e=t<<BigInt(2)|BigInt(1);return new Uint8Array([Number(e&BigInt(255)),Number(e>>BigInt(8)&BigInt(255))])}else if(t<BigInt(1)<<BigInt(30)){const e=t<<BigInt(2)|BigInt(2);return new Uint8Array([Number(e&BigInt(255)),Number(e>>BigInt(8)&BigInt(255)),Number(e>>BigInt(16)&BigInt(255)),Number(e>>BigInt(24)&BigInt(255))])}else throw new Error("BigInt compact encoding not supported > 2^30")}function rse(t){const e=Uint8Array.from(Buffer.from(t.signature,"hex")),r=Yne(t.transaction.address),n=Xne({publicKey:r,signature:e,payload:t.transaction}),s=Buffer.from(n).toString("hex");return Zne(s)}function Nv({logger:t,name:e}){const r=typeof t=="string"?GN({opts:{level:t,name:e}}).logger:t;return r.level=typeof t=="string"?t:t.level,r}let Ov=class extends JT{constructor(e){super(e),this.events=new dr.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async request(e,r){return this.requestStrict(Ar(e.method,e.params||[],e.id||Tn().toString()),r)}async requestStrict(e,r){return new Promise(async(n,s)=>{if(!this.connection.connected)try{await this.open()}catch(i){s(i)}this.events.on(`${e.id}`,i=>{nr(i)?s(i.error):n(i.result)});try{await this.connection.send(e,r)}catch(i){s(i)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),Ua(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&e.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",e=>this.onClose(e)),this.connection.on("error",e=>this.events.emit("error",e)),this.connection.on("register_error",e=>this.onClose()),this.hasRegisteredEventListeners=!0)}};const nse=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),sse=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",gA=t=>t.split("?")[0],yA=10,ise=nse();let ose=class{constructor(e){if(this.url=e,this.events=new dr.EventEmitter,this.registering=!1,!rg(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async open(e=this.url){await this.register(e)}async close(){return new Promise((e,r)=>{if(typeof this.socket>"u"){r(new Error("Connection already closed"));return}this.socket.onclose=n=>{this.onClose(n),e()},this.socket.close()})}async send(e){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(Bn(e))}catch(r){this.onError(e.id,r)}}register(e=this.url){if(!rg(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((n,s)=>{this.events.once("register_error",i=>{this.resetMaxListeners(),s(i)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return s(new Error("WebSocket connection is missing or invalid"));n(this.socket)})})}return this.url=e,this.registering=!0,new Promise((r,n)=>{const s=ZT.isReactNative()?void 0:{rejectUnauthorized:!eN(e)},i=new ise(e,[],s);sse()?i.onerror=o=>{const a=o;n(this.emitError(a.error))}:i.on("error",o=>{n(this.emitError(o))}),i.onopen=()=>{this.onOpen(i),r(i)}})}onOpen(e){e.onmessage=r=>this.onPayload(r),e.onclose=r=>this.onClose(r),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(typeof e.data>"u")return;const r=typeof e.data=="string"?Wi(e.data):e.data;this.events.emit("payload",r)}onError(e,r){const n=this.parseError(r),s=n.message||n.toString(),i=Vc(e,s);this.events.emit("payload",i)}parseError(e,r=this.url){return tv(e,gA(r),"WS")}resetMaxListeners(){this.events.getMaxListeners()>yA&&this.events.setMaxListeners(yA)}emitError(e){const r=this.parseError(new Error(e?.message||`WebSocket connection failed for host: ${gA(this.url)}`));return this.events.emit("register_error",r),r}};var ase={};const P5="wc",R5=2,kb="core",Ki=`${P5}@2:${kb}:`,cse={logger:"error"},lse={database:":memory:"},use="crypto",mA="client_ed25519_seed",dse=X.ONE_DAY,hse="keychain",fse="0.3",pse="messages",gse="0.3",yse=X.SIX_HOURS,mse="publisher",D5="irn",wse="error",U5="wss://relay.walletconnect.org",bse="relayer",fr={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},vse="_subscription",Us={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},Ese=.1,Pb="2.22.4",Gt={link_mode:"link_mode",relay:"relay"},bp={inbound:"inbound",outbound:"outbound"},_se="0.3",xse="WALLETCONNECT_CLIENT_ID",wA="WALLETCONNECT_LINK_MODE_APPS",ms={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},Sse="subscription",Ase="0.3",Ise="pairing",Cse="0.3",Zu={wc_pairingDelete:{req:{ttl:X.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:X.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:X.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:X.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:X.ONE_DAY,prompt:!1,tag:0},res:{ttl:X.ONE_DAY,prompt:!1,tag:0}}},cc={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},ni={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},$se="history",Tse="0.3",Nse="expirer",zs={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},Ose="0.3",kse="verify-api",Pse="https://verify.walletconnect.com",B5="https://verify.walletconnect.org",xd=B5,Rse=`${xd}/v3`,Dse=[Pse,B5],Use="echo",Bse="https://echo.walletconnect.com",ki={pairing_started:"pairing_started",pairing_uri_validation_success:"pairing_uri_validation_success",pairing_uri_not_expired:"pairing_uri_not_expired",store_new_pairing:"store_new_pairing",subscribing_pairing_topic:"subscribing_pairing_topic",subscribe_pairing_topic_success:"subscribe_pairing_topic_success",existing_pairing:"existing_pairing",pairing_not_expired:"pairing_not_expired",emit_inactive_pairing:"emit_inactive_pairing",emit_session_proposal:"emit_session_proposal",subscribing_to_pairing_topic:"subscribing_to_pairing_topic"},lo={no_wss_connection:"no_wss_connection",no_internet_connection:"no_internet_connection",malformed_pairing_uri:"malformed_pairing_uri",active_pairing_already_exists:"active_pairing_already_exists",subscribe_pairing_topic_failure:"subscribe_pairing_topic_failure",pairing_expired:"pairing_expired",proposal_expired:"proposal_expired",proposal_listener_not_found:"proposal_listener_not_found"},si={session_approve_started:"session_approve_started",proposal_not_expired:"proposal_not_expired",session_namespaces_validation_success:"session_namespaces_validation_success",create_session_topic:"create_session_topic",subscribing_session_topic:"subscribing_session_topic",subscribe_session_topic_success:"subscribe_session_topic_success",publishing_session_approve:"publishing_session_approve",session_approve_publish_success:"session_approve_publish_success",store_session:"store_session",publishing_session_settle:"publishing_session_settle",session_settle_publish_success:"session_settle_publish_success",session_request_response_started:"session_request_response_started",session_request_response_validation_success:"session_request_response_validation_success",session_request_response_publish_started:"session_request_response_publish_started"},Ya={no_internet_connection:"no_internet_connection",no_wss_connection:"no_wss_connection",proposal_expired:"proposal_expired",subscribe_session_topic_failure:"subscribe_session_topic_failure",session_approve_publish_failure:"session_approve_publish_failure",session_settle_publish_failure:"session_settle_publish_failure",session_approve_namespace_validation_failure:"session_approve_namespace_validation_failure",proposal_not_found:"proposal_not_found",session_request_response_validation_failure:"session_request_response_validation_failure",session_request_response_publish_failure:"session_request_response_publish_failure"},Xa={authenticated_session_approve_started:"authenticated_session_approve_started",create_authenticated_session_topic:"create_authenticated_session_topic",cacaos_verified:"cacaos_verified",store_authenticated_session:"store_authenticated_session",subscribing_authenticated_session_topic:"subscribing_authenticated_session_topic",subscribe_authenticated_session_topic_success:"subscribe_authenticated_session_topic_success",publishing_authenticated_session_approve:"publishing_authenticated_session_approve"},Ju={no_internet_connection:"no_internet_connection",invalid_cacao:"invalid_cacao",subscribe_authenticated_session_topic_failure:"subscribe_authenticated_session_topic_failure",authenticated_session_approve_publish_failure:"authenticated_session_approve_publish_failure",authenticated_session_pending_request_not_found:"authenticated_session_pending_request_not_found"},Lse=.1,Mse="event-client",jse=86400,Fse="https://pulse.walletconnect.org/batch";function qse(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var s=0;s<t.length;s++){var i=t.charAt(s),o=i.charCodeAt(0);if(r[o]!==255)throw new TypeError(i+" is ambiguous");r[o]=s}var a=t.length,c=t.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function d(y){if(y instanceof Uint8Array||(ArrayBuffer.isView(y)?y=new Uint8Array(y.buffer,y.byteOffset,y.byteLength):Array.isArray(y)&&(y=Uint8Array.from(y))),!(y instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(y.length===0)return"";for(var g=0,w=0,S=0,A=y.length;S!==A&&y[S]===0;)S++,g++;for(var E=(A-S)*u+1>>>0,v=new Uint8Array(E);S!==A;){for(var C=y[S],O=0,L=E-1;(C!==0||O<w)&&L!==-1;L--,O++)C+=256*v[L]>>>0,v[L]=C%a>>>0,C=C/a>>>0;if(C!==0)throw new Error("Non-zero carry");w=O,S++}for(var j=E-w;j!==E&&v[j]===0;)j++;for(var D=c.repeat(g);j<E;++j)D+=t.charAt(v[j]);return D}function h(y){if(typeof y!="string")throw new TypeError("Expected String");if(y.length===0)return new Uint8Array;var g=0;if(y[g]!==" "){for(var w=0,S=0;y[g]===c;)w++,g++;for(var A=(y.length-g)*l+1>>>0,E=new Uint8Array(A);y[g];){var v=r[y.charCodeAt(g)];if(v===255)return;for(var C=0,O=A-1;(v!==0||C<S)&&O!==-1;O--,C++)v+=a*E[O]>>>0,E[O]=v%256>>>0,v=v/256>>>0;if(v!==0)throw new Error("Non-zero carry");S=C,g++}if(y[g]!==" "){for(var L=A-S;L!==A&&E[L]===0;)L++;for(var j=new Uint8Array(w+(A-L)),D=w;L!==A;)j[D++]=E[L++];return j}}}function p(y){var g=h(y);if(g)return g;throw new Error(`Non-${e} character`)}return{encode:d,decodeUnsafe:h,decode:p}}var zse=qse,Hse=zse;const L5=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},Wse=t=>new TextEncoder().encode(t),Vse=t=>new TextDecoder().decode(t);class Kse{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class Gse{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return M5(this,e)}}class Yse{constructor(e){this.decoders=e}or(e){return M5(this,e)}decode(e){const r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const M5=(t,e)=>new Yse({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});class Xse{constructor(e,r,n,s){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=s,this.encoder=new Kse(e,r,n),this.decoder=new Gse(e,r,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const vy=({name:t,prefix:e,encode:r,decode:n})=>new Xse(t,e,r,n),Jh=({prefix:t,name:e,alphabet:r})=>{const{encode:n,decode:s}=Hse(r,e);return vy({prefix:t,name:e,encode:n,decode:i=>L5(s(i))})},Zse=(t,e,r,n)=>{const s={};for(let u=0;u<e.length;++u)s[e[u]]=u;let i=t.length;for(;t[i-1]==="=";)--i;const o=new Uint8Array(i*r/8|0);let a=0,c=0,l=0;for(let u=0;u<i;++u){const d=s[t[u]];if(d===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<r|d,a+=r,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},Jse=(t,e,r)=>{const n=e[e.length-1]==="=",s=(1<<r)-1;let i="",o=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],o+=8;o>r;)o-=r,i+=e[s&a>>o];if(o&&(i+=e[s&a<<r-o]),n)for(;i.length*r&7;)i+="=";return i},fn=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>vy({prefix:e,name:t,encode(s){return Jse(s,n,r)},decode(s){return Zse(s,n,r,t)}}),Qse=vy({prefix:"\0",name:"identity",encode:t=>Vse(t),decode:t=>Wse(t)});var eie=Object.freeze({__proto__:null,identity:Qse});const tie=fn({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var rie=Object.freeze({__proto__:null,base2:tie});const nie=fn({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var sie=Object.freeze({__proto__:null,base8:nie});const iie=Jh({prefix:"9",name:"base10",alphabet:"0123456789"});var oie=Object.freeze({__proto__:null,base10:iie});const aie=fn({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),cie=fn({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var lie=Object.freeze({__proto__:null,base16:aie,base16upper:cie});const uie=fn({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),die=fn({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),hie=fn({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),fie=fn({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),pie=fn({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),gie=fn({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),yie=fn({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),mie=fn({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),wie=fn({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var bie=Object.freeze({__proto__:null,base32:uie,base32upper:die,base32pad:hie,base32padupper:fie,base32hex:pie,base32hexupper:gie,base32hexpad:yie,base32hexpadupper:mie,base32z:wie});const vie=Jh({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Eie=Jh({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var _ie=Object.freeze({__proto__:null,base36:vie,base36upper:Eie});const xie=Jh({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Sie=Jh({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Aie=Object.freeze({__proto__:null,base58btc:xie,base58flickr:Sie});const Iie=fn({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Cie=fn({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),$ie=fn({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Tie=fn({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Nie=Object.freeze({__proto__:null,base64:Iie,base64pad:Cie,base64url:$ie,base64urlpad:Tie});const j5=Array.from(""),Oie=j5.reduce((t,e,r)=>(t[r]=e,t),[]),kie=j5.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function Pie(t){return t.reduce((e,r)=>(e+=Oie[r],e),"")}function Rie(t){const e=[];for(const r of t){const n=kie[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}const Die=vy({prefix:"",name:"base256emoji",encode:Pie,decode:Rie});var Uie=Object.freeze({__proto__:null,base256emoji:Die}),Bie=F5,bA=128,Lie=-128,Mie=Math.pow(2,31);function F5(t,e,r){e=e||[],r=r||0;for(var n=r;t>=Mie;)e[r++]=t&255|bA,t/=128;for(;t&Lie;)e[r++]=t&255|bA,t>>>=7;return e[r]=t|0,F5.bytes=r-n+1,e}var jie=Rb,Fie=128,vA=127;function Rb(t,n){var r=0,n=n||0,s=0,i=n,o,a=t.length;do{if(i>=a)throw Rb.bytes=0,new RangeError("Could not decode varint");o=t[i++],r+=s<28?(o&vA)<<s:(o&vA)*Math.pow(2,s),s+=7}while(o>=Fie);return Rb.bytes=i-n,r}var qie=Math.pow(2,7),zie=Math.pow(2,14),Hie=Math.pow(2,21),Wie=Math.pow(2,28),Vie=Math.pow(2,35),Kie=Math.pow(2,42),Gie=Math.pow(2,49),Yie=Math.pow(2,56),Xie=Math.pow(2,63),Zie=function(t){return t<qie?1:t<zie?2:t<Hie?3:t<Wie?4:t<Vie?5:t<Kie?6:t<Gie?7:t<Yie?8:t<Xie?9:10},Jie={encode:Bie,decode:jie,encodingLength:Zie},q5=Jie;const EA=(t,e,r=0)=>(q5.encode(t,e,r),e),_A=t=>q5.encodingLength(t),Db=(t,e)=>{const r=e.byteLength,n=_A(t),s=n+_A(r),i=new Uint8Array(s+r);return EA(t,i,0),EA(r,i,n),i.set(e,s),new Qie(t,r,e,i)};class Qie{constructor(e,r,n,s){this.code=e,this.size=r,this.digest=n,this.bytes=s}}const z5=({name:t,code:e,encode:r})=>new eoe(t,e,r);class eoe{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){const r=this.encode(e);return r instanceof Uint8Array?Db(this.code,r):r.then(n=>Db(this.code,n))}else throw Error("Unknown type, must be binary type")}}const H5=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),toe=z5({name:"sha2-256",code:18,encode:H5("SHA-256")}),roe=z5({name:"sha2-512",code:19,encode:H5("SHA-512")});var noe=Object.freeze({__proto__:null,sha256:toe,sha512:roe});const W5=0,soe="identity",V5=L5,ioe=t=>Db(W5,V5(t)),ooe={code:W5,name:soe,encode:V5,digest:ioe};var aoe=Object.freeze({__proto__:null,identity:ooe});new TextEncoder,new TextDecoder;const xA={...eie,...rie,...sie,...oie,...lie,...bie,..._ie,...Aie,...Nie,...Uie};({...noe,...aoe});function K5(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function coe(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?K5(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function G5(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}const SA=G5("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),Tw=G5("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);const e=coe(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),loe={utf8:SA,"utf-8":SA,hex:xA.base16,latin1:Tw,ascii:Tw,binary:Tw,...xA};function uoe(t,e="utf8"){const r=loe[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?K5(globalThis.Buffer.from(t,"utf-8")):r.decoder.decode(`${r.prefix}${t}`)}var doe=Object.defineProperty,hoe=(t,e,r)=>e in t?doe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Ti=(t,e,r)=>hoe(t,typeof e!="symbol"?e+"":e,r);class foe{constructor(e,r){this.core=e,this.logger=r,Ti(this,"keychain",new Map),Ti(this,"name",hse),Ti(this,"version",fse),Ti(this,"initialized",!1),Ti(this,"storagePrefix",Ki),Ti(this,"init",async()=>{if(!this.initialized){const n=await this.getKeyChain();typeof n<"u"&&(this.keychain=n),this.initialized=!0}}),Ti(this,"has",n=>(this.isInitialized(),this.keychain.has(n))),Ti(this,"set",async(n,s)=>{this.isInitialized(),this.keychain.set(n,s),await this.persist()}),Ti(this,"get",n=>{this.isInitialized();const s=this.keychain.get(n);if(typeof s>"u"){const{message:i}=be("NO_MATCHING_KEY",`${this.name}: ${n}`);throw new Error(i)}return s}),Ti(this,"del",async n=>{this.isInitialized(),this.keychain.delete(n),await this.persist()}),this.core=e,this.logger=Ts(r,this.name)}get context(){return cs(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,wb(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?bb(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=be("NOT_INITIALIZED",this.name);throw new Error(e)}}}var poe=Object.defineProperty,goe=(t,e,r)=>e in t?poe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Fr=(t,e,r)=>goe(t,typeof e!="symbol"?e+"":e,r);class yoe{constructor(e,r,n){this.core=e,this.logger=r,Fr(this,"name",use),Fr(this,"keychain"),Fr(this,"randomSessionIdentifier",Nb()),Fr(this,"initialized",!1),Fr(this,"clientId"),Fr(this,"init",async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)}),Fr(this,"hasKeys",s=>(this.isInitialized(),this.keychain.has(s))),Fr(this,"getClientId",async()=>{if(this.isInitialized(),this.clientId)return this.clientId;const s=await this.getClientSeed(),i=jp(s),o=k1(i.publicKey);return this.clientId=o,o}),Fr(this,"generateKeyPair",()=>{this.isInitialized();const s=jre();return this.setPrivateKey(s.publicKey,s.privateKey)}),Fr(this,"signJWT",async s=>{this.isInitialized();const i=await this.getClientSeed(),o=jp(i),a=this.randomSessionIdentifier;return await U3(a,s,dse,o)}),Fr(this,"generateSharedKey",(s,i,o)=>{this.isInitialized();const a=this.getPrivateKey(s),c=Fre(a,i);return this.setSymKey(c,o)}),Fr(this,"setSymKey",async(s,i)=>{this.isInitialized();const o=i||wp(s);return await this.keychain.set(o,s),o}),Fr(this,"deleteKeyPair",async s=>{this.isInitialized(),await this.keychain.del(s)}),Fr(this,"deleteSymKey",async s=>{this.isInitialized(),await this.keychain.del(s)}),Fr(this,"encode",async(s,i,o)=>{this.isInitialized();const a=N5(o),c=Bn(i);if(tA(a))return Hre(c,o?.encoding);if(eA(a)){const h=a.senderPublicKey,p=a.receiverPublicKey;s=await this.generateSharedKey(h,p)}const l=this.getSymKey(s),{type:u,senderPublicKey:d}=a;return qre({type:u,symKey:l,message:c,senderPublicKey:d,encoding:o?.encoding})}),Fr(this,"decode",async(s,i,o)=>{this.isInitialized();const a=Vre(i,o);if(tA(a)){const c=Wre(i,o?.encoding);return Wi(c)}if(eA(a)){const c=a.receiverPublicKey,l=a.senderPublicKey;s=await this.generateSharedKey(c,l)}try{const c=this.getSymKey(s),l=zre({symKey:c,encoded:i,encoding:o?.encoding});return Wi(l)}catch(c){this.logger.error(`Failed to decode message from topic: '${s}', clientId: '${await this.getClientId()}'`),this.logger.error(c)}}),Fr(this,"getPayloadType",(s,i=Qn)=>{const o=wh({encoded:s,encoding:i});return jc(o.type)}),Fr(this,"getPayloadSenderPublicKey",(s,i=Qn)=>{const o=wh({encoded:s,encoding:i});return o.senderPublicKey?jt(o.senderPublicKey,Un):void 0}),this.core=e,this.logger=Ts(r,this.name),this.keychain=n||new foe(this.core,this.logger)}get context(){return cs(this.logger)}async setPrivateKey(e,r){return await this.keychain.set(e,r),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(mA)}catch{e=Nb(),await this.keychain.set(mA,e)}return uoe(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=be("NOT_INITIALIZED",this.name);throw new Error(e)}}}var moe=Object.defineProperty,woe=Object.defineProperties,boe=Object.getOwnPropertyDescriptors,AA=Object.getOwnPropertySymbols,voe=Object.prototype.hasOwnProperty,Eoe=Object.prototype.propertyIsEnumerable,Ub=(t,e,r)=>e in t?moe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,_oe=(t,e)=>{for(var r in e||(e={}))voe.call(e,r)&&Ub(t,r,e[r]);if(AA)for(var r of AA(e))Eoe.call(e,r)&&Ub(t,r,e[r]);return t},xoe=(t,e)=>woe(t,boe(e)),ps=(t,e,r)=>Ub(t,typeof e!="symbol"?e+"":e,r);class Soe extends xZ{constructor(e,r){super(e,r),this.logger=e,this.core=r,ps(this,"messages",new Map),ps(this,"messagesWithoutClientAck",new Map),ps(this,"name",pse),ps(this,"version",gse),ps(this,"initialized",!1),ps(this,"storagePrefix",Ki),ps(this,"init",async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const n=await this.getRelayerMessages();typeof n<"u"&&(this.messages=n);const s=await this.getRelayerMessagesWithoutClientAck();typeof s<"u"&&(this.messagesWithoutClientAck=s),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(n){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(n)}finally{this.initialized=!0}}}),ps(this,"set",async(n,s,i)=>{this.isInitialized();const o=Ks(s);let a=this.messages.get(n);if(typeof a>"u"&&(a={}),typeof a[o]<"u")return o;if(a[o]=s,this.messages.set(n,a),i===bp.inbound){const c=this.messagesWithoutClientAck.get(n)||{};this.messagesWithoutClientAck.set(n,xoe(_oe({},c),{[o]:s}))}return await this.persist(),o}),ps(this,"get",n=>{this.isInitialized();let s=this.messages.get(n);return typeof s>"u"&&(s={}),s}),ps(this,"getWithoutAck",n=>{this.isInitialized();const s={};for(const i of n){const o=this.messagesWithoutClientAck.get(i)||{};s[i]=Object.values(o)}return s}),ps(this,"has",(n,s)=>{this.isInitialized();const i=this.get(n),o=Ks(s);return typeof i[o]<"u"}),ps(this,"ack",async(n,s)=>{this.isInitialized();const i=this.messagesWithoutClientAck.get(n);if(typeof i>"u")return;const o=Ks(s);delete i[o],Object.keys(i).length===0?this.messagesWithoutClientAck.delete(n):this.messagesWithoutClientAck.set(n,i),await this.persist()}),ps(this,"del",async n=>{this.isInitialized(),this.messages.delete(n),this.messagesWithoutClientAck.delete(n),await this.persist()}),this.logger=Ts(e,this.name),this.core=r}get context(){return cs(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get storageKeyWithoutClientAck(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name+"_withoutClientAck"}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,wb(e))}async setRelayerMessagesWithoutClientAck(e){await this.core.storage.setItem(this.storageKeyWithoutClientAck,wb(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?bb(e):void 0}async getRelayerMessagesWithoutClientAck(){const e=await this.core.storage.getItem(this.storageKeyWithoutClientAck);return typeof e<"u"?bb(e):void 0}async persist(){await this.setRelayerMessages(this.messages),await this.setRelayerMessagesWithoutClientAck(this.messagesWithoutClientAck)}isInitialized(){if(!this.initialized){const{message:e}=be("NOT_INITIALIZED",this.name);throw new Error(e)}}}var Aoe=Object.defineProperty,Ioe=Object.defineProperties,Coe=Object.getOwnPropertyDescriptors,IA=Object.getOwnPropertySymbols,$oe=Object.prototype.hasOwnProperty,Toe=Object.prototype.propertyIsEnumerable,Bb=(t,e,r)=>e in t?Aoe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,vl=(t,e)=>{for(var r in e||(e={}))$oe.call(e,r)&&Bb(t,r,e[r]);if(IA)for(var r of IA(e))Toe.call(e,r)&&Bb(t,r,e[r]);return t},CA=(t,e)=>Ioe(t,Coe(e)),Bs=(t,e,r)=>Bb(t,typeof e!="symbol"?e+"":e,r);class Noe extends SZ{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,Bs(this,"events",new dr.EventEmitter),Bs(this,"name",mse),Bs(this,"queue",new Map),Bs(this,"publishTimeout",X.toMiliseconds(X.ONE_MINUTE)),Bs(this,"initialPublishTimeout",X.toMiliseconds(X.ONE_SECOND*15)),Bs(this,"needsTransportRestart",!1),Bs(this,"publish",async(n,s,i)=>{var o,a,c,l,u;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:s,opts:i}});const d=i?.ttl||yse,h=i?.prompt||!1,p=i?.tag||0,y=i?.id||Tn().toString(),g=kl(vg().protocol),w={id:y,method:i?.publishMethod||g.publish,params:vl({topic:n,message:s,ttl:d,prompt:h,tag:p,attestation:i?.attestation},i?.tvf)},S=`Failed to publish payload, please try again. id:${y} tag:${p}`;try{Dr((o=w.params)==null?void 0:o.prompt)&&((a=w.params)==null||delete a.prompt),Dr((c=w.params)==null?void 0:c.tag)&&((l=w.params)==null||delete l.tag);const A=new Promise(async E=>{const v=({id:O})=>{var L;((L=w.id)==null?void 0:L.toString())===O.toString()&&(this.removeRequestFromQueue(O),this.relayer.events.removeListener(fr.publish,v),E())};this.relayer.events.on(fr.publish,v);const C=Mi(new Promise((O,L)=>{this.rpcPublish(w,i).then(O).catch(j=>{this.logger.warn(j,j?.message),L(j)})}),this.initialPublishTimeout,`Failed initial publish, retrying.... id:${y} tag:${p}`);try{await C,this.events.removeListener(fr.publish,v)}catch(O){this.queue.set(y,{request:w,opts:i,attempt:1}),this.logger.warn(O,O?.message)}});this.logger.trace({type:"method",method:"publish",params:{id:y,topic:n,message:s,opts:i}}),await Mi(A,this.publishTimeout,S)}catch(A){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(A),(u=i?.internal)!=null&&u.throwOnFailedPublish)throw A}finally{this.queue.delete(y)}}),Bs(this,"publishCustom",async n=>{var s,i,o,a,c;this.logger.debug("Publishing custom payload"),this.logger.trace({type:"method",method:"publishCustom",params:n});const{payload:l,opts:u={}}=n,{attestation:d,tvf:h,publishMethod:p,prompt:y,tag:g,ttl:w=X.FIVE_MINUTES}=u,S=u.id||Tn().toString(),A=kl(vg().protocol),E=p||A.publish,v={id:S,method:E,params:vl(CA(vl({},l),{ttl:w,prompt:y,tag:g,attestation:d}),h)},C=`Failed to publish custom payload, please try again. id:${S} tag:${g}`;try{Dr((s=v.params)==null?void 0:s.prompt)&&((i=v.params)==null||delete i.prompt),Dr((o=v.params)==null?void 0:o.tag)&&((a=v.params)==null||delete a.tag);const O=new Promise(async L=>{const j=({id:W})=>{var P;((P=v.id)==null?void 0:P.toString())===W.toString()&&(this.removeRequestFromQueue(W),this.relayer.events.removeListener(fr.publish,j),L())};this.relayer.events.on(fr.publish,j);const D=Mi(new Promise((W,P)=>{this.rpcPublish(v,u).then(W).catch(R=>{this.logger.warn(R,R?.message),P(R)})}),this.initialPublishTimeout,`Failed initial custom payload publish, retrying.... method:${E} id:${S} tag:${g}`);try{await D,this.events.removeListener(fr.publish,j)}catch(W){this.queue.set(S,{request:v,opts:u,attempt:1}),this.logger.warn(W,W?.message)}});this.logger.trace({type:"method",method:"publish",params:{id:S,payload:l,opts:u}}),await Mi(O,this.publishTimeout,C)}catch(O){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(O),(c=u?.internal)!=null&&c.throwOnFailedPublish)throw O}finally{this.queue.delete(S)}}),Bs(this,"on",(n,s)=>{this.events.on(n,s)}),Bs(this,"once",(n,s)=>{this.events.once(n,s)}),Bs(this,"off",(n,s)=>{this.events.off(n,s)}),Bs(this,"removeListener",(n,s)=>{this.events.removeListener(n,s)}),this.relayer=e,this.logger=Ts(r,this.name),this.registerEventListeners()}get context(){return cs(this.logger)}async rpcPublish(e,r){this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:e});const n=await this.relayer.request(e);return this.relayer.events.emit(fr.publish,vl(vl({},e),r)),this.logger.debug("Successfully Published Payload"),n}removeRequestFromQueue(e){this.queue.delete(e)}checkQueue(){this.queue.forEach(async(e,r)=>{var n;const s=e.attempt+1;this.queue.set(r,CA(vl({},e),{attempt:s})),this.logger.warn({},`Publisher: queue->publishing: ${e.request.id}, tag: ${(n=e.request.params)==null?void 0:n.tag}, attempt: ${s}`),await this.rpcPublish(e.request,e.opts),this.logger.warn({},`Publisher: queue->published: ${e.request.id}`)})}registerEventListeners(){this.relayer.core.heartbeat.on(Zc.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(fr.connection_stalled);return}this.checkQueue()}),this.relayer.on(fr.message_ack,e=>{this.removeRequestFromQueue(e.id.toString())})}}var Ooe=Object.defineProperty,koe=(t,e,r)=>e in t?Ooe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,El=(t,e,r)=>koe(t,typeof e!="symbol"?e+"":e,r);class Poe{constructor(){El(this,"map",new Map),El(this,"set",(e,r)=>{const n=this.get(e);this.exists(e,r)||this.map.set(e,[...n,r])}),El(this,"get",e=>this.map.get(e)||[]),El(this,"exists",(e,r)=>this.get(e).includes(r)),El(this,"delete",(e,r)=>{if(typeof r>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const n=this.get(e);if(!this.exists(e,r))return;const s=n.filter(i=>i!==r);if(!s.length){this.map.delete(e);return}this.map.set(e,s)}),El(this,"clear",()=>{this.map.clear()})}get topics(){return Array.from(this.map.keys())}}var Roe=Object.defineProperty,Doe=Object.defineProperties,Uoe=Object.getOwnPropertyDescriptors,$A=Object.getOwnPropertySymbols,Boe=Object.prototype.hasOwnProperty,Loe=Object.prototype.propertyIsEnumerable,Lb=(t,e,r)=>e in t?Roe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Qu=(t,e)=>{for(var r in e||(e={}))Boe.call(e,r)&&Lb(t,r,e[r]);if($A)for(var r of $A(e))Loe.call(e,r)&&Lb(t,r,e[r]);return t},Nw=(t,e)=>Doe(t,Uoe(e)),zt=(t,e,r)=>Lb(t,typeof e!="symbol"?e+"":e,r);class Moe extends CZ{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,zt(this,"subscriptions",new Map),zt(this,"topicMap",new Poe),zt(this,"events",new dr.EventEmitter),zt(this,"name",Sse),zt(this,"version",Ase),zt(this,"pending",new Map),zt(this,"cached",[]),zt(this,"initialized",!1),zt(this,"storagePrefix",Ki),zt(this,"subscribeTimeout",X.toMiliseconds(X.ONE_MINUTE)),zt(this,"initialSubscribeTimeout",X.toMiliseconds(X.ONE_SECOND*15)),zt(this,"clientId"),zt(this,"batchSubscribeTopicsLimit",500),zt(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),await this.restore()),this.initialized=!0}),zt(this,"subscribe",async(n,s)=>{var i;this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:s}});try{const o=vg(s),a={topic:n,relay:o,transportType:s?.transportType};(i=s?.internal)!=null&&i.skipSubscribe||this.pending.set(n,a);const c=await this.rpcSubscribe(n,o,s);return typeof c=="string"&&(this.onSubscribe(c,a),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:s}})),c}catch(o){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(o),o}}),zt(this,"unsubscribe",async(n,s)=>{this.isInitialized(),typeof s?.id<"u"?await this.unsubscribeById(n,s.id,s):await this.unsubscribeByTopic(n,s)}),zt(this,"isSubscribed",n=>new Promise(s=>{s(this.topicMap.topics.includes(n))})),zt(this,"isKnownTopic",n=>new Promise(s=>{s(this.topicMap.topics.includes(n)||this.pending.has(n)||this.cached.some(i=>i.topic===n))})),zt(this,"on",(n,s)=>{this.events.on(n,s)}),zt(this,"once",(n,s)=>{this.events.once(n,s)}),zt(this,"off",(n,s)=>{this.events.off(n,s)}),zt(this,"removeListener",(n,s)=>{this.events.removeListener(n,s)}),zt(this,"start",async()=>{await this.onConnect()}),zt(this,"stop",async()=>{await this.onDisconnect()}),zt(this,"restart",async()=>{await this.restore(),await this.onRestart()}),zt(this,"checkPending",async()=>{if(this.pending.size===0&&(!this.initialized||!this.relayer.connected))return;const n=[];this.pending.forEach(s=>{n.push(s)}),await this.batchSubscribe(n)}),zt(this,"registerEventListeners",()=>{this.relayer.core.heartbeat.on(Zc.pulse,async()=>{await this.checkPending()}),this.events.on(ms.created,async n=>{const s=ms.created;this.logger.info(`Emitting ${s}`),this.logger.debug({type:"event",event:s,data:n}),await this.persist()}),this.events.on(ms.deleted,async n=>{const s=ms.deleted;this.logger.info(`Emitting ${s}`),this.logger.debug({type:"event",event:s,data:n}),await this.persist()})}),this.relayer=e,this.logger=Ts(r,this.name),this.clientId=""}get context(){return cs(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}get hasAnyTopics(){return this.topicMap.topics.length>0||this.pending.size>0||this.cached.length>0||this.subscriptions.size>0}hasSubscription(e,r){let n=!1;try{n=this.getSubscription(e).topic===r}catch{}return n}reset(){this.cached=[],this.initialized=!0}onDisable(){this.values.length>0&&(this.cached=this.values),this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,r){const n=this.topicMap.get(e);await Promise.all(n.map(async s=>await this.unsubscribeById(e,s,r)))}async unsubscribeById(e,r,n){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:n}});try{const s=vg(n);await this.restartToComplete({topic:e,id:r,relay:s}),await this.rpcUnsubscribe(e,r,s);const i=er("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,r,i),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:n}})}catch(s){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(s),s}}async rpcSubscribe(e,r,n){var s,i;const o=await this.getSubscriptionId(e);if((s=n?.internal)!=null&&s.skipSubscribe)return o;(!n||n?.transportType===Gt.relay)&&await this.restartToComplete({topic:e,id:e,relay:r});const a={method:kl(r.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:a});const c=(i=n?.internal)==null?void 0:i.throwOnFailedPublish;try{if(n?.transportType===Gt.link_mode)return setTimeout(()=>{(this.relayer.connected||this.relayer.connecting)&&this.relayer.request(a).catch(d=>this.logger.warn(d))},X.toMiliseconds(X.ONE_SECOND)),o;const l=new Promise(async d=>{const h=p=>{p.topic===e&&(this.events.removeListener(ms.created,h),d(p.id))};this.events.on(ms.created,h);try{const p=await Mi(new Promise((y,g)=>{this.relayer.request(a).catch(w=>{this.logger.warn(w,w?.message),g(w)}).then(y)}),this.initialSubscribeTimeout,`Subscribing to ${e} failed, please try again`);this.events.removeListener(ms.created,h),d(p)}catch{}}),u=await Mi(l,this.subscribeTimeout,`Subscribing to ${e} failed, please try again`);if(!u&&c)throw new Error(`Subscribing to ${e} failed, please try again`);return u?o:null}catch(l){if(this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(fr.connection_stalled),c)throw l}return null}async rpcBatchSubscribe(e){if(!e.length)return;const r=e[0].relay,n={method:kl(r.protocol).batchSubscribe,params:{topics:e.map(s=>s.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{await await Mi(new Promise(s=>{this.relayer.request(n).catch(i=>this.logger.warn(i)).then(s)}),this.subscribeTimeout,"rpcBatchSubscribe failed, please try again")}catch{this.relayer.events.emit(fr.connection_stalled)}}async rpcBatchFetchMessages(e){if(!e.length)return;const r=e[0].relay,n={method:kl(r.protocol).batchFetchMessages,params:{topics:e.map(i=>i.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});let s;try{s=await await Mi(new Promise((i,o)=>{this.relayer.request(n).catch(a=>{this.logger.warn(a),o(a)}).then(i)}),this.subscribeTimeout,"rpcBatchFetchMessages failed, please try again")}catch{this.relayer.events.emit(fr.connection_stalled)}return s}rpcUnsubscribe(e,r,n){const s={method:kl(n.protocol).unsubscribe,params:{topic:e,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s}),this.relayer.request(s)}onSubscribe(e,r){this.setSubscription(e,Nw(Qu({},r),{id:e})),this.pending.delete(r.topic)}onBatchSubscribe(e){e.length&&e.forEach(r=>{this.setSubscription(r.id,Qu({},r)),this.pending.delete(r.topic)})}async onUnsubscribe(e,r,n){this.events.removeAllListeners(r),this.hasSubscription(r,e)&&this.deleteSubscription(r,n),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,r){this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:r}),this.addSubscription(e,r)}addSubscription(e,r){this.subscriptions.set(e,Qu({},r)),this.topicMap.set(r.topic,e),this.events.emit(ms.created,r)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const r=this.subscriptions.get(e);if(!r){const{message:n}=be("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(n)}return r}deleteSubscription(e,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:r});const n=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(n.topic,e),this.events.emit(ms.deleted,Nw(Qu({},n),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(ms.sync)}async onRestart(){if(this.cached.length){const e=[...this.cached],r=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let n=0;n<r;n++){const s=e.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(s)}}this.events.emit(ms.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size&&!e.every(r=>{var n;return r.topic===((n=this.subscriptions.get(r.id))==null?void 0:n.topic)})){const{message:r}=be("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){e.length&&(await this.rpcBatchSubscribe(e),this.onBatchSubscribe(await Promise.all(e.map(async r=>Nw(Qu({},r),{id:await this.getSubscriptionId(r.topic)})))))}async batchFetchMessages(e){if(!e.length)return;this.logger.trace(`Fetching batch messages for ${e.length} subscriptions`);const r=await this.rpcBatchFetchMessages(e);r&&r.messages&&(await cee(X.toMiliseconds(X.ONE_SECOND)),await this.relayer.handleBatchMessageEvents(r.messages))}async onConnect(){await this.restart(),this.reset()}onDisconnect(){this.onDisable()}isInitialized(){if(!this.initialized){const{message:e}=be("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(e){!this.relayer.connected&&!this.relayer.connecting&&(this.cached.push(e),await this.relayer.transportOpen())}async getClientId(){return this.clientId||(this.clientId=await this.relayer.core.crypto.getClientId()),this.clientId}async getSubscriptionId(e){return Ks(e+await this.getClientId())}}var joe=Object.defineProperty,TA=Object.getOwnPropertySymbols,Foe=Object.prototype.hasOwnProperty,qoe=Object.prototype.propertyIsEnumerable,Mb=(t,e,r)=>e in t?joe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,NA=(t,e)=>{for(var r in e||(e={}))Foe.call(e,r)&&Mb(t,r,e[r]);if(TA)for(var r of TA(e))qoe.call(e,r)&&Mb(t,r,e[r]);return t},$t=(t,e,r)=>Mb(t,typeof e!="symbol"?e+"":e,r);class zoe extends AZ{constructor(e){var r;super(e),$t(this,"protocol","wc"),$t(this,"version",2),$t(this,"core"),$t(this,"logger"),$t(this,"events",new dr.EventEmitter),$t(this,"provider"),$t(this,"messages"),$t(this,"subscriber"),$t(this,"publisher"),$t(this,"name",bse),$t(this,"transportExplicitlyClosed",!1),$t(this,"initialized",!1),$t(this,"connectionAttemptInProgress",!1),$t(this,"relayUrl"),$t(this,"projectId"),$t(this,"packageName"),$t(this,"bundleId"),$t(this,"hasExperiencedNetworkDisruption",!1),$t(this,"pingTimeout"),$t(this,"heartBeatTimeout",X.toMiliseconds(X.THIRTY_SECONDS+X.FIVE_SECONDS)),$t(this,"reconnectTimeout"),$t(this,"connectPromise"),$t(this,"reconnectInProgress",!1),$t(this,"requestsInFlight",[]),$t(this,"connectTimeout",X.toMiliseconds(X.ONE_SECOND*15)),$t(this,"request",async n=>{var s,i;this.logger.debug("Publishing Request Payload");const o=n.id||Tn().toString();await this.toEstablishConnection();try{this.logger.trace({id:o,method:n.method,topic:(s=n.params)==null?void 0:s.topic},"relayer.request - publishing...");const a=`${o}:${((i=n.params)==null?void 0:i.tag)||""}`;this.requestsInFlight.push(a);const c=await this.provider.request(n);return this.requestsInFlight=this.requestsInFlight.filter(l=>l!==a),c}catch(a){throw this.logger.debug(`Failed to Publish Request: ${o}`),a}}),$t(this,"resetPingTimeout",()=>{pg()&&(clearTimeout(this.pingTimeout),this.pingTimeout=setTimeout(()=>{var n,s,i,o;try{this.logger.debug({},"pingTimeout: Connection stalled, terminating..."),(o=(i=(s=(n=this.provider)==null?void 0:n.connection)==null?void 0:s.socket)==null?void 0:i.terminate)==null||o.call(i)}catch(a){this.logger.warn(a,a?.message)}},this.heartBeatTimeout))}),$t(this,"onPayloadHandler",n=>{this.onProviderPayload(n),this.resetPingTimeout()}),$t(this,"onConnectHandler",()=>{this.logger.warn({},"Relayer connected "),this.startPingTimeout(),this.events.emit(fr.connect)}),$t(this,"onDisconnectHandler",()=>{this.logger.warn({},"Relayer disconnected "),this.requestsInFlight=[],this.onProviderDisconnect()}),$t(this,"onProviderErrorHandler",n=>{this.logger.fatal(`Fatal socket error: ${n.message}`),this.events.emit(fr.error,n),this.logger.fatal("Fatal socket error received, closing transport"),this.transportClose()}),$t(this,"registerProviderListeners",()=>{this.provider.on(Us.payload,this.onPayloadHandler),this.provider.on(Us.connect,this.onConnectHandler),this.provider.on(Us.disconnect,this.onDisconnectHandler),this.provider.on(Us.error,this.onProviderErrorHandler)}),this.core=e.core,this.logger=Nv({logger:(r=e.logger)!=null?r:wse,name:this.name}),this.messages=new Soe(this.logger,e.core),this.subscriber=new Moe(this,this.logger),this.publisher=new Noe(this,this.logger),this.projectId=e?.projectId,this.relayUrl=e?.relayUrl||U5,VQ()?this.packageName=_S():KQ()&&(this.bundleId=_S()),this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await Promise.all([this.messages.init(),this.subscriber.init()]),this.initialized=!0,this.transportOpen().catch(e=>this.logger.warn(e,e?.message))}get context(){return cs(this.logger)}get connected(){var e,r,n;return((n=(r=(e=this.provider)==null?void 0:e.connection)==null?void 0:r.socket)==null?void 0:n.readyState)===1||!1}get connecting(){var e,r,n;return((n=(r=(e=this.provider)==null?void 0:e.connection)==null?void 0:r.socket)==null?void 0:n.readyState)===0||this.connectPromise!==void 0||!1}async publish(e,r,n){this.isInitialized(),await this.publisher.publish(e,r,n),await this.recordMessageEvent({topic:e,message:r,publishedAt:Date.now(),transportType:Gt.relay},bp.outbound)}async publishCustom(e){this.isInitialized(),await this.publisher.publishCustom(e)}async subscribe(e,r){var n,s,i;this.isInitialized(),(!(r!=null&&r.transportType)||r?.transportType==="relay")&&await this.toEstablishConnection();const o=typeof((n=r?.internal)==null?void 0:n.throwOnFailedPublish)>"u"?!0:(s=r?.internal)==null?void 0:s.throwOnFailedPublish;let a=((i=this.subscriber.topicMap.get(e))==null?void 0:i[0])||"",c;const l=u=>{u.topic===e&&(this.subscriber.off(ms.created,l),c())};return await Promise.all([new Promise(u=>{c=u,this.subscriber.on(ms.created,l)}),new Promise(async(u,d)=>{a=await this.subscriber.subscribe(e,NA({internal:{throwOnFailedPublish:o}},r)).catch(h=>{o&&d(h)})||a,u()})]),a}async unsubscribe(e,r){this.isInitialized(),await this.subscriber.unsubscribe(e,r)}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async transportDisconnect(){this.provider.disconnect&&(this.hasExperiencedNetworkDisruption||this.connected)?await Mi(this.provider.disconnect(),2e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.onProviderDisconnect()}async transportClose(){this.transportExplicitlyClosed=!0,await this.transportDisconnect()}async transportOpen(e){if(!this.subscriber.hasAnyTopics){this.logger.info("Starting WS connection skipped because the client has no topics to work with.");return}if(this.connectPromise?(this.logger.debug({},"Waiting for existing connection attempt to resolve..."),await this.connectPromise,this.logger.debug({},"Existing connection attempt resolved")):(this.connectPromise=new Promise(async(r,n)=>{await this.connect(e).then(r).catch(n).finally(()=>{this.connectPromise=void 0})}),await this.connectPromise),!this.connected)throw new Error(`Couldn't establish socket connection to the relay server: ${this.relayUrl}`)}async restartTransport(e){this.logger.debug({},"Restarting transport..."),!this.connectionAttemptInProgress&&(this.relayUrl=e||this.relayUrl,await this.confirmOnlineStateOrThrow(),await this.transportClose(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await pA())throw new Error("No internet connection detected. Please restart your network and try again.")}async handleBatchMessageEvents(e){if(e?.length===0){this.logger.trace("Batch message events is empty. Ignoring...");return}const r=e.sort((n,s)=>n.publishedAt-s.publishedAt);this.logger.debug(`Batch of ${r.length} message events sorted`);for(const n of r)try{await this.onMessageEvent(n)}catch(s){this.logger.warn(s,"Error while processing batch message event: "+s?.message)}this.logger.trace(`Batch of ${r.length} message events processed`)}async onLinkMessageEvent(e,r){const{topic:n}=e;if(!r.sessionExists){const s=vr(X.FIVE_MINUTES),i={topic:n,expiry:s,relay:{protocol:"irn"},active:!1};await this.core.pairing.pairings.set(n,i)}this.events.emit(fr.message,e),await this.recordMessageEvent(e,bp.inbound)}async connect(e){await this.confirmOnlineStateOrThrow(),e&&e!==this.relayUrl&&(this.relayUrl=e,await this.transportDisconnect()),this.connectionAttemptInProgress=!0,this.transportExplicitlyClosed=!1;let r=1;for(;r<6;){try{if(this.transportExplicitlyClosed)break;this.logger.debug({},`Connecting to ${this.relayUrl}, attempt: ${r}...`),await this.createProvider(),await new Promise(async(n,s)=>{const i=()=>{s(new Error("Connection interrupted while trying to connect"))};this.provider.once(Us.disconnect,i),await Mi(new Promise((o,a)=>{this.provider.connect().then(o).catch(a)}),this.connectTimeout,`Socket stalled when trying to connect to ${this.relayUrl}`).catch(o=>{s(o)}).finally(()=>{this.provider.off(Us.disconnect,i),clearTimeout(this.reconnectTimeout)}),await new Promise(async(o,a)=>{const c=()=>{s(new Error("Connection interrupted while trying to subscribe"))};this.provider.once(Us.disconnect,c),await this.subscriber.start().then(o).catch(a).finally(()=>{this.provider.off(Us.disconnect,c)})}),this.hasExperiencedNetworkDisruption=!1,n()})}catch(n){await this.subscriber.stop();const s=n;this.logger.warn({},s.message),this.hasExperiencedNetworkDisruption=!0}finally{this.connectionAttemptInProgress=!1}if(this.connected){this.logger.debug({},`Connected to ${this.relayUrl} successfully on attempt: ${r}`);break}await new Promise(n=>setTimeout(n,X.toMiliseconds(r*1))),r++}}startPingTimeout(){var e,r,n,s,i;if(pg())try{(r=(e=this.provider)==null?void 0:e.connection)!=null&&r.socket&&((i=(s=(n=this.provider)==null?void 0:n.connection)==null?void 0:s.socket)==null||i.on("ping",()=>{this.resetPingTimeout()})),this.resetPingTimeout()}catch(o){this.logger.warn(o,o?.message)}}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new Ov(new ose(JQ({sdkVersion:Pb,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0,bundleId:this.bundleId,packageName:this.packageName}))),this.registerProviderListeners()}async recordMessageEvent(e,r){const{topic:n,message:s}=e;await this.messages.set(n,s,r)}async shouldIgnoreMessageEvent(e){const{topic:r,message:n}=e;if(!n||n.length===0)return this.logger.warn(`Ignoring invalid/empty message: ${n}`),!0;if(!await this.subscriber.isKnownTopic(r))return this.logger.warn(`Ignoring message for unknown topic ${r}`),!0;const s=this.messages.has(r,n);return s&&this.logger.warn(`Ignoring duplicate message: ${n}`),s}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),yu(e)){if(!e.method.endsWith(vse))return;const r=e.params,{topic:n,message:s,publishedAt:i,attestation:o}=r.data,a={topic:n,message:s,publishedAt:i,transportType:Gt.relay,attestation:o};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(NA({type:"event",event:r.id},a)),this.events.emit(r.id,a),await this.acknowledgePayload(e),await this.onMessageEvent(a)}else Ua(e)&&this.events.emit(fr.message_ack,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(await this.recordMessageEvent(e,bp.inbound),this.events.emit(fr.message,e))}async acknowledgePayload(e){const r=Do(e.id,!0);await this.provider.connection.send(r)}unregisterProviderListeners(){this.provider.off(Us.payload,this.onPayloadHandler),this.provider.off(Us.connect,this.onConnectHandler),this.provider.off(Us.disconnect,this.onDisconnectHandler),this.provider.off(Us.error,this.onProviderErrorHandler),clearTimeout(this.pingTimeout)}async registerEventListeners(){let e=await pA();Wne(async r=>{e!==r&&(e=r,r?await this.transportOpen().catch(n=>this.logger.error(n,n?.message)):(this.hasExperiencedNetworkDisruption=!0,await this.transportDisconnect(),this.transportExplicitlyClosed=!1))}),this.core.heartbeat.on(Zc.pulse,async()=>{if(!this.transportExplicitlyClosed&&!this.connected&&Gne())try{await this.confirmOnlineStateOrThrow(),await this.transportOpen()}catch(r){this.logger.warn(r,r?.message)}})}async onProviderDisconnect(){clearTimeout(this.pingTimeout),this.events.emit(fr.disconnect),this.connectionAttemptInProgress=!1,!this.reconnectInProgress&&(this.reconnectInProgress=!0,await this.subscriber.stop(),this.subscriber.hasAnyTopics&&(this.transportExplicitlyClosed||(this.reconnectTimeout=setTimeout(async()=>{await this.transportOpen().catch(e=>this.logger.error(e,e?.message)),this.reconnectTimeout=void 0,this.reconnectInProgress=!1},X.toMiliseconds(Ese)))))}isInitialized(){if(!this.initialized){const{message:e}=be("NOT_INITIALIZED",this.name);throw new Error(e)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectPromise){await this.connectPromise;return}await this.connect()}}}function Hoe(t,e){return t===e||Number.isNaN(t)&&Number.isNaN(e)}function OA(t){return Object.getOwnPropertySymbols(t).filter(e=>Object.prototype.propertyIsEnumerable.call(t,e))}function kA(t){return t==null?t===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(t)}const Woe="[object RegExp]",Voe="[object String]",Koe="[object Number]",Goe="[object Boolean]",PA="[object Arguments]",Yoe="[object Symbol]",Xoe="[object Date]",Zoe="[object Map]",Joe="[object Set]",Qoe="[object Array]",eae="[object Function]",tae="[object ArrayBuffer]",Ow="[object Object]",rae="[object Error]",nae="[object DataView]",sae="[object Uint8Array]",iae="[object Uint8ClampedArray]",oae="[object Uint16Array]",aae="[object Uint32Array]",cae="[object BigUint64Array]",lae="[object Int8Array]",uae="[object Int16Array]",dae="[object Int32Array]",hae="[object BigInt64Array]",fae="[object Float32Array]",pae="[object Float64Array]";function gae(){}function RA(t){if(!t||typeof t!="object")return!1;const e=Object.getPrototypeOf(t);return e===null||e===Object.prototype||Object.getPrototypeOf(e)===null?Object.prototype.toString.call(t)==="[object Object]":!1}function yae(t,e,r){return ud(t,e,void 0,void 0,void 0,void 0,r)}function ud(t,e,r,n,s,i,o){const a=o(t,e,r,n,s,i);if(a!==void 0)return a;if(typeof t==typeof e)switch(typeof t){case"bigint":case"string":case"boolean":case"symbol":case"undefined":return t===e;case"number":return t===e||Object.is(t,e);case"function":return t===e;case"object":return Sd(t,e,i,o)}return Sd(t,e,i,o)}function Sd(t,e,r,n){if(Object.is(t,e))return!0;let s=kA(t),i=kA(e);if(s===PA&&(s=Ow),i===PA&&(i=Ow),s!==i)return!1;switch(s){case Voe:return t.toString()===e.toString();case Koe:{const c=t.valueOf(),l=e.valueOf();return Hoe(c,l)}case Goe:case Xoe:case Yoe:return Object.is(t.valueOf(),e.valueOf());case Woe:return t.source===e.source&&t.flags===e.flags;case eae:return t===e}r=r??new Map;const o=r.get(t),a=r.get(e);if(o!=null&&a!=null)return o===e;r.set(t,e),r.set(e,t);try{switch(s){case Zoe:{if(t.size!==e.size)return!1;for(const[c,l]of t.entries())if(!e.has(c)||!ud(l,e.get(c),c,t,e,r,n))return!1;return!0}case Joe:{if(t.size!==e.size)return!1;const c=Array.from(t.values()),l=Array.from(e.values());for(let u=0;u<c.length;u++){const d=c[u],h=l.findIndex(p=>ud(d,p,void 0,t,e,r,n));if(h===-1)return!1;l.splice(h,1)}return!0}case Qoe:case sae:case iae:case oae:case aae:case cae:case lae:case uae:case dae:case hae:case fae:case pae:{if(typeof Buffer<"u"&&Buffer.isBuffer(t)!==Buffer.isBuffer(e)||t.length!==e.length)return!1;for(let c=0;c<t.length;c++)if(!ud(t[c],e[c],c,t,e,r,n))return!1;return!0}case tae:return t.byteLength!==e.byteLength?!1:Sd(new Uint8Array(t),new Uint8Array(e),r,n);case nae:return t.byteLength!==e.byteLength||t.byteOffset!==e.byteOffset?!1:Sd(new Uint8Array(t),new Uint8Array(e),r,n);case rae:return t.name===e.name&&t.message===e.message;case Ow:{if(!(Sd(t.constructor,e.constructor,r,n)||RA(t)&&RA(e)))return!1;const c=[...Object.keys(t),...OA(t)],l=[...Object.keys(e),...OA(e)];if(c.length!==l.length)return!1;for(let u=0;u<c.length;u++){const d=c[u],h=t[d];if(!Object.hasOwn(e,d))return!1;const p=e[d];if(!ud(h,p,d,t,e,r,n))return!1}return!0}default:return!1}}finally{r.delete(t),r.delete(e)}}function mae(t,e){return yae(t,e,gae)}var wae=Object.defineProperty,DA=Object.getOwnPropertySymbols,bae=Object.prototype.hasOwnProperty,vae=Object.prototype.propertyIsEnumerable,jb=(t,e,r)=>e in t?wae(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,UA=(t,e)=>{for(var r in e||(e={}))bae.call(e,r)&&jb(t,r,e[r]);if(DA)for(var r of DA(e))vae.call(e,r)&&jb(t,r,e[r]);return t},zn=(t,e,r)=>jb(t,typeof e!="symbol"?e+"":e,r);class Qc extends IZ{constructor(e,r,n,s=Ki,i=void 0){super(e,r,n,s),this.core=e,this.logger=r,this.name=n,zn(this,"map",new Map),zn(this,"version",_se),zn(this,"cached",[]),zn(this,"initialized",!1),zn(this,"getKey"),zn(this,"storagePrefix",Ki),zn(this,"recentlyDeleted",[]),zn(this,"recentlyDeletedLimit",200),zn(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(o=>{this.getKey&&o!==null&&!Dr(o)?this.map.set(this.getKey(o),o):_ne(o)?this.map.set(o.id,o):xne(o)&&this.map.set(o.topic,o)}),this.cached=[],this.initialized=!0)}),zn(this,"set",async(o,a)=>{this.isInitialized(),this.map.has(o)?await this.update(o,a):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:o,value:a}),this.map.set(o,a),await this.persist())}),zn(this,"get",o=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:o}),this.getData(o))),zn(this,"getAll",o=>(this.isInitialized(),o?this.values.filter(a=>Object.keys(o).every(c=>mae(a[c],o[c]))):this.values)),zn(this,"update",async(o,a)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:o,update:a});const c=UA(UA({},this.getData(o)),a);this.map.set(o,c),await this.persist()}),zn(this,"delete",async(o,a)=>{this.isInitialized(),this.map.has(o)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:o,reason:a}),this.map.delete(o),this.addToRecentlyDeleted(o),await this.persist())}),this.logger=Ts(r,this.name),this.storagePrefix=s,this.getKey=i}get context(){return cs(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}addToRecentlyDeleted(e){this.recentlyDeleted.push(e),this.recentlyDeleted.length>=this.recentlyDeletedLimit&&this.recentlyDeleted.splice(0,this.recentlyDeletedLimit/2)}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const r=this.map.get(e);if(!r){if(this.recentlyDeleted.includes(e)){const{message:s}=be("MISSING_OR_INVALID",`Record was recently deleted - ${this.name}: ${e}`);throw this.logger.error(s),new Error(s)}const{message:n}=be("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(n),new Error(n)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:r}=be("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=be("NOT_INITIALIZED",this.name);throw new Error(e)}}}var Eae=Object.defineProperty,_ae=(t,e,r)=>e in t?Eae(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ht=(t,e,r)=>_ae(t,typeof e!="symbol"?e+"":e,r);class xae{constructor(e,r){this.core=e,this.logger=r,ht(this,"name",Ise),ht(this,"version",Cse),ht(this,"events",new $h),ht(this,"pairings"),ht(this,"initialized",!1),ht(this,"storagePrefix",Ki),ht(this,"ignoredPayloadTypes",[ko]),ht(this,"registeredMethods",[]),ht(this,"init",async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))}),ht(this,"register",({methods:n})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...n])]}),ht(this,"create",async n=>{this.isInitialized();const s=Nb(),i=await this.core.crypto.setSymKey(s),o=vr(X.FIVE_MINUTES),a={protocol:D5},c={topic:i,expiry:o,relay:a,active:!1,methods:n?.methods},l=iA({protocol:this.core.protocol,version:this.core.version,topic:i,symKey:s,relay:a,expiryTimestamp:o,methods:n?.methods});return this.events.emit(cc.create,c),this.core.expirer.set(i,o),await this.pairings.set(i,c),await this.core.relayer.subscribe(i,{transportType:n?.transportType,internal:n?.internal}),{topic:i,uri:l}}),ht(this,"pair",async n=>{this.isInitialized();const s=this.core.eventClient.createEvent({properties:{topic:n?.uri,trace:[ki.pairing_started]}});this.isValidPair(n,s);const{topic:i,symKey:o,relay:a,expiryTimestamp:c,methods:l}=sA(n.uri);s.props.properties.topic=i,s.addTrace(ki.pairing_uri_validation_success),s.addTrace(ki.pairing_uri_not_expired);let u;if(this.pairings.keys.includes(i)){if(u=this.pairings.get(i),s.addTrace(ki.existing_pairing),u.active)throw s.setError(lo.active_pairing_already_exists),new Error(`Pairing already exists: ${i}. Please try again with a new connection URI.`);s.addTrace(ki.pairing_not_expired)}const d=c||vr(X.FIVE_MINUTES),h={topic:i,relay:a,expiry:d,active:!1,methods:l};this.core.expirer.set(i,d),await this.pairings.set(i,h),s.addTrace(ki.store_new_pairing),n.activatePairing&&await this.activate({topic:i}),this.events.emit(cc.create,h),s.addTrace(ki.emit_inactive_pairing),this.core.crypto.keychain.has(i)||await this.core.crypto.setSymKey(o,i),s.addTrace(ki.subscribing_pairing_topic);try{await this.core.relayer.confirmOnlineStateOrThrow()}catch{s.setError(lo.no_internet_connection)}try{await this.core.relayer.subscribe(i,{relay:a})}catch(p){throw s.setError(lo.subscribe_pairing_topic_failure),p}return s.addTrace(ki.subscribe_pairing_topic_success),h}),ht(this,"activate",async({topic:n})=>{this.isInitialized();const s=vr(X.FIVE_MINUTES);this.core.expirer.set(n,s),await this.pairings.update(n,{active:!0,expiry:s})}),ht(this,"ping",async n=>{this.isInitialized(),await this.isValidPing(n),this.logger.warn("ping() is deprecated and will be removed in the next major release.");const{topic:s}=n;if(this.pairings.keys.includes(s)){const i=await this.sendRequest(s,"wc_pairingPing",{}),{done:o,resolve:a,reject:c}=rc();this.events.once(kt("pairing_ping",i),({error:l})=>{l?c(l):a()}),await o()}}),ht(this,"updateExpiry",async({topic:n,expiry:s})=>{this.isInitialized(),await this.pairings.update(n,{expiry:s})}),ht(this,"updateMetadata",async({topic:n,metadata:s})=>{this.isInitialized(),await this.pairings.update(n,{peerMetadata:s})}),ht(this,"getPairings",()=>(this.isInitialized(),this.pairings.values)),ht(this,"disconnect",async n=>{this.isInitialized(),await this.isValidDisconnect(n);const{topic:s}=n;this.pairings.keys.includes(s)&&(await this.sendRequest(s,"wc_pairingDelete",er("USER_DISCONNECTED")),await this.deletePairing(s))}),ht(this,"formatUriFromPairing",n=>{this.isInitialized();const{topic:s,relay:i,expiry:o,methods:a}=n,c=this.core.crypto.keychain.get(s);return iA({protocol:this.core.protocol,version:this.core.version,topic:s,symKey:c,relay:i,expiryTimestamp:o,methods:a})}),ht(this,"sendRequest",async(n,s,i)=>{const o=Ar(s,i),a=await this.core.crypto.encode(n,o),c=Zu[s].req;return this.core.history.set(n,o),this.core.relayer.publish(n,a,c),o.id}),ht(this,"sendResult",async(n,s,i)=>{const o=Do(n,i),a=await this.core.crypto.encode(s,o),c=(await this.core.history.get(s,n)).request.method,l=Zu[c].res;await this.core.relayer.publish(s,a,l),await this.core.history.resolve(o)}),ht(this,"sendError",async(n,s,i)=>{const o=Vc(n,i),a=await this.core.crypto.encode(s,o),c=(await this.core.history.get(s,n)).request.method,l=Zu[c]?Zu[c].res:Zu.unregistered_method.res;await this.core.relayer.publish(s,a,l),await this.core.history.resolve(o)}),ht(this,"deletePairing",async(n,s)=>{await this.core.relayer.unsubscribe(n),await Promise.all([this.pairings.delete(n,er("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(n),s?Promise.resolve():this.core.expirer.del(n)])}),ht(this,"cleanup",async()=>{const n=this.pairings.getAll().filter(s=>Ui(s.expiry));await Promise.all(n.map(s=>this.deletePairing(s.topic)))}),ht(this,"onRelayEventRequest",async n=>{const{topic:s,payload:i}=n;switch(i.method){case"wc_pairingPing":return await this.onPairingPingRequest(s,i);case"wc_pairingDelete":return await this.onPairingDeleteRequest(s,i);default:return await this.onUnknownRpcMethodRequest(s,i)}}),ht(this,"onRelayEventResponse",async n=>{const{topic:s,payload:i}=n,o=(await this.core.history.get(s,i.id)).request.method;switch(o){case"wc_pairingPing":return this.onPairingPingResponse(s,i);default:return this.onUnknownRpcMethodResponse(o)}}),ht(this,"onPairingPingRequest",async(n,s)=>{const{id:i}=s;try{this.isValidPing({topic:n}),await this.sendResult(i,n,!0),this.events.emit(cc.ping,{id:i,topic:n})}catch(o){await this.sendError(i,n,o),this.logger.error(o)}}),ht(this,"onPairingPingResponse",(n,s)=>{const{id:i}=s;setTimeout(()=>{Rr(s)?this.events.emit(kt("pairing_ping",i),{}):nr(s)&&this.events.emit(kt("pairing_ping",i),{error:s.error})},500)}),ht(this,"onPairingDeleteRequest",async(n,s)=>{const{id:i}=s;try{this.isValidDisconnect({topic:n}),await this.deletePairing(n),this.events.emit(cc.delete,{id:i,topic:n})}catch(o){await this.sendError(i,n,o),this.logger.error(o)}}),ht(this,"onUnknownRpcMethodRequest",async(n,s)=>{const{id:i,method:o}=s;try{if(this.registeredMethods.includes(o))return;const a=er("WC_METHOD_UNSUPPORTED",o);await this.sendError(i,n,a),this.logger.error(a)}catch(a){await this.sendError(i,n,a),this.logger.error(a)}}),ht(this,"onUnknownRpcMethodResponse",n=>{this.registeredMethods.includes(n)||this.logger.error(er("WC_METHOD_UNSUPPORTED",n))}),ht(this,"isValidPair",(n,s)=>{var i;if(!Vn(n)){const{message:a}=be("MISSING_OR_INVALID",`pair() params: ${n}`);throw s.setError(lo.malformed_pairing_uri),new Error(a)}if(!Ene(n.uri)){const{message:a}=be("MISSING_OR_INVALID",`pair() uri: ${n.uri}`);throw s.setError(lo.malformed_pairing_uri),new Error(a)}const o=sA(n?.uri);if(!((i=o?.relay)!=null&&i.protocol)){const{message:a}=be("MISSING_OR_INVALID","pair() uri#relay-protocol");throw s.setError(lo.malformed_pairing_uri),new Error(a)}if(!(o!=null&&o.symKey)){const{message:a}=be("MISSING_OR_INVALID","pair() uri#symKey");throw s.setError(lo.malformed_pairing_uri),new Error(a)}if(o!=null&&o.expiryTimestamp&&X.toMiliseconds(o?.expiryTimestamp)<Date.now()){s.setError(lo.pairing_expired);const{message:a}=be("EXPIRED","pair() URI has expired. Please try again with a new connection URI.");throw new Error(a)}}),ht(this,"isValidPing",async n=>{if(!Vn(n)){const{message:i}=be("MISSING_OR_INVALID",`ping() params: ${n}`);throw new Error(i)}const{topic:s}=n;await this.isValidPairingTopic(s)}),ht(this,"isValidDisconnect",async n=>{if(!Vn(n)){const{message:i}=be("MISSING_OR_INVALID",`disconnect() params: ${n}`);throw new Error(i)}const{topic:s}=n;await this.isValidPairingTopic(s)}),ht(this,"isValidPairingTopic",async n=>{if(!Sr(n,!1)){const{message:s}=be("MISSING_OR_INVALID",`pairing topic should be a string: ${n}`);throw new Error(s)}if(!this.pairings.keys.includes(n)){const{message:s}=be("NO_MATCHING_KEY",`pairing topic doesn't exist: ${n}`);throw new Error(s)}if(Ui(this.pairings.get(n).expiry)){await this.deletePairing(n);const{message:s}=be("EXPIRED",`pairing topic: ${n}`);throw new Error(s)}}),this.core=e,this.logger=Ts(r,this.name),this.pairings=new Qc(this.core,this.logger,this.name,this.storagePrefix)}get context(){return cs(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=be("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(fr.message,async e=>{const{topic:r,message:n,transportType:s}=e;if(this.pairings.keys.includes(r)&&s!==Gt.link_mode&&!this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(n)))try{const i=await this.core.crypto.decode(r,n);yu(i)?(this.core.history.set(r,i),await this.onRelayEventRequest({topic:r,payload:i})):Ua(i)&&(await this.core.history.resolve(i),await this.onRelayEventResponse({topic:r,payload:i}),this.core.history.delete(r,i.id)),await this.core.relayer.messages.ack(r,n)}catch(i){this.logger.error(i)}})}registerExpirerEvents(){this.core.expirer.on(zs.expired,async e=>{const{topic:r}=PO(e.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit(cc.expire,{topic:r}))})}}var Sae=Object.defineProperty,Aae=(t,e,r)=>e in t?Sae(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,rn=(t,e,r)=>Aae(t,typeof e!="symbol"?e+"":e,r);class Iae extends _Z{constructor(e,r){super(e,r),this.core=e,this.logger=r,rn(this,"records",new Map),rn(this,"events",new dr.EventEmitter),rn(this,"name",$se),rn(this,"version",Tse),rn(this,"cached",[]),rn(this,"initialized",!1),rn(this,"storagePrefix",Ki),rn(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.records.set(n.id,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),rn(this,"set",(n,s,i)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:n,request:s,chainId:i}),this.records.has(s.id))return;const o={id:s.id,topic:n,request:{method:s.method,params:s.params||null},chainId:i,expiry:vr(X.THIRTY_DAYS)};this.records.set(o.id,o),this.persist(),this.events.emit(ni.created,o)}),rn(this,"resolve",async n=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:n}),!this.records.has(n.id))return;const s=await this.getRecord(n.id);typeof s.response>"u"&&(s.response=nr(n)?{error:n.error}:{result:n.result},this.records.set(s.id,s),this.persist(),this.events.emit(ni.updated,s))}),rn(this,"get",async(n,s)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:n,id:s}),await this.getRecord(s))),rn(this,"delete",(n,s)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:s}),this.values.forEach(i=>{if(i.topic===n){if(typeof s<"u"&&i.id!==s)return;this.records.delete(i.id),this.events.emit(ni.deleted,i)}}),this.persist()}),rn(this,"exists",async(n,s)=>(this.isInitialized(),this.records.has(s)?(await this.getRecord(s)).topic===n:!1)),rn(this,"on",(n,s)=>{this.events.on(n,s)}),rn(this,"once",(n,s)=>{this.events.once(n,s)}),rn(this,"off",(n,s)=>{this.events.off(n,s)}),rn(this,"removeListener",(n,s)=>{this.events.removeListener(n,s)}),this.logger=Ts(r,this.name)}get context(){return cs(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const n={topic:r.topic,request:Ar(r.request.method,r.request.params,r.id),chainId:r.chainId};return e.push(n)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const r=this.records.get(e);if(!r){const{message:n}=be("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(n)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(ni.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:r}=be("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(ni.created,e=>{const r=ni.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e})}),this.events.on(ni.updated,e=>{const r=ni.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e})}),this.events.on(ni.deleted,e=>{const r=ni.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e})}),this.core.heartbeat.on(Zc.pulse,()=>{this.cleanup()})}cleanup(){try{this.isInitialized();let e=!1;this.records.forEach(r=>{X.toMiliseconds(r.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${r.id}`),this.records.delete(r.id),this.events.emit(ni.deleted,r,!1),e=!0)}),e&&this.persist()}catch(e){this.logger.warn(e)}}isInitialized(){if(!this.initialized){const{message:e}=be("NOT_INITIALIZED",this.name);throw new Error(e)}}}var Cae=Object.defineProperty,$ae=(t,e,r)=>e in t?Cae(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Sn=(t,e,r)=>$ae(t,typeof e!="symbol"?e+"":e,r);class Tae extends $Z{constructor(e,r){super(e,r),this.core=e,this.logger=r,Sn(this,"expirations",new Map),Sn(this,"events",new dr.EventEmitter),Sn(this,"name",Nse),Sn(this,"version",Ose),Sn(this,"cached",[]),Sn(this,"initialized",!1),Sn(this,"storagePrefix",Ki),Sn(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.expirations.set(n.target,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),Sn(this,"has",n=>{try{const s=this.formatTarget(n);return typeof this.getExpiration(s)<"u"}catch{return!1}}),Sn(this,"set",(n,s)=>{this.isInitialized();const i=this.formatTarget(n),o={target:i,expiry:s};this.expirations.set(i,o),this.checkExpiry(i,o),this.events.emit(zs.created,{target:i,expiration:o})}),Sn(this,"get",n=>{this.isInitialized();const s=this.formatTarget(n);return this.getExpiration(s)}),Sn(this,"del",n=>{if(this.isInitialized(),this.has(n)){const s=this.formatTarget(n),i=this.getExpiration(s);this.expirations.delete(s),this.events.emit(zs.deleted,{target:s,expiration:i})}}),Sn(this,"on",(n,s)=>{this.events.on(n,s)}),Sn(this,"once",(n,s)=>{this.events.once(n,s)}),Sn(this,"off",(n,s)=>{this.events.off(n,s)}),Sn(this,"removeListener",(n,s)=>{this.events.removeListener(n,s)}),this.logger=Ts(r,this.name)}get context(){return cs(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return QQ(e);if(typeof e=="number")return eee(e);const{message:r}=be("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(r)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(zs.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:r}=be("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const r=this.expirations.get(e);if(!r){const{message:n}=be("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.warn(n),new Error(n)}return r}checkExpiry(e,r){const{expiry:n}=r;X.toMiliseconds(n)-Date.now()<=0&&this.expire(e,r)}expire(e,r){this.expirations.delete(e),this.events.emit(zs.expired,{target:e,expiration:r})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,r)=>this.checkExpiry(r,e))}registerEventListeners(){this.core.heartbeat.on(Zc.pulse,()=>this.checkExpirations()),this.events.on(zs.created,e=>{const r=zs.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(zs.expired,e=>{const r=zs.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(zs.deleted,e=>{const r=zs.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=be("NOT_INITIALIZED",this.name);throw new Error(e)}}}var Nae=Object.defineProperty,Oae=(t,e,r)=>e in t?Nae(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,br=(t,e,r)=>Oae(t,typeof e!="symbol"?e+"":e,r);class kae extends TZ{constructor(e,r,n){super(e,r,n),this.core=e,this.logger=r,this.store=n,br(this,"name",kse),br(this,"abortController"),br(this,"isDevEnv"),br(this,"verifyUrlV3",Rse),br(this,"storagePrefix",Ki),br(this,"version",R5),br(this,"publicKey"),br(this,"fetchPromise"),br(this,"init",async()=>{var s;this.isDevEnv||(this.publicKey=await this.store.getItem(this.storeKey),this.publicKey&&X.toMiliseconds((s=this.publicKey)==null?void 0:s.expiresAt)<Date.now()&&(this.logger.debug("verify v2 public key expired"),await this.removePublicKey()))}),br(this,"register",async s=>{if(!mu()||this.isDevEnv)return;const i=window.location.origin,{id:o,decryptedId:a}=s,c=`${this.verifyUrlV3}/attestation?projectId=${this.core.projectId}&origin=${i}&id=${o}&decryptedId=${a}`;try{const l=Xr.getDocument(),u=this.startAbortTimer(X.ONE_SECOND*5),d=await new Promise((h,p)=>{const y=()=>{window.removeEventListener("message",w),l.body.removeChild(g),p("attestation aborted")};this.abortController.signal.addEventListener("abort",y);const g=l.createElement("iframe");g.src=c,g.style.display="none",g.addEventListener("error",y,{signal:this.abortController.signal});const w=S=>{if(S.data&&typeof S.data=="string")try{const A=JSON.parse(S.data);if(A.type==="verify_attestation"){if(Xl(A.attestation).payload.id!==o)return;clearInterval(u),l.body.removeChild(g),this.abortController.signal.removeEventListener("abort",y),window.removeEventListener("message",w),h(A.attestation===null?"":A.attestation)}}catch(A){this.logger.warn(A)}};l.body.appendChild(g),window.addEventListener("message",w,{signal:this.abortController.signal})});return this.logger.debug(d,"jwt attestation"),d}catch(l){this.logger.warn(l)}return""}),br(this,"resolve",async s=>{if(this.isDevEnv)return"";const{attestationId:i,hash:o,encryptedId:a}=s;if(i===""){this.logger.debug("resolve: attestationId is empty, skipping");return}if(i){if(Xl(i).payload.id!==a)return;const l=await this.isValidJwtAttestation(i);if(l){if(!l.isVerified){this.logger.warn("resolve: jwt attestation: origin url not verified");return}return l}}if(!o)return;const c=this.getVerifyUrl(s?.verifyUrl);return this.fetchAttestation(o,c)}),br(this,"fetchAttestation",async(s,i)=>{this.logger.debug(`resolving attestation: ${s} from url: ${i}`);const o=this.startAbortTimer(X.ONE_SECOND*5),a=await fetch(`${i}/attestation/${s}?v2Supported=true`,{signal:this.abortController.signal});return clearTimeout(o),a.status===200?await a.json():void 0}),br(this,"getVerifyUrl",s=>{let i=s||xd;return Dse.includes(i)||(this.logger.info(`verify url: ${i}, not included in trusted list, assigning default: ${xd}`),i=xd),i}),br(this,"fetchPublicKey",async()=>{try{this.logger.debug(`fetching public key from: ${this.verifyUrlV3}`);const s=this.startAbortTimer(X.FIVE_SECONDS),i=await fetch(`${this.verifyUrlV3}/public-key`,{signal:this.abortController.signal});return clearTimeout(s),await i.json()}catch(s){this.logger.warn(s)}}),br(this,"persistPublicKey",async s=>{this.logger.debug(s,"persisting public key to local storage"),await this.store.setItem(this.storeKey,s),this.publicKey=s}),br(this,"removePublicKey",async()=>{this.logger.debug("removing verify v2 public key from storage"),await this.store.removeItem(this.storeKey),this.publicKey=void 0}),br(this,"isValidJwtAttestation",async s=>{const i=await this.getPublicKey();try{if(i)return this.validateAttestation(s,i)}catch(a){this.logger.error(a),this.logger.warn("error validating attestation")}const o=await this.fetchAndPersistPublicKey();try{if(o)return this.validateAttestation(s,o)}catch(a){this.logger.error(a),this.logger.warn("error validating attestation")}}),br(this,"getPublicKey",async()=>this.publicKey?this.publicKey:await this.fetchAndPersistPublicKey()),br(this,"fetchAndPersistPublicKey",async()=>{if(this.fetchPromise)return await this.fetchPromise,this.publicKey;this.fetchPromise=new Promise(async i=>{const o=await this.fetchPublicKey();o&&(await this.persistPublicKey(o),i(o))});const s=await this.fetchPromise;return this.fetchPromise=void 0,s}),br(this,"validateAttestation",(s,i)=>{const o=Gre(s,i.publicKey),a={hasExpired:X.toMiliseconds(o.exp)<Date.now(),payload:o};if(a.hasExpired)throw this.logger.warn("resolve: jwt attestation expired"),new Error("JWT attestation expired");return{origin:a.payload.origin,isScam:a.payload.isScam,isVerified:a.payload.isVerified}}),this.logger=Ts(r,this.name),this.abortController=new AbortController,this.isDevEnv=wv(),this.init()}get storeKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//verify:public:key"}get context(){return cs(this.logger)}startAbortTimer(e){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),X.toMiliseconds(e))}}var Pae=Object.defineProperty,Rae=(t,e,r)=>e in t?Pae(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,BA=(t,e,r)=>Rae(t,typeof e!="symbol"?e+"":e,r);class Dae extends NZ{constructor(e,r){super(e,r),this.projectId=e,this.logger=r,BA(this,"context",Use),BA(this,"registerDeviceToken",async n=>{const{clientId:s,token:i,notificationType:o,enableEncrypted:a=!1}=n,c=`${Bse}/${this.projectId}/clients`;await fetch(c,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:s,type:o,token:i,always_raw:a})})}),this.logger=Ts(r,this.context)}}var Uae=Object.defineProperty,LA=Object.getOwnPropertySymbols,Bae=Object.prototype.hasOwnProperty,Lae=Object.prototype.propertyIsEnumerable,Fb=(t,e,r)=>e in t?Uae(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ed=(t,e)=>{for(var r in e||(e={}))Bae.call(e,r)&&Fb(t,r,e[r]);if(LA)for(var r of LA(e))Lae.call(e,r)&&Fb(t,r,e[r]);return t},qr=(t,e,r)=>Fb(t,typeof e!="symbol"?e+"":e,r);class Mae extends OZ{constructor(e,r,n=!0){super(e,r,n),this.core=e,this.logger=r,qr(this,"context",Mse),qr(this,"storagePrefix",Ki),qr(this,"storageVersion",Lse),qr(this,"events",new Map),qr(this,"shouldPersist",!1),qr(this,"init",async()=>{if(!wv())try{const s={eventId:SS(),timestamp:Date.now(),domain:this.getAppDomain(),props:{event:"INIT",type:"",properties:{client_id:await this.core.crypto.getClientId(),user_agent:OO(this.core.relayer.protocol,this.core.relayer.version,Pb)}}};await this.sendEvent([s])}catch(s){this.logger.warn(s)}}),qr(this,"createEvent",s=>{const{event:i="ERROR",type:o="",properties:{topic:a,trace:c}}=s,l=SS(),u=this.core.projectId||"",d=Date.now(),h=ed({eventId:l,timestamp:d,props:{event:i,type:o,properties:{topic:a,trace:c}},bundleId:u,domain:this.getAppDomain()},this.setMethods(l));return this.telemetryEnabled&&(this.events.set(l,h),this.shouldPersist=!0),h}),qr(this,"getEvent",s=>{const{eventId:i,topic:o}=s;if(i)return this.events.get(i);const a=Array.from(this.events.values()).find(c=>c.props.properties.topic===o);if(a)return ed(ed({},a),this.setMethods(a.eventId))}),qr(this,"deleteEvent",s=>{const{eventId:i}=s;this.events.delete(i),this.shouldPersist=!0}),qr(this,"setEventListeners",()=>{this.core.heartbeat.on(Zc.pulse,async()=>{this.shouldPersist&&await this.persist(),this.events.forEach(s=>{X.fromMiliseconds(Date.now())-X.fromMiliseconds(s.timestamp)>jse&&(this.events.delete(s.eventId),this.shouldPersist=!0)})})}),qr(this,"setMethods",s=>({addTrace:i=>this.addTrace(s,i),setError:i=>this.setError(s,i)})),qr(this,"addTrace",(s,i)=>{const o=this.events.get(s);o&&(o.props.properties.trace.push(i),this.events.set(s,o),this.shouldPersist=!0)}),qr(this,"setError",(s,i)=>{const o=this.events.get(s);o&&(o.props.type=i,o.timestamp=Date.now(),this.events.set(s,o),this.shouldPersist=!0)}),qr(this,"persist",async()=>{await this.core.storage.setItem(this.storageKey,Array.from(this.events.values())),this.shouldPersist=!1}),qr(this,"restore",async()=>{try{const s=await this.core.storage.getItem(this.storageKey)||[];if(!s.length)return;s.forEach(i=>{this.events.set(i.eventId,ed(ed({},i),this.setMethods(i.eventId)))})}catch(s){this.logger.warn(s)}}),qr(this,"submit",async()=>{if(!this.telemetryEnabled||this.events.size===0)return;const s=[];for(const[i,o]of this.events)o.props.type&&s.push(o);if(s.length!==0)try{if((await this.sendEvent(s)).ok)for(const i of s)this.events.delete(i.eventId),this.shouldPersist=!0}catch(i){this.logger.warn(i)}}),qr(this,"sendEvent",async s=>{const i=this.getAppDomain()?"":"&sp=desktop";return await fetch(`${Fse}?projectId=${this.core.projectId}&st=events_sdk&sv=js-${Pb}${i}`,{method:"POST",body:JSON.stringify(s)})}),qr(this,"getAppDomain",()=>NO().url),this.logger=Ts(r,this.context),this.telemetryEnabled=n,n?this.restore().then(async()=>{await this.submit(),this.setEventListeners()}):this.persist()}get storageKey(){return this.storagePrefix+this.storageVersion+this.core.customStoragePrefix+"//"+this.context}}var jae=Object.defineProperty,MA=Object.getOwnPropertySymbols,Fae=Object.prototype.hasOwnProperty,qae=Object.prototype.propertyIsEnumerable,qb=(t,e,r)=>e in t?jae(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,jA=(t,e)=>{for(var r in e||(e={}))Fae.call(e,r)&&qb(t,r,e[r]);if(MA)for(var r of MA(e))qae.call(e,r)&&qb(t,r,e[r]);return t},Wt=(t,e,r)=>qb(t,typeof e!="symbol"?e+"":e,r);let zae=class Y5 extends wZ{constructor(e){var r;super(e),Wt(this,"protocol",P5),Wt(this,"version",R5),Wt(this,"name",kb),Wt(this,"relayUrl"),Wt(this,"projectId"),Wt(this,"customStoragePrefix"),Wt(this,"events",new dr.EventEmitter),Wt(this,"logger"),Wt(this,"heartbeat"),Wt(this,"relayer"),Wt(this,"crypto"),Wt(this,"storage"),Wt(this,"history"),Wt(this,"expirer"),Wt(this,"pairing"),Wt(this,"verify"),Wt(this,"echoClient"),Wt(this,"linkModeSupportedApps"),Wt(this,"eventClient"),Wt(this,"initialized",!1),Wt(this,"logChunkController"),Wt(this,"on",(a,c)=>this.events.on(a,c)),Wt(this,"once",(a,c)=>this.events.once(a,c)),Wt(this,"off",(a,c)=>this.events.off(a,c)),Wt(this,"removeListener",(a,c)=>this.events.removeListener(a,c)),Wt(this,"dispatchEnvelope",({topic:a,message:c,sessionExists:l})=>{if(!a||!c)return;const u={topic:a,message:c,publishedAt:Date.now(),transportType:Gt.link_mode};this.relayer.onLinkMessageEvent(u,{sessionExists:l})});const n=this.getGlobalCore(e?.customStoragePrefix);if(n)try{return this.customStoragePrefix=n.customStoragePrefix,this.logger=n.logger,this.heartbeat=n.heartbeat,this.crypto=n.crypto,this.history=n.history,this.expirer=n.expirer,this.storage=n.storage,this.relayer=n.relayer,this.pairing=n.pairing,this.verify=n.verify,this.echoClient=n.echoClient,this.linkModeSupportedApps=n.linkModeSupportedApps,this.eventClient=n.eventClient,this.initialized=n.initialized,this.logChunkController=n.logChunkController,n}catch(a){console.warn("Failed to copy global core",a)}this.projectId=e?.projectId,this.relayUrl=e?.relayUrl||U5,this.customStoragePrefix=e!=null&&e.customStoragePrefix?`:${e.customStoragePrefix}`:"";const s=dZ({level:typeof e?.logger=="string"&&e.logger?e.logger:cse.logger,name:kb}),{logger:i,chunkLoggerController:o}=GN({opts:s,maxSizeInBytes:e?.maxLogBlobSizeInBytes,loggerOverride:e?.logger});this.logChunkController=o,(r=this.logChunkController)!=null&&r.downloadLogsBlobInBrowser&&(window.downloadLogsBlobInBrowser=async()=>{var a,c;(a=this.logChunkController)!=null&&a.downloadLogsBlobInBrowser&&((c=this.logChunkController)==null||c.downloadLogsBlobInBrowser({clientId:await this.crypto.getClientId()}))}),this.logger=Ts(i,this.name),this.heartbeat=new HX,this.crypto=new yoe(this,this.logger,e?.keychain),this.history=new Iae(this,this.logger),this.expirer=new Tae(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new s3(jA(jA({},lse),e?.storageOptions)),this.relayer=new zoe({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new xae(this,this.logger),this.verify=new kae(this,this.logger,this.storage),this.echoClient=new Dae(this.projectId||"",this.logger),this.linkModeSupportedApps=[],this.eventClient=new Mae(this,this.logger,e?.telemetryEnabled),this.setGlobalCore(this)}static async init(e){const r=new Y5(e);await r.initialize();const n=await r.crypto.getClientId();return await r.storage.setItem(xse,n),r}get context(){return cs(this.logger)}async start(){this.initialized||await this.initialize()}async getLogsBlob(){var e;return(e=this.logChunkController)==null?void 0:e.logsToBlob({clientId:await this.crypto.getClientId()})}async addLinkModeSupportedApp(e){this.linkModeSupportedApps.includes(e)||(this.linkModeSupportedApps.push(e),await this.storage.setItem(wA,this.linkModeSupportedApps))}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.linkModeSupportedApps=await this.storage.getItem(wA)||[],this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(e,`Core Initialization Failure at epoch ${Date.now()}`),this.logger.error(e.message),e}}getGlobalCore(e=""){try{if(this.isGlobalCoreDisabled())return;const r=`_walletConnectCore_${e}`,n=`${r}_count`;return globalThis[n]=(globalThis[n]||0)+1,globalThis[n]>1&&console.warn(`WalletConnect Core is already initialized. This is probably a mistake and can lead to unexpected behavior. Init() was called ${globalThis[n]} times.`),globalThis[r]}catch(r){console.warn("Failed to get global WalletConnect core",r);return}}setGlobalCore(e){var r;try{if(this.isGlobalCoreDisabled())return;const n=`_walletConnectCore_${((r=e.opts)==null?void 0:r.customStoragePrefix)||""}`;globalThis[n]=e}catch(n){console.warn("Failed to set global WalletConnect core",n)}}isGlobalCoreDisabled(){try{return typeof process<"u"&&ase.DISABLE_GLOBAL_CORE==="true"}catch{return!0}}};const Hae=zae,X5="wc",Z5=2,J5="client",kv=`${X5}@${Z5}:${J5}:`,kw={name:J5,logger:"error"},FA="WALLETCONNECT_DEEPLINK_CHOICE",Wae="proposal",qA="Proposal expired",Vae="session",_l=X.SEVEN_DAYS,Kae="engine",nn={wc_sessionPropose:{req:{ttl:X.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:X.FIVE_MINUTES,prompt:!1,tag:1101},reject:{ttl:X.FIVE_MINUTES,prompt:!1,tag:1120},autoReject:{ttl:X.FIVE_MINUTES,prompt:!1,tag:1121}},wc_sessionSettle:{req:{ttl:X.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:X.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:X.ONE_DAY,prompt:!1,tag:1104},res:{ttl:X.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:X.ONE_DAY,prompt:!1,tag:1106},res:{ttl:X.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:X.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:X.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:X.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:X.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:X.ONE_DAY,prompt:!1,tag:1112},res:{ttl:X.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:X.ONE_DAY,prompt:!1,tag:1114},res:{ttl:X.ONE_DAY,prompt:!1,tag:1115}},wc_sessionAuthenticate:{req:{ttl:X.ONE_HOUR,prompt:!0,tag:1116},res:{ttl:X.ONE_HOUR,prompt:!1,tag:1117},reject:{ttl:X.FIVE_MINUTES,prompt:!1,tag:1118},autoReject:{ttl:X.FIVE_MINUTES,prompt:!1,tag:1119}}},Pw={min:X.FIVE_MINUTES,max:X.SEVEN_DAYS},Ni={idle:"IDLE",active:"ACTIVE"},Gae={eth_sendTransaction:{key:""},eth_sendRawTransaction:{key:""},wallet_sendCalls:{key:""},solana_signTransaction:{key:"signature"},solana_signAllTransactions:{key:"transactions"},solana_signAndSendTransaction:{key:"signature"},sui_signAndExecuteTransaction:{key:"digest"},sui_signTransaction:{key:""},hedera_signAndExecuteTransaction:{key:"transactionId"},hedera_executeTransaction:{key:"transactionId"},near_signTransaction:{key:""},near_signTransactions:{key:""},tron_signTransaction:{key:"txID"},xrpl_signTransaction:{key:""},xrpl_signTransactionFor:{key:""},algo_signTxn:{key:""},sendTransfer:{key:"txid"},stacks_stxTransfer:{key:"txId"},polkadot_signTransaction:{key:""},cosmos_signDirect:{key:""}},Yae="request",Xae=["wc_sessionPropose","wc_sessionRequest","wc_authRequest","wc_sessionAuthenticate"],Zae="wc",Jae="auth",Qae="authKeys",ece="pairingTopics",tce="requests",Ey=`${Zae}@${1.5}:${Jae}:`,vp=`${Ey}:PUB_KEY`;var rce=Object.defineProperty,nce=Object.defineProperties,sce=Object.getOwnPropertyDescriptors,zA=Object.getOwnPropertySymbols,ice=Object.prototype.hasOwnProperty,oce=Object.prototype.propertyIsEnumerable,zb=(t,e,r)=>e in t?rce(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Dt=(t,e)=>{for(var r in e||(e={}))ice.call(e,r)&&zb(t,r,e[r]);if(zA)for(var r of zA(e))oce.call(e,r)&&zb(t,r,e[r]);return t},An=(t,e)=>nce(t,sce(e)),ue=(t,e,r)=>zb(t,typeof e!="symbol"?e+"":e,r);class ace extends DZ{constructor(e){super(e),ue(this,"name",Kae),ue(this,"events",new $h),ue(this,"initialized",!1),ue(this,"requestQueue",{state:Ni.idle,queue:[]}),ue(this,"sessionRequestQueue",{state:Ni.idle,queue:[]}),ue(this,"emittedSessionRequests",new lee({limit:500})),ue(this,"requestQueueDelay",X.ONE_SECOND),ue(this,"expectedPairingMethodMap",new Map),ue(this,"recentlyDeletedMap",new Map),ue(this,"recentlyDeletedLimit",200),ue(this,"relayMessageCache",[]),ue(this,"pendingSessions",new Map),ue(this,"init",async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),await this.registerLinkModeListeners(),this.client.core.pairing.register({methods:Object.keys(nn)}),this.initialized=!0,setTimeout(async()=>{await this.processPendingMessageEvents(),this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},X.toMiliseconds(this.requestQueueDelay)))}),ue(this,"connect",async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();const n=An(Dt({},r),{requiredNamespaces:r.requiredNamespaces||{},optionalNamespaces:r.optionalNamespaces||{}});await this.isValidConnect(n),n.optionalNamespaces=yne(n.requiredNamespaces,n.optionalNamespaces),n.requiredNamespaces={};const{pairingTopic:s,requiredNamespaces:i,optionalNamespaces:o,sessionProperties:a,scopedProperties:c,relays:l}=n;let u=s,d,h=!1;try{if(u){const O=this.client.core.pairing.pairings.get(u);this.client.logger.warn("connect() with existing pairing topic is deprecated and will be removed in the next major release."),h=O.active}}catch(O){throw this.client.logger.error(`connect() -> pairing.get(${u}) failed`),O}if(!u||!h){const{topic:O,uri:L}=await this.client.core.pairing.create({internal:{skipSubscribe:!0}});u=O,d=L}if(!u){const{message:O}=be("NO_MATCHING_KEY",`connect() pairing topic: ${u}`);throw new Error(O)}const p=await this.client.core.crypto.generateKeyPair(),y=nn.wc_sessionPropose.req.ttl||X.FIVE_MINUTES,g=vr(y),w=An(Dt(Dt({requiredNamespaces:i,optionalNamespaces:o,relays:l??[{protocol:D5}],proposer:{publicKey:p,metadata:this.client.metadata},expiryTimestamp:g,pairingTopic:u},a&&{sessionProperties:a}),c&&{scopedProperties:c}),{id:Vr()}),S=kt("session_connect",w.id),{reject:A,resolve:E,done:v}=rc(y,qA),C=({id:O})=>{O===w.id&&(this.client.events.off("proposal_expire",C),this.pendingSessions.delete(w.id),this.events.emit(S,{error:{message:qA,code:0}}))};return this.client.events.on("proposal_expire",C),this.events.once(S,({error:O,session:L})=>{this.client.events.off("proposal_expire",C),O?A(O):L&&E(L)}),await this.sendProposeSession({proposal:w,publishOpts:{internal:{throwOnFailedPublish:!0},tvf:{correlationId:w.id}}}),await this.setProposal(w.id,w),{uri:d,approval:v}}),ue(this,"pair",async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{return await this.client.core.pairing.pair(r)}catch(n){throw this.client.logger.error("pair() failed"),n}}),ue(this,"approve",async r=>{var n,s,i;const o=this.client.core.eventClient.createEvent({properties:{topic:(n=r?.id)==null?void 0:n.toString(),trace:[si.session_approve_started]}});try{this.isInitialized(),await this.confirmOnlineStateOrThrow()}catch(D){throw o.setError(Ya.no_internet_connection),D}try{await this.isValidProposalId(r?.id)}catch(D){throw this.client.logger.error(`approve() -> proposal.get(${r?.id}) failed`),o.setError(Ya.proposal_not_found),D}try{await this.isValidApprove(r)}catch(D){throw this.client.logger.error("approve() -> isValidApprove() failed"),o.setError(Ya.session_approve_namespace_validation_failure),D}const{id:a,relayProtocol:c,namespaces:l,sessionProperties:u,scopedProperties:d,sessionConfig:h}=r,p=this.client.proposal.get(a);this.client.core.eventClient.deleteEvent({eventId:o.eventId});const{pairingTopic:y,proposer:g,requiredNamespaces:w,optionalNamespaces:S}=p;let A=(s=this.client.core.eventClient)==null?void 0:s.getEvent({topic:y});A||(A=(i=this.client.core.eventClient)==null?void 0:i.createEvent({type:si.session_approve_started,properties:{topic:y,trace:[si.session_approve_started,si.session_namespaces_validation_success]}}));const E=await this.client.core.crypto.generateKeyPair(),v=g.publicKey,C=await this.client.core.crypto.generateSharedKey(E,v),O=Dt(Dt(Dt({relay:{protocol:c??"irn"},namespaces:l,controller:{publicKey:E,metadata:this.client.metadata},expiry:vr(_l)},u&&{sessionProperties:u}),d&&{scopedProperties:d}),h&&{sessionConfig:h}),L=Gt.relay;A.addTrace(si.subscribing_session_topic);try{await this.client.core.relayer.subscribe(C,{transportType:L,internal:{skipSubscribe:!0}})}catch(D){throw A.setError(Ya.subscribe_session_topic_failure),D}A.addTrace(si.subscribe_session_topic_success);const j=An(Dt({},O),{topic:C,requiredNamespaces:w,optionalNamespaces:S,pairingTopic:y,acknowledged:!1,self:O.controller,peer:{publicKey:g.publicKey,metadata:g.metadata},controller:E,transportType:Gt.relay});await this.client.session.set(C,j),A.addTrace(si.store_session);try{await this.sendApproveSession({sessionTopic:C,proposal:p,pairingProposalResponse:{relay:{protocol:c??"irn"},responderPublicKey:E},sessionSettleRequest:O,publishOpts:{internal:{throwOnFailedPublish:!0},tvf:{correlationId:a}}}),A.addTrace(si.session_approve_publish_success)}catch(D){throw this.client.logger.error(D),this.client.session.delete(C,er("USER_DISCONNECTED")),await this.client.core.relayer.unsubscribe(C),D}return this.client.core.eventClient.deleteEvent({eventId:A.eventId}),await this.client.core.pairing.updateMetadata({topic:y,metadata:g.metadata}),await this.deleteProposal(a),await this.client.core.pairing.activate({topic:y}),await this.setExpiry(C,vr(_l)),{topic:C,acknowledged:()=>Promise.resolve(this.client.session.get(C))}}),ue(this,"reject",async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidReject(r)}catch(o){throw this.client.logger.error("reject() -> isValidReject() failed"),o}const{id:n,reason:s}=r;let i;try{i=this.client.proposal.get(n).pairingTopic}catch(o){throw this.client.logger.error(`reject() -> proposal.get(${n}) failed`),o}i&&await this.sendError({id:n,topic:i,error:s,rpcOpts:nn.wc_sessionPropose.reject}),await this.deleteProposal(n)}),ue(this,"update",async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidUpdate(r)}catch(d){throw this.client.logger.error("update() -> isValidUpdate() failed"),d}const{topic:n,namespaces:s}=r,{done:i,resolve:o,reject:a}=rc(),c=Vr(),l=Tn().toString(),u=this.client.session.get(n).namespaces;return this.events.once(kt("session_update",c),({error:d})=>{d?a(d):o()}),await this.client.session.update(n,{namespaces:s}),await this.sendRequest({topic:n,method:"wc_sessionUpdate",params:{namespaces:s},throwOnFailedPublish:!0,clientRpcId:c,relayRpcId:l}).catch(d=>{this.client.logger.error(d),this.client.session.update(n,{namespaces:u}),a(d)}),{acknowledged:i}}),ue(this,"extend",async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidExtend(r)}catch(c){throw this.client.logger.error("extend() -> isValidExtend() failed"),c}const{topic:n}=r,s=Vr(),{done:i,resolve:o,reject:a}=rc();return this.events.once(kt("session_extend",s),({error:c})=>{c?a(c):o()}),await this.setExpiry(n,vr(_l)),this.sendRequest({topic:n,method:"wc_sessionExtend",params:{},clientRpcId:s,throwOnFailedPublish:!0}).catch(c=>{a(c)}),{acknowledged:i}}),ue(this,"request",async r=>{this.isInitialized();try{await this.isValidRequest(r)}catch(w){throw this.client.logger.error("request() -> isValidRequest() failed"),w}const{chainId:n,request:s,topic:i,expiry:o=nn.wc_sessionRequest.req.ttl}=r,a=this.client.session.get(i);a?.transportType===Gt.relay&&await this.confirmOnlineStateOrThrow();const c=Vr(),l=Tn().toString(),{done:u,resolve:d,reject:h}=rc(o,"Request expired. Please try again.");this.events.once(kt("session_request",c),({error:w,result:S})=>{w?h(w):d(S)});const p="wc_sessionRequest",y=this.getAppLinkIfEnabled(a.peer.metadata,a.transportType);if(y)return await this.sendRequest({clientRpcId:c,relayRpcId:l,topic:i,method:p,params:{request:An(Dt({},s),{expiryTimestamp:vr(o)}),chainId:n},expiry:o,throwOnFailedPublish:!0,appLink:y}).catch(w=>h(w)),this.client.events.emit("session_request_sent",{topic:i,request:s,chainId:n,id:c}),await u();const g={request:An(Dt({},s),{expiryTimestamp:vr(o)}),chainId:n};return await Promise.all([new Promise(async w=>{await this.sendRequest({clientRpcId:c,relayRpcId:l,topic:i,method:p,params:g,expiry:o,throwOnFailedPublish:!0,tvf:this.getTVFParams(c,g)}).catch(S=>h(S)),this.client.events.emit("session_request_sent",{topic:i,request:s,chainId:n,id:c}),w()}),new Promise(async w=>{var S;if(!((S=a.sessionConfig)!=null&&S.disableDeepLink)){const A=await see(this.client.core.storage,FA);await tee({id:c,topic:i,wcDeepLink:A})}w()}),u()]).then(w=>w[2])}),ue(this,"respond",async r=>{var n,s;this.isInitialized();const i=this.client.core.eventClient.createEvent({properties:{topic:r?.topic||((s=(n=r?.response)==null?void 0:n.id)==null?void 0:s.toString()),trace:[si.session_request_response_started]}});try{await this.isValidRespond(r)}catch(d){throw i.addTrace(d?.message),i.setError(Ya.session_request_response_validation_failure),d}i.addTrace(si.session_request_response_validation_success);const{topic:o,response:a}=r,{id:c}=a,l=this.client.session.get(o);l.transportType===Gt.relay&&await this.confirmOnlineStateOrThrow();const u=this.getAppLinkIfEnabled(l.peer.metadata,l.transportType);try{i.addTrace(si.session_request_response_publish_started),Rr(a)?await this.sendResult({id:c,topic:o,result:a.result,throwOnFailedPublish:!0,appLink:u}):nr(a)&&await this.sendError({id:c,topic:o,error:a.error,appLink:u}),this.cleanupAfterResponse(r)}catch(d){throw i.addTrace(d?.message),i.setError(Ya.session_request_response_publish_failure),d}}),ue(this,"ping",async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidPing(r)}catch(s){throw this.client.logger.error("ping() -> isValidPing() failed"),s}const{topic:n}=r;if(this.client.session.keys.includes(n)){const s=Vr(),i=Tn().toString(),{done:o,resolve:a,reject:c}=rc();this.events.once(kt("session_ping",s),({error:l})=>{l?c(l):a()}),await Promise.all([this.sendRequest({topic:n,method:"wc_sessionPing",params:{},throwOnFailedPublish:!0,clientRpcId:s,relayRpcId:i}),o()])}else this.client.core.pairing.pairings.keys.includes(n)&&(this.client.logger.warn("ping() on pairing topic is deprecated and will be removed in the next major release."),await this.client.core.pairing.ping({topic:n}))}),ue(this,"emit",async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidEmit(r);const{topic:n,event:s,chainId:i}=r,o=Tn().toString(),a=Vr();await this.sendRequest({topic:n,method:"wc_sessionEvent",params:{event:s,chainId:i},throwOnFailedPublish:!0,relayRpcId:o,clientRpcId:a})}),ue(this,"disconnect",async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidDisconnect(r);const{topic:n}=r;if(this.client.session.keys.includes(n))await this.sendRequest({topic:n,method:"wc_sessionDelete",params:er("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession({topic:n,emitEvent:!1});else if(this.client.core.pairing.pairings.keys.includes(n))await this.client.core.pairing.disconnect({topic:n});else{const{message:s}=be("MISMATCHED_TOPIC",`Session or pairing topic not found: ${n}`);throw new Error(s)}}),ue(this,"find",r=>(this.isInitialized(),this.client.session.getAll().filter(n=>bne(n,r)))),ue(this,"getPendingSessionRequests",()=>this.client.pendingRequest.getAll()),ue(this,"authenticate",async(r,n)=>{var s;this.isInitialized(),this.isValidAuthenticate(r);const i=n&&this.client.core.linkModeSupportedApps.includes(n)&&((s=this.client.metadata.redirect)==null?void 0:s.linkMode),o=i?Gt.link_mode:Gt.relay;o===Gt.relay&&await this.confirmOnlineStateOrThrow();const{chains:a,statement:c="",uri:l,domain:u,nonce:d,type:h,exp:p,nbf:y,methods:g=[],expiry:w}=r,S=[...r.resources||[]],{topic:A,uri:E}=await this.client.core.pairing.create({methods:["wc_sessionAuthenticate"],transportType:o});this.client.logger.info({message:"Generated new pairing",pairing:{topic:A,uri:E}});const v=await this.client.core.crypto.generateKeyPair(),C=wp(v);if(await Promise.all([this.client.auth.authKeys.set(vp,{responseTopic:C,publicKey:v}),this.client.auth.pairingTopics.set(C,{topic:C,pairingTopic:A})]),await this.client.core.relayer.subscribe(C,{transportType:o}),this.client.logger.info(`sending request to new pairing topic: ${A}`),g.length>0){const{namespace:x}=Oo(a[0]);let N=vte(x,"request",g);mp(S)&&(N=_te(N,S.pop())),S.push(N)}const O=w&&w>nn.wc_sessionAuthenticate.req.ttl?w:nn.wc_sessionAuthenticate.req.ttl,L={authPayload:{type:h??"caip122",chains:a,statement:c,aud:l,domain:u,version:"1",nonce:d,iat:new Date().toISOString(),exp:p,nbf:y,resources:S},requester:{publicKey:v,metadata:this.client.metadata},expiryTimestamp:vr(O)},j={eip155:{chains:a,methods:[...new Set(["personal_sign",...g])],events:["chainChanged","accountsChanged"]}},D={requiredNamespaces:{},optionalNamespaces:j,relays:[{protocol:"irn"}],pairingTopic:A,proposer:{publicKey:v,metadata:this.client.metadata},expiryTimestamp:vr(nn.wc_sessionPropose.req.ttl),id:Vr()},{done:W,resolve:P,reject:R}=rc(O,"Request expired"),T=Vr(),k=kt("session_connect",D.id),f=kt("session_request",T),m=async({error:x,session:N})=>{this.events.off(f,_),x?R(x):N&&P({session:N})},_=async x=>{var N,H,z;if(await this.deletePendingAuthRequest(T,{message:"fulfilled",code:0}),x.error){const ne=er("WC_METHOD_UNSUPPORTED","wc_sessionAuthenticate");return x.error.code===ne.code?void 0:(this.events.off(k,m),R(x.error.message))}await this.deleteProposal(D.id),this.events.off(k,m);const{cacaos:G,responder:M}=x.result,V=[],J=[];for(const ne of G){await DS({cacao:ne,projectId:this.client.core.projectId})||(this.client.logger.error(ne,"Signature verification failed"),R(er("SESSION_SETTLEMENT_FAILED","Signature verification failed")));const{p:se}=ne,Ie=mp(se.resources),Me=[vb(se.iss)],Ve=yg(se.iss);if(Ie){const Ze=US(Ie),Nt=BS(Ie);V.push(...Ze),Me.push(...Nt)}for(const Ze of Me)J.push(`${Ze}:${Ve}`)}const re=await this.client.core.crypto.generateSharedKey(v,M.publicKey);let ye;V.length>0&&(ye={topic:re,acknowledged:!0,self:{publicKey:v,metadata:this.client.metadata},peer:M,controller:M.publicKey,expiry:vr(_l),requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:A,namespaces:lA([...new Set(V)],[...new Set(J)]),transportType:o},await this.client.core.relayer.subscribe(re,{transportType:o}),await this.client.session.set(re,ye),A&&await this.client.core.pairing.updateMetadata({topic:A,metadata:M.metadata}),ye=this.client.session.get(re)),(N=this.client.metadata.redirect)!=null&&N.linkMode&&(H=M.metadata.redirect)!=null&&H.linkMode&&(z=M.metadata.redirect)!=null&&z.universal&&n&&(this.client.core.addLinkModeSupportedApp(M.metadata.redirect.universal),this.client.session.update(re,{transportType:Gt.link_mode})),P({auths:G,session:ye})};this.events.once(k,m),this.events.once(f,_);let $;try{if(i){const x=Ar("wc_sessionAuthenticate",L,T);this.client.core.history.set(A,x);const N=await this.client.core.crypto.encode("",x,{type:Zh,encoding:ma});$=Hf(n,A,N)}else await Promise.all([this.sendRequest({topic:A,method:"wc_sessionAuthenticate",params:L,expiry:r.expiry,throwOnFailedPublish:!0,clientRpcId:T}),this.sendRequest({topic:A,method:"wc_sessionPropose",params:D,expiry:nn.wc_sessionPropose.req.ttl,throwOnFailedPublish:!0,clientRpcId:D.id})])}catch(x){throw this.events.off(k,m),this.events.off(f,_),x}return await this.setProposal(D.id,D),await this.setAuthRequest(T,{request:An(Dt({},L),{verifyContext:{}}),pairingTopic:A,transportType:o}),{uri:$??E,response:W}}),ue(this,"approveSessionAuthenticate",async r=>{const{id:n,auths:s}=r,i=this.client.core.eventClient.createEvent({properties:{topic:n.toString(),trace:[Xa.authenticated_session_approve_started]}});try{this.isInitialized()}catch(w){throw i.setError(Ju.no_internet_connection),w}const o=this.getPendingAuthRequest(n);if(!o)throw i.setError(Ju.authenticated_session_pending_request_not_found),new Error(`Could not find pending auth request with id ${n}`);const a=o.transportType||Gt.relay;a===Gt.relay&&await this.confirmOnlineStateOrThrow();const c=o.requester.publicKey,l=await this.client.core.crypto.generateKeyPair(),u=wp(c),d={type:ko,receiverPublicKey:c,senderPublicKey:l},h=[],p=[];for(const w of s){if(!await DS({cacao:w,projectId:this.client.core.projectId})){i.setError(Ju.invalid_cacao);const C=er("SESSION_SETTLEMENT_FAILED","Signature verification failed");throw await this.sendError({id:n,topic:u,error:C,encodeOpts:d}),new Error(C.message)}i.addTrace(Xa.cacaos_verified);const{p:S}=w,A=mp(S.resources),E=[vb(S.iss)],v=yg(S.iss);if(A){const C=US(A),O=BS(A);h.push(...C),E.push(...O)}for(const C of E)p.push(`${C}:${v}`)}const y=await this.client.core.crypto.generateSharedKey(l,c);i.addTrace(Xa.create_authenticated_session_topic);let g;if(h?.length>0){g={topic:y,acknowledged:!0,self:{publicKey:l,metadata:this.client.metadata},peer:{publicKey:c,metadata:o.requester.metadata},controller:c,expiry:vr(_l),authentication:s,requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:o.pairingTopic,namespaces:lA([...new Set(h)],[...new Set(p)]),transportType:a},i.addTrace(Xa.subscribing_authenticated_session_topic);try{await this.client.core.relayer.subscribe(y,{transportType:a})}catch(w){throw i.setError(Ju.subscribe_authenticated_session_topic_failure),w}i.addTrace(Xa.subscribe_authenticated_session_topic_success),await this.client.session.set(y,g),i.addTrace(Xa.store_authenticated_session),await this.client.core.pairing.updateMetadata({topic:o.pairingTopic,metadata:o.requester.metadata})}i.addTrace(Xa.publishing_authenticated_session_approve);try{await this.sendResult({topic:u,id:n,result:{cacaos:s,responder:{publicKey:l,metadata:this.client.metadata}},encodeOpts:d,throwOnFailedPublish:!0,appLink:this.getAppLinkIfEnabled(o.requester.metadata,a)})}catch(w){throw i.setError(Ju.authenticated_session_approve_publish_failure),w}return await this.client.auth.requests.delete(n,{message:"fulfilled",code:0}),await this.client.core.pairing.activate({topic:o.pairingTopic}),this.client.core.eventClient.deleteEvent({eventId:i.eventId}),{session:g}}),ue(this,"rejectSessionAuthenticate",async r=>{this.isInitialized();const{id:n,reason:s}=r,i=this.getPendingAuthRequest(n);if(!i)throw new Error(`Could not find pending auth request with id ${n}`);i.transportType===Gt.relay&&await this.confirmOnlineStateOrThrow();const o=i.requester.publicKey,a=await this.client.core.crypto.generateKeyPair(),c=wp(o),l={type:ko,receiverPublicKey:o,senderPublicKey:a};await this.sendError({id:n,topic:c,error:s,encodeOpts:l,rpcOpts:nn.wc_sessionAuthenticate.reject,appLink:this.getAppLinkIfEnabled(i.requester.metadata,i.transportType)}),await this.client.auth.requests.delete(n,{message:"rejected",code:0}),await this.deleteProposal(n)}),ue(this,"formatAuthMessage",r=>{this.isInitialized();const{request:n,iss:s}=r;return YO(n,s)}),ue(this,"processRelayMessageCache",()=>{setTimeout(async()=>{if(this.relayMessageCache.length!==0)for(;this.relayMessageCache.length>0;)try{const r=this.relayMessageCache.shift();r&&await this.onRelayMessage(r)}catch(r){this.client.logger.error(r)}},50)}),ue(this,"cleanupDuplicatePairings",async r=>{if(r.pairingTopic)try{const n=this.client.core.pairing.pairings.get(r.pairingTopic),s=this.client.core.pairing.pairings.getAll().filter(i=>{var o,a;return((o=i.peerMetadata)==null?void 0:o.url)&&((a=i.peerMetadata)==null?void 0:a.url)===r.peer.metadata.url&&i.topic&&i.topic!==n.topic});if(s.length===0)return;this.client.logger.info(`Cleaning up ${s.length} duplicate pairing(s)`),await Promise.all(s.map(i=>this.client.core.pairing.disconnect({topic:i.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(n){this.client.logger.error(n)}}),ue(this,"deleteSession",async r=>{var n;const{topic:s,expirerHasDeleted:i=!1,emitEvent:o=!0,id:a=0}=r,{self:c}=this.client.session.get(s);await this.client.core.relayer.unsubscribe(s),await this.client.session.delete(s,er("USER_DISCONNECTED")),this.addToRecentlyDeleted(s,"session"),this.client.core.crypto.keychain.has(c.publicKey)&&await this.client.core.crypto.deleteKeyPair(c.publicKey),this.client.core.crypto.keychain.has(s)&&await this.client.core.crypto.deleteSymKey(s),i||this.client.core.expirer.del(s),this.client.core.storage.removeItem(FA).catch(l=>this.client.logger.warn(l)),this.getPendingSessionRequests().forEach(l=>{l.topic===s&&this.deletePendingSessionRequest(l.id,er("USER_DISCONNECTED"))}),s===((n=this.sessionRequestQueue.queue[0])==null?void 0:n.topic)&&(this.sessionRequestQueue.state=Ni.idle),o&&this.client.events.emit("session_delete",{id:a,topic:s})}),ue(this,"deleteProposal",async(r,n)=>{if(n)try{const s=this.client.proposal.get(r);this.client.core.eventClient.getEvent({topic:s.pairingTopic})?.setError(Ya.proposal_expired)}catch{}await Promise.all([this.client.proposal.delete(r,er("USER_DISCONNECTED")),n?Promise.resolve():this.client.core.expirer.del(r)]),this.addToRecentlyDeleted(r,"proposal")}),ue(this,"deletePendingSessionRequest",async(r,n,s=!1)=>{await Promise.all([this.client.pendingRequest.delete(r,n),s?Promise.resolve():this.client.core.expirer.del(r)]),this.addToRecentlyDeleted(r,"request"),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(i=>i.id!==r),s&&(this.sessionRequestQueue.state=Ni.idle,this.client.events.emit("session_request_expire",{id:r}))}),ue(this,"deletePendingAuthRequest",async(r,n,s=!1)=>{await Promise.all([this.client.auth.requests.delete(r,n),s?Promise.resolve():this.client.core.expirer.del(r)])}),ue(this,"setExpiry",async(r,n)=>{this.client.session.keys.includes(r)&&(this.client.core.expirer.set(r,n),await this.client.session.update(r,{expiry:n}))}),ue(this,"setProposal",async(r,n)=>{this.client.core.expirer.set(r,vr(nn.wc_sessionPropose.req.ttl)),await this.client.proposal.set(r,n)}),ue(this,"setAuthRequest",async(r,n)=>{const{request:s,pairingTopic:i,transportType:o=Gt.relay}=n;this.client.core.expirer.set(r,s.expiryTimestamp),await this.client.auth.requests.set(r,{authPayload:s.authPayload,requester:s.requester,expiryTimestamp:s.expiryTimestamp,id:r,pairingTopic:i,verifyContext:s.verifyContext,transportType:o})}),ue(this,"setPendingSessionRequest",async r=>{const{id:n,topic:s,params:i,verifyContext:o}=r,a=i.request.expiryTimestamp||vr(nn.wc_sessionRequest.req.ttl);this.client.core.expirer.set(n,a),await this.client.pendingRequest.set(n,{id:n,topic:s,params:i,verifyContext:o})}),ue(this,"sendRequest",async r=>{const{topic:n,method:s,params:i,expiry:o,relayRpcId:a,clientRpcId:c,throwOnFailedPublish:l,appLink:u,tvf:d,publishOpts:h={}}=r,p=Ar(s,i,c);let y;const g=!!u;try{const A=g?ma:Qn;y=await this.client.core.crypto.encode(n,p,{encoding:A})}catch(A){throw await this.cleanup(),this.client.logger.error(`sendRequest() -> core.crypto.encode() for topic ${n} failed`),A}let w;if(Xae.includes(s)){const A=Ks(JSON.stringify(p)),E=Ks(y);w=await this.client.core.verify.register({id:E,decryptedId:A})}const S=Dt(Dt({},nn[s].req),h);if(S.attestation=w,o&&(S.ttl=o),a&&(S.id=a),this.client.core.history.set(n,p),g){const A=Hf(u,n,y);await global.Linking.openURL(A,this.client.name)}else S.tvf=An(Dt({},d),{correlationId:p.id}),l?(S.internal=An(Dt({},S.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(n,y,S)):this.client.core.relayer.publish(n,y,S).catch(A=>this.client.logger.error(A));return p.id}),ue(this,"sendProposeSession",async r=>{const{proposal:n,publishOpts:s}=r,i=Ar("wc_sessionPropose",n,n.id);this.client.core.history.set(n.pairingTopic,i);const o=await this.client.core.crypto.encode(n.pairingTopic,i,{encoding:Qn}),a=Ks(JSON.stringify(i)),c=Ks(o),l=await this.client.core.verify.register({id:c,decryptedId:a});await this.client.core.relayer.publishCustom({payload:{pairingTopic:n.pairingTopic,sessionProposal:o},opts:An(Dt({},s),{publishMethod:"wc_proposeSession",attestation:l})})}),ue(this,"sendApproveSession",async r=>{const{sessionTopic:n,pairingProposalResponse:s,proposal:i,sessionSettleRequest:o,publishOpts:a}=r,c=Do(i.id,s),l=await this.client.core.crypto.encode(i.pairingTopic,c,{encoding:Qn}),u=Ar("wc_sessionSettle",o,a?.id),d=await this.client.core.crypto.encode(n,u,{encoding:Qn});this.client.core.history.set(n,u),await this.client.core.relayer.publishCustom({payload:{sessionTopic:n,pairingTopic:i.pairingTopic,sessionProposalResponse:l,sessionSettlementRequest:d},opts:An(Dt({},a),{publishMethod:"wc_approveSession"})})}),ue(this,"sendResult",async r=>{const{id:n,topic:s,result:i,throwOnFailedPublish:o,encodeOpts:a,appLink:c}=r,l=Do(n,i);let u;const d=c&&typeof(global==null?void 0:global.Linking)<"u";try{const y=d?ma:Qn;u=await this.client.core.crypto.encode(s,l,An(Dt({},a||{}),{encoding:y}))}catch(y){throw await this.cleanup(),this.client.logger.error(`sendResult() -> core.crypto.encode() for topic ${s} failed`),y}let h,p;try{h=await this.client.core.history.get(s,n);const y=h.request;try{p=this.getTVFParams(n,y.params,i)}catch(g){this.client.logger.warn(`sendResult() -> getTVFParams() failed: ${g?.message}`)}}catch(y){throw this.client.logger.error(`sendResult() -> history.get(${s}, ${n}) failed`),y}if(d){const y=Hf(c,s,u);await global.Linking.openURL(y,this.client.name)}else{const y=h.request.method,g=nn[y].res;g.tvf=An(Dt({},p),{correlationId:n}),o?(g.internal=An(Dt({},g.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(s,u,g)):this.client.core.relayer.publish(s,u,g).catch(w=>this.client.logger.error(w))}await this.client.core.history.resolve(l)}),ue(this,"sendError",async r=>{const{id:n,topic:s,error:i,encodeOpts:o,rpcOpts:a,appLink:c}=r,l=Vc(n,i);let u;const d=c&&typeof(global==null?void 0:global.Linking)<"u";try{const p=d?ma:Qn;u=await this.client.core.crypto.encode(s,l,An(Dt({},o||{}),{encoding:p}))}catch(p){throw await this.cleanup(),this.client.logger.error(`sendError() -> core.crypto.encode() for topic ${s} failed`),p}let h;try{h=await this.client.core.history.get(s,n)}catch(p){throw this.client.logger.error(`sendError() -> history.get(${s}, ${n}) failed`),p}if(d){const p=Hf(c,s,u);await global.Linking.openURL(p,this.client.name)}else{const p=h.request.method,y=a||nn[p].res;this.client.core.relayer.publish(s,u,y)}await this.client.core.history.resolve(l)}),ue(this,"cleanup",async()=>{const r=[],n=[];this.client.session.getAll().forEach(s=>{let i=!1;Ui(s.expiry)&&(i=!0),this.client.core.crypto.keychain.has(s.topic)||(i=!0),i&&r.push(s.topic)}),this.client.proposal.getAll().forEach(s=>{Ui(s.expiryTimestamp)&&n.push(s.id)}),await Promise.all([...r.map(s=>this.deleteSession({topic:s})),...n.map(s=>this.deleteProposal(s))])}),ue(this,"onProviderMessageEvent",async r=>{!this.initialized||this.relayMessageCache.length>0?this.relayMessageCache.push(r):await this.onRelayMessage(r)}),ue(this,"onRelayEventRequest",async r=>{this.requestQueue.queue.push(r),await this.processRequestsQueue()}),ue(this,"processRequestsQueue",async()=>{if(this.requestQueue.state===Ni.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=Ni.active;const r=this.requestQueue.queue.shift();if(r)try{await this.processRequest(r)}catch(n){this.client.logger.warn(n)}}this.requestQueue.state=Ni.idle}),ue(this,"processRequest",async r=>{const{topic:n,payload:s,attestation:i,transportType:o,encryptedId:a}=r,c=s.method;if(!this.shouldIgnorePairingRequest({topic:n,requestMethod:c}))switch(c){case"wc_sessionPropose":return await this.onSessionProposeRequest({topic:n,payload:s,attestation:i,encryptedId:a});case"wc_sessionSettle":return await this.onSessionSettleRequest(n,s);case"wc_sessionUpdate":return await this.onSessionUpdateRequest(n,s);case"wc_sessionExtend":return await this.onSessionExtendRequest(n,s);case"wc_sessionPing":return await this.onSessionPingRequest(n,s);case"wc_sessionDelete":return await this.onSessionDeleteRequest(n,s);case"wc_sessionRequest":return await this.onSessionRequest({topic:n,payload:s,attestation:i,encryptedId:a,transportType:o});case"wc_sessionEvent":return await this.onSessionEventRequest(n,s);case"wc_sessionAuthenticate":return await this.onSessionAuthenticateRequest({topic:n,payload:s,attestation:i,encryptedId:a,transportType:o});default:return this.client.logger.info(`Unsupported request method ${c}`)}}),ue(this,"onRelayEventResponse",async r=>{const{topic:n,payload:s,transportType:i}=r,o=(await this.client.core.history.get(n,s.id)).request.method;switch(o){case"wc_sessionPropose":return this.onSessionProposeResponse(n,s,i);case"wc_sessionSettle":return this.onSessionSettleResponse(n,s);case"wc_sessionUpdate":return this.onSessionUpdateResponse(n,s);case"wc_sessionExtend":return this.onSessionExtendResponse(n,s);case"wc_sessionPing":return this.onSessionPingResponse(n,s);case"wc_sessionRequest":return this.onSessionRequestResponse(n,s);case"wc_sessionAuthenticate":return this.onSessionAuthenticateResponse(n,s);default:return this.client.logger.info(`Unsupported response method ${o}`)}}),ue(this,"onRelayEventUnknownPayload",r=>{const{topic:n}=r,{message:s}=be("MISSING_OR_INVALID",`Decoded payload on topic ${n} is not identifiable as a JSON-RPC request or a response.`);throw new Error(s)}),ue(this,"shouldIgnorePairingRequest",r=>{const{topic:n,requestMethod:s}=r,i=this.expectedPairingMethodMap.get(n);return!i||i.includes(s)?!1:!!(i.includes("wc_sessionAuthenticate")&&this.client.events.listenerCount("session_authenticate")>0)}),ue(this,"onSessionProposeRequest",async r=>{const{topic:n,payload:s,attestation:i,encryptedId:o}=r,{params:a,id:c}=s;try{const l=this.client.core.eventClient.getEvent({topic:n});this.client.events.listenerCount("session_proposal")===0&&(console.warn("No listener for session_proposal event"),l?.setError(lo.proposal_listener_not_found)),this.isValidConnect(Dt({},s.params));const u=a.expiryTimestamp||vr(nn.wc_sessionPropose.req.ttl),d=Dt({id:c,pairingTopic:n,expiryTimestamp:u,attestation:i,encryptedId:o},a);await this.setProposal(c,d);const h=await this.getVerifyContext({attestationId:i,hash:Ks(JSON.stringify(s)),encryptedId:o,metadata:d.proposer.metadata});l?.addTrace(ki.emit_session_proposal),this.client.events.emit("session_proposal",{id:c,params:d,verifyContext:h})}catch(l){await this.sendError({id:c,topic:n,error:l,rpcOpts:nn.wc_sessionPropose.autoReject}),this.client.logger.error(l)}}),ue(this,"onSessionProposeResponse",async(r,n,s)=>{const{id:i}=n;if(Rr(n)){const{result:o}=n;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:o});const a=this.client.proposal.get(i);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:a});const c=a.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:c});const l=o.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:l});const u=await this.client.core.crypto.generateSharedKey(c,l);this.pendingSessions.set(i,{sessionTopic:u,pairingTopic:r,proposalId:i,publicKey:c});const d=await this.client.core.relayer.subscribe(u,{transportType:s});this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:d}),await this.client.core.pairing.activate({topic:r})}else if(nr(n)){await this.deleteProposal(i);const o=kt("session_connect",i);if(this.events.listenerCount(o)===0)throw new Error(`emitting ${o} without any listeners, 954`);this.events.emit(o,{error:n.error})}}),ue(this,"onSessionSettleRequest",async(r,n)=>{const{id:s,params:i}=n;try{this.isValidSessionSettleRequest(i);const{relay:o,controller:a,expiry:c,namespaces:l,sessionProperties:u,scopedProperties:d,sessionConfig:h}=n.params,p=[...this.pendingSessions.values()].find(w=>w.sessionTopic===r);if(!p)return this.client.logger.error(`Pending session not found for topic ${r}`);const y=this.client.proposal.get(p.proposalId),g=An(Dt(Dt(Dt({topic:r,relay:o,expiry:c,namespaces:l,acknowledged:!0,pairingTopic:p.pairingTopic,requiredNamespaces:y.requiredNamespaces,optionalNamespaces:y.optionalNamespaces,controller:a.publicKey,self:{publicKey:p.publicKey,metadata:this.client.metadata},peer:{publicKey:a.publicKey,metadata:a.metadata}},u&&{sessionProperties:u}),d&&{scopedProperties:d}),h&&{sessionConfig:h}),{transportType:Gt.relay});await this.client.session.set(g.topic,g),await this.setExpiry(g.topic,g.expiry),await this.client.core.pairing.updateMetadata({topic:p.pairingTopic,metadata:g.peer.metadata}),this.client.events.emit("session_connect",{session:g}),this.events.emit(kt("session_connect",p.proposalId),{session:g}),this.pendingSessions.delete(p.proposalId),this.deleteProposal(p.proposalId,!1),this.cleanupDuplicatePairings(g),await this.sendResult({id:n.id,topic:r,result:!0})}catch(o){await this.sendError({id:s,topic:r,error:o}),this.client.logger.error(o)}}),ue(this,"onSessionSettleResponse",async(r,n)=>{const{id:s}=n;Rr(n)?(await this.client.session.update(r,{acknowledged:!0}),this.events.emit(kt("session_approve",s),{})):nr(n)&&(await this.client.session.delete(r,er("USER_DISCONNECTED")),this.events.emit(kt("session_approve",s),{error:n.error}))}),ue(this,"onSessionUpdateRequest",async(r,n)=>{const{params:s,id:i}=n;try{const o=`${r}_session_update`,a=Xu.get(o);if(a&&this.isRequestOutOfSync(a,i)){this.client.logger.warn(`Discarding out of sync request - ${i}`),this.sendError({id:i,topic:r,error:er("INVALID_UPDATE_REQUEST")});return}this.isValidUpdate(Dt({topic:r},s));try{Xu.set(o,i),await this.client.session.update(r,{namespaces:s.namespaces}),await this.sendResult({id:i,topic:r,result:!0})}catch(c){throw Xu.delete(o),c}this.client.events.emit("session_update",{id:i,topic:r,params:s})}catch(o){await this.sendError({id:i,topic:r,error:o}),this.client.logger.error(o)}}),ue(this,"isRequestOutOfSync",(r,n)=>n.toString().slice(0,-3)<r.toString().slice(0,-3)),ue(this,"onSessionUpdateResponse",(r,n)=>{const{id:s}=n,i=kt("session_update",s);if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners`);Rr(n)?this.events.emit(kt("session_update",s),{}):nr(n)&&this.events.emit(kt("session_update",s),{error:n.error})}),ue(this,"onSessionExtendRequest",async(r,n)=>{const{id:s}=n;try{this.isValidExtend({topic:r}),await this.setExpiry(r,vr(_l)),await this.sendResult({id:s,topic:r,result:!0}),this.client.events.emit("session_extend",{id:s,topic:r})}catch(i){await this.sendError({id:s,topic:r,error:i}),this.client.logger.error(i)}}),ue(this,"onSessionExtendResponse",(r,n)=>{const{id:s}=n,i=kt("session_extend",s);if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners`);Rr(n)?this.events.emit(kt("session_extend",s),{}):nr(n)&&this.events.emit(kt("session_extend",s),{error:n.error})}),ue(this,"onSessionPingRequest",async(r,n)=>{const{id:s}=n;try{this.isValidPing({topic:r}),await this.sendResult({id:s,topic:r,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_ping",{id:s,topic:r})}catch(i){await this.sendError({id:s,topic:r,error:i}),this.client.logger.error(i)}}),ue(this,"onSessionPingResponse",(r,n)=>{const{id:s}=n,i=kt("session_ping",s);setTimeout(()=>{if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners 2176`);Rr(n)?this.events.emit(kt("session_ping",s),{}):nr(n)&&this.events.emit(kt("session_ping",s),{error:n.error})},500)}),ue(this,"onSessionDeleteRequest",async(r,n)=>{const{id:s}=n;try{this.isValidDisconnect({topic:r,reason:n.params}),await Promise.all([new Promise(i=>{this.client.core.relayer.once(fr.publish,async()=>{i(await this.deleteSession({topic:r,id:s}))})}),this.sendResult({id:s,topic:r,result:!0}),this.cleanupPendingSentRequestsForTopic({topic:r,error:er("USER_DISCONNECTED")})]).catch(i=>this.client.logger.error(i))}catch(i){this.client.logger.error(i)}}),ue(this,"onSessionRequest",async r=>{var n,s,i;const{topic:o,payload:a,attestation:c,encryptedId:l,transportType:u}=r,{id:d,params:h}=a;try{await this.isValidRequest(Dt({topic:o},h));const p=this.client.session.get(o),y=await this.getVerifyContext({attestationId:c,hash:Ks(JSON.stringify(Ar("wc_sessionRequest",h,d))),encryptedId:l,metadata:p.peer.metadata,transportType:u}),g={id:d,topic:o,params:h,verifyContext:y};await this.setPendingSessionRequest(g),u===Gt.link_mode&&(n=p.peer.metadata.redirect)!=null&&n.universal&&this.client.core.addLinkModeSupportedApp((s=p.peer.metadata.redirect)==null?void 0:s.universal),(i=this.client.signConfig)!=null&&i.disableRequestQueue?this.emitSessionRequest(g):(this.addSessionRequestToSessionRequestQueue(g),this.processSessionRequestQueue())}catch(p){await this.sendError({id:d,topic:o,error:p}),this.client.logger.error(p)}}),ue(this,"onSessionRequestResponse",(r,n)=>{const{id:s}=n,i=kt("session_request",s);if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners`);Rr(n)?this.events.emit(kt("session_request",s),{result:n.result}):nr(n)&&this.events.emit(kt("session_request",s),{error:n.error})}),ue(this,"onSessionEventRequest",async(r,n)=>{const{id:s,params:i}=n;try{const o=`${r}_session_event_${i.event.name}`,a=Xu.get(o);if(a&&this.isRequestOutOfSync(a,s)){this.client.logger.info(`Discarding out of sync request - ${s}`);return}this.isValidEmit(Dt({topic:r},i)),this.client.events.emit("session_event",{id:s,topic:r,params:i}),Xu.set(o,s)}catch(o){await this.sendError({id:s,topic:r,error:o}),this.client.logger.error(o)}}),ue(this,"onSessionAuthenticateResponse",(r,n)=>{const{id:s}=n;this.client.logger.trace({type:"method",method:"onSessionAuthenticateResponse",topic:r,payload:n}),Rr(n)?this.events.emit(kt("session_request",s),{result:n.result}):nr(n)&&this.events.emit(kt("session_request",s),{error:n.error})}),ue(this,"onSessionAuthenticateRequest",async r=>{var n;const{topic:s,payload:i,attestation:o,encryptedId:a,transportType:c}=r;try{const{requester:l,authPayload:u,expiryTimestamp:d}=i.params,h=await this.getVerifyContext({attestationId:o,hash:Ks(JSON.stringify(i)),encryptedId:a,metadata:l.metadata,transportType:c}),p={requester:l,pairingTopic:s,id:i.id,authPayload:u,verifyContext:h,expiryTimestamp:d};await this.setAuthRequest(i.id,{request:p,pairingTopic:s,transportType:c}),c===Gt.link_mode&&(n=l.metadata.redirect)!=null&&n.universal&&this.client.core.addLinkModeSupportedApp(l.metadata.redirect.universal),this.client.events.emit("session_authenticate",{topic:s,params:i.params,id:i.id,verifyContext:h})}catch(l){this.client.logger.error(l);const u=i.params.requester.publicKey,d=await this.client.core.crypto.generateKeyPair(),h=this.getAppLinkIfEnabled(i.params.requester.metadata,c),p={type:ko,receiverPublicKey:u,senderPublicKey:d};await this.sendError({id:i.id,topic:s,error:l,encodeOpts:p,rpcOpts:nn.wc_sessionAuthenticate.autoReject,appLink:h})}}),ue(this,"addSessionRequestToSessionRequestQueue",r=>{this.sessionRequestQueue.queue.push(r)}),ue(this,"cleanupAfterResponse",r=>{this.deletePendingSessionRequest(r.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=Ni.idle,this.processSessionRequestQueue()},X.toMiliseconds(this.requestQueueDelay))}),ue(this,"cleanupPendingSentRequestsForTopic",({topic:r,error:n})=>{const s=this.client.core.history.pending;s.length>0&&s.filter(i=>i.topic===r&&i.request.method==="wc_sessionRequest").forEach(i=>{const o=i.request.id,a=kt("session_request",o);if(this.events.listenerCount(a)===0)throw new Error(`emitting ${a} without any listeners`);this.events.emit(kt("session_request",i.request.id),{error:n})})}),ue(this,"processSessionRequestQueue",()=>{if(this.sessionRequestQueue.state===Ni.active){this.client.logger.info("session request queue is already active.");return}const r=this.sessionRequestQueue.queue[0];if(!r){this.client.logger.info("session request queue is empty.");return}try{this.emitSessionRequest(r)}catch(n){this.client.logger.error(n)}}),ue(this,"emitSessionRequest",r=>{if(this.emittedSessionRequests.has(r.id)){this.client.logger.warn({id:r.id},`Skipping emitting \`session_request\` event for duplicate request. id: ${r.id}`);return}this.sessionRequestQueue.state=Ni.active,this.emittedSessionRequests.add(r.id),this.client.events.emit("session_request",r)}),ue(this,"onPairingCreated",r=>{if(r.methods&&this.expectedPairingMethodMap.set(r.topic,r.methods),r.active)return;const n=this.client.proposal.getAll().find(s=>s.pairingTopic===r.topic);n&&this.onSessionProposeRequest({topic:r.topic,payload:Ar("wc_sessionPropose",An(Dt({},n),{requiredNamespaces:n.requiredNamespaces,optionalNamespaces:n.optionalNamespaces,relays:n.relays,proposer:n.proposer,sessionProperties:n.sessionProperties,scopedProperties:n.scopedProperties}),n.id),attestation:n.attestation,encryptedId:n.encryptedId})}),ue(this,"isValidConnect",async r=>{if(!Vn(r)){const{message:l}=be("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(r)}`);throw new Error(l)}const{pairingTopic:n,requiredNamespaces:s,optionalNamespaces:i,sessionProperties:o,scopedProperties:a,relays:c}=r;if(Dr(n)||await this.isValidPairingTopic(n),!One(c)){const{message:l}=be("MISSING_OR_INVALID",`connect() relays: ${c}`);throw new Error(l)}if(s&&!Dr(s)&&Hi(s)!==0){const l="requiredNamespaces are deprecated and are automatically assigned to optionalNamespaces";["fatal","error","silent"].includes(this.client.logger.level)?console.warn(l):this.client.logger.warn(l),this.validateNamespaces(s,"requiredNamespaces")}if(i&&!Dr(i)&&Hi(i)!==0&&this.validateNamespaces(i,"optionalNamespaces"),o&&!Dr(o)&&this.validateSessionProps(o,"sessionProperties"),a&&!Dr(a)){this.validateSessionProps(a,"scopedProperties");const l=Object.keys(s||{}).concat(Object.keys(i||{}));if(!Object.keys(a).every(u=>l.includes(u.split(":")[0])))throw new Error(`Scoped properties must be a subset of required/optional namespaces, received: ${JSON.stringify(a)}, required/optional namespaces: ${JSON.stringify(l)}`)}}),ue(this,"validateNamespaces",(r,n)=>{const s=Nne(r,"connect()",n);if(s)throw new Error(s.message)}),ue(this,"isValidApprove",async r=>{if(!Vn(r))throw new Error(be("MISSING_OR_INVALID",`approve() params: ${r}`).message);const{id:n,namespaces:s,relayProtocol:i,sessionProperties:o,scopedProperties:a}=r;this.checkRecentlyDeleted(n),await this.isValidProposalId(n);const c=this.client.proposal.get(n),l=Cw(s,"approve()");if(l)throw new Error(l.message);const u=hA(c.requiredNamespaces,s,"approve()");if(u)throw new Error(u.message);if(!Sr(i,!0)){const{message:d}=be("MISSING_OR_INVALID",`approve() relayProtocol: ${i}`);throw new Error(d)}if(o&&!Dr(o)&&this.validateSessionProps(o,"sessionProperties"),a&&!Dr(a)){this.validateSessionProps(a,"scopedProperties");const d=new Set(Object.keys(s));if(!Object.keys(a).every(h=>d.has(h.split(":")[0])))throw new Error(`Scoped properties must be a subset of approved namespaces, received: ${JSON.stringify(a)}, approved namespaces: ${Array.from(d).join(", ")}`)}}),ue(this,"isValidReject",async r=>{if(!Vn(r)){const{message:i}=be("MISSING_OR_INVALID",`reject() params: ${r}`);throw new Error(i)}const{id:n,reason:s}=r;if(this.checkRecentlyDeleted(n),await this.isValidProposalId(n),!Pne(s)){const{message:i}=be("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(s)}`);throw new Error(i)}}),ue(this,"isValidSessionSettleRequest",r=>{if(!Vn(r)){const{message:l}=be("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${r}`);throw new Error(l)}const{relay:n,controller:s,namespaces:i,expiry:o}=r;if(!k5(n)){const{message:l}=be("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(l)}const a=Sne(s,"onSessionSettleRequest()");if(a)throw new Error(a.message);const c=Cw(i,"onSessionSettleRequest()");if(c)throw new Error(c.message);if(Ui(o)){const{message:l}=be("EXPIRED","onSessionSettleRequest()");throw new Error(l)}}),ue(this,"isValidUpdate",async r=>{if(!Vn(r)){const{message:c}=be("MISSING_OR_INVALID",`update() params: ${r}`);throw new Error(c)}const{topic:n,namespaces:s}=r;this.checkRecentlyDeleted(n),await this.isValidSessionTopic(n);const i=this.client.session.get(n),o=Cw(s,"update()");if(o)throw new Error(o.message);const a=hA(i.requiredNamespaces,s,"update()");if(a)throw new Error(a.message)}),ue(this,"isValidExtend",async r=>{if(!Vn(r)){const{message:s}=be("MISSING_OR_INVALID",`extend() params: ${r}`);throw new Error(s)}const{topic:n}=r;this.checkRecentlyDeleted(n),await this.isValidSessionTopic(n)}),ue(this,"isValidRequest",async r=>{if(!Vn(r)){const{message:c}=be("MISSING_OR_INVALID",`request() params: ${r}`);throw new Error(c)}const{topic:n,request:s,chainId:i,expiry:o}=r;this.checkRecentlyDeleted(n),await this.isValidSessionTopic(n);const{namespaces:a}=this.client.session.get(n);if(!dA(a,i)){const{message:c}=be("MISSING_OR_INVALID",`request() chainId: ${i}`);throw new Error(c)}if(!Rne(s)){const{message:c}=be("MISSING_OR_INVALID",`request() ${JSON.stringify(s)}`);throw new Error(c)}if(!Bne(a,i,s.method)){const{message:c}=be("MISSING_OR_INVALID",`request() method: ${s.method}`);throw new Error(c)}if(o&&!Fne(o,Pw)){const{message:c}=be("MISSING_OR_INVALID",`request() expiry: ${o}. Expiry must be a number (in seconds) between ${Pw.min} and ${Pw.max}`);throw new Error(c)}}),ue(this,"isValidRespond",async r=>{var n;if(!Vn(r)){const{message:a}=be("MISSING_OR_INVALID",`respond() params: ${r}`);throw new Error(a)}const{topic:s,response:i}=r;try{await this.isValidSessionTopic(s)}catch(a){throw(n=r?.response)!=null&&n.id&&this.cleanupAfterResponse(r),a}if(!Dne(i)){const{message:a}=be("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(i)}`);throw new Error(a)}const o=this.client.pendingRequest.get(i.id);if(o.topic!==s){const{message:a}=be("MISMATCHED_TOPIC",`Request response topic mismatch. reqId: ${i.id}, expected topic: ${o.topic}, received topic: ${s}`);throw new Error(a)}}),ue(this,"isValidPing",async r=>{if(!Vn(r)){const{message:s}=be("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(s)}const{topic:n}=r;await this.isValidSessionOrPairingTopic(n)}),ue(this,"isValidEmit",async r=>{if(!Vn(r)){const{message:a}=be("MISSING_OR_INVALID",`emit() params: ${r}`);throw new Error(a)}const{topic:n,event:s,chainId:i}=r;await this.isValidSessionTopic(n);const{namespaces:o}=this.client.session.get(n);if(!dA(o,i)){const{message:a}=be("MISSING_OR_INVALID",`emit() chainId: ${i}`);throw new Error(a)}if(!Une(s)){const{message:a}=be("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(s)}`);throw new Error(a)}if(!Lne(o,i,s.name)){const{message:a}=be("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(s)}`);throw new Error(a)}}),ue(this,"isValidDisconnect",async r=>{if(!Vn(r)){const{message:s}=be("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(s)}const{topic:n}=r;await this.isValidSessionOrPairingTopic(n)}),ue(this,"isValidAuthenticate",r=>{const{chains:n,uri:s,domain:i,nonce:o}=r;if(!Array.isArray(n)||n.length===0)throw new Error("chains is required and must be a non-empty array");if(!Sr(s,!1))throw new Error("uri is required parameter");if(!Sr(i,!1))throw new Error("domain is required parameter");if(!Sr(o,!1))throw new Error("nonce is required parameter");if([...new Set(n.map(c=>Oo(c).namespace))].length>1)throw new Error("Multi-namespace requests are not supported. Please request single namespace only.");const{namespace:a}=Oo(n[0]);if(a!=="eip155")throw new Error("Only eip155 namespace is supported for authenticated sessions. Please use .connect() for non-eip155 chains.")}),ue(this,"getVerifyContext",async r=>{const{attestationId:n,hash:s,encryptedId:i,metadata:o,transportType:a}=r,c={verified:{verifyUrl:o.verifyUrl||xd,validation:"UNKNOWN",origin:o.url||""}};try{if(a===Gt.link_mode){const u=this.getAppLinkIfEnabled(o,a);return c.verified.validation=u&&new URL(u).origin===new URL(o.url).origin?"VALID":"INVALID",c}const l=await this.client.core.verify.resolve({attestationId:n,hash:s,encryptedId:i,verifyUrl:o.verifyUrl});l&&(c.verified.origin=l.origin,c.verified.isScam=l.isScam,c.verified.validation=l.origin===new URL(o.url).origin?"VALID":"INVALID")}catch(l){this.client.logger.warn(l)}return this.client.logger.debug(`Verify context: ${JSON.stringify(c)}`),c}),ue(this,"validateSessionProps",(r,n)=>{Object.values(r).forEach((s,i)=>{if(s==null){const{message:o}=be("MISSING_OR_INVALID",`${n} must contain an existing value for each key. Received: ${s} for key ${Object.keys(r)[i]}`);throw new Error(o)}})}),ue(this,"getPendingAuthRequest",r=>{const n=this.client.auth.requests.get(r);return typeof n=="object"?n:void 0}),ue(this,"addToRecentlyDeleted",(r,n)=>{if(this.recentlyDeletedMap.set(r,n),this.recentlyDeletedMap.size>=this.recentlyDeletedLimit){let s=0;const i=this.recentlyDeletedLimit/2;for(const o of this.recentlyDeletedMap.keys()){if(s++>=i)break;this.recentlyDeletedMap.delete(o)}}}),ue(this,"checkRecentlyDeleted",r=>{const n=this.recentlyDeletedMap.get(r);if(n){const{message:s}=be("MISSING_OR_INVALID",`Record was recently deleted - ${n}: ${r}`);throw new Error(s)}}),ue(this,"isLinkModeEnabled",(r,n)=>{var s,i,o,a,c,l,u,d,h;return!r||n!==Gt.link_mode?!1:((i=(s=this.client.metadata)==null?void 0:s.redirect)==null?void 0:i.linkMode)===!0&&((a=(o=this.client.metadata)==null?void 0:o.redirect)==null?void 0:a.universal)!==void 0&&((l=(c=this.client.metadata)==null?void 0:c.redirect)==null?void 0:l.universal)!==""&&((u=r?.redirect)==null?void 0:u.universal)!==void 0&&((d=r?.redirect)==null?void 0:d.universal)!==""&&((h=r?.redirect)==null?void 0:h.linkMode)===!0&&this.client.core.linkModeSupportedApps.includes(r.redirect.universal)&&typeof(global==null?void 0:global.Linking)<"u"}),ue(this,"getAppLinkIfEnabled",(r,n)=>{var s;return this.isLinkModeEnabled(r,n)?(s=r?.redirect)==null?void 0:s.universal:void 0}),ue(this,"handleLinkModeMessage",({url:r})=>{if(!r||!r.includes("wc_ev")||!r.includes("topic"))return;const n=xS(r,"topic")||"",s=decodeURIComponent(xS(r,"wc_ev")||""),i=this.client.session.keys.includes(n);i&&this.client.session.update(n,{transportType:Gt.link_mode}),this.client.core.dispatchEnvelope({topic:n,message:s,sessionExists:i})}),ue(this,"registerLinkModeListeners",async()=>{var r;if(wv()||Ba()&&(r=this.client.metadata.redirect)!=null&&r.linkMode){const n=global==null?void 0:global.Linking;if(typeof n<"u"){n.addEventListener("url",this.handleLinkModeMessage,this.client.name);const s=await n.getInitialURL();s&&setTimeout(()=>{this.handleLinkModeMessage({url:s})},50)}}}),ue(this,"getTVFParams",(r,n,s)=>{var i,o,a;if(!((i=n.request)!=null&&i.method))return{};const c={correlationId:r,rpcMethods:[n.request.method],chainId:n.chainId};try{const l=this.extractTxHashesFromResult(n.request,s);c.txHashes=l,c.contractAddresses=this.isValidContractData(n.request.params)?[(a=(o=n.request.params)==null?void 0:o[0])==null?void 0:a.to]:[]}catch(l){this.client.logger.warn(l,"Error getting TVF params")}return c}),ue(this,"isValidContractData",r=>{var n;if(!r)return!1;try{const s=r?.data||((n=r?.[0])==null?void 0:n.data);if(!s.startsWith("0x"))return!1;const i=s.slice(2);return/^[0-9a-fA-F]*$/.test(i)?i.length%2===0:!1}catch{}return!1}),ue(this,"extractTxHashesFromResult",(r,n)=>{var s;try{if(!n)return[];const i=r.method,o=Gae[i];if(i==="sui_signTransaction")return[nte(n.transactionBytes)];if(i==="near_signTransaction")return[OS(n)];if(i==="near_signTransactions")return n.map(c=>OS(c));if(i==="xrpl_signTransactionFor"||i==="xrpl_signTransaction")return[(s=n.tx_json)==null?void 0:s.hash];if(i==="polkadot_signTransaction")return[rse({transaction:r.params.transactionPayload,signature:n.signature})];if(i==="algo_signTxn")return Po(n)?n.map(c=>kS(c)):[kS(n)];if(i==="cosmos_signDirect")return[ite(n)];if(i==="wallet_sendCalls")return ote(n);if(typeof n=="string")return[n];const a=n[o.key];if(Po(a))return i==="solana_signAllTransactions"?a.map(c=>rte(c)):a;if(typeof a=="string")return[a]}catch(i){this.client.logger.warn(i,"Error extracting tx hashes from result")}return[]})}async processPendingMessageEvents(){try{const e=this.client.session.keys,r=this.client.core.relayer.messages.getWithoutAck(e);for(const[n,s]of Object.entries(r))for(const i of s)try{await this.onProviderMessageEvent({topic:n,message:i,publishedAt:Date.now()})}catch{this.client.logger.warn(`Error processing pending message event for topic: ${n}, message: ${i}`)}}catch(e){this.client.logger.warn(e,"processPendingMessageEvents failed")}}isInitialized(){if(!this.initialized){const{message:e}=be("NOT_INITIALIZED",this.name);throw new Error(e)}}async confirmOnlineStateOrThrow(){await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(fr.message,e=>{this.onProviderMessageEvent(e)})}async onRelayMessage(e){const{topic:r,message:n,attestation:s,transportType:i}=e,{publicKey:o}=this.client.auth.authKeys.keys.includes(vp)?this.client.auth.authKeys.get(vp):{publicKey:void 0};try{const a=await this.client.core.crypto.decode(r,n,{receiverPublicKey:o,encoding:i===Gt.link_mode?ma:Qn});yu(a)?(this.client.core.history.set(r,a),await this.onRelayEventRequest({topic:r,payload:a,attestation:s,transportType:i,encryptedId:Ks(n)})):Ua(a)?(await this.client.core.history.resolve(a),await this.onRelayEventResponse({topic:r,payload:a,transportType:i}),this.client.core.history.delete(r,a.id)):await this.onRelayEventUnknownPayload({topic:r,payload:a,transportType:i}),await this.client.core.relayer.messages.ack(r,n)}catch(a){this.client.logger.error(a)}}registerExpirerEvents(){this.client.core.expirer.on(zs.expired,async e=>{const{topic:r,id:n}=PO(e.target);if(n&&this.client.pendingRequest.keys.includes(n))return await this.deletePendingSessionRequest(n,be("EXPIRED"),!0);if(n&&this.client.auth.requests.keys.includes(n))return await this.deletePendingAuthRequest(n,be("EXPIRED"),!0);r?this.client.session.keys.includes(r)&&(await this.deleteSession({topic:r,expirerHasDeleted:!0}),this.client.events.emit("session_expire",{topic:r})):n&&(await this.deleteProposal(n,!0),this.client.events.emit("proposal_expire",{id:n}))})}registerPairingEvents(){this.client.core.pairing.events.on(cc.create,e=>this.onPairingCreated(e)),this.client.core.pairing.events.on(cc.delete,e=>{this.addToRecentlyDeleted(e.topic,"pairing")})}isValidPairingTopic(e){if(!Sr(e,!1)){const{message:r}=be("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(r)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:r}=be("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(r)}if(Ui(this.client.core.pairing.pairings.get(e).expiry)){const{message:r}=be("EXPIRED",`pairing topic: ${e}`);throw new Error(r)}}async isValidSessionTopic(e){if(!Sr(e,!1)){const{message:r}=be("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(r)}if(this.checkRecentlyDeleted(e),!this.client.session.keys.includes(e)){const{message:r}=be("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(r)}if(Ui(this.client.session.get(e).expiry)){await this.deleteSession({topic:e});const{message:r}=be("EXPIRED",`session topic: ${e}`);throw new Error(r)}if(!this.client.core.crypto.keychain.has(e)){const{message:r}=be("MISSING_OR_INVALID",`session topic does not exist in keychain: ${e}`);throw await this.deleteSession({topic:e}),new Error(r)}}async isValidSessionOrPairingTopic(e){if(this.checkRecentlyDeleted(e),this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(Sr(e,!1)){const{message:r}=be("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(r)}else{const{message:r}=be("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(r)}}async isValidProposalId(e){if(!kne(e)){const{message:r}=be("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(r)}if(!this.client.proposal.keys.includes(e)){const{message:r}=be("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(r)}if(Ui(this.client.proposal.get(e).expiryTimestamp)){await this.deleteProposal(e);const{message:r}=be("EXPIRED",`proposal id: ${e}`);throw new Error(r)}}}class cce extends Qc{constructor(e,r){super(e,r,Wae,kv),this.core=e,this.logger=r}}let lce=class extends Qc{constructor(e,r){super(e,r,Vae,kv),this.core=e,this.logger=r}};class uce extends Qc{constructor(e,r){super(e,r,Yae,kv,n=>n.id),this.core=e,this.logger=r}}class dce extends Qc{constructor(e,r){super(e,r,Qae,Ey,()=>vp),this.core=e,this.logger=r}}class hce extends Qc{constructor(e,r){super(e,r,ece,Ey),this.core=e,this.logger=r}}class fce extends Qc{constructor(e,r){super(e,r,tce,Ey,n=>n.id),this.core=e,this.logger=r}}var pce=Object.defineProperty,gce=(t,e,r)=>e in t?pce(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Rw=(t,e,r)=>gce(t,typeof e!="symbol"?e+"":e,r);class yce{constructor(e,r){this.core=e,this.logger=r,Rw(this,"authKeys"),Rw(this,"pairingTopics"),Rw(this,"requests"),this.authKeys=new dce(this.core,this.logger),this.pairingTopics=new hce(this.core,this.logger),this.requests=new fce(this.core,this.logger)}async init(){await this.authKeys.init(),await this.pairingTopics.init(),await this.requests.init()}}var mce=Object.defineProperty,wce=(t,e,r)=>e in t?mce(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ft=(t,e,r)=>wce(t,typeof e!="symbol"?e+"":e,r);let bce=class Q5 extends RZ{constructor(e){super(e),ft(this,"protocol",X5),ft(this,"version",Z5),ft(this,"name",kw.name),ft(this,"metadata"),ft(this,"core"),ft(this,"logger"),ft(this,"events",new dr.EventEmitter),ft(this,"engine"),ft(this,"session"),ft(this,"proposal"),ft(this,"pendingRequest"),ft(this,"auth"),ft(this,"signConfig"),ft(this,"on",(n,s)=>this.events.on(n,s)),ft(this,"once",(n,s)=>this.events.once(n,s)),ft(this,"off",(n,s)=>this.events.off(n,s)),ft(this,"removeListener",(n,s)=>this.events.removeListener(n,s)),ft(this,"removeAllListeners",n=>this.events.removeAllListeners(n)),ft(this,"connect",async n=>{try{return await this.engine.connect(n)}catch(s){throw this.logger.error(s.message),s}}),ft(this,"pair",async n=>{try{return await this.engine.pair(n)}catch(s){throw this.logger.error(s.message),s}}),ft(this,"approve",async n=>{try{return await this.engine.approve(n)}catch(s){throw this.logger.error(s.message),s}}),ft(this,"reject",async n=>{try{return await this.engine.reject(n)}catch(s){throw this.logger.error(s.message),s}}),ft(this,"update",async n=>{try{return await this.engine.update(n)}catch(s){throw this.logger.error(s.message),s}}),ft(this,"extend",async n=>{try{return await this.engine.extend(n)}catch(s){throw this.logger.error(s.message),s}}),ft(this,"request",async n=>{try{return await this.engine.request(n)}catch(s){throw this.logger.error(s.message),s}}),ft(this,"respond",async n=>{try{return await this.engine.respond(n)}catch(s){throw this.logger.error(s.message),s}}),ft(this,"ping",async n=>{try{return await this.engine.ping(n)}catch(s){throw this.logger.error(s.message),s}}),ft(this,"emit",async n=>{try{return await this.engine.emit(n)}catch(s){throw this.logger.error(s.message),s}}),ft(this,"disconnect",async n=>{try{return await this.engine.disconnect(n)}catch(s){throw this.logger.error(s.message),s}}),ft(this,"find",n=>{try{return this.engine.find(n)}catch(s){throw this.logger.error(s.message),s}}),ft(this,"getPendingSessionRequests",()=>{try{return this.engine.getPendingSessionRequests()}catch(n){throw this.logger.error(n.message),n}}),ft(this,"authenticate",async(n,s)=>{try{return await this.engine.authenticate(n,s)}catch(i){throw this.logger.error(i.message),i}}),ft(this,"formatAuthMessage",n=>{try{return this.engine.formatAuthMessage(n)}catch(s){throw this.logger.error(s.message),s}}),ft(this,"approveSessionAuthenticate",async n=>{try{return await this.engine.approveSessionAuthenticate(n)}catch(s){throw this.logger.error(s.message),s}}),ft(this,"rejectSessionAuthenticate",async n=>{try{return await this.engine.rejectSessionAuthenticate(n)}catch(s){throw this.logger.error(s.message),s}}),this.name=e?.name||kw.name,this.metadata=YQ(e?.metadata),this.signConfig=e?.signConfig;const r=Nv({logger:e?.logger||kw.logger,name:this.name});this.logger=r,this.core=e?.core||new Hae(e),this.session=new lce(this.core,this.logger),this.proposal=new cce(this.core,this.logger),this.pendingRequest=new uce(this.core,this.logger),this.engine=new ace(this),this.auth=new yce(this.core,this.logger)}static async init(e){const r=new Q5(e);return await r.initialize(),r}get context(){return cs(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.auth.init(),await this.engine.init(),this.logger.info("SignClient Initialization Success")}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}};const vce=bce;var Wf={exports:{}},HA;function Ece(){return HA||(HA=1,(function(t,e){var r=typeof globalThis<"u"&&globalThis||typeof self<"u"&&self||typeof Di<"u"&&Di,n=(function(){function i(){this.fetch=!1,this.DOMException=r.DOMException}return i.prototype=r,new i})();(function(i){(function(o){var a=typeof i<"u"&&i||typeof self<"u"&&self||typeof Di<"u"&&Di||{},c={searchParams:"URLSearchParams"in a,iterable:"Symbol"in a&&"iterator"in Symbol,blob:"FileReader"in a&&"Blob"in a&&(function(){try{return new Blob,!0}catch{return!1}})(),formData:"FormData"in a,arrayBuffer:"ArrayBuffer"in a};function l(f){return f&&DataView.prototype.isPrototypeOf(f)}if(c.arrayBuffer)var u=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],d=ArrayBuffer.isView||function(f){return f&&u.indexOf(Object.prototype.toString.call(f))>-1};function h(f){if(typeof f!="string"&&(f=String(f)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(f)||f==="")throw new TypeError('Invalid character in header field name: "'+f+'"');return f.toLowerCase()}function p(f){return typeof f!="string"&&(f=String(f)),f}function y(f){var m={next:function(){var _=f.shift();return{done:_===void 0,value:_}}};return c.iterable&&(m[Symbol.iterator]=function(){return m}),m}function g(f){this.map={},f instanceof g?f.forEach(function(m,_){this.append(_,m)},this):Array.isArray(f)?f.forEach(function(m){if(m.length!=2)throw new TypeError("Headers constructor: expected name/value pair to be length 2, found"+m.length);this.append(m[0],m[1])},this):f&&Object.getOwnPropertyNames(f).forEach(function(m){this.append(m,f[m])},this)}g.prototype.append=function(f,m){f=h(f),m=p(m);var _=this.map[f];this.map[f]=_?_+", "+m:m},g.prototype.delete=function(f){delete this.map[h(f)]},g.prototype.get=function(f){return f=h(f),this.has(f)?this.map[f]:null},g.prototype.has=function(f){return this.map.hasOwnProperty(h(f))},g.prototype.set=function(f,m){this.map[h(f)]=p(m)},g.prototype.forEach=function(f,m){for(var _ in this.map)this.map.hasOwnProperty(_)&&f.call(m,this.map[_],_,this)},g.prototype.keys=function(){var f=[];return this.forEach(function(m,_){f.push(_)}),y(f)},g.prototype.values=function(){var f=[];return this.forEach(function(m){f.push(m)}),y(f)},g.prototype.entries=function(){var f=[];return this.forEach(function(m,_){f.push([_,m])}),y(f)},c.iterable&&(g.prototype[Symbol.iterator]=g.prototype.entries);function w(f){if(!f._noBody){if(f.bodyUsed)return Promise.reject(new TypeError("Already read"));f.bodyUsed=!0}}function S(f){return new Promise(function(m,_){f.onload=function(){m(f.result)},f.onerror=function(){_(f.error)}})}function A(f){var m=new FileReader,_=S(m);return m.readAsArrayBuffer(f),_}function E(f){var m=new FileReader,_=S(m),$=/charset=([A-Za-z0-9_-]+)/.exec(f.type),x=$?$[1]:"utf-8";return m.readAsText(f,x),_}function v(f){for(var m=new Uint8Array(f),_=new Array(m.length),$=0;$<m.length;$++)_[$]=String.fromCharCode(m[$]);return _.join("")}function C(f){if(f.slice)return f.slice(0);var m=new Uint8Array(f.byteLength);return m.set(new Uint8Array(f)),m.buffer}function O(){return this.bodyUsed=!1,this._initBody=function(f){this.bodyUsed=this.bodyUsed,this._bodyInit=f,f?typeof f=="string"?this._bodyText=f:c.blob&&Blob.prototype.isPrototypeOf(f)?this._bodyBlob=f:c.formData&&FormData.prototype.isPrototypeOf(f)?this._bodyFormData=f:c.searchParams&&URLSearchParams.prototype.isPrototypeOf(f)?this._bodyText=f.toString():c.arrayBuffer&&c.blob&&l(f)?(this._bodyArrayBuffer=C(f.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):c.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(f)||d(f))?this._bodyArrayBuffer=C(f):this._bodyText=f=Object.prototype.toString.call(f):(this._noBody=!0,this._bodyText=""),this.headers.get("content-type")||(typeof f=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):c.searchParams&&URLSearchParams.prototype.isPrototypeOf(f)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},c.blob&&(this.blob=function(){var f=w(this);if(f)return f;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))}),this.arrayBuffer=function(){if(this._bodyArrayBuffer){var f=w(this);return f||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}else{if(c.blob)return this.blob().then(A);throw new Error("could not read as ArrayBuffer")}},this.text=function(){var f=w(this);if(f)return f;if(this._bodyBlob)return E(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(v(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},c.formData&&(this.formData=function(){return this.text().then(W)}),this.json=function(){return this.text().then(JSON.parse)},this}var L=["CONNECT","DELETE","GET","HEAD","OPTIONS","PATCH","POST","PUT","TRACE"];function j(f){var m=f.toUpperCase();return L.indexOf(m)>-1?m:f}function D(f,m){if(!(this instanceof D))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');m=m||{};var _=m.body;if(f instanceof D){if(f.bodyUsed)throw new TypeError("Already read");this.url=f.url,this.credentials=f.credentials,m.headers||(this.headers=new g(f.headers)),this.method=f.method,this.mode=f.mode,this.signal=f.signal,!_&&f._bodyInit!=null&&(_=f._bodyInit,f.bodyUsed=!0)}else this.url=String(f);if(this.credentials=m.credentials||this.credentials||"same-origin",(m.headers||!this.headers)&&(this.headers=new g(m.headers)),this.method=j(m.method||this.method||"GET"),this.mode=m.mode||this.mode||null,this.signal=m.signal||this.signal||(function(){if("AbortController"in a){var N=new AbortController;return N.signal}})(),this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&_)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(_),(this.method==="GET"||this.method==="HEAD")&&(m.cache==="no-store"||m.cache==="no-cache")){var $=/([?&])_=[^&]*/;if($.test(this.url))this.url=this.url.replace($,"$1_="+new Date().getTime());else{var x=/\?/;this.url+=(x.test(this.url)?"&":"?")+"_="+new Date().getTime()}}}D.prototype.clone=function(){return new D(this,{body:this._bodyInit})};function W(f){var m=new FormData;return f.trim().split("&").forEach(function(_){if(_){var $=_.split("="),x=$.shift().replace(/\+/g," "),N=$.join("=").replace(/\+/g," ");m.append(decodeURIComponent(x),decodeURIComponent(N))}}),m}function P(f){var m=new g,_=f.replace(/\r?\n[\t ]+/g," ");return _.split("\r").map(function($){return $.indexOf(`
`)===0?$.substr(1,$.length):$}).forEach(function($){var x=$.split(":"),N=x.shift().trim();if(N){var H=x.join(":").trim();try{m.append(N,H)}catch(z){console.warn("Response "+z.message)}}}),m}O.call(D.prototype);function R(f,m){if(!(this instanceof R))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');if(m||(m={}),this.type="default",this.status=m.status===void 0?200:m.status,this.status<200||this.status>599)throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");this.ok=this.status>=200&&this.status<300,this.statusText=m.statusText===void 0?"":""+m.statusText,this.headers=new g(m.headers),this.url=m.url||"",this._initBody(f)}O.call(R.prototype),R.prototype.clone=function(){return new R(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new g(this.headers),url:this.url})},R.error=function(){var f=new R(null,{status:200,statusText:""});return f.ok=!1,f.status=0,f.type="error",f};var T=[301,302,303,307,308];R.redirect=function(f,m){if(T.indexOf(m)===-1)throw new RangeError("Invalid status code");return new R(null,{status:m,headers:{location:f}})},o.DOMException=a.DOMException;try{new o.DOMException}catch{o.DOMException=function(m,_){this.message=m,this.name=_;var $=Error(m);this.stack=$.stack},o.DOMException.prototype=Object.create(Error.prototype),o.DOMException.prototype.constructor=o.DOMException}function k(f,m){return new Promise(function(_,$){var x=new D(f,m);if(x.signal&&x.signal.aborted)return $(new o.DOMException("Aborted","AbortError"));var N=new XMLHttpRequest;function H(){N.abort()}N.onload=function(){var M={statusText:N.statusText,headers:P(N.getAllResponseHeaders()||"")};x.url.indexOf("file://")===0&&(N.status<200||N.status>599)?M.status=200:M.status=N.status,M.url="responseURL"in N?N.responseURL:M.headers.get("X-Request-URL");var V="response"in N?N.response:N.responseText;setTimeout(function(){_(new R(V,M))},0)},N.onerror=function(){setTimeout(function(){$(new TypeError("Network request failed"))},0)},N.ontimeout=function(){setTimeout(function(){$(new TypeError("Network request timed out"))},0)},N.onabort=function(){setTimeout(function(){$(new o.DOMException("Aborted","AbortError"))},0)};function z(M){try{return M===""&&a.location.href?a.location.href:M}catch{return M}}if(N.open(x.method,z(x.url),!0),x.credentials==="include"?N.withCredentials=!0:x.credentials==="omit"&&(N.withCredentials=!1),"responseType"in N&&(c.blob?N.responseType="blob":c.arrayBuffer&&(N.responseType="arraybuffer")),m&&typeof m.headers=="object"&&!(m.headers instanceof g||a.Headers&&m.headers instanceof a.Headers)){var G=[];Object.getOwnPropertyNames(m.headers).forEach(function(M){G.push(h(M)),N.setRequestHeader(M,p(m.headers[M]))}),x.headers.forEach(function(M,V){G.indexOf(V)===-1&&N.setRequestHeader(V,M)})}else x.headers.forEach(function(M,V){N.setRequestHeader(V,M)});x.signal&&(x.signal.addEventListener("abort",H),N.onreadystatechange=function(){N.readyState===4&&x.signal.removeEventListener("abort",H)}),N.send(typeof x._bodyInit>"u"?null:x._bodyInit)})}return k.polyfill=!0,a.fetch||(a.fetch=k,a.Headers=g,a.Request=D,a.Response=R),o.Headers=g,o.Request=D,o.Response=R,o.fetch=k,Object.defineProperty(o,"__esModule",{value:!0}),o})({})})(n),n.fetch.ponyfill=!0,delete n.fetch.polyfill;var s=r.fetch?r:n;e=s.fetch,e.default=s.fetch,e.fetch=s.fetch,e.Headers=s.Headers,e.Request=s.Request,e.Response=s.Response,t.exports=e})(Wf,Wf.exports)),Wf.exports}var _ce=Ece();const WA=Sh(_ce);var xce=Object.defineProperty,Sce=Object.defineProperties,Ace=Object.getOwnPropertyDescriptors,VA=Object.getOwnPropertySymbols,Ice=Object.prototype.hasOwnProperty,Cce=Object.prototype.propertyIsEnumerable,KA=(t,e,r)=>e in t?xce(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,GA=(t,e)=>{for(var r in e||(e={}))Ice.call(e,r)&&KA(t,r,e[r]);if(VA)for(var r of VA(e))Cce.call(e,r)&&KA(t,r,e[r]);return t},YA=(t,e)=>Sce(t,Ace(e));const $ce={Accept:"application/json","Content-Type":"application/json"},Tce="POST",XA={headers:$ce,method:Tce},ZA=10;let e6=class{constructor(e,r=!1){if(this.url=e,this.disableProviderPing=r,this.events=new dr.EventEmitter,this.isAvailable=!1,this.registering=!1,!tx(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);this.url=e,this.disableProviderPing=r}get connected(){return this.isAvailable}get connecting(){return this.registering}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async open(e=this.url){await this.register(e)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(e){this.isAvailable||await this.register();try{const r=Bn(e),n=await(await WA(this.url,YA(GA({},XA),{body:r}))).json();this.onPayload({data:n})}catch(r){this.onError(e.id,r)}}async register(e=this.url){if(!tx(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((n,s)=>{this.events.once("register_error",i=>{this.resetMaxListeners(),s(i)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return s(new Error("HTTP connection is missing or invalid"));n()})})}this.url=e,this.registering=!0;try{if(!this.disableProviderPing){const r=Bn({id:1,jsonrpc:"2.0",method:"test",params:[]});await WA(e,YA(GA({},XA),{body:r}))}this.onOpen()}catch(r){const n=this.parseError(r);throw this.events.emit("register_error",n),this.onClose(),n}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;const r=typeof e.data=="string"?Wi(e.data):e.data;this.events.emit("payload",r)}onError(e,r){const n=this.parseError(r),s=n.message||n.toString(),i=Vc(e,s);this.events.emit("payload",i)}parseError(e,r=this.url){return tv(e,r,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>ZA&&this.events.setMaxListeners(ZA)}};function Pv(t){return t==null||typeof t!="object"&&typeof t!="function"}function t6(t){return Object.getOwnPropertySymbols(t).filter(e=>Object.prototype.propertyIsEnumerable.call(t,e))}function r6(t){return t==null?t===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(t)}const Nce="[object RegExp]",n6="[object String]",s6="[object Number]",i6="[object Boolean]",o6="[object Arguments]",Oce="[object Symbol]",kce="[object Date]",Pce="[object Map]",Rce="[object Set]",Dce="[object Array]",Uce="[object ArrayBuffer]",Bce="[object Object]",Lce="[object DataView]",Mce="[object Uint8Array]",jce="[object Uint8ClampedArray]",Fce="[object Uint16Array]",qce="[object Uint32Array]",zce="[object Int8Array]",Hce="[object Int16Array]",Wce="[object Int32Array]",Vce="[object Float32Array]",Kce="[object Float64Array]";function Rv(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function Gce(t,e){return Rl(t,void 0,t,new Map,e)}function Rl(t,e,r,n=new Map,s=void 0){const i=s?.(t,e,r,n);if(i!=null)return i;if(Pv(t))return t;if(n.has(t))return n.get(t);if(Array.isArray(t)){const o=new Array(t.length);n.set(t,o);for(let a=0;a<t.length;a++)o[a]=Rl(t[a],a,r,n,s);return Object.hasOwn(t,"index")&&(o.index=t.index),Object.hasOwn(t,"input")&&(o.input=t.input),o}if(t instanceof Date)return new Date(t.getTime());if(t instanceof RegExp){const o=new RegExp(t.source,t.flags);return o.lastIndex=t.lastIndex,o}if(t instanceof Map){const o=new Map;n.set(t,o);for(const[a,c]of t)o.set(a,Rl(c,a,r,n,s));return o}if(t instanceof Set){const o=new Set;n.set(t,o);for(const a of t)o.add(Rl(a,void 0,r,n,s));return o}if(typeof Buffer<"u"&&Buffer.isBuffer(t))return t.subarray();if(Rv(t)){const o=new(Object.getPrototypeOf(t)).constructor(t.length);n.set(t,o);for(let a=0;a<t.length;a++)o[a]=Rl(t[a],a,r,n,s);return o}if(t instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&t instanceof SharedArrayBuffer)return t.slice(0);if(t instanceof DataView){const o=new DataView(t.buffer.slice(0),t.byteOffset,t.byteLength);return n.set(t,o),lc(o,t,r,n,s),o}if(typeof File<"u"&&t instanceof File){const o=new File([t],t.name,{type:t.type});return n.set(t,o),lc(o,t,r,n,s),o}if(t instanceof Blob){const o=new Blob([t],{type:t.type});return n.set(t,o),lc(o,t,r,n,s),o}if(t instanceof Error){const o=new t.constructor;return n.set(t,o),o.message=t.message,o.name=t.name,o.stack=t.stack,o.cause=t.cause,lc(o,t,r,n,s),o}if(typeof t=="object"&&Yce(t)){const o=Object.create(Object.getPrototypeOf(t));return n.set(t,o),lc(o,t,r,n,s),o}return t}function lc(t,e,r=t,n,s){const i=[...Object.keys(e),...t6(e)];for(let o=0;o<i.length;o++){const a=i[o],c=Object.getOwnPropertyDescriptor(t,a);(c==null||c.writable)&&(t[a]=Rl(e[a],a,r,n,s))}}function Yce(t){switch(r6(t)){case o6:case Dce:case Uce:case Lce:case i6:case kce:case Vce:case Kce:case zce:case Hce:case Wce:case Pce:case s6:case Bce:case Nce:case Rce:case n6:case Oce:case Mce:case jce:case Fce:case qce:return!0;default:return!1}}function Xce(t,e){return Gce(t,(r,n,s,i)=>{if(typeof t=="object")switch(Object.prototype.toString.call(t)){case s6:case n6:case i6:{const o=new t.constructor(t?.valueOf());return lc(o,t),o}case o6:{const o={};return lc(o,t),o.length=t.length,o[Symbol.iterator]=t[Symbol.iterator],o}default:return}})}function JA(t){return Xce(t)}function QA(t){return t!==null&&typeof t=="object"&&r6(t)==="[object Arguments]"}function eI(t){return typeof t=="object"&&t!==null}function Zce(){}function Jce(t){return Rv(t)}function Qce(t){if(typeof t!="object"||t==null)return!1;if(Object.getPrototypeOf(t)===null)return!0;if(Object.prototype.toString.call(t)!=="[object Object]"){const r=t[Symbol.toStringTag];return r==null||!Object.getOwnPropertyDescriptor(t,Symbol.toStringTag)?.writable?!1:t.toString()===`[object ${r}]`}let e=t;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e}function ele(t){if(Pv(t))return t;if(Array.isArray(t)||Rv(t)||t instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&t instanceof SharedArrayBuffer)return t.slice(0);const e=Object.getPrototypeOf(t),r=e.constructor;if(t instanceof Date||t instanceof Map||t instanceof Set)return new r(t);if(t instanceof RegExp){const n=new r(t);return n.lastIndex=t.lastIndex,n}if(t instanceof DataView)return new r(t.buffer.slice(0));if(t instanceof Error){const n=new r(t.message);return n.stack=t.stack,n.name=t.name,n.cause=t.cause,n}if(typeof File<"u"&&t instanceof File)return new r([t],t.name,{type:t.type,lastModified:t.lastModified});if(typeof t=="object"){const n=Object.create(e);return Object.assign(n,t)}return t}function tle(t,...e){const r=e.slice(0,-1),n=e[e.length-1];let s=t;for(let i=0;i<r.length;i++){const o=r[i];s=Hb(s,o,n,new Map)}return s}function Hb(t,e,r,n){if(Pv(t)&&(t=Object(t)),e==null||typeof e!="object")return t;if(n.has(e))return ele(n.get(e));if(n.set(e,t),Array.isArray(e)){e=e.slice();for(let i=0;i<e.length;i++)e[i]=e[i]??void 0}const s=[...Object.keys(e),...t6(e)];for(let i=0;i<s.length;i++){const o=s[i];let a=e[o],c=t[o];if(QA(a)&&(a={...a}),QA(c)&&(c={...c}),typeof Buffer<"u"&&Buffer.isBuffer(a)&&(a=JA(a)),Array.isArray(a))if(typeof c=="object"&&c!=null){const u=[],d=Reflect.ownKeys(c);for(let h=0;h<d.length;h++){const p=d[h];u[p]=c[p]}c=u}else c=[];const l=r(c,a,o,t,e,n);l!=null?t[o]=l:Array.isArray(a)||eI(c)&&eI(a)?t[o]=Hb(c,a,r,n):c==null&&Qce(a)?t[o]=Hb({},a,r,n):c==null&&Jce(a)?t[o]=JA(a):(c===void 0||a!==void 0)&&(t[o]=a)}return t}function rle(t,...e){return tle(t,...e,Zce)}const tI="error",nle="wss://relay.walletconnect.org",sle="wc",a6="universal_provider",Vf=`${sle}@2:${a6}:`,c6="https://rpc.walletconnect.org/v1/",l6="generic",ile=`${c6}bundler`,zl="call_status",ole=86400,Dv={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var ale=Object.defineProperty,cle=Object.defineProperties,lle=Object.getOwnPropertyDescriptors,rI=Object.getOwnPropertySymbols,ule=Object.prototype.hasOwnProperty,dle=Object.prototype.propertyIsEnumerable,nI=(t,e,r)=>e in t?ale(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Kf=(t,e)=>{for(var r in e||(e={}))ule.call(e,r)&&nI(t,r,e[r]);if(rI)for(var r of rI(e))dle.call(e,r)&&nI(t,r,e[r]);return t},hle=(t,e)=>cle(t,lle(e));function u6(t,e,r){var n;const s=Oo(t);return((n=e.rpcMap)==null?void 0:n[s.reference])||`${c6}?chainId=${s.namespace}:${s.reference}&projectId=${r}`}function fle(t){return t.includes(":")?t.split(":")[1]:t}function d6(t){return t.map(e=>`${e.split(":")[0]}:${e.split(":")[1]}`)}function ple(t,e){const r=Object.keys(e.namespaces).filter(s=>s.includes(t));if(!r.length)return[];const n=[];return r.forEach(s=>{const i=e.namespaces[s].accounts;n.push(...i)}),n}function sI(t){return Object.fromEntries(Object.entries(t).filter(([e,r])=>{var n,s;return((n=r?.chains)==null?void 0:n.length)&&((s=r?.chains)==null?void 0:s.length)>0}))}function Gf(t={},e={}){const r=sI(iI(t)),n=sI(iI(e));return rle(r,n)}function iI(t){var e,r,n,s,i;const o={};if(!Hi(t))return o;for(const[a,c]of Object.entries(t)){const l=by(a)?[a]:c.chains,u=c.methods||[],d=c.events||[],h=c.rpcMap||{},p=Pl(a);o[p]=hle(Kf(Kf({},o[p]),c),{chains:zi(l,(e=o[p])==null?void 0:e.chains),methods:zi(u,(r=o[p])==null?void 0:r.methods),events:zi(d,(n=o[p])==null?void 0:n.events)}),(Hi(h)||Hi(((s=o[p])==null?void 0:s.rpcMap)||{}))&&(o[p].rpcMap=Kf(Kf({},h),(i=o[p])==null?void 0:i.rpcMap))}return o}function oI(t){return t.includes(":")?t.split(":")[2]:t}function aI(t){const e={};for(const[r,n]of Object.entries(t)){const s=n.methods||[],i=n.events||[],o=n.accounts||[],a=by(r)?[r]:n.chains?n.chains:d6(n.accounts);e[r]={chains:a,methods:s,events:i,accounts:o}}return e}function Dw(t){return typeof t=="number"?t:t.includes("0x")?parseInt(t,16):(t=t.includes(":")?t.split(":")[1]:t,isNaN(Number(t))?t:Number(t))}function gle(t){try{const e=JSON.parse(t);return typeof e=="object"&&e!==null&&!Array.isArray(e)}catch{return!1}}const h6={},Hl=t=>h6[t],Uw=(t,e)=>{h6[t]=e};var yle=Object.defineProperty,cI=Object.getOwnPropertySymbols,mle=Object.prototype.hasOwnProperty,wle=Object.prototype.propertyIsEnumerable,lI=(t,e,r)=>e in t?yle(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,uI=(t,e)=>{for(var r in e||(e={}))mle.call(e,r)&&lI(t,r,e[r]);if(cI)for(var r of cI(e))wle.call(e,r)&&lI(t,r,e[r]);return t};const dI="eip155",ble=["atomic","flow-control","paymasterService","sessionKeys","auxiliaryFunds"],vle=t=>t&&t.startsWith("0x")?BigInt(t).toString(10):t,Bw=t=>t&&t.startsWith("0x")?t:`0x${BigInt(t).toString(16)}`,hI=t=>Object.keys(t).filter(e=>ble.includes(e)).reduce((e,r)=>(e[r]=Ele(t[r]),e),{}),Ele=t=>typeof t=="string"&&gle(t)?JSON.parse(t):t,_le=(t,e,r)=>{const{sessionProperties:n={},scopedProperties:s={}}=t,i={};if(!Hi(s)&&!Hi(n))return;const o=hI(n);for(const a of r){const c=vle(a);if(!c)continue;i[Bw(c)]=o;const l=s?.[`${dI}:${c}`];if(l){const u=l?.[`${dI}:${c}:${e}`];i[Bw(c)]=uI(uI({},i[Bw(c)]),hI(u||l))}}for(const[a,c]of Object.entries(i))Object.keys(c).length===0&&delete i[a];return Object.keys(i).length>0?i:void 0};var xle=Object.defineProperty,Sle=(t,e,r)=>e in t?xle(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Ale=(t,e,r)=>Sle(t,e+"",r);let Lw;class Uv{constructor(e){Ale(this,"storage"),this.storage=e}async getItem(e){return await this.storage.getItem(e)}async setItem(e,r){return await this.storage.setItem(e,r)}async removeItem(e){return await this.storage.removeItem(e)}static getStorage(e){return Lw||(Lw=new Uv(e)),Lw}}var Ile=Object.defineProperty,Cle=Object.defineProperties,$le=Object.getOwnPropertyDescriptors,fI=Object.getOwnPropertySymbols,Tle=Object.prototype.hasOwnProperty,Nle=Object.prototype.propertyIsEnumerable,pI=(t,e,r)=>e in t?Ile(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Ole=(t,e)=>{for(var r in e||(e={}))Tle.call(e,r)&&pI(t,r,e[r]);if(fI)for(var r of fI(e))Nle.call(e,r)&&pI(t,r,e[r]);return t},kle=(t,e)=>Cle(t,$le(e));async function Ple(t,e){const r=Oo(t.result.capabilities.caip345.caip2),n=t.result.capabilities.caip345.transactionHashes,s=await Promise.allSettled(n.map(d=>Rle(r.reference,d,e))),i=s.filter(d=>d.status==="fulfilled").map(d=>d.value).filter(d=>d);s.filter(d=>d.status==="rejected").forEach(d=>console.warn("Failed to fetch transaction receipt:",d.reason));const o=!i.length||i.some(d=>!d),a=i.every(d=>d?.status==="0x1"),c=i.every(d=>d?.status==="0x0"),l=i.some(d=>d?.status==="0x0");let u;return o?u=100:a?u=200:c?u=500:l&&(u=600),{id:t.result.id,version:t.request.version,atomic:t.request.atomicRequired,chainId:t.request.chainId,capabilities:t.result.capabilities,receipts:i,status:u}}async function Rle(t,e,r){return await r(parseInt(t)).request(Ar("eth_getTransactionReceipt",[e]))}async function Dle({sendCalls:t,storage:e}){const r=await e.getItem(zl);await e.setItem(zl,kle(Ole({},r),{[t.result.id]:{request:t.request,result:t.result,expiry:vr(ole)}}))}async function Ule({resultId:t,storage:e}){const r=await e.getItem(zl);if(r){delete r[t],await e.setItem(zl,r);for(const n in r)Ui(r[n].expiry)&&delete r[n];await e.setItem(zl,r)}}async function Ble({resultId:t,storage:e}){const r=await e.getItem(zl),n=r?.[t];if(n&&!Ui(n.expiry))return n;await Ule({resultId:t,storage:e})}var Lle=Object.defineProperty,Mle=Object.defineProperties,jle=Object.getOwnPropertyDescriptors,gI=Object.getOwnPropertySymbols,Fle=Object.prototype.hasOwnProperty,qle=Object.prototype.propertyIsEnumerable,Wb=(t,e,r)=>e in t?Lle(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Mw=(t,e)=>{for(var r in e||(e={}))Fle.call(e,r)&&Wb(t,r,e[r]);if(gI)for(var r of gI(e))qle.call(e,r)&&Wb(t,r,e[r]);return t},jw=(t,e)=>Mle(t,jle(e)),Za=(t,e,r)=>Wb(t,typeof e!="symbol"?e+"":e,r);class zle{constructor(e){Za(this,"name","eip155"),Za(this,"client"),Za(this,"chainId"),Za(this,"namespace"),Za(this,"httpProviders"),Za(this,"events"),Za(this,"storage"),this.namespace=e.namespace,this.events=Hl("events"),this.client=Hl("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain()),this.storage=Uv.getStorage(this.client.core.storage)}async request(e){switch(e.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(e);case"eth_chainId":return parseInt(this.getDefaultChain());case"wallet_getCapabilities":return await this.getCapabilities(e);case"wallet_getCallsStatus":return await this.getCallStatus(e);case"wallet_sendCalls":return await this.sendCalls(e)}return this.namespace.methods.includes(e.request.method)?await this.client.request(e):this.getHttpProvider().request(e.request)}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,r){this.httpProviders[e]||this.setHttpProvider(parseInt(e),r);const n=this.chainId;this.chainId=parseInt(e),this.events.emit(Dv.DEFAULT_CHAIN_CHANGED,{currentCaipChainId:`${this.name}:${e}`,previousCaipChainId:`${this.name}:${n}`})}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}createHttpProvider(e,r){const n=r||u6(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new Ov(new e6(n,Hl("disableProviderPing")))}setHttpProvider(e,r){const n=this.createHttpProvider(e,r);n&&(this.httpProviders[e]=n)}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{var n;const s=parseInt(fle(r));e[s]=this.createHttpProvider(s,(n=this.namespace.rpcMap)==null?void 0:n[r])}),e}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}getHttpProvider(e){const r=e||this.chainId;return this.httpProviders[r]||(this.httpProviders=jw(Mw({},this.httpProviders),{[r]:this.createHttpProvider(r)}),this.httpProviders[r])}async handleSwitchChain(e){var r,n;let s=e.request.params?(r=e.request.params[0])==null?void 0:r.chainId:"0x0";s=s.startsWith("0x")?s:`0x${s}`;const i=parseInt(s,16);if(this.isChainApproved(i))this.setDefaultChain(`${i}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:e.topic,request:{method:e.request.method,params:[{chainId:s}]},chainId:(n=this.namespace.chains)==null?void 0:n[0]}),this.setDefaultChain(`${i}`);else throw new Error(`Failed to switch to chain 'eip155:${i}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(e){return this.namespace.chains.includes(`${this.name}:${e}`)}async getCapabilities(e){var r,n,s,i,o;const a=(n=(r=e.request)==null?void 0:r.params)==null?void 0:n[0],c=((i=(s=e.request)==null?void 0:s.params)==null?void 0:i[1])||[];if(!a)throw new Error("Missing address parameter in `wallet_getCapabilities` request");const l=this.client.session.get(e.topic),u=((o=l?.sessionProperties)==null?void 0:o.capabilities)||{},d=`${a}${c.join(",")}`,h=u?.[d];if(h)return h;let p;try{p=_le(l,a,c)}catch(g){console.warn("Failed to extract capabilities from session",g)}if(p)return p;const y=await this.client.request(e);try{await this.client.session.update(e.topic,{sessionProperties:jw(Mw({},l.sessionProperties||{}),{capabilities:jw(Mw({},u||{}),{[d]:y})})})}catch(g){console.warn("Failed to update session with capabilities",g)}return y}async getCallStatus(e){var r,n,s;const i=this.client.session.get(e.topic),o=(r=i.sessionProperties)==null?void 0:r.bundler_name;if(o){const l=this.getBundlerUrl(e.chainId,o);try{return await this.getUserOperationReceipt(l,e)}catch(u){console.warn("Failed to fetch call status from bundler",u,l)}}const a=(n=i.sessionProperties)==null?void 0:n.bundler_url;if(a)try{return await this.getUserOperationReceipt(a,e)}catch(l){console.warn("Failed to fetch call status from custom bundler",l,a)}const c=await Ble({resultId:(s=e.request.params)==null?void 0:s[0],storage:this.storage});if(c)try{return await Ple(c,this.getHttpProvider.bind(this))}catch(l){console.warn("Failed to fetch call status from stored send calls",l,c)}if(this.namespace.methods.includes(e.request.method))return await this.client.request(e);throw new Error("Fetching call status not approved by the wallet.")}async getUserOperationReceipt(e,r){var n;const s=new URL(e),i=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Ar("eth_getUserOperationReceipt",[(n=r.request.params)==null?void 0:n[0]]))});if(!i.ok)throw new Error(`Failed to fetch user operation receipt - ${i.status}`);return await i.json()}getBundlerUrl(e,r){return`${ile}?projectId=${this.client.core.projectId}&chainId=${e}&bundler=${r}`}async sendCalls(e){var r,n,s;const i=await this.client.request(e),o=(r=e.request.params)==null?void 0:r[0],a=i?.id,c=i?.capabilities||{},l=(n=c?.caip345)==null?void 0:n.caip2,u=(s=c?.caip345)==null?void 0:s.transactionHashes;return!a||!l||!(u!=null&&u.length)||await Dle({sendCalls:{request:o,result:i},storage:this.storage}),i}}var Hle=Object.defineProperty,Wle=(t,e,r)=>e in t?Hle(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,xl=(t,e,r)=>Wle(t,typeof e!="symbol"?e+"":e,r);class Vle{constructor(e){xl(this,"name",l6),xl(this,"client"),xl(this,"httpProviders"),xl(this,"events"),xl(this,"namespace"),xl(this,"chainId"),this.namespace=e.namespace,this.events=Hl("events"),this.client=Hl("client"),this.chainId=this.getDefaultChain(),this.name=this.getNamespaceName(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace.chains=[...new Set((this.namespace.chains||[]).concat(e.chains||[]))],this.namespace.accounts=[...new Set((this.namespace.accounts||[]).concat(e.accounts||[]))],this.namespace.methods=[...new Set((this.namespace.methods||[]).concat(e.methods||[]))],this.namespace.events=[...new Set((this.namespace.events||[]).concat(e.events||[]))],this.httpProviders=this.createHttpProviders()}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider(e.chainId).request(e.request)}setDefaultChain(e,r){this.httpProviders[e]||this.setHttpProvider(e,r);const n=this.chainId;this.chainId=e,this.events.emit(Dv.DEFAULT_CHAIN_CHANGED,{currentCaipChainId:`${this.name}:${e}`,previousCaipChainId:`${this.name}:${n}`})}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getNamespaceName(){const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return Oo(e).namespace}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){var e,r;const n={};return(r=(e=this.namespace)==null?void 0:e.accounts)==null||r.forEach(s=>{var i,o;const a=Oo(s),c=(o=(i=this.namespace)==null?void 0:i.rpcMap)==null?void 0:o[`${a.namespace}:${a.reference}`];n[a.reference]=this.createHttpProvider(s,c)}),n}getHttpProvider(e){const r=Oo(e).reference,n=this.httpProviders[r];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return n}setHttpProvider(e,r){const n=this.createHttpProvider(e,r);n&&(this.httpProviders[e]=n)}createHttpProvider(e,r){const n=r||u6(e,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new Ov(new e6(n,Hl("disableProviderPing")))}}var Kle=Object.defineProperty,Gle=Object.defineProperties,Yle=Object.getOwnPropertyDescriptors,yI=Object.getOwnPropertySymbols,Xle=Object.prototype.hasOwnProperty,Zle=Object.prototype.propertyIsEnumerable,Vb=(t,e,r)=>e in t?Kle(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,td=(t,e)=>{for(var r in e||(e={}))Xle.call(e,r)&&Vb(t,r,e[r]);if(yI)for(var r of yI(e))Zle.call(e,r)&&Vb(t,r,e[r]);return t},Yf=(t,e)=>Gle(t,Yle(e)),Ls=(t,e,r)=>Vb(t,typeof e!="symbol"?e+"":e,r);let Jle=class f6{constructor(e){Ls(this,"client"),Ls(this,"namespaces"),Ls(this,"optionalNamespaces"),Ls(this,"sessionProperties"),Ls(this,"scopedProperties"),Ls(this,"events",new $h),Ls(this,"rpcProviders",{}),Ls(this,"session"),Ls(this,"providerOpts"),Ls(this,"logger"),Ls(this,"uri"),Ls(this,"disableProviderPing",!1);var r,n;this.providerOpts=e,this.logger=Nv({logger:(r=e.logger)!=null?r:tI,name:(n=this.providerOpts.name)!=null?n:a6}),this.disableProviderPing=e?.disableProviderPing||!1}static async init(e){const r=new f6(e);return await r.initialize(),r}async request(e,r,n){const[s,i]=this.validateChain(r);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(s).request({request:td({},e),chainId:`${s}:${i}`,topic:this.session.topic,expiry:n})}sendAsync(e,r,n,s){const i=new Date().getTime();this.request(e,n,s).then(o=>r(null,Do(i,o))).catch(o=>r(o,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties}),await this.requestAccounts()}async disconnect(){var e;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(e=this.session)==null?void 0:e.topic,reason:er("USER_DISCONNECTED")}),await this.cleanup()}async connect(e){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(e),this.cleanupPendingPairings(),!e.skipPairing)return await this.pair(e.pairingTopic)}async authenticate(e,r){if(!this.client)throw new Error("Sign Client not initialized");this.setNamespaces(e),await this.cleanupPendingPairings();const{uri:n,response:s}=await this.client.authenticate(e,r);n&&(this.uri=n,this.events.emit("display_uri",n));const i=await s();if(this.session=i.session,this.session){const o=aI(this.session.namespaces);this.namespaces=Gf(this.namespaces,o),await this.persist("namespaces",this.namespaces),this.onConnect()}return i}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}removeListener(e,r){this.events.removeListener(e,r)}off(e,r){this.events.off(e,r)}get isWalletConnect(){return!0}async pair(e){const{uri:r,approval:n}=await this.client.connect({pairingTopic:e,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties});r&&(this.uri=r,this.events.emit("display_uri",r));const s=await n();this.session=s;const i=aI(s.namespaces);return this.namespaces=Gf(this.namespaces,i),await this.persist("namespaces",this.namespaces),await this.persist("optionalNamespaces",this.optionalNamespaces),this.onConnect(),this.session}setDefaultChain(e,r){try{if(!this.session)return;const[n,s]=this.validateChain(e);this.getProvider(n).setDefaultChain(s,r)}catch(n){if(!/Please call connect/.test(n.message))throw n}}async cleanupPendingPairings(e={}){try{this.logger.info("Cleaning up inactive pairings...");const r=this.client.pairing.getAll();if(!Po(r))return;for(const n of r)e.deletePairings?this.client.core.expirer.set(n.topic,0):await this.client.core.relayer.subscriber.unsubscribe(n.topic);this.logger.info(`Inactive pairings cleared: ${r.length}`)}catch(r){this.logger.warn(r,"Failed to cleanup pending pairings")}}abortPairingAttempt(){this.logger.warn("abortPairingAttempt is deprecated. This is now a no-op.")}async checkStorage(){this.namespaces=await this.getFromStore("namespaces")||{},this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.session&&this.createProviders()}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){var e,r;if(this.client=this.providerOpts.client||await vce.init({core:this.providerOpts.core,logger:this.providerOpts.logger||tI,relayUrl:this.providerOpts.relayUrl||nle,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name,customStoragePrefix:this.providerOpts.customStoragePrefix,telemetryEnabled:this.providerOpts.telemetryEnabled}),this.providerOpts.session)try{this.session=this.client.session.get(this.providerOpts.session.topic)}catch(n){throw this.logger.error(n,"Failed to get session"),new Error(`The provided session: ${(r=(e=this.providerOpts)==null?void 0:e.session)==null?void 0:r.topic} doesn't exist in the Sign client`)}else{const n=this.client.session.getAll();this.session=n[0]}this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const e=[...new Set(Object.keys(this.session.namespaces).map(r=>Pl(r)))];Uw("client",this.client),Uw("events",this.events),Uw("disableProviderPing",this.disableProviderPing),e.forEach(r=>{if(!this.session)return;const n=ple(r,this.session);if(n?.length===0)return;const s=d6(n),i=Gf(this.namespaces,this.optionalNamespaces),o=Yf(td({},i[r]),{accounts:n,chains:s});switch(r){case"eip155":this.rpcProviders[r]=new zle({namespace:o});break;default:this.rpcProviders[r]=new Vle({namespace:o})}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",e=>{var r;const{topic:n}=e;n===((r=this.session)==null?void 0:r.topic)&&this.events.emit("session_ping",e)}),this.client.on("session_event",e=>{var r;const{params:n,topic:s}=e;if(s!==((r=this.session)==null?void 0:r.topic))return;const{event:i}=n;if(i.name==="accountsChanged"){const o=i.data;o&&Po(o)&&this.events.emit("accountsChanged",o.map(oI))}else if(i.name==="chainChanged"){const o=n.chainId,a=n.event.data,c=Pl(o),l=Dw(o)!==Dw(a)?`${c}:${Dw(a)}`:o;this.onChainChanged({currentCaipChainId:l})}else this.events.emit(i.name,i.data);this.events.emit("session_event",e)}),this.client.on("session_update",({topic:e,params:r})=>{var n,s;if(e!==((n=this.session)==null?void 0:n.topic))return;const{namespaces:i}=r,o=(s=this.client)==null?void 0:s.session.get(e);this.session=Yf(td({},o),{namespaces:i}),this.onSessionUpdate(),this.events.emit("session_update",{topic:e,params:r})}),this.client.on("session_delete",async e=>{var r;e.topic===((r=this.session)==null?void 0:r.topic)&&(await this.cleanup(),this.events.emit("session_delete",e),this.events.emit("disconnect",Yf(td({},er("USER_DISCONNECTED")),{data:e.topic})))}),this.on(Dv.DEFAULT_CHAIN_CHANGED,e=>{this.onChainChanged(Yf(td({},e),{internal:!0}))})}getProvider(e){return this.rpcProviders[e]||this.rpcProviders[l6]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(e=>{var r;this.getProvider(e).updateNamespace((r=this.session)==null?void 0:r.namespaces[e])})}setNamespaces(e){const{namespaces:r={},optionalNamespaces:n={},sessionProperties:s,scopedProperties:i}=e;this.optionalNamespaces=Gf(r,n),this.sessionProperties=s,this.scopedProperties=i}validateChain(e){const[r,n]=e?.split(":")||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[r,n];if(r&&!Object.keys(this.namespaces||{}).map(o=>Pl(o)).includes(r))throw new Error(`Namespace '${r}' is not configured. Please call connect() first with namespace config.`);if(r&&n)return[r,n];const s=Pl(Object.keys(this.namespaces)[0]),i=this.rpcProviders[s].getDefaultChain();return[s,i]}async requestAccounts(){const[e]=this.validateChain();return await this.getProvider(e).requestAccounts()}async onChainChanged({currentCaipChainId:e,previousCaipChainId:r,internal:n=!1}){if(!this.namespaces)return;const[s,i]=this.validateChain(e);i&&(this.updateNamespaceChain(s,i),n?(this.events.emit("chainChanged",i),this.emitAccountsChangedOnChainChange({namespace:s,currentCaipChainId:e,previousCaipChainId:r})):this.getProvider(s).setDefaultChain(i),await this.persist("namespaces",this.namespaces))}emitAccountsChangedOnChainChange({namespace:e,currentCaipChainId:r,previousCaipChainId:n}){var s,i;try{if(n===r)return;const o=(i=(s=this.session)==null?void 0:s.namespaces[e])==null?void 0:i.accounts;if(!o)return;const a=o.filter(c=>c.includes(`${r}:`)).map(oI);if(!Po(a))return;this.events.emit("accountsChanged",a)}catch(o){this.logger.warn(o,"Failed to emit accountsChanged on chain change")}}updateNamespaceChain(e,r){if(!this.namespaces)return;const n=this.namespaces[e]?e:`${e}:${r}`,s={chains:[],methods:[],events:[],defaultChain:r};this.namespaces[n]?this.namespaces[n]&&(this.namespaces[n].defaultChain=r):this.namespaces[n]=s}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,await this.deleteFromStore("namespaces"),await this.deleteFromStore("optionalNamespaces"),await this.deleteFromStore("sessionProperties"),this.session=void 0,this.cleanupPendingPairings({deletePairings:!0}),await this.cleanupStorage()}async persist(e,r){var n;const s=((n=this.session)==null?void 0:n.topic)||"";await this.client.core.storage.setItem(`${Vf}/${e}${s}`,r)}async getFromStore(e){var r;const n=((r=this.session)==null?void 0:r.topic)||"";return await this.client.core.storage.getItem(`${Vf}/${e}${n}`)}async deleteFromStore(e){var r;const n=((r=this.session)==null?void 0:r.topic)||"";await this.client.core.storage.removeItem(`${Vf}/${e}${n}`)}async cleanupStorage(){var e;try{if(((e=this.client)==null?void 0:e.session.length)>0)return;const r=await this.client.core.storage.getKeys();for(const n of r)n.startsWith(Vf)&&await this.client.core.storage.removeItem(n)}catch(r){this.logger.warn(r,"Failed to cleanup storage")}}};const mI=2147483648,Qle={convertEVMChainIdToCoinType(t){if(t>=mI)throw new Error("Invalid chainId");return(mI|t)>>>0}},Ms=Xt({suggestions:[],loading:!1}),eue={state:Ms,subscribe(t){return an(Ms,()=>t(Ms))},subscribeKey(t,e){return cn(Ms,t,e)},async resolveName(t){try{return await He.lookupEnsName(t)}catch(e){const r=e;throw new Error(r?.reasons?.[0]?.description||"Error resolving name")}},async isNameRegistered(t){try{return await He.lookupEnsName(t),!0}catch{return!1}},async getSuggestions(t){try{Ms.loading=!0,Ms.suggestions=[];const e=await He.getEnsNameSuggestions(t);return Ms.suggestions=e.suggestions||[],Ms.suggestions}catch(e){const r=Ad.parseEnsApiError(e,"Error fetching name suggestions");throw new Error(r)}finally{Ms.loading=!1}},async getNamesForAddress(t){try{if(!q.state.activeCaipNetwork)return[];const r=de.getEnsFromCacheForAddress(t);if(r)return r;const n=await He.reverseLookupEnsName({address:t});return de.updateEnsCache({address:t,ens:n,timestamp:Date.now()}),n}catch(e){const r=Ad.parseEnsApiError(e,"Error fetching names for address");throw new Error(r)}},async registerName(t){const e=q.state.activeCaipNetwork,r=q.getAccountData(e?.chainNamespace)?.address,n=ge.getAuthConnector();if(!e)throw new Error("Network not found");if(!r||!n)throw new Error("Address or auth connector not found");Ms.loading=!0;try{const s=JSON.stringify({name:t,attributes:{},timestamp:Math.floor(Date.now()/1e3)});qe.pushTransactionStack({onCancel(){qe.replace("RegisterAccountName")}});const i=await Ee.signMessage(s);Ms.loading=!1;const o=e.id;if(!o)throw new Error("Network not found");const a=Qle.convertEVMChainIdToCoinType(Number(o));await He.registerEnsName({coinType:a,address:r,signature:i,message:s}),q.setAccountProp("profileName",t,e.chainNamespace),de.updateEnsCache({address:r,ens:[{name:t,registered_at:new Date().toISOString(),updated_at:void 0,addresses:{},attributes:[]}],timestamp:Date.now()}),qe.replace("RegisterAccountNameSuccess")}catch(s){const i=Ad.parseEnsApiError(s,`Error registering name ${t}`);throw qe.replace("RegisterAccountName"),new Error(i)}finally{Ms.loading=!1}},validateName(t){return/^[a-zA-Z0-9-]{4,}$/u.test(t)},parseEnsApiError(t,e){return t?.reasons?.[0]?.description||e}},Ad=Js(eue),tue={solana:["solana_signMessage","solana_signTransaction","solana_requestAccounts","solana_getAccounts","solana_signAllTransactions","solana_signAndSendTransaction"],eip155:["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_getCallsStatus","wallet_showCallsStatus","wallet_sendCalls","wallet_getCapabilities","wallet_grantPermissions","wallet_revokePermissions","wallet_getAssets"],bip122:["sendTransfer","signMessage","signPsbt","getAccountAddresses"]},Ca={RPC_ERROR_CODE:{USER_REJECTED:5e3,USER_REJECTED_METHODS:5002},getMethodsByChainNamespace(t){return tue[t]||[]},createDefaultNamespace(t){return{methods:this.getMethodsByChainNamespace(t),events:["accountsChanged","chainChanged"],chains:[],rpcMap:{}}},applyNamespaceOverrides(t,e){if(!e)return{...t};const r={...t},n=new Set;if(e.methods&&Object.keys(e.methods).forEach(s=>n.add(s)),e.chains&&Object.keys(e.chains).forEach(s=>n.add(s)),e.events&&Object.keys(e.events).forEach(s=>n.add(s)),e.rpcMap&&Object.keys(e.rpcMap).forEach(s=>{const[i]=s.split(":");i&&n.add(i)}),n.forEach(s=>{r[s]||(r[s]=this.createDefaultNamespace(s))}),e.methods&&Object.entries(e.methods).forEach(([s,i])=>{r[s]&&(r[s].methods=i)}),e.chains&&Object.entries(e.chains).forEach(([s,i])=>{r[s]&&(r[s].chains=i)}),e.events&&Object.entries(e.events).forEach(([s,i])=>{r[s]&&(r[s].events=i)}),e.rpcMap){const s=new Set;Object.entries(e.rpcMap).forEach(([i,o])=>{const[a,c]=i.split(":");!a||!c||!r[a]||(r[a].rpcMap||(r[a].rpcMap={}),s.has(a)||(r[a].rpcMap={},s.add(a)),r[a].rpcMap[c]=o)})}return r},createNamespaces(t,e){const r=t.reduce((n,s)=>{const{id:i,chainNamespace:o,rpcUrls:a}=s,c=a.default.http[0];n[o]||(n[o]=this.createDefaultNamespace(o));const l=`${o}:${i}`,u=n[o];switch(u.chains.push(l),l){case"solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp":u.chains.push("solana:4sGjMW1sUnHzSxGspuhpqLDx6wiyjNtZ");break;case"solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1":u.chains.push("solana:8E9rvCKLFQia2Y35HXjjpWzj8weVo44K");break}return u?.rpcMap&&c&&(u.rpcMap[i]=c),n},{});return this.applyNamespaceOverrides(r,e)},resolveReownName:async t=>{const e=await Ad.resolveName(t);return(Object.values(e?.addresses)||[])[0]?.address||!1},getChainsFromNamespaces(t={}){return Object.values(t).flatMap(e=>{const r=e.chains||[],n=e.accounts.map(s=>{const[i,o]=s.split(":");return`${i}:${o}`});return Array.from(new Set([...r,...n]))})},isSessionEventData(t){return typeof t=="object"&&t!==null&&"id"in t&&"topic"in t&&"params"in t&&typeof t.params=="object"&&t.params!==null&&"chainId"in t.params&&"event"in t.params&&typeof t.params.event=="object"&&t.params.event!==null},isUserRejectedRequestError(t){try{if(typeof t=="object"&&t!==null){const e=t,r=typeof e.code=="number",n=r&&e.code===Ca.RPC_ERROR_CODE.USER_REJECTED_METHODS,s=r&&e.code===Ca.RPC_ERROR_CODE.USER_REJECTED;return n||s}return!1}catch{return!1}},isOriginAllowed(t,e,r){for(const n of[...e,...r])if(n.includes("*")){const i=`^${n.replace(/[.*+?^${}()|[\]\\]/gu,"\\$&").replace(/\\\*/gu,".*")}$`;if(new RegExp(i,"u").test(t))return!0}else try{if(new URL(n).origin===t)return!0}catch{if(n===t)return!0}return!1},listenWcProvider({universalProvider:t,namespace:e,onConnect:r,onDisconnect:n,onAccountsChanged:s,onChainChanged:i,onDisplayUri:o}){r&&t.on("connect",()=>{const a=Ca.getWalletConnectAccounts(t,e);r(a)}),n&&t.on("disconnect",()=>{n()}),s&&t.on("accountsChanged",a=>{try{const c=t.session?.namespaces?.[e]?.accounts||[],l=t.rpcProviders?.[e]?.getDefaultChain(),u=a.map(d=>{const h=c.find(g=>g.includes(`${e}:${l}:${d}`));if(!h)return;const{chainId:p,chainNamespace:y}=sn.parseCaipAddress(h);return{address:d,chainId:p,chainNamespace:y}}).filter(d=>d!==void 0);u.length>0&&s(u)}catch(c){console.warn("Failed to parse accounts for namespace on accountsChanged event",e,a,c)}}),i&&t.on("chainChanged",a=>{i(a)}),o&&t.on("display_uri",a=>{o(a)})},getWalletConnectAccounts(t,e){const r=new Set,n=t?.session?.namespaces?.[e]?.accounts?.map(s=>sn.parseCaipAddress(s)).filter(({address:s})=>r.has(s.toLowerCase())?!1:(r.add(s.toLowerCase()),!0));return n&&n.length>0?n:[]}},rue=[fe.CONNECTOR_ID.AUTH,fe.CONNECTOR_ID.WALLET_CONNECT];class nue{constructor(e){this.availableConnectors=[],this.availableConnections=[],this.providerHandlers={},this.eventListeners=new Map,this.getCaipNetworks=r=>q.getCaipNetworks(r),this.getConnectorId=r=>ge.getConnectorId(r),e&&this.construct(e)}construct(e){this.projectId=e.projectId,this.namespace=e.namespace,this.adapterType=e.adapterType}get connectors(){return this.availableConnectors}get connections(){return this.availableConnections}get networks(){return this.getCaipNetworks(this.namespace)}onAuthConnected({accounts:e,chainId:r}){const n=this.getCaipNetworks().filter(s=>s.chainNamespace===this.namespace).find(s=>s.id.toString()===r?.toString());e&&n&&this.addConnection({connectorId:fe.CONNECTOR_ID.AUTH,accounts:e,caipNetwork:n})}setAuthProvider(e){e.onConnect(this.onAuthConnected.bind(this)),e.onSocialConnected(this.onAuthConnected.bind(this)),this.addConnector({id:fe.CONNECTOR_ID.AUTH,type:"AUTH",name:fe.CONNECTOR_NAMES.AUTH,provider:e,imageId:void 0,chain:this.namespace,chains:[]})}addConnector(...e){const r=new Set;this.availableConnectors=[...e,...this.availableConnectors].filter(n=>r.has(n.id)?!1:(r.add(n.id),!0)),this.emit("connectors",this.availableConnectors)}addConnection(...e){const r=new Set;this.availableConnections=[...e,...this.availableConnections].filter(n=>r.has(n.connectorId.toLowerCase())?!1:(r.add(n.connectorId.toLowerCase()),!0)),this.emit("connections",this.availableConnections)}deleteConnection(e){this.availableConnections=this.availableConnections.filter(r=>r.connectorId.toLowerCase()!==e.toLowerCase()),this.emit("connections",this.availableConnections)}clearConnections(e=!1){this.availableConnections=[],e&&this.emit("connections",this.availableConnections)}setStatus(e,r){q.setAccountProp("status",e,r)}on(e,r){this.eventListeners.has(e)||this.eventListeners.set(e,new Set),this.eventListeners.get(e)?.add(r)}off(e,r){const n=this.eventListeners.get(e);n&&n.delete(r)}removeAllEventListeners(){this.eventListeners.forEach(e=>{e.clear()})}emit(e,r){const n=this.eventListeners.get(e);n&&n.forEach(s=>s(r))}async connectWalletConnect(e){try{return{clientId:(await this.getWalletConnectConnector().connectWalletConnect()).clientId}}catch(r){throw Ca.isUserRejectedRequestError(r)?new CN(r):r}}async switchNetwork(e){const{caipNetwork:r}=e,n=Qt.getProviderId(r.chainNamespace),s=Qt.getProvider(r.chainNamespace);if(!s)throw new Error("Provider not found");if(n==="WALLET_CONNECT"){s.setDefaultChain(r.caipNetworkId);return}if(n==="AUTH"){const i=ge.getAuthConnector()?.provider;if(!i)throw new Error("Auth provider not found");const o=Ys(r.chainNamespace);await i.switchNetwork({chainId:r.caipNetworkId});const a=await i.getUser({chainId:r.caipNetworkId,preferredAccountType:o});this.emit("switchNetwork",a)}}getWalletConnectConnector(){const e=this.connectors.find(r=>r.id==="walletConnect");if(!e)throw new Error("WalletConnectConnector not found");return e}onConnect(e,r){if(e.length>0){const{address:n,chainId:s}=Ne.getAccount(e[0]),i=this.getCaipNetworks().filter(a=>a.chainNamespace===this.namespace).find(a=>a.id.toString()===s?.toString()),o=this.connectors.find(a=>a.id===r);n&&(this.emit("accountChanged",{address:n,chainId:s,connector:o}),this.addConnection({connectorId:r,accounts:e.map(a=>{const{address:c}=Ne.getAccount(a);return{address:c}}),caipNetwork:i}))}}onAccountsChanged(e,r,n=!0){if(e.length>0){const{address:s}=Ne.getAccount(e[0]),i=this.getConnection({connectorId:r,connections:this.connections,connectors:this.connectors});s&&this.getConnectorId(fe.CHAIN.EVM)?.toLowerCase()===r.toLowerCase()&&this.emit("accountChanged",{address:s,chainId:i?.caipNetwork?.id,connector:i?.connector}),this.addConnection({connectorId:r,accounts:e.map(o=>{const{address:a}=Ne.getAccount(o);return{address:a}}),caipNetwork:i?.caipNetwork})}else n&&this.onDisconnect(r)}onDisconnect(e){this.removeProviderListeners(e),this.deleteConnection(e),this.getConnectorId(fe.CHAIN.EVM)?.toLowerCase()===e.toLowerCase()&&this.emitFirstAvailableConnection(),this.connections.length===0&&this.emit("disconnect")}onChainChanged(e,r){const n=typeof e=="string"&&e.startsWith("0x")?parseInt(e,16).toString():e.toString(),s=this.getConnection({connectorId:r,connections:this.connections,connectors:this.connectors}),i=this.getCaipNetworks().filter(o=>o.chainNamespace===this.namespace).find(o=>o.id.toString()===n);s&&this.addConnection({connectorId:r,accounts:s.accounts,caipNetwork:i}),this.getConnectorId(fe.CHAIN.EVM)?.toLowerCase()===r.toLowerCase()&&this.emit("switchNetwork",{chainId:n})}listenProviderEvents(e,r){if(rue.includes(e))return;const n=o=>this.onAccountsChanged(o,e),s=o=>this.onChainChanged(o,e),i=()=>this.onDisconnect(e);this.providerHandlers[e]||(r.on("disconnect",i),r.on("accountsChanged",n),r.on("chainChanged",s),this.providerHandlers[e]={provider:r,disconnect:i,accountsChanged:n,chainChanged:s})}removeProviderListeners(e){if(this.providerHandlers[e]){const{provider:r,disconnect:n,accountsChanged:s,chainChanged:i}=this.providerHandlers[e];r.removeListener("disconnect",n),r.removeListener("accountsChanged",s),r.removeListener("chainChanged",i),this.providerHandlers[e]=null}}emitFirstAvailableConnection(){const e=this.getConnection({connections:this.connections,connectors:this.connectors});if(e){const[r]=e.accounts;this.emit("accountChanged",{address:r?.address,chainId:e.caipNetwork?.id,connector:e.connector})}}getConnection({address:e,connectorId:r,connections:n,connectors:s}){if(r){const o=n.find(l=>l.connectorId.toLowerCase()===r.toLowerCase());if(!o)return null;const a=s.find(l=>l.id.toLowerCase()===o.connectorId.toLowerCase()),c=e?o.accounts.find(l=>l.address.toLowerCase()===e.toLowerCase()):o.accounts[0];return{...o,account:c,connector:a}}const i=n.find(o=>o.accounts.length>0&&s.some(a=>a.id.toLowerCase()===o.connectorId.toLowerCase()));if(i){const[o]=i.accounts,a=s.find(c=>c.id.toLowerCase()===i.connectorId.toLowerCase());return{...i,account:o,connector:a}}return null}}let Ja=null;const hi={getSIWX(){return te.state.siwx},async initializeIfEnabled(t=q.getActiveCaipAddress()){const e=te.state.siwx;if(!(e&&t))return;const[r,n,s]=t.split(":");if(q.checkIfSupportedNetwork(r,`${r}:${n}`))try{if(te.state.remoteFeatures?.emailCapture){const o=q.getAccountData(r)?.user;await lt.open({view:"DataCapture",data:{email:o?.email??void 0}});return}if(Ja&&await Ja,(await e.getSessions(`${r}:${n}`,s)).length)return;await lt.open({view:"SIWXSignMessage"})}catch(i){console.error("SIWXUtil:initializeIfEnabled",i),ct.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:this.getSIWXEventProperties(i)}),await Ee._getClient()?.disconnect().catch(console.error),qe.reset("Connect"),Li.showError("A problem occurred while trying initialize authentication")}},async isAuthenticated(t=q.getActiveCaipAddress()){if(!te.state.siwx||!t)return!0;const{chainNamespace:r,chainId:n,address:s}=sn.parseCaipAddress(t),i=`${r}:${n}`;return(await hi.getSessions({address:s,caipNetworkId:i})).length>0},async requestSignMessage(){const t=te.state.siwx,e=Ne.getPlainAddress(q.getActiveCaipAddress()),r=Pf();if(!t)throw new Error("SIWX is not enabled");if(!e)throw new Error("No ActiveCaipAddress found");if(!r)throw new Error("No ActiveCaipNetwork or client found");try{const n=await t.createMessage({chainId:r.caipNetworkId,accountAddress:e}),s=n.toString();let i="";t.signMessage?i=await t.signMessage({message:s,chainId:r.caipNetworkId,accountAddress:e}):(ge.getConnectorId(r.chainNamespace)===fe.CONNECTOR_ID.AUTH&&qe.pushTransactionStack({}),i=await Ee.signMessage(s)||""),await t.addSession({data:n,message:s,signature:i}),q.setLastConnectedSIWECaipNetwork(r),lt.close(),ct.sendEvent({type:"track",event:"SIWX_AUTH_SUCCESS",properties:this.getSIWXEventProperties()})}catch(n){(!lt.state.open||qe.state.view==="ApproveTransaction")&&await lt.open({view:"SIWXSignMessage"}),Li.showError("Error signing message"),ct.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:this.getSIWXEventProperties(n)}),console.error("SWIXUtil:requestSignMessage",n)}},async cancelSignMessage(){try{const t=this.getSIWX();if(t?.getRequired?.()){const r=q.getLastConnectedSIWECaipNetwork();if(r){const n=await t?.getSessions(r?.caipNetworkId,Ne.getPlainAddress(q.getActiveCaipAddress())||"");n&&n.length>0?await q.switchActiveNetwork(r):await Ee.disconnect()}else await Ee.disconnect()}else lt.close();lt.close(),ct.sendEvent({event:"CLICK_CANCEL_SIWX",type:"track",properties:this.getSIWXEventProperties()})}catch(t){console.error("SIWXUtil:cancelSignMessage",t)}},async getAllSessions(){const t=this.getSIWX(),e=q.getAllRequestedCaipNetworks(),r=[];return await Promise.all(e.map(async n=>{const s=await t?.getSessions(n.caipNetworkId,Ne.getPlainAddress(q.getActiveCaipAddress())||"");s&&r.push(...s)})),r},async getSessions(t){const e=te.state.siwx;let r=t?.address;if(!r){const s=q.getActiveCaipAddress();r=Ne.getPlainAddress(s)}let n=t?.caipNetworkId;return n||(n=q.getActiveCaipNetwork()?.caipNetworkId),e&&r&&n?e.getSessions(n,r):[]},async isSIWXCloseDisabled(){const t=this.getSIWX();if(t){const e=qe.state.view==="ApproveTransaction",r=qe.state.view==="SIWXSignMessage";if(e||r)return t.getRequired?.()&&(await this.getSessions()).length===0}return!1},async authConnectorAuthenticate({authConnector:t,chainId:e,socialUri:r,preferredAccountType:n,chainNamespace:s}){const i=hi.getSIWX(),o=Pf();if(!i||!s.includes(fe.CHAIN.EVM)||te.state.remoteFeatures?.emailCapture){const d=await t.connect({chainId:e,socialUri:r,preferredAccountType:n});return{address:d.address,chainId:d.chainId,accounts:d.accounts}}const a=`${s}:${e}`,c=await i.createMessage({chainId:a,accountAddress:"<<AccountAddress>>"}),l={accountAddress:c.accountAddress,chainId:c.chainId,domain:c.domain,uri:c.uri,version:c.version,nonce:c.nonce,notBefore:c.notBefore,statement:c.statement,resources:c.resources,requestId:c.requestId,issuedAt:c.issuedAt,expirationTime:c.expirationTime,serializedMessage:c.toString()},u=await t.connect({chainId:e,socialUri:r,siwxMessage:l,preferredAccountType:n});return l.accountAddress=u.address,l.serializedMessage=u.message||"",u.signature&&u.message&&await hi.addEmbeddedWalletSession(l,u.message,u.signature),q.setLastConnectedSIWECaipNetwork(o),{address:u.address,chainId:u.chainId,accounts:u.accounts}},async addEmbeddedWalletSession(t,e,r){if(Ja)return Ja;const n=hi.getSIWX();return n?(Ja=n.addSession({data:t,message:e,signature:r}).finally(()=>{Ja=null}),Ja):Promise.resolve()},async universalProviderAuthenticate({universalProvider:t,chains:e,methods:r}){const n=hi.getSIWX(),s=Pf(),i=new Set(e.map(l=>l.split(":")[0]));if(!n||i.size!==1||!i.has("eip155"))return!1;const o=await n.createMessage({chainId:Pf()?.caipNetworkId||"",accountAddress:""}),a=await t.authenticate({nonce:o.nonce,domain:o.domain,uri:o.uri,exp:o.expirationTime,iat:o.issuedAt,nbf:o.notBefore,requestId:o.requestId,version:o.version,resources:o.resources,statement:o.statement,chainId:o.chainId,methods:r,chains:[o.chainId,...e.filter(l=>l!==o.chainId)]});Li.showLoading("Authenticating...",{autoClose:!1});const c={...a.session.peer.metadata,name:a.session.peer.metadata.name,icon:a.session.peer.metadata.icons?.[0],type:"WALLET_CONNECT"};if(q.setAccountProp("connectedWalletInfo",c,Array.from(i)[0]),a?.auths?.length){const l=a.auths.map(u=>{const d=t.client.formatAuthMessage({request:u.p,iss:u.p.iss});return{data:{...u.p,accountAddress:u.p.iss.split(":").slice(-1).join(""),chainId:u.p.iss.split(":").slice(2,4).join(":"),uri:u.p.aud,version:u.p.version||o.version,expirationTime:u.p.exp,issuedAt:u.p.iat,notBefore:u.p.nbf},message:d,signature:u.s.s,cacao:u}});try{await n.setSessions(l),s&&q.setLastConnectedSIWECaipNetwork(s),ct.sendEvent({type:"track",event:"SIWX_AUTH_SUCCESS",properties:hi.getSIWXEventProperties()})}catch(u){throw console.error("SIWX:universalProviderAuth - failed to set sessions",u),ct.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:hi.getSIWXEventProperties(u)}),await t.disconnect().catch(console.error),u}finally{Li.hide()}}return!0},getSIWXEventProperties(t){const e=q.state.activeChain;if(!e)throw new Error("SIWXUtil:getSIWXEventProperties - namespace is required");return{network:q.state.activeCaipNetwork?.caipNetworkId||"",isSmartAccount:Ys(e)===xo.ACCOUNT_TYPES.SMART_ACCOUNT,message:t?Ne.parseError(t):void 0}},async clearSessions(){const t=this.getSIWX();t&&await t.setSessions([])}};class sue{constructor({provider:e,namespace:r}){this.id=fe.CONNECTOR_ID.WALLET_CONNECT,this.name="WalletConnect",this.type="WALLET_CONNECT",this.imageId="ef1a1fcf-7fe8-4d69-bd6d-fda1345b4400",this.getCaipNetworks=q.getCaipNetworks.bind(q),this.caipNetworks=this.getCaipNetworks(),this.provider=e,this.chain=r}get chains(){return this.getCaipNetworks()}async connectWalletConnect(){if(!await this.authenticate()){const r=this.getCaipNetworks(),n=te.state.universalProviderConfigOverride,s=Ca.createNamespaces(r,n);await this.provider.connect({optionalNamespaces:s})}return{clientId:await this.provider.client.core.crypto.getClientId(),session:this.provider.session}}async disconnect(){await this.provider.disconnect()}async authenticate(){const e=this.chains.map(r=>r.caipNetworkId);return hi.universalProviderAuthenticate({universalProvider:this.provider,chains:e,methods:iue})}}const iue=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_getCallsStatus","wallet_sendCalls","wallet_getCapabilities","wallet_grantPermissions","wallet_revokePermissions","wallet_getAssets"],ii=Xt({message:"",variant:"info",open:!1}),oue={state:ii,subscribeKey(t,e){return cn(ii,t,e)},open(t,e){const{debug:r}=te.state,{code:n,displayMessage:s,debugMessage:i}=t;s&&r&&(ii.message=s,ii.variant=e,ii.open=!0),i&&console.error(typeof i=="function"?i():i,n?{code:n}:void 0)},warn(t,e,r){ii.open=!0,ii.message=t,ii.variant="warning",e&&console.warn(e,r)},close(){ii.open=!1,ii.message="",ii.variant="info"}},gs=Js(oue),aue={asset:"0x833589fcd6edb6e08f4c7c32d4f71b54bda02913"},cue={asset:"0x036CbD53842c5426634e7929541eC2318f3dCF7e"},uo={EIP155:fe.CHAIN.EVM,CONNECTOR_TYPE_WALLET_CONNECT:"WALLET_CONNECT",CONNECTOR_TYPE_INJECTED:"INJECTED",CONNECTOR_TYPE_ANNOUNCED:"ANNOUNCED",CONNECTOR_TYPE_AUTH:"AUTH"},lue={NetworkImageIds:{1:"ba0ba0cd-17c6-4806-ad93-f9d174f17900",42161:"3bff954d-5cb0-47a0-9a23-d20192e74600",43114:"30c46e53-e989-45fb-4549-be3bd4eb3b00",56:"93564157-2e8e-4ce7-81df-b264dbee9b00",250:"06b26297-fe0c-4733-5d6b-ffa5498aac00",10:"ab9c186a-c52f-464b-2906-ca59d760a400",137:"41d04d42-da3b-4453-8506-668cc0727900",5e3:"e86fae9b-b770-4eea-e520-150e12c81100",295:"6a97d510-cac8-4e58-c7ce-e8681b044c00",11155111:"e909ea0a-f92a-4512-c8fc-748044ea6800",84532:"a18a7ecd-e307-4360-4746-283182228e00",1301:"4eeea7ef-0014-4649-5d1d-07271a80f600",130:"2257980a-3463-48c6-cbac-a42d2a956e00",10143:"0a728e83-bacb-46db-7844-948f05434900",100:"02b53f6a-e3d4-479e-1cb4-21178987d100",9001:"f926ff41-260d-4028-635e-91913fc28e00",324:"b310f07f-4ef7-49f3-7073-2a0a39685800",314:"5a73b3dd-af74-424e-cae0-0de859ee9400",4689:"34e68754-e536-40da-c153-6ef2e7188a00",1088:"3897a66d-40b9-4833-162f-a2c90531c900",1284:"161038da-44ae-4ec7-1208-0ea569454b00",1285:"f1d73bb6-5450-4e18-38f7-fb6484264a00",7777777:"845c60df-d429-4991-e687-91ae45791600",42220:"ab781bbc-ccc6-418d-d32d-789b15da1f00",8453:"7289c336-3981-4081-c5f4-efc26ac64a00",1313161554:"3ff73439-a619-4894-9262-4470c773a100",2020:"b8101fc0-9c19-4b6f-ec65-f6dfff106e00",2021:"b8101fc0-9c19-4b6f-ec65-f6dfff106e00",80094:"e329c2c9-59b0-4a02-83e4-212ff3779900",2741:"fc2427d1-5af9-4a9c-8da5-6f94627cd900","5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp":"a1b58899-f671-4276-6a5e-56ca5bd59700","4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z":"a1b58899-f671-4276-6a5e-56ca5bd59700",EtWTRABZaYq6iMfeYKouRu166VU2xqa1:"a1b58899-f671-4276-6a5e-56ca5bd59700","000000000019d6689c085ae165831e93":"0b4838db-0161-4ffe-022d-532bf03dba00","000000000933ea01ad0ee984209779ba":"39354064-d79b-420b-065d-f980c4b78200","00000008819873e925422c1ff0f99f7c":"b3406e4a-bbfc-44fb-e3a6-89673c78b700"}},bh={getCaipTokens(t){if(!t)return;const e={};return Object.entries(t).forEach(([r,n])=>{e[`${uo.EIP155}:${r}`]=n}),e},isLowerCaseMatch(t,e){return t?.toLowerCase()===e?.toLowerCase()},getActiveNamespaceConnectedToAuth(){const t=q.state.activeChain;return fe.AUTH_CONNECTOR_SUPPORTED_CHAINS.find(e=>ge.getConnectorId(e)===fe.CONNECTOR_ID.AUTH&&e===t)},withRetry({conditionFn:t,intervalMs:e,maxRetries:r}){let n=0;return new Promise(s=>{async function i(){return n+=1,await t()?s(!0):n>=r?s(!1):(setTimeout(i,e),null)}i()})},userChainIdToChainNamespace(t){if(typeof t=="number")return fe.CHAIN.EVM;const[e]=t.split(":");return e},getOtherAuthNamespaces(t){return t?fe.AUTH_CONNECTOR_SUPPORTED_CHAINS.filter(n=>n!==t):[]},getConnectorStorageInfo(t,e){const n=de.getConnections()[e]??[];return{hasDisconnected:de.isConnectorDisconnected(t,e),hasConnected:n.some(s=>bh.isLowerCaseMatch(s.connectorId,t))}}},uue=new AbortController,js={EmbeddedWalletAbortController:uue,UniversalProviderErrors:{UNAUTHORIZED_DOMAIN_NOT_ALLOWED:{message:"Unauthorized: origin not allowed",alertErrorKey:"ORIGIN_NOT_ALLOWED"},JWT_VALIDATION_ERROR:{message:"JWT validation error: JWT Token is not yet valid",alertErrorKey:"JWT_TOKEN_NOT_VALID"},INVALID_KEY:{message:"Unauthorized: invalid key",alertErrorKey:"INVALID_PROJECT_ID"}},ALERT_ERRORS:{SWITCH_NETWORK_NOT_FOUND:{code:"APKT001",displayMessage:"Network Not Found",debugMessage:"The specified network is not recognized. Please ensure it is included in the `networks` array of your `createAppKit` configuration."},ORIGIN_NOT_ALLOWED:{code:"APKT002",displayMessage:"Invalid App Configuration",debugMessage:()=>`The origin ${ad()?window.origin:"unknown"} is not in your allow list. Please update your allowed domains at https://dashboard.reown.com. [PID: ${te.state.projectId}]`},IFRAME_LOAD_FAILED:{code:"APKT003",displayMessage:"Network Error: Wallet Load Failed",debugMessage:()=>"Failed to load the embedded wallet. This may be due to network issues or server downtime. Please check your network connection and try again shortly. Contact support if the issue persists."},IFRAME_REQUEST_TIMEOUT:{code:"APKT004",displayMessage:"Wallet Request Timeout",debugMessage:()=>"The request to the embedded wallet timed out. Please check your network connection and try again shortly. Contact support if the issue persists."},UNVERIFIED_DOMAIN:{code:"APKT005",displayMessage:"Unverified Domain",debugMessage:()=>"Embedded wallet load failed. Ensure your domain is verified in https://dashboard.reown.com."},JWT_TOKEN_NOT_VALID:{code:"APKT006",displayMessage:"Session Expired",debugMessage:"Your session is invalid or expired. Please check your systems date and time settings, then reconnect."},INVALID_PROJECT_ID:{code:"APKT007",displayMessage:"Invalid Project ID",debugMessage:"The specified project ID is invalid. Please visit https://dashboard.reown.com to obtain a valid project ID."},PROJECT_ID_NOT_CONFIGURED:{code:"APKT008",displayMessage:"Project ID Missing",debugMessage:"No project ID is configured. You can create and configure a project ID at https://dashboard.reown.com."},SERVER_ERROR_APP_CONFIGURATION:{code:"APKT009",displayMessage:"Server Error",debugMessage:t=>`Unable to fetch App Configuration. ${t}. Please check your network connection and try again shortly. Contact support if the issue persists.`},RATE_LIMITED_APP_CONFIGURATION:{code:"APKT010",displayMessage:"Rate Limited",debugMessage:"You have been rate limited while retrieving App Configuration. Please wait a few minutes and try again. Contact support if the issue persists."}},ALERT_WARNINGS:{LOCAL_CONFIGURATION_IGNORED:{debugMessage:t=>`[Reown Config Notice] ${t}`},INACTIVE_NAMESPACE_NOT_CONNECTED:{code:"APKTW001",displayMessage:"Inactive Namespace Not Connected",debugMessage:(t,e)=>`An error occurred while connecting an inactive namespace ${t}: "${e}"`},INVALID_EMAIL:{code:"APKTW002",displayMessage:"Invalid Email Address",debugMessage:"Please enter a valid email address"}}},p6={TOKEN_ADDRESSES_BY_SYMBOL:{USDC:{8453:aue.asset,84532:cue.asset}},getTokenSymbolByAddress(t){if(!t)return;const[e]=Object.entries(p6.TOKEN_ADDRESSES_BY_SYMBOL).find(([r,n])=>Object.values(n).includes(t))??[];return e}};var rd={exports:{}},wI;function due(){if(wI)return rd.exports;wI=1;const t=x1();rd.exports=u;const e=k().console||{},r={mapHttpRequest:L,mapHttpResponse:L,wrapRequestSerializer:j,wrapResponseSerializer:j,wrapErrorSerializer:j,req:L,res:L,err:C,errWithCause:C};function n(f,m){return f==="silent"?1/0:m.levels.values[f]}const s=Symbol("pino.logFuncs"),i=Symbol("pino.hierarchy"),o={error:"log",fatal:"error",warn:"error",info:"log",debug:"log",trace:"log"};function a(f,m){const _={logger:m,parent:f[i]};m[i]=_}function c(f,m,_){const $={};m.forEach(x=>{$[x]=_[x]?_[x]:e[x]||e[o[x]||"log"]||D}),f[s]=$}function l(f,m){return Array.isArray(f)?f.filter(function($){return $!=="!stdSerializers.err"}):f===!0?Object.keys(m):!1}function u(f){f=f||{},f.browser=f.browser||{};const m=f.browser.transmit;if(m&&typeof m.send!="function")throw Error("pino: transmit option must have a send function");const _=f.browser.write||e;f.browser.write&&(f.browser.asObject=!0);const $=f.serializers||{},x=l(f.browser.serialize,$);let N=f.browser.serialize;Array.isArray(f.browser.serialize)&&f.browser.serialize.indexOf("!stdSerializers.err")>-1&&(N=!1);const H=Object.keys(f.customLevels||{}),z=["error","fatal","warn","info","debug","trace"].concat(H);typeof _=="function"&&z.forEach(function(se){_[se]=_}),(f.enabled===!1||f.browser.disabled)&&(f.level="silent");const G=f.level||"info",M=Object.create(_);M.log||(M.log=D),c(M,z,_),a({},M),Object.defineProperty(M,"levelVal",{get:J}),Object.defineProperty(M,"level",{get:re,set:ye});const V={transmit:m,serialize:x,asObject:f.browser.asObject,asObjectBindingsOnly:f.browser.asObjectBindingsOnly,formatters:f.browser.formatters,levels:z,timestamp:O(f),messageKey:f.messageKey||"msg",onChild:f.onChild||D};M.levels=d(f),M.level=G,M.isLevelEnabled=function(se){return this.levels.values[se]?this.levels.values[se]>=this.levels.values[this.level]:!1},M.setMaxListeners=M.getMaxListeners=M.emit=M.addListener=M.on=M.prependListener=M.once=M.prependOnceListener=M.removeListener=M.removeAllListeners=M.listeners=M.listenerCount=M.eventNames=M.write=M.flush=D,M.serializers=$,M._serialize=x,M._stdErrSerialize=N,M.child=function(...se){return ne.call(this,V,...se)},m&&(M._logEvent=v());function J(){return n(this.level,this)}function re(){return this._level}function ye(se){if(se!=="silent"&&!this.levels.values[se])throw Error("unknown level "+se);this._level=se,y(this,V,M,"error"),y(this,V,M,"fatal"),y(this,V,M,"warn"),y(this,V,M,"info"),y(this,V,M,"debug"),y(this,V,M,"trace"),H.forEach(Ie=>{y(this,V,M,Ie)})}function ne(se,Ie,Me){if(!Ie)throw new Error("missing bindings for child Pino");Me=Me||{},x&&Ie.serializers&&(Me.serializers=Ie.serializers);const Ve=Me.serializers;if(x&&Ve){var Ze=Object.assign({},$,Ve),Nt=f.browser.serialize===!0?Object.keys(Ze):x;delete Ie.serializers,A([Ie],Nt,Ze,this._stdErrSerialize)}function Br(Ir){this._childLevel=(Ir._childLevel|0)+1,this.bindings=Ie,Ze&&(this.serializers=Ze,this._serialize=Nt),m&&(this._logEvent=v([].concat(Ir._logEvent.bindings,Ie)))}Br.prototype=this;const sr=new Br(this);return a(this,sr),sr.child=function(...Ir){return ne.call(this,se,...Ir)},sr.level=Me.level||this.level,se.onChild(sr),sr}return M}function d(f){const m=f.customLevels||{},_=Object.assign({},u.levels.values,m),$=Object.assign({},u.levels.labels,h(m));return{values:_,labels:$}}function h(f){const m={};return Object.keys(f).forEach(function(_){m[f[_]]=_}),m}u.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},u.stdSerializers=r,u.stdTimeFunctions=Object.assign({},{nullTime:W,epochTime:P,unixTime:R,isoTime:T});function p(f){const m=[];f.bindings&&m.push(f.bindings);let _=f[i];for(;_.parent;)_=_.parent,_.logger.bindings&&m.push(_.logger.bindings);return m.reverse()}function y(f,m,_,$){if(Object.defineProperty(f,$,{value:n(f.level,_)>n($,_)?D:_[s][$],writable:!0,enumerable:!0,configurable:!0}),f[$]===D){if(!m.transmit)return;const N=m.transmit.level||f.level,H=n(N,_);if(n($,_)<H)return}f[$]=w(f,m,_,$);const x=p(f);x.length!==0&&(f[$]=g(x,f[$]))}function g(f,m){return function(){return m.apply(this,[...f,...arguments])}}function w(f,m,_,$){return(function(x){return function(){const H=m.timestamp(),z=new Array(arguments.length),G=Object.getPrototypeOf&&Object.getPrototypeOf(this)===e?e:this;for(var M=0;M<z.length;M++)z[M]=arguments[M];var V=!1;if(m.serialize&&(A(z,this._serialize,this.serializers,this._stdErrSerialize),V=!0),m.asObject||m.formatters?x.call(G,...S(this,$,z,H,m)):x.apply(G,z),m.transmit){const J=m.transmit.level||f._level,re=n(J,_),ye=n($,_);if(ye<re)return;E(this,{ts:H,methodLevel:$,methodValue:ye,transmitValue:_.levels.values[m.transmit.level||f._level],send:m.transmit.send,val:n(f._level,_)},z,V)}}})(f[s][$])}function S(f,m,_,$,x){const{level:N,log:H=J=>J}=x.formatters||{},z=_.slice();let G=z[0];const M={};let V=(f._childLevel|0)+1;if(V<1&&(V=1),$&&(M.time=$),N){const J=N(m,f.levels.values[m]);Object.assign(M,J)}else M.level=f.levels.values[m];if(x.asObjectBindingsOnly){if(G!==null&&typeof G=="object")for(;V--&&typeof z[0]=="object";)Object.assign(M,z.shift());return[H(M),...z]}else{if(G!==null&&typeof G=="object"){for(;V--&&typeof z[0]=="object";)Object.assign(M,z.shift());G=z.length?t(z.shift(),z):void 0}else typeof G=="string"&&(G=t(z.shift(),z));return G!==void 0&&(M[x.messageKey]=G),[H(M)]}}function A(f,m,_,$){for(const x in f)if($&&f[x]instanceof Error)f[x]=u.stdSerializers.err(f[x]);else if(typeof f[x]=="object"&&!Array.isArray(f[x])&&m)for(const N in f[x])m.indexOf(N)>-1&&N in _&&(f[x][N]=_[N](f[x][N]))}function E(f,m,_,$=!1){const x=m.send,N=m.ts,H=m.methodLevel,z=m.methodValue,G=m.val,M=f._logEvent.bindings;$||A(_,f._serialize||Object.keys(f.serializers),f.serializers,f._stdErrSerialize===void 0?!0:f._stdErrSerialize),f._logEvent.ts=N,f._logEvent.messages=_.filter(function(V){return M.indexOf(V)===-1}),f._logEvent.level.label=H,f._logEvent.level.value=z,x(H,f._logEvent,G),f._logEvent=v(M)}function v(f){return{ts:0,messages:[],bindings:f||[],level:{label:"",value:0}}}function C(f){const m={type:f.constructor.name,msg:f.message,stack:f.stack};for(const _ in f)m[_]===void 0&&(m[_]=f[_]);return m}function O(f){return typeof f.timestamp=="function"?f.timestamp:f.timestamp===!1?W:P}function L(){return{}}function j(f){return f}function D(){}function W(){return!1}function P(){return Date.now()}function R(){return Math.round(Date.now()/1e3)}function T(){return new Date(Date.now()).toISOString()}function k(){function f(m){return typeof m<"u"&&m}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return f(self)||f(window)||f(this)||{}}}return rd.exports.default=u,rd.exports.pino=u,rd.exports}var Il=due();const g6=Sh(Il),hue={level:"info"},Bv=1e3*1024;var fue=Object.defineProperty,pue=(t,e,r)=>e in t?fue(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,wa=(t,e,r)=>pue(t,typeof e!="symbol"?e+"":e,r);let gue=class{constructor(e){wa(this,"nodeValue"),wa(this,"sizeInBytes"),wa(this,"next"),this.nodeValue=e,this.sizeInBytes=new TextEncoder().encode(this.nodeValue).length,this.next=null}get value(){return this.nodeValue}get size(){return this.sizeInBytes}},bI=class{constructor(e){wa(this,"lengthInNodes"),wa(this,"sizeInBytes"),wa(this,"head"),wa(this,"tail"),wa(this,"maxSizeInBytes"),this.head=null,this.tail=null,this.lengthInNodes=0,this.maxSizeInBytes=e,this.sizeInBytes=0}append(e){const r=new gue(e);if(r.size>this.maxSizeInBytes)throw new Error(`[LinkedList] Value too big to insert into list: ${e} with size ${r.size}`);for(;this.size+r.size>this.maxSizeInBytes;)this.shift();this.head?(this.tail&&(this.tail.next=r),this.tail=r):(this.head=r,this.tail=r),this.lengthInNodes++,this.sizeInBytes+=r.size}shift(){if(!this.head)return;const e=this.head;this.head=this.head.next,this.head||(this.tail=null),this.lengthInNodes--,this.sizeInBytes-=e.size}toArray(){const e=[];let r=this.head;for(;r!==null;)e.push(r.value),r=r.next;return e}get length(){return this.lengthInNodes}get size(){return this.sizeInBytes}toOrderedArray(){return Array.from(this)}[Symbol.iterator](){let e=this.head;return{next:()=>{if(!e)return{done:!0,value:null};const r=e.value;return e=e.next,{done:!1,value:r}}}}};var yue=Object.defineProperty,mue=(t,e,r)=>e in t?yue(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Xf=(t,e,r)=>mue(t,typeof e!="symbol"?e+"":e,r);let y6=class{constructor(e,r=Bv){Xf(this,"logs"),Xf(this,"level"),Xf(this,"levelValue"),Xf(this,"MAX_LOG_SIZE_IN_BYTES"),this.level=e??"error",this.levelValue=Il.levels.values[this.level],this.MAX_LOG_SIZE_IN_BYTES=r,this.logs=new bI(this.MAX_LOG_SIZE_IN_BYTES)}forwardToConsole(e,r){r===Il.levels.values.error?console.error(e):r===Il.levels.values.warn?console.warn(e):r===Il.levels.values.debug?console.debug(e):r===Il.levels.values.trace?console.trace(e):console.log(e)}appendToLogs(e){this.logs.append(Bn({timestamp:new Date().toISOString(),log:e}));const r=typeof e=="string"?JSON.parse(e).level:e.level;r>=this.levelValue&&this.forwardToConsole(e,r)}getLogs(){return this.logs}clearLogs(){this.logs=new bI(this.MAX_LOG_SIZE_IN_BYTES)}getLogArray(){return Array.from(this.logs)}logsToBlob(e){const r=this.getLogArray();return r.push(Bn({extraMetadata:e})),new Blob(r,{type:"application/json"})}};var wue=Object.defineProperty,bue=(t,e,r)=>e in t?wue(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,vue=(t,e,r)=>bue(t,e+"",r);let Eue=class{constructor(e,r=Bv){vue(this,"baseChunkLogger"),this.baseChunkLogger=new y6(e,r)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}downloadLogsBlobInBrowser(e){const r=URL.createObjectURL(this.logsToBlob(e)),n=document.createElement("a");n.href=r,n.download=`walletconnect-logs-${new Date().toISOString()}.txt`,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(r)}};var _ue=Object.defineProperty,xue=(t,e,r)=>e in t?_ue(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Sue=(t,e,r)=>xue(t,e+"",r);let Aue=class{constructor(e,r=Bv){Sue(this,"baseChunkLogger"),this.baseChunkLogger=new y6(e,r)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}};var Iue=Object.defineProperty,Cue=Object.defineProperties,$ue=Object.getOwnPropertyDescriptors,vI=Object.getOwnPropertySymbols,Tue=Object.prototype.hasOwnProperty,Nue=Object.prototype.propertyIsEnumerable,EI=(t,e,r)=>e in t?Iue(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,_g=(t,e)=>{for(var r in e||(e={}))Tue.call(e,r)&&EI(t,r,e[r]);if(vI)for(var r of vI(e))Nue.call(e,r)&&EI(t,r,e[r]);return t},xg=(t,e)=>Cue(t,$ue(e));function Oue(t){return xg(_g({},t),{level:t?.level||hue.level})}function kue(t){var e,r;const n=new Eue((e=t.opts)==null?void 0:e.level,t.maxSizeInBytes);return{logger:g6(xg(_g({},t.opts),{level:"trace",browser:xg(_g({},(r=t.opts)==null?void 0:r.browser),{write:s=>n.write(s)})})),chunkLoggerController:n}}function Pue(t){var e;const r=new Aue((e=t.opts)==null?void 0:e.level,t.maxSizeInBytes);return{logger:g6(xg(_g({},t.opts),{level:"trace"}),r),chunkLoggerController:r}}function Rue(t){return typeof t.loggerOverride<"u"&&typeof t.loggerOverride!="string"?{logger:t.loggerOverride,chunkLoggerController:null}:typeof window<"u"?kue(t):Pue(t)}const Due={createLogger(t,e="error"){const r=Oue({level:e}),{logger:n}=Rue({opts:r});return n.error=(...s)=>{for(const i of s)if(i instanceof Error){t(i,...s);return}t(void 0,...s)},n}},Uue="rpc.walletconnect.org";function _I(t,e){const r=new URL("https://rpc.walletconnect.org/v1/");return r.searchParams.set("chainId",t),r.searchParams.set("projectId",e),r.toString()}const Fw=["near:mainnet","solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp","eip155:1101","eip155:56","eip155:42161","eip155:7777777","eip155:59144","eip155:324","solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1","eip155:5000","solana:4sgjmw1sunhzsxgspuhpqldx6wiyjntz","eip155:80084","eip155:5003","eip155:100","eip155:8453","eip155:42220","eip155:1313161555","eip155:17000","eip155:1","eip155:300","eip155:1313161554","eip155:1329","eip155:84532","eip155:421614","eip155:11155111","eip155:8217","eip155:43114","solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z","eip155:999999999","eip155:11155420","eip155:80002","eip155:97","eip155:43113","eip155:137","eip155:10","eip155:1301","eip155:80094","eip155:80069","eip155:560048","eip155:31","eip155:2818","eip155:57054","eip155:911867","eip155:534351","eip155:1112","eip155:534352","eip155:1111","eip155:146","eip155:130","eip155:1284","eip155:30","eip155:2810","bip122:000000000019d6689c085ae165831e93","bip122:000000000933ea01ad0ee984209779ba"],Cl={extendRpcUrlWithProjectId(t,e){let r=!1;try{r=new URL(t).host===Uue}catch{r=!1}if(r){const n=new URL(t);return n.searchParams.has("projectId")||n.searchParams.set("projectId",e),n.toString()}return t},isCaipNetwork(t){return"chainNamespace"in t&&"caipNetworkId"in t},getChainNamespace(t){return this.isCaipNetwork(t)?t.chainNamespace:fe.CHAIN.EVM},getCaipNetworkId(t){return this.isCaipNetwork(t)?t.caipNetworkId:`${fe.CHAIN.EVM}:${t.id}`},getDefaultRpcUrl(t,e,r){const n=t.rpcUrls?.default?.http?.[0];return Fw.includes(e)?_I(e,r):n||""},extendCaipNetwork(t,{customNetworkImageUrls:e,projectId:r,customRpcUrls:n}){const s=this.getChainNamespace(t),i=this.getCaipNetworkId(t),o=t.rpcUrls?.default?.http?.[0],a=this.getDefaultRpcUrl(t,i,r),c=t?.rpcUrls?.chainDefault?.http?.[0]||o,l=n?.[i]?.map(h=>h.url)||[],u=[...l,...a?[a]:[]],d=[...l];return c&&!d.includes(c)&&d.push(c),{...t,chainNamespace:s,caipNetworkId:i,assets:{imageId:lue.NetworkImageIds[t.id],imageUrl:e?.[t.id]},rpcUrls:{...t.rpcUrls,default:{http:u},chainDefault:{http:d}}}},extendCaipNetworks(t,{customNetworkImageUrls:e,projectId:r,customRpcUrls:n}){return t.map(s=>Cl.extendCaipNetwork(s,{customNetworkImageUrls:e,customRpcUrls:n,projectId:r}))},getViemTransport(t,e,r){const n=[];return r?.forEach(s=>{n.push(kf(s.url,s.config))}),Fw.includes(t.caipNetworkId)&&n.push(kf(_I(t.caipNetworkId,e),{fetchOptions:{headers:{"Content-Type":"text/plain"}}})),t?.rpcUrls?.default?.http?.forEach(s=>{n.push(kf(s))}),qx(n)},extendWagmiTransports(t,e,r){if(Fw.includes(t.caipNetworkId)){const n=this.getDefaultRpcUrl(t,t.caipNetworkId,e);return qx([r,kf(n)])}return r},getUnsupportedNetwork(t){return{id:t.split(":")[1],caipNetworkId:t,name:fe.UNSUPPORTED_NETWORK_NAME,chainNamespace:t.split(":")[0],nativeCurrency:{name:"",decimals:0,symbol:""},rpcUrls:{default:{http:[]}}}},getCaipNetworkFromStorage(t){const e=de.getActiveCaipNetworkId(),r=q.getAllRequestedCaipNetworks(),n=Array.from(q.state.chains?.keys()||[]),s=e?.split(":")[0],i=s?n.includes(s):!1,o=r?.find(c=>c.caipNetworkId===e);return i&&!o&&e?this.getUnsupportedNetwork(e):o||t||r?.[0]}},Bue={ACCOUNT_TABS:[{label:"Tokens"},{label:"Activity"}],VIEW_DIRECTION:{Next:"next",Prev:"prev"},DEFAULT_CONNECT_METHOD_ORDER:["email","social","wallet"],ANIMATION_DURATIONS:{HeaderText:120},VIEWS_WITH_LEGAL_FOOTER:["Connect","ConnectWallets","OnRampTokenSelect","OnRampFiatSelect","OnRampProviders"],VIEWS_WITH_DEFAULT_FOOTER:["Networks"]},dd={filterOutDuplicatesByRDNS(t){const e=te.state.enableEIP6963?ge.state.connectors:[],r=de.getRecentWallets(),n=e.map(a=>a.info?.rdns).filter(Boolean),s=r.map(a=>a.rdns).filter(Boolean),i=n.concat(s);if(i.includes("io.metamask.mobile")&&Ne.isMobile()){const a=i.indexOf("io.metamask.mobile");i[a]="io.metamask"}return t.filter(a=>!(a?.rdns&&i.includes(String(a.rdns))||!a?.rdns&&e.some(l=>l.name===a.name)))},filterOutDuplicatesByIds(t){const e=ge.state.connectors.filter(a=>a.type==="ANNOUNCED"||a.type==="INJECTED"),r=de.getRecentWallets(),n=e.map(a=>a.explorerId),s=r.map(a=>a.id),i=n.concat(s);return t.filter(a=>!i.includes(a?.id))},filterOutDuplicateWallets(t){const e=this.filterOutDuplicatesByRDNS(t);return this.filterOutDuplicatesByIds(e)},markWalletsAsInstalled(t){const{connectors:e}=ge.state,{featuredWalletIds:r}=te.state,n=e.filter(o=>o.type==="ANNOUNCED").reduce((o,a)=>(a.info?.rdns&&(o[a.info.rdns]=!0),o),{});return t.map(o=>({...o,installed:!!o.rdns&&!!n[o.rdns??""]})).sort((o,a)=>{const c=Number(a.installed)-Number(o.installed);if(c!==0)return c;if(r?.length){const l=r.indexOf(o.id),u=r.indexOf(a.id);if(l!==-1&&u!==-1)return l-u;if(l!==-1)return-1;if(u!==-1)return 1}return 0})},getConnectOrderMethod(t,e){const r=t?.connectMethodsOrder||te.state.features?.connectMethodsOrder,n=e||ge.state.connectors;if(r)return r;const{injected:s,announced:i}=qw.getConnectorsByType(n,Ue.state.recommended,Ue.state.featured),o=s.filter(qw.showConnector),a=i.filter(qw.showConnector);return o.length||a.length?["wallet","email","social"]:Bue.DEFAULT_CONNECT_METHOD_ORDER},isExcluded(t){const e=!!t.rdns&&Ue.state.excludedWallets.some(n=>n.rdns===t.rdns),r=!!t.name&&Ue.state.excludedWallets.some(n=>bh.isLowerCaseMatch(n.name,t.name));return e||r},markWalletsWithDisplayIndex(t){return t.map((e,r)=>({...e,display_index:r}))}},qw={getConnectorsByType(t,e,r){const{customWallets:n}=te.state,s=de.getRecentWallets(),i=dd.filterOutDuplicateWallets(e),o=dd.filterOutDuplicateWallets(r),a=t.filter(d=>d.type==="MULTI_CHAIN"),c=t.filter(d=>d.type==="ANNOUNCED"),l=t.filter(d=>d.type==="INJECTED"),u=t.filter(d=>d.type==="EXTERNAL");return{custom:n,recent:s,external:u,multiChain:a,announced:c,injected:l,recommended:i,featured:o}},showConnector(t){const e=t.info?.rdns,r=!!e&&Ue.state.excludedWallets.some(s=>!!s.rdns&&s.rdns===e),n=!!t.name&&Ue.state.excludedWallets.some(s=>bh.isLowerCaseMatch(s.name,t.name));return!(t.type==="INJECTED"&&(t.name==="Browser Wallet"&&(!Ne.isMobile()||Ne.isMobile()&&!e&&!Ee.checkInstalled())||r||n)||(t.type==="ANNOUNCED"||t.type==="EXTERNAL")&&(r||n))},getIsConnectedWithWC(){return Array.from(q.state.chains.values()).some(r=>ge.getConnectorId(r.namespace)===fe.CONNECTOR_ID.WALLET_CONNECT)},getConnectorTypeOrder({recommended:t,featured:e,custom:r,recent:n,announced:s,injected:i,multiChain:o,external:a,overriddenConnectors:c=te.state.features?.connectorTypeOrder??[]}){const u=[{type:"walletConnect",isEnabled:!0},{type:"recent",isEnabled:n.length>0},{type:"injected",isEnabled:[...i,...s,...o].length>0},{type:"featured",isEnabled:e.length>0},{type:"custom",isEnabled:r&&r.length>0},{type:"external",isEnabled:a.length>0},{type:"recommended",isEnabled:t.length>0}].filter(y=>y.isEnabled),d=new Set(u.map(y=>y.type)),h=c.filter(y=>d.has(y)).map(y=>({type:y,isEnabled:!0})),p=u.filter(({type:y})=>!h.some(({type:w})=>w===y));return Array.from(new Set([...h,...p].map(({type:y})=>y)))},sortConnectorsByExplorerWallet(t){return[...t].sort((e,r)=>e.explorerWallet&&r.explorerWallet?(e.explorerWallet.order??0)-(r.explorerWallet.order??0):e.explorerWallet?-1:r.explorerWallet?1:0)},getAuthName({email:t,socialUsername:e,socialProvider:r}){return e?r&&r==="discord"&&e.endsWith("0")?e.slice(0,-1):e:t.length>30?`${t.slice(0,-3)}...`:t},async fetchProviderData(t){try{if(t.name==="Browser Wallet"&&!Ne.isMobile())return{accounts:[],chainId:void 0};if(t.id===fe.CONNECTOR_ID.AUTH)return{accounts:[],chainId:void 0};const[e,r]=await Promise.all([t.provider?.request({method:"eth_accounts"}),t.provider?.request({method:"eth_chainId"}).then(n=>Number(n))]);return{accounts:e,chainId:r}}catch(e){return console.warn(`Failed to fetch provider data for ${t.name}`,e),{accounts:[],chainId:void 0}}},getFilteredCustomWallets(t){const e=de.getRecentWallets(),r=ge.state.connectors.map(o=>o.info?.rdns).filter(Boolean),n=e.map(o=>o.rdns).filter(Boolean),s=r.concat(n);if(s.includes("io.metamask.mobile")&&Ne.isMobile()){const o=s.indexOf("io.metamask.mobile");s[o]="io.metamask"}return t.filter(o=>!s.includes(String(o?.rdns)))},hasWalletConnector(t){return ge.state.connectors.some(e=>e.id===t.id||e.name===t.name)},isWalletCompatibleWithCurrentChain(t){const e=q.state.activeChain;return e&&t.chains?t.chains.some(r=>{const n=r.split(":")[0];return e===n}):!0},getFilteredRecentWallets(){return de.getRecentWallets().filter(r=>!dd.isExcluded(r)).filter(r=>!this.hasWalletConnector(r)).filter(r=>this.isWalletCompatibleWithCurrentChain(r))},getCappedRecommendedWallets(t){const{connectors:e}=ge.state,{customWallets:r,featuredWalletIds:n}=te.state,s=e.find(A=>A.id==="walletConnect"),i=e.filter(A=>A.type==="INJECTED"||A.type==="ANNOUNCED"||A.type==="MULTI_CHAIN");if(!s&&!i.length&&!r?.length)return[];const o=ab.isEmailEnabled(),a=ab.isSocialsEnabled(),c=i.filter(A=>A.name!=="Browser Wallet"),l=n?.length||0,u=r?.length||0,d=c.length||0,h=o?1:0,p=a?1:0,y=l+u+d+h+p,w=Math.max(0,4-y);return w<=0?[]:dd.filterOutDuplicateWallets(t).slice(0,w)}};const Ep=globalThis,Lv=Ep.ShadowRoot&&(Ep.ShadyCSS===void 0||Ep.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,Mv=Symbol(),xI=new WeakMap;let m6=class{constructor(e,r,n){if(this._$cssResult$=!0,n!==Mv)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this.t=r}get styleSheet(){let e=this.o;const r=this.t;if(Lv&&e===void 0){const n=r!==void 0&&r.length===1;n&&(e=xI.get(r)),e===void 0&&((this.o=e=new CSSStyleSheet).replaceSync(this.cssText),n&&xI.set(r,e))}return e}toString(){return this.cssText}};const di=t=>new m6(typeof t=="string"?t:t+"",void 0,Mv),ba=(t,...e)=>{const r=t.length===1?t[0]:e.reduce(((n,s,i)=>n+(o=>{if(o._$cssResult$===!0)return o.cssText;if(typeof o=="number")return o;throw Error("Value passed to 'css' function must be a 'css' function result: "+o+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(s)+t[i+1]),t[0]);return new m6(r,t,Mv)},Lue=(t,e)=>{if(Lv)t.adoptedStyleSheets=e.map((r=>r instanceof CSSStyleSheet?r:r.styleSheet));else for(const r of e){const n=document.createElement("style"),s=Ep.litNonce;s!==void 0&&n.setAttribute("nonce",s),n.textContent=r.cssText,t.appendChild(n)}},SI=Lv?t=>t:t=>t instanceof CSSStyleSheet?(e=>{let r="";for(const n of e.cssRules)r+=n.cssText;return di(r)})(t):t;const{is:Mue,defineProperty:jue,getOwnPropertyDescriptor:Fue,getOwnPropertyNames:que,getOwnPropertySymbols:zue,getPrototypeOf:Hue}=Object,_y=globalThis,AI=_y.trustedTypes,Wue=AI?AI.emptyScript:"",Vue=_y.reactiveElementPolyfillSupport,Id=(t,e)=>t,Kb={toAttribute(t,e){switch(e){case Boolean:t=t?Wue:null;break;case Object:case Array:t=t==null?t:JSON.stringify(t)}return t},fromAttribute(t,e){let r=t;switch(e){case Boolean:r=t!==null;break;case Number:r=t===null?null:Number(t);break;case Object:case Array:try{r=JSON.parse(t)}catch{r=null}}return r}},w6=(t,e)=>!Mue(t,e),II={attribute:!0,type:String,converter:Kb,reflect:!1,useDefault:!1,hasChanged:w6};Symbol.metadata??=Symbol("metadata"),_y.litPropertyMetadata??=new WeakMap;let $l=class extends HTMLElement{static addInitializer(e){this._$Ei(),(this.l??=[]).push(e)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(e,r=II){if(r.state&&(r.attribute=!1),this._$Ei(),this.prototype.hasOwnProperty(e)&&((r=Object.create(r)).wrapped=!0),this.elementProperties.set(e,r),!r.noAccessor){const n=Symbol(),s=this.getPropertyDescriptor(e,n,r);s!==void 0&&jue(this.prototype,e,s)}}static getPropertyDescriptor(e,r,n){const{get:s,set:i}=Fue(this.prototype,e)??{get(){return this[r]},set(o){this[r]=o}};return{get:s,set(o){const a=s?.call(this);i?.call(this,o),this.requestUpdate(e,a,n)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)??II}static _$Ei(){if(this.hasOwnProperty(Id("elementProperties")))return;const e=Hue(this);e.finalize(),e.l!==void 0&&(this.l=[...e.l]),this.elementProperties=new Map(e.elementProperties)}static finalize(){if(this.hasOwnProperty(Id("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(Id("properties"))){const r=this.properties,n=[...que(r),...zue(r)];for(const s of n)this.createProperty(s,r[s])}const e=this[Symbol.metadata];if(e!==null){const r=litPropertyMetadata.get(e);if(r!==void 0)for(const[n,s]of r)this.elementProperties.set(n,s)}this._$Eh=new Map;for(const[r,n]of this.elementProperties){const s=this._$Eu(r,n);s!==void 0&&this._$Eh.set(s,r)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(e){const r=[];if(Array.isArray(e)){const n=new Set(e.flat(1/0).reverse());for(const s of n)r.unshift(SI(s))}else e!==void 0&&r.push(SI(e));return r}static _$Eu(e,r){const n=r.attribute;return n===!1?void 0:typeof n=="string"?n:typeof e=="string"?e.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){this._$ES=new Promise((e=>this.enableUpdating=e)),this._$AL=new Map,this._$E_(),this.requestUpdate(),this.constructor.l?.forEach((e=>e(this)))}addController(e){(this._$EO??=new Set).add(e),this.renderRoot!==void 0&&this.isConnected&&e.hostConnected?.()}removeController(e){this._$EO?.delete(e)}_$E_(){const e=new Map,r=this.constructor.elementProperties;for(const n of r.keys())this.hasOwnProperty(n)&&(e.set(n,this[n]),delete this[n]);e.size>0&&(this._$Ep=e)}createRenderRoot(){const e=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return Lue(e,this.constructor.elementStyles),e}connectedCallback(){this.renderRoot??=this.createRenderRoot(),this.enableUpdating(!0),this._$EO?.forEach((e=>e.hostConnected?.()))}enableUpdating(e){}disconnectedCallback(){this._$EO?.forEach((e=>e.hostDisconnected?.()))}attributeChangedCallback(e,r,n){this._$AK(e,n)}_$ET(e,r){const n=this.constructor.elementProperties.get(e),s=this.constructor._$Eu(e,n);if(s!==void 0&&n.reflect===!0){const i=(n.converter?.toAttribute!==void 0?n.converter:Kb).toAttribute(r,n.type);this._$Em=e,i==null?this.removeAttribute(s):this.setAttribute(s,i),this._$Em=null}}_$AK(e,r){const n=this.constructor,s=n._$Eh.get(e);if(s!==void 0&&this._$Em!==s){const i=n.getPropertyOptions(s),o=typeof i.converter=="function"?{fromAttribute:i.converter}:i.converter?.fromAttribute!==void 0?i.converter:Kb;this._$Em=s;const a=o.fromAttribute(r,i.type);this[s]=a??this._$Ej?.get(s)??a,this._$Em=null}}requestUpdate(e,r,n){if(e!==void 0){const s=this.constructor,i=this[e];if(n??=s.getPropertyOptions(e),!((n.hasChanged??w6)(i,r)||n.useDefault&&n.reflect&&i===this._$Ej?.get(e)&&!this.hasAttribute(s._$Eu(e,n))))return;this.C(e,r,n)}this.isUpdatePending===!1&&(this._$ES=this._$EP())}C(e,r,{useDefault:n,reflect:s,wrapped:i},o){n&&!(this._$Ej??=new Map).has(e)&&(this._$Ej.set(e,o??r??this[e]),i!==!0||o!==void 0)||(this._$AL.has(e)||(this.hasUpdated||n||(r=void 0),this._$AL.set(e,r)),s===!0&&this._$Em!==e&&(this._$Eq??=new Set).add(e))}async _$EP(){this.isUpdatePending=!0;try{await this._$ES}catch(r){Promise.reject(r)}const e=this.scheduleUpdate();return e!=null&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??=this.createRenderRoot(),this._$Ep){for(const[s,i]of this._$Ep)this[s]=i;this._$Ep=void 0}const n=this.constructor.elementProperties;if(n.size>0)for(const[s,i]of n){const{wrapped:o}=i,a=this[s];o!==!0||this._$AL.has(s)||a===void 0||this.C(s,void 0,i,a)}}let e=!1;const r=this._$AL;try{e=this.shouldUpdate(r),e?(this.willUpdate(r),this._$EO?.forEach((n=>n.hostUpdate?.())),this.update(r)):this._$EM()}catch(n){throw e=!1,this._$EM(),n}e&&this._$AE(r)}willUpdate(e){}_$AE(e){this._$EO?.forEach((r=>r.hostUpdated?.())),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$EM(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(e){return!0}update(e){this._$Eq&&=this._$Eq.forEach((r=>this._$ET(r,this[r]))),this._$EM()}updated(e){}firstUpdated(e){}};$l.elementStyles=[],$l.shadowRootOptions={mode:"open"},$l[Id("elementProperties")]=new Map,$l[Id("finalized")]=new Map,Vue?.({ReactiveElement:$l}),(_y.reactiveElementVersions??=[]).push("2.1.1");const jv=globalThis,Sg=jv.trustedTypes,CI=Sg?Sg.createPolicy("lit-html",{createHTML:t=>t}):void 0,b6="$lit$",va=`lit$${Math.random().toFixed(9).slice(2)}$`,v6="?"+va,Kue=`<${v6}>`,Fc=document,vh=()=>Fc.createComment(""),Eh=t=>t===null||typeof t!="object"&&typeof t!="function",Fv=Array.isArray,Gue=t=>Fv(t)||typeof t?.[Symbol.iterator]=="function",zw=`[ 	
\f\r]`,nd=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,$I=/-->/g,TI=/>/g,Qa=RegExp(`>|${zw}(?:([^\\s"'>=/]+)(${zw}*=${zw}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),NI=/'/g,OI=/"/g,E6=/^(?:script|style|textarea|title)$/i,_6=t=>(e,...r)=>({_$litType$:t,strings:e,values:r}),Tpe=_6(1),Npe=_6(2),lu=Symbol.for("lit-noChange"),Gr=Symbol.for("lit-nothing"),kI=new WeakMap,xc=Fc.createTreeWalker(Fc,129);function x6(t,e){if(!Fv(t)||!t.hasOwnProperty("raw"))throw Error("invalid template strings array");return CI!==void 0?CI.createHTML(e):e}const Yue=(t,e)=>{const r=t.length-1,n=[];let s,i=e===2?"<svg>":e===3?"<math>":"",o=nd;for(let a=0;a<r;a++){const c=t[a];let l,u,d=-1,h=0;for(;h<c.length&&(o.lastIndex=h,u=o.exec(c),u!==null);)h=o.lastIndex,o===nd?u[1]==="!--"?o=$I:u[1]!==void 0?o=TI:u[2]!==void 0?(E6.test(u[2])&&(s=RegExp("</"+u[2],"g")),o=Qa):u[3]!==void 0&&(o=Qa):o===Qa?u[0]===">"?(o=s??nd,d=-1):u[1]===void 0?d=-2:(d=o.lastIndex-u[2].length,l=u[1],o=u[3]===void 0?Qa:u[3]==='"'?OI:NI):o===OI||o===NI?o=Qa:o===$I||o===TI?o=nd:(o=Qa,s=void 0);const p=o===Qa&&t[a+1].startsWith("/>")?" ":"";i+=o===nd?c+Kue:d>=0?(n.push(l),c.slice(0,d)+b6+c.slice(d)+va+p):c+va+(d===-2?a:p)}return[x6(t,i+(t[r]||"<?>")+(e===2?"</svg>":e===3?"</math>":"")),n]};class _h{constructor({strings:e,_$litType$:r},n){let s;this.parts=[];let i=0,o=0;const a=e.length-1,c=this.parts,[l,u]=Yue(e,r);if(this.el=_h.createElement(l,n),xc.currentNode=this.el.content,r===2||r===3){const d=this.el.content.firstChild;d.replaceWith(...d.childNodes)}for(;(s=xc.nextNode())!==null&&c.length<a;){if(s.nodeType===1){if(s.hasAttributes())for(const d of s.getAttributeNames())if(d.endsWith(b6)){const h=u[o++],p=s.getAttribute(d).split(va),y=/([.?@])?(.*)/.exec(h);c.push({type:1,index:i,name:y[2],strings:p,ctor:y[1]==="."?Zue:y[1]==="?"?Jue:y[1]==="@"?Que:xy}),s.removeAttribute(d)}else d.startsWith(va)&&(c.push({type:6,index:i}),s.removeAttribute(d));if(E6.test(s.tagName)){const d=s.textContent.split(va),h=d.length-1;if(h>0){s.textContent=Sg?Sg.emptyScript:"";for(let p=0;p<h;p++)s.append(d[p],vh()),xc.nextNode(),c.push({type:2,index:++i});s.append(d[h],vh())}}}else if(s.nodeType===8)if(s.data===v6)c.push({type:2,index:i});else{let d=-1;for(;(d=s.data.indexOf(va,d+1))!==-1;)c.push({type:7,index:i}),d+=va.length-1}i++}}static createElement(e,r){const n=Fc.createElement("template");return n.innerHTML=e,n}}function uu(t,e,r=t,n){if(e===lu)return e;let s=n!==void 0?r._$Co?.[n]:r._$Cl;const i=Eh(e)?void 0:e._$litDirective$;return s?.constructor!==i&&(s?._$AO?.(!1),i===void 0?s=void 0:(s=new i(t),s._$AT(t,r,n)),n!==void 0?(r._$Co??=[])[n]=s:r._$Cl=s),s!==void 0&&(e=uu(t,s._$AS(t,e.values),s,n)),e}class Xue{constructor(e,r){this._$AV=[],this._$AN=void 0,this._$AD=e,this._$AM=r}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(e){const{el:{content:r},parts:n}=this._$AD,s=(e?.creationScope??Fc).importNode(r,!0);xc.currentNode=s;let i=xc.nextNode(),o=0,a=0,c=n[0];for(;c!==void 0;){if(o===c.index){let l;c.type===2?l=new Qh(i,i.nextSibling,this,e):c.type===1?l=new c.ctor(i,c.name,c.strings,this,e):c.type===6&&(l=new ede(i,this,e)),this._$AV.push(l),c=n[++a]}o!==c?.index&&(i=xc.nextNode(),o++)}return xc.currentNode=Fc,s}p(e){let r=0;for(const n of this._$AV)n!==void 0&&(n.strings!==void 0?(n._$AI(e,n,r),r+=n.strings.length-2):n._$AI(e[r])),r++}}class Qh{get _$AU(){return this._$AM?._$AU??this._$Cv}constructor(e,r,n,s){this.type=2,this._$AH=Gr,this._$AN=void 0,this._$AA=e,this._$AB=r,this._$AM=n,this.options=s,this._$Cv=s?.isConnected??!0}get parentNode(){let e=this._$AA.parentNode;const r=this._$AM;return r!==void 0&&e?.nodeType===11&&(e=r.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,r=this){e=uu(this,e,r),Eh(e)?e===Gr||e==null||e===""?(this._$AH!==Gr&&this._$AR(),this._$AH=Gr):e!==this._$AH&&e!==lu&&this._(e):e._$litType$!==void 0?this.$(e):e.nodeType!==void 0?this.T(e):Gue(e)?this.k(e):this._(e)}O(e){return this._$AA.parentNode.insertBefore(e,this._$AB)}T(e){this._$AH!==e&&(this._$AR(),this._$AH=this.O(e))}_(e){this._$AH!==Gr&&Eh(this._$AH)?this._$AA.nextSibling.data=e:this.T(Fc.createTextNode(e)),this._$AH=e}$(e){const{values:r,_$litType$:n}=e,s=typeof n=="number"?this._$AC(e):(n.el===void 0&&(n.el=_h.createElement(x6(n.h,n.h[0]),this.options)),n);if(this._$AH?._$AD===s)this._$AH.p(r);else{const i=new Xue(s,this),o=i.u(this.options);i.p(r),this.T(o),this._$AH=i}}_$AC(e){let r=kI.get(e.strings);return r===void 0&&kI.set(e.strings,r=new _h(e)),r}k(e){Fv(this._$AH)||(this._$AH=[],this._$AR());const r=this._$AH;let n,s=0;for(const i of e)s===r.length?r.push(n=new Qh(this.O(vh()),this.O(vh()),this,this.options)):n=r[s],n._$AI(i),s++;s<r.length&&(this._$AR(n&&n._$AB.nextSibling,s),r.length=s)}_$AR(e=this._$AA.nextSibling,r){for(this._$AP?.(!1,!0,r);e!==this._$AB;){const n=e.nextSibling;e.remove(),e=n}}setConnected(e){this._$AM===void 0&&(this._$Cv=e,this._$AP?.(e))}}class xy{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(e,r,n,s,i){this.type=1,this._$AH=Gr,this._$AN=void 0,this.element=e,this.name=r,this._$AM=s,this.options=i,n.length>2||n[0]!==""||n[1]!==""?(this._$AH=Array(n.length-1).fill(new String),this.strings=n):this._$AH=Gr}_$AI(e,r=this,n,s){const i=this.strings;let o=!1;if(i===void 0)e=uu(this,e,r,0),o=!Eh(e)||e!==this._$AH&&e!==lu,o&&(this._$AH=e);else{const a=e;let c,l;for(e=i[0],c=0;c<i.length-1;c++)l=uu(this,a[n+c],r,c),l===lu&&(l=this._$AH[c]),o||=!Eh(l)||l!==this._$AH[c],l===Gr?e=Gr:e!==Gr&&(e+=(l??"")+i[c+1]),this._$AH[c]=l}o&&!s&&this.j(e)}j(e){e===Gr?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,e??"")}}class Zue extends xy{constructor(){super(...arguments),this.type=3}j(e){this.element[this.name]=e===Gr?void 0:e}}class Jue extends xy{constructor(){super(...arguments),this.type=4}j(e){this.element.toggleAttribute(this.name,!!e&&e!==Gr)}}class Que extends xy{constructor(e,r,n,s,i){super(e,r,n,s,i),this.type=5}_$AI(e,r=this){if((e=uu(this,e,r,0)??Gr)===lu)return;const n=this._$AH,s=e===Gr&&n!==Gr||e.capture!==n.capture||e.once!==n.once||e.passive!==n.passive,i=e!==Gr&&(n===Gr||s);s&&this.element.removeEventListener(this.name,this,n),i&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){typeof this._$AH=="function"?this._$AH.call(this.options?.host??this.element,e):this._$AH.handleEvent(e)}}class ede{constructor(e,r,n){this.element=e,this.type=6,this._$AN=void 0,this._$AM=r,this.options=n}get _$AU(){return this._$AM._$AU}_$AI(e){uu(this,e)}}const tde=jv.litHtmlPolyfillSupport;tde?.(_h,Qh),(jv.litHtmlVersions??=[]).push("3.3.1");const rde=(t,e,r)=>{const n=r?.renderBefore??e;let s=n._$litPart$;if(s===void 0){const i=r?.renderBefore??null;n._$litPart$=s=new Qh(e.insertBefore(vh(),i),i,void 0,r??{})}return s._$AI(t),s};const qv=globalThis;class _p extends $l{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){const e=super.createRenderRoot();return this.renderOptions.renderBefore??=e.firstChild,e}update(e){const r=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(e),this._$Do=rde(r,this.renderRoot,this.renderOptions)}connectedCallback(){super.connectedCallback(),this._$Do?.setConnected(!0)}disconnectedCallback(){super.disconnectedCallback(),this._$Do?.setConnected(!1)}render(){return lu}}_p._$litElement$=!0,_p.finalized=!0,qv.litElementHydrateSupport?.({LitElement:_p});const nde=qv.litElementPolyfillSupport;nde?.({LitElement:_p});(qv.litElementVersions??=[]).push("4.2.1");const sde={black:"#202020",white:"#FFFFFF",white010:"rgba(255, 255, 255, 0.1)",accent010:"rgba(9, 136, 240, 0.1)",accent020:"rgba(9, 136, 240, 0.2)",accent030:"rgba(9, 136, 240, 0.3)",accent040:"rgba(9, 136, 240, 0.4)",accent050:"rgba(9, 136, 240, 0.5)",accent060:"rgba(9, 136, 240, 0.6)",accent070:"rgba(9, 136, 240, 0.7)",accent080:"rgba(9, 136, 240, 0.8)",accent090:"rgba(9, 136, 240, 0.9)",accent100:"rgba(9, 136, 240, 1.0)",accentSecondary010:"rgba(199, 185, 148, 0.1)",accentSecondary020:"rgba(199, 185, 148, 0.2)",accentSecondary030:"rgba(199, 185, 148, 0.3)",accentSecondary040:"rgba(199, 185, 148, 0.4)",accentSecondary050:"rgba(199, 185, 148, 0.5)",accentSecondary060:"rgba(199, 185, 148, 0.6)",accentSecondary070:"rgba(199, 185, 148, 0.7)",accentSecondary080:"rgba(199, 185, 148, 0.8)",accentSecondary090:"rgba(199, 185, 148, 0.9)",accentSecondary100:"rgba(199, 185, 148, 1.0)",productWalletKit:"#FFB800",productAppKit:"#FF573B",productCloud:"#0988F0",productDocumentation:"#008847",neutrals050:"#F6F6F6",neutrals100:"#F3F3F3",neutrals200:"#E9E9E9",neutrals300:"#D0D0D0",neutrals400:"#BBB",neutrals500:"#9A9A9A",neutrals600:"#6C6C6C",neutrals700:"#4F4F4F",neutrals800:"#363636",neutrals900:"#2A2A2A",neutrals1000:"#252525",semanticSuccess010:"rgba(48, 164, 107, 0.1)",semanticSuccess020:"rgba(48, 164, 107, 0.2)",semanticSuccess030:"rgba(48, 164, 107, 0.3)",semanticSuccess040:"rgba(48, 164, 107, 0.4)",semanticSuccess050:"rgba(48, 164, 107, 0.5)",semanticSuccess060:"rgba(48, 164, 107, 0.6)",semanticSuccess070:"rgba(48, 164, 107, 0.7)",semanticSuccess080:"rgba(48, 164, 107, 0.8)",semanticSuccess090:"rgba(48, 164, 107, 0.9)",semanticSuccess100:"rgba(48, 164, 107, 1.0)",semanticError010:"rgba(223, 74, 52, 0.1)",semanticError020:"rgba(223, 74, 52, 0.2)",semanticError030:"rgba(223, 74, 52, 0.3)",semanticError040:"rgba(223, 74, 52, 0.4)",semanticError050:"rgba(223, 74, 52, 0.5)",semanticError060:"rgba(223, 74, 52, 0.6)",semanticError070:"rgba(223, 74, 52, 0.7)",semanticError080:"rgba(223, 74, 52, 0.8)",semanticError090:"rgba(223, 74, 52, 0.9)",semanticError100:"rgba(223, 74, 52, 1.0)",semanticWarning010:"rgba(243, 161, 63, 0.1)",semanticWarning020:"rgba(243, 161, 63, 0.2)",semanticWarning030:"rgba(243, 161, 63, 0.3)",semanticWarning040:"rgba(243, 161, 63, 0.4)",semanticWarning050:"rgba(243, 161, 63, 0.5)",semanticWarning060:"rgba(243, 161, 63, 0.6)",semanticWarning070:"rgba(243, 161, 63, 0.7)",semanticWarning080:"rgba(243, 161, 63, 0.8)",semanticWarning090:"rgba(243, 161, 63, 0.9)",semanticWarning100:"rgba(243, 161, 63, 1.0)"},Ag={core:{backgroundAccentPrimary:"#0988F0",backgroundAccentCertified:"#C7B994",backgroundWalletKit:"#FFB800",backgroundAppKit:"#FF573B",backgroundCloud:"#0988F0",backgroundDocumentation:"#008847",backgroundSuccess:"rgba(48, 164, 107, 0.20)",backgroundError:"rgba(223, 74, 52, 0.20)",backgroundWarning:"rgba(243, 161, 63, 0.20)",textAccentPrimary:"#0988F0",textAccentCertified:"#C7B994",textWalletKit:"#FFB800",textAppKit:"#FF573B",textCloud:"#0988F0",textDocumentation:"#008847",textSuccess:"#30A46B",textError:"#DF4A34",textWarning:"#F3A13F",borderAccentPrimary:"#0988F0",borderSecondary:"#C7B994",borderSuccess:"#30A46B",borderError:"#DF4A34",borderWarning:"#F3A13F",foregroundAccent010:"rgba(9, 136, 240, 0.1)",foregroundAccent020:"rgba(9, 136, 240, 0.2)",foregroundAccent040:"rgba(9, 136, 240, 0.4)",foregroundAccent060:"rgba(9, 136, 240, 0.6)",foregroundSecondary020:"rgba(199, 185, 148, 0.2)",foregroundSecondary040:"rgba(199, 185, 148, 0.4)",foregroundSecondary060:"rgba(199, 185, 148, 0.6)",iconAccentPrimary:"#0988F0",iconAccentCertified:"#C7B994",iconSuccess:"#30A46B",iconError:"#DF4A34",iconWarning:"#F3A13F",glass010:"rgba(255, 255, 255, 0.1)",zIndex:"9999"},dark:{overlay:"rgba(0, 0, 0, 0.50)",backgroundPrimary:"#202020",backgroundInvert:"#FFFFFF",textPrimary:"#FFFFFF",textSecondary:"#9A9A9A",textTertiary:"#BBBBBB",textInvert:"#202020",borderPrimary:"#2A2A2A",borderPrimaryDark:"#363636",borderSecondary:"#4F4F4F",foregroundPrimary:"#252525",foregroundSecondary:"#2A2A2A",foregroundTertiary:"#363636",iconDefault:"#9A9A9A",iconInverse:"#FFFFFF"},light:{overlay:"rgba(230 , 230, 230, 0.5)",backgroundPrimary:"#FFFFFF",borderPrimaryDark:"#E9E9E9",backgroundInvert:"#202020",textPrimary:"#202020",textSecondary:"#9A9A9A",textTertiary:"#6C6C6C",textInvert:"#FFFFFF",borderPrimary:"#E9E9E9",borderSecondary:"#D0D0D0",foregroundPrimary:"#F3F3F3",foregroundSecondary:"#E9E9E9",foregroundTertiary:"#D0D0D0",iconDefault:"#9A9A9A",iconInverse:"#202020"}},ide={1:"4px",2:"8px",10:"10px",3:"12px",4:"16px",6:"24px",5:"20px",8:"32px",16:"64px",20:"80px",32:"128px",64:"256px",128:"512px",round:"9999px"},ode={0:"0px","01":"2px",1:"4px",2:"8px",3:"12px",4:"16px",5:"20px",6:"24px",7:"28px",8:"32px",9:"36px",10:"40px",12:"48px",14:"56px",16:"64px",20:"80px",32:"128px",64:"256px"},ade={regular:"KHTeka",mono:"KHTekaMono"},cde={regular:"400",medium:"500"},lde={h1:"50px",h2:"44px",h3:"38px",h4:"32px",h5:"26px",h6:"20px",large:"16px",medium:"14px",small:"12px"},ude={"h1-regular-mono":{lineHeight:"50px",letterSpacing:"-3px"},"h1-regular":{lineHeight:"50px",letterSpacing:"-1px"},"h1-medium":{lineHeight:"50px",letterSpacing:"-0.84px"},"h2-regular-mono":{lineHeight:"44px",letterSpacing:"-2.64px"},"h2-regular":{lineHeight:"44px",letterSpacing:"-0.88px"},"h2-medium":{lineHeight:"44px",letterSpacing:"-0.88px"},"h3-regular-mono":{lineHeight:"38px",letterSpacing:"-2.28px"},"h3-regular":{lineHeight:"38px",letterSpacing:"-0.76px"},"h3-medium":{lineHeight:"38px",letterSpacing:"-0.76px"},"h4-regular-mono":{lineHeight:"32px",letterSpacing:"-1.92px"},"h4-regular":{lineHeight:"32px",letterSpacing:"-0.32px"},"h4-medium":{lineHeight:"32px",letterSpacing:"-0.32px"},"h5-regular-mono":{lineHeight:"26px",letterSpacing:"-1.56px"},"h5-regular":{lineHeight:"26px",letterSpacing:"-0.26px"},"h5-medium":{lineHeight:"26px",letterSpacing:"-0.26px"},"h6-regular-mono":{lineHeight:"20px",letterSpacing:"-1.2px"},"h6-regular":{lineHeight:"20px",letterSpacing:"-0.6px"},"h6-medium":{lineHeight:"20px",letterSpacing:"-0.6px"},"lg-regular-mono":{lineHeight:"16px",letterSpacing:"-0.96px"},"lg-regular":{lineHeight:"18px",letterSpacing:"-0.16px"},"lg-medium":{lineHeight:"18px",letterSpacing:"-0.16px"},"md-regular-mono":{lineHeight:"14px",letterSpacing:"-0.84px"},"md-regular":{lineHeight:"16px",letterSpacing:"-0.14px"},"md-medium":{lineHeight:"16px",letterSpacing:"-0.14px"},"sm-regular-mono":{lineHeight:"12px",letterSpacing:"-0.72px"},"sm-regular":{lineHeight:"14px",letterSpacing:"-0.12px"},"sm-medium":{lineHeight:"14px",letterSpacing:"-0.12px"}},dde={"ease-out-power-2":"cubic-bezier(0.23, 0.09, 0.08, 1.13)","ease-out-power-1":"cubic-bezier(0.12, 0.04, 0.2, 1.06)","ease-in-power-2":"cubic-bezier(0.92, -0.13, 0.77, 0.91)","ease-in-power-1":"cubic-bezier(0.88, -0.06, 0.8, 0.96)","ease-inout-power-2":"cubic-bezier(0.77, 0.09, 0.23, 1.13)","ease-inout-power-1":"cubic-bezier(0.88, 0.04, 0.12, 1.06)"},hde={xl:"400ms",lg:"200ms",md:"125ms",sm:"75ms"},Gb={colors:sde,fontFamily:ade,fontWeight:cde,textSize:lde,typography:ude,tokens:{core:Ag.core,theme:Ag.dark},borderRadius:ide,spacing:ode,durations:hde,easings:dde},PI="--apkt",go={createCSSVariables(t){const e={},r={};function n(i,o,a=""){for(const[c,l]of Object.entries(i)){const u=a?`${a}-${c}`:c;l&&typeof l=="object"&&Object.keys(l).length?(o[c]={},n(l,o[c],u)):typeof l=="string"&&(o[c]=`${PI}-${u}`)}}function s(i,o){for(const[a,c]of Object.entries(i))c&&typeof c=="object"?(o[a]={},s(c,o[a])):typeof c=="string"&&(o[a]=`var(${c})`)}return n(t,e),s(e,r),{cssVariables:e,cssVariablesVarPrefix:r}},assignCSSVariables(t,e){const r={};function n(s,i,o){for(const[a,c]of Object.entries(s)){const l=o?`${o}-${a}`:a,u=i[a];c&&typeof c=="object"?n(c,u,l):typeof u=="string"&&(r[`${PI}-${l}`]=u)}}return n(t,e),r},createRootStyles(t,e){const r={...Gb,tokens:{...Gb.tokens,theme:t==="light"?Ag.light:Ag.dark}},{cssVariables:n}=go.createCSSVariables(r),s=go.assignCSSVariables(n,r),i=go.generateW3MVariables(e),o=go.generateW3MOverrides(e),a=go.generateScaledVariables(e),c=go.generateBaseVariables(s),l={...s,...c,...i,...o,...a},u=go.applyColorMixToVariables(e,l),d={...l,...u};return`:root {${Object.entries(d).map(([p,y])=>`${p}:${y.replace("/[:;{}</>]/g","")};`).join("")}}`},generateW3MVariables(t){if(!t)return{};const e={};return e["--w3m-font-family"]=t["--w3m-font-family"]||"KHTeka",e["--w3m-accent"]=t["--w3m-accent"]||"#0988F0",e["--w3m-color-mix"]=t["--w3m-color-mix"]||"#000",e["--w3m-color-mix-strength"]=`${t["--w3m-color-mix-strength"]||0}%`,e["--w3m-font-size-master"]=t["--w3m-font-size-master"]||"10px",e["--w3m-border-radius-master"]=t["--w3m-border-radius-master"]||"4px",e},generateW3MOverrides(t){if(!t)return{};const e={};if(t["--w3m-accent"]){const r=t["--w3m-accent"];e["--apkt-tokens-core-iconAccentPrimary"]=r,e["--apkt-tokens-core-borderAccentPrimary"]=r,e["--apkt-tokens-core-textAccentPrimary"]=r,e["--apkt-tokens-core-backgroundAccentPrimary"]=r}return t["--w3m-font-family"]&&(e["--apkt-fontFamily-regular"]=t["--w3m-font-family"]),t["--w3m-z-index"]&&(e["--apkt-tokens-core-zIndex"]=`${t["--w3m-z-index"]}`),e},generateScaledVariables(t){if(!t)return{};const e={};if(t["--w3m-font-size-master"]){const r=parseFloat(t["--w3m-font-size-master"].replace("px",""));e["--apkt-textSize-h1"]=`${Number(r)*5}px`,e["--apkt-textSize-h2"]=`${Number(r)*4.4}px`,e["--apkt-textSize-h3"]=`${Number(r)*3.8}px`,e["--apkt-textSize-h4"]=`${Number(r)*3.2}px`,e["--apkt-textSize-h5"]=`${Number(r)*2.6}px`,e["--apkt-textSize-h6"]=`${Number(r)*2}px`,e["--apkt-textSize-large"]=`${Number(r)*1.6}px`,e["--apkt-textSize-medium"]=`${Number(r)*1.4}px`,e["--apkt-textSize-small"]=`${Number(r)*1.2}px`}if(t["--w3m-border-radius-master"]){const r=parseFloat(t["--w3m-border-radius-master"].replace("px",""));e["--apkt-borderRadius-1"]=`${Number(r)}px`,e["--apkt-borderRadius-2"]=`${Number(r)*2}px`,e["--apkt-borderRadius-3"]=`${Number(r)*3}px`,e["--apkt-borderRadius-4"]=`${Number(r)*4}px`,e["--apkt-borderRadius-5"]=`${Number(r)*5}px`,e["--apkt-borderRadius-6"]=`${Number(r)*6}px`,e["--apkt-borderRadius-8"]=`${Number(r)*8}px`,e["--apkt-borderRadius-16"]=`${Number(r)*16}px`,e["--apkt-borderRadius-20"]=`${Number(r)*20}px`,e["--apkt-borderRadius-32"]=`${Number(r)*32}px`,e["--apkt-borderRadius-64"]=`${Number(r)*64}px`,e["--apkt-borderRadius-128"]=`${Number(r)*128}px`}return e},generateColorMixCSS(t,e){if(!t?.["--w3m-color-mix"]||!t["--w3m-color-mix-strength"])return"";const r=t["--w3m-color-mix"],n=t["--w3m-color-mix-strength"];if(!n||n===0)return"";const s=Object.keys(e||{}).filter(o=>{const a=o.includes("-tokens-core-background")||o.includes("-tokens-core-text")||o.includes("-tokens-core-border")||o.includes("-tokens-core-foreground")||o.includes("-tokens-core-icon")||o.includes("-tokens-theme-background")||o.includes("-tokens-theme-text")||o.includes("-tokens-theme-border")||o.includes("-tokens-theme-foreground")||o.includes("-tokens-theme-icon"),c=o.includes("-borderRadius-")||o.includes("-spacing-")||o.includes("-textSize-")||o.includes("-fontFamily-")||o.includes("-fontWeight-")||o.includes("-typography-")||o.includes("-duration-")||o.includes("-ease-")||o.includes("-path-")||o.includes("-width-")||o.includes("-height-")||o.includes("-visual-size-")||o.includes("-modal-width")||o.includes("-cover");return a&&!c});return s.length===0?"":` @supports (background: color-mix(in srgb, white 50%, black)) {
      :root {
        ${s.map(o=>{const a=e?.[o]||"";return a.includes("color-mix")||a.startsWith("#")||a.startsWith("rgb")?`${o}: color-mix(in srgb, ${r} ${n}%, ${a});`:`${o}: color-mix(in srgb, ${r} ${n}%, var(${o}-base, ${a}));`}).join("")}
      }
    }`},generateBaseVariables(t){const e={},r=t["--apkt-tokens-theme-backgroundPrimary"];r&&(e["--apkt-tokens-theme-backgroundPrimary-base"]=r);const n=t["--apkt-tokens-core-backgroundAccentPrimary"];return n&&(e["--apkt-tokens-core-backgroundAccentPrimary-base"]=n),e},applyColorMixToVariables(t,e){const r={};if(e?.["--apkt-tokens-theme-backgroundPrimary"]&&(r["--apkt-tokens-theme-backgroundPrimary"]="var(--apkt-tokens-theme-backgroundPrimary-base)"),e?.["--apkt-tokens-core-backgroundAccentPrimary"]&&(r["--apkt-tokens-core-backgroundAccentPrimary"]="var(--apkt-tokens-core-backgroundAccentPrimary-base)"),!t?.["--w3m-color-mix"]||!t["--w3m-color-mix-strength"])return r;const n=t["--w3m-color-mix"],s=t["--w3m-color-mix-strength"];if(!s||s===0)return r;const i=Object.keys(e||{}).filter(o=>{const a=o.includes("-tokens-core-background")||o.includes("-tokens-core-text")||o.includes("-tokens-core-border")||o.includes("-tokens-core-foreground")||o.includes("-tokens-core-icon")||o.includes("-tokens-theme-background")||o.includes("-tokens-theme-text")||o.includes("-tokens-theme-border")||o.includes("-tokens-theme-foreground")||o.includes("-tokens-theme-icon")||o.includes("-tokens-theme-overlay"),c=o.includes("-borderRadius-")||o.includes("-spacing-")||o.includes("-textSize-")||o.includes("-fontFamily-")||o.includes("-fontWeight-")||o.includes("-typography-")||o.includes("-duration-")||o.includes("-ease-")||o.includes("-path-")||o.includes("-width-")||o.includes("-height-")||o.includes("-visual-size-")||o.includes("-modal-width")||o.includes("-cover");return a&&!c});return i.length===0||i.forEach(o=>{const a=e?.[o]||"";o.endsWith("-base")||(o==="--apkt-tokens-theme-backgroundPrimary"||o==="--apkt-tokens-core-backgroundAccentPrimary"?r[o]=`color-mix(in srgb, ${n} ${s}%, var(${o}-base))`:a.includes("color-mix")||a.startsWith("#")||a.startsWith("rgb")?r[o]=`color-mix(in srgb, ${n} ${s}%, ${a})`:r[o]=`color-mix(in srgb, ${n} ${s}%, var(${o}-base, ${a}))`)}),r}},{cssVariablesVarPrefix:fde}=go.createCSSVariables(Gb);function Ope(t,...e){return ba(t,...e.map(r=>di(typeof r=="function"?r(fde):r)))}let uc,Sc,ji,pi,Ig;const ho={"KHTeka-500-woff2":"https://fonts.reown.com/KHTeka-Medium.woff2","KHTeka-400-woff2":"https://fonts.reown.com/KHTeka-Regular.woff2","KHTeka-300-woff2":"https://fonts.reown.com/KHTeka-Light.woff2","KHTekaMono-400-woff2":"https://fonts.reown.com/KHTekaMono-Regular.woff2","KHTeka-500-woff":"https://fonts.reown.com/KHTeka-Light.woff","KHTeka-400-woff":"https://fonts.reown.com/KHTeka-Regular.woff","KHTeka-300-woff":"https://fonts.reown.com/KHTeka-Light.woff","KHTekaMono-400-woff":"https://fonts.reown.com/KHTekaMono-Regular.woff"};function Cg(t,e="dark"){uc&&document.head.removeChild(uc),uc=document.createElement("style"),uc.textContent=go.createRootStyles(e,t),document.head.appendChild(uc)}function kpe(t,e="dark"){if(Ig=t,Sc=document.createElement("style"),ji=document.createElement("style"),pi=document.createElement("style"),Sc.textContent=Wl(t).core.cssText,ji.textContent=Wl(t).dark.cssText,pi.textContent=Wl(t).light.cssText,document.head.appendChild(Sc),document.head.appendChild(ji),document.head.appendChild(pi),Cg(t,e),Yb(e),!t?.["--w3m-font-family"])for(const[r,n]of Object.entries(ho)){const s=document.createElement("link");s.rel="preload",s.href=n,s.as="font",s.type=r.includes("woff2")?"font/woff2":"font/woff",s.crossOrigin="anonymous",document.head.appendChild(s)}Yb(e)}function Yb(t="dark"){ji&&pi&&uc&&(t==="light"?(Cg(Ig,t),ji.removeAttribute("media"),pi.media="enabled"):(Cg(Ig,t),pi.removeAttribute("media"),ji.media="enabled"))}function pde(t){if(Ig=t,Sc&&ji&&pi&&(Sc.textContent=Wl(t).core.cssText,ji.textContent=Wl(t).dark.cssText,pi.textContent=Wl(t).light.cssText,t?.["--w3m-font-family"])){const e=t["--w3m-font-family"];Sc.textContent=Sc.textContent?.replace("font-family: KHTeka",`font-family: ${e}`),ji.textContent=ji.textContent?.replace("font-family: KHTeka",`font-family: ${e}`),pi.textContent=pi.textContent?.replace("font-family: KHTeka",`font-family: ${e}`)}if(uc){const e=pi?.media==="enabled"?"light":"dark";Cg(t,e)}}function Wl(t){const e=!!t?.["--w3m-font-family"];return{core:ba`
      ${e?ba``:ba`
            @font-face {
              font-family: 'KHTeka';
              src:
                url(${di(ho["KHTeka-400-woff2"])}) format('woff2'),
                url(${di(ho["KHTeka-400-woff"])}) format('woff');
              font-weight: 400;
              font-style: normal;
              font-display: swap;
            }

            @font-face {
              font-family: 'KHTeka';
              src:
                url(${di(ho["KHTeka-300-woff2"])}) format('woff2'),
                url(${di(ho["KHTeka-300-woff"])}) format('woff');
              font-weight: 300;
              font-style: normal;
            }

            @font-face {
              font-family: 'KHTekaMono';
              src:
                url(${di(ho["KHTekaMono-400-woff2"])}) format('woff2'),
                url(${di(ho["KHTekaMono-400-woff"])}) format('woff');
              font-weight: 400;
              font-style: normal;
            }

            @font-face {
              font-family: 'KHTeka';
              src:
                url(${di(ho["KHTeka-400-woff2"])}) format('woff2'),
                url(${di(ho["KHTeka-400-woff"])}) format('woff');
              font-weight: 400;
              font-style: normal;
            }
          `}

      @keyframes w3m-shake {
        0% {
          transform: scale(1) rotate(0deg);
        }
        20% {
          transform: scale(1) rotate(-1deg);
        }
        40% {
          transform: scale(1) rotate(1.5deg);
        }
        60% {
          transform: scale(1) rotate(-1.5deg);
        }
        80% {
          transform: scale(1) rotate(1deg);
        }
        100% {
          transform: scale(1) rotate(0deg);
        }
      }
      @keyframes w3m-iframe-fade-out {
        0% {
          opacity: 1;
        }
        100% {
          opacity: 0;
        }
      }
      @keyframes w3m-iframe-zoom-in {
        0% {
          transform: translateY(50px);
          opacity: 0;
        }
        100% {
          transform: translateY(0px);
          opacity: 1;
        }
      }
      @keyframes w3m-iframe-zoom-in-mobile {
        0% {
          transform: scale(0.95);
          opacity: 0;
        }
        100% {
          transform: scale(1);
          opacity: 1;
        }
      }
      :root {
        --apkt-modal-width: 370px;

        --apkt-visual-size-inherit: inherit;
        --apkt-visual-size-sm: 40px;
        --apkt-visual-size-md: 55px;
        --apkt-visual-size-lg: 80px;

        --apkt-path-network-sm: path(
          'M15.4 2.1a5.21 5.21 0 0 1 5.2 0l11.61 6.7a5.21 5.21 0 0 1 2.61 4.52v13.4c0 1.87-1 3.59-2.6 4.52l-11.61 6.7c-1.62.93-3.6.93-5.22 0l-11.6-6.7a5.21 5.21 0 0 1-2.61-4.51v-13.4c0-1.87 1-3.6 2.6-4.52L15.4 2.1Z'
        );

        --apkt-path-network-md: path(
          'M43.4605 10.7248L28.0485 1.61089C25.5438 0.129705 22.4562 0.129705 19.9515 1.61088L4.53951 10.7248C2.03626 12.2051 0.5 14.9365 0.5 17.886V36.1139C0.5 39.0635 2.03626 41.7949 4.53951 43.2752L19.9515 52.3891C22.4562 53.8703 25.5438 53.8703 28.0485 52.3891L43.4605 43.2752C45.9637 41.7949 47.5 39.0635 47.5 36.114V17.8861C47.5 14.9365 45.9637 12.2051 43.4605 10.7248Z'
        );

        --apkt-path-network-lg: path(
          'M78.3244 18.926L50.1808 2.45078C45.7376 -0.150261 40.2624 -0.150262 35.8192 2.45078L7.6756 18.926C3.23322 21.5266 0.5 26.3301 0.5 31.5248V64.4752C0.5 69.6699 3.23322 74.4734 7.6756 77.074L35.8192 93.5492C40.2624 96.1503 45.7376 96.1503 50.1808 93.5492L78.3244 77.074C82.7668 74.4734 85.5 69.6699 85.5 64.4752V31.5248C85.5 26.3301 82.7668 21.5266 78.3244 18.926Z'
        );

        --apkt-width-network-sm: 36px;
        --apkt-width-network-md: 48px;
        --apkt-width-network-lg: 86px;

        --apkt-duration-dynamic: 0ms;
        --apkt-height-network-sm: 40px;
        --apkt-height-network-md: 54px;
        --apkt-height-network-lg: 96px;
      }
    `,dark:ba`
      :root {
      }
    `,light:ba`
      :root {
      }
    `}}const Ppe=ba`
  div,
  span,
  iframe,
  a,
  img,
  form,
  button,
  label,
  *::after,
  *::before {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-style: normal;
    text-rendering: optimizeSpeed;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    -webkit-tap-highlight-color: transparent;
    backface-visibility: hidden;
  }

  :host {
    font-family: var(--apkt-fontFamily-regular);
  }
`,Rpe=ba`
  button,
  a {
    cursor: pointer;
    display: flex;
    justify-content: center;
    align-items: center;
    position: relative;

    will-change: background-color, color, border, box-shadow, width, height, transform, opacity;
    outline: none;
    border: none;
    text-decoration: none;
    transition:
      background-color var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      color var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      border var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      box-shadow var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      width var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      height var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      transform var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      opacity var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      scale var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      border-radius var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2);
    will-change:
      background-color, color, border, box-shadow, width, height, transform, opacity, scale,
      border-radius;
  }

  a:active:not([disabled]),
  button:active:not([disabled]) {
    scale: 0.975;
    transform-origin: center;
  }

  button:disabled {
    cursor: default;
  }

  input {
    border: none;
    outline: none;
    appearance: none;
  }
`;function gde(t){if(t.length>=255)throw new TypeError("Alphabet too long");const e=new Uint8Array(256);for(let l=0;l<e.length;l++)e[l]=255;for(let l=0;l<t.length;l++){const u=t.charAt(l),d=u.charCodeAt(0);if(e[d]!==255)throw new TypeError(u+" is ambiguous");e[d]=l}const r=t.length,n=t.charAt(0),s=Math.log(r)/Math.log(256),i=Math.log(256)/Math.log(r);function o(l){if(l instanceof Uint8Array||(ArrayBuffer.isView(l)?l=new Uint8Array(l.buffer,l.byteOffset,l.byteLength):Array.isArray(l)&&(l=Uint8Array.from(l))),!(l instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(l.length===0)return"";let u=0,d=0,h=0;const p=l.length;for(;h!==p&&l[h]===0;)h++,u++;const y=(p-h)*i+1>>>0,g=new Uint8Array(y);for(;h!==p;){let A=l[h],E=0;for(let v=y-1;(A!==0||E<d)&&v!==-1;v--,E++)A+=256*g[v]>>>0,g[v]=A%r>>>0,A=A/r>>>0;if(A!==0)throw new Error("Non-zero carry");d=E,h++}let w=y-d;for(;w!==y&&g[w]===0;)w++;let S=n.repeat(u);for(;w<y;++w)S+=t.charAt(g[w]);return S}function a(l){if(typeof l!="string")throw new TypeError("Expected String");if(l.length===0)return new Uint8Array;let u=0,d=0,h=0;for(;l[u]===n;)d++,u++;const p=(l.length-u)*s+1>>>0,y=new Uint8Array(p);for(;u<l.length;){const A=l.charCodeAt(u);if(A>255)return;let E=e[A];if(E===255)return;let v=0;for(let C=p-1;(E!==0||v<h)&&C!==-1;C--,v++)E+=r*y[C]>>>0,y[C]=E%256>>>0,E=E/256>>>0;if(E!==0)throw new Error("Non-zero carry");h=v,u++}let g=p-h;for(;g!==p&&y[g]===0;)g++;const w=new Uint8Array(d+(p-g));let S=d;for(;g!==p;)w[S++]=y[g++];return w}function c(l){const u=a(l);if(u)return u;throw new Error("Non-base"+r+" character")}return{encode:o,decodeUnsafe:a,decode:c}}var yde="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";const mde=gde(yde),Zf={ERROR_CODE_UNRECOGNIZED_CHAIN_ID:4902,ERROR_CODE_DEFAULT:5e3,ERROR_INVALID_CHAIN_ID:32603};class wde extends nue{async setUniversalProvider(e){if(!this.namespace)throw new Error("UniversalAdapter:setUniversalProvider - namespace is required");return this.addConnector(new sue({provider:e,caipNetworks:this.getCaipNetworks(),namespace:this.namespace})),Promise.resolve()}async connect(e){return Promise.resolve({id:"WALLET_CONNECT",type:"WALLET_CONNECT",chainId:Number(e.chainId),provider:this.provider,address:""})}async disconnect(){try{await this.getWalletConnectConnector().disconnect(),this.emit("disconnect")}catch(e){console.warn("UniversalAdapter:disconnect - error",e)}return{connections:[]}}syncConnections(){return Promise.resolve()}async getAccounts({namespace:e}){const n=this.provider?.session?.namespaces?.[e]?.accounts?.map(s=>{const[,,i]=s.split(":");return i}).filter((s,i,o)=>o.indexOf(s)===i)||[];return Promise.resolve({accounts:n.map(s=>Ne.createAccount(e,s,e==="bip122"?"payment":"eoa"))})}async syncConnectors(){return Promise.resolve()}async getBalance(e){if(!(e.caipNetwork&&mt.BALANCE_SUPPORTED_CHAINS.includes(e.caipNetwork?.chainNamespace))||e.caipNetwork?.testnet)return{balance:"0.00",symbol:e.caipNetwork?.nativeCurrency.symbol||""};const n=q.getAccountData();if(n?.balanceLoading&&e.chainId===q.state.activeCaipNetwork?.id)return{balance:n?.balance||"0.00",symbol:n?.balanceSymbol||""};const i=(await q.fetchTokenBalance()).find(o=>o.chainId===`${e.caipNetwork?.chainNamespace}:${e.chainId}`&&o.symbol===e.caipNetwork?.nativeCurrency.symbol);return{balance:i?.quantity.numeric||"0.00",symbol:i?.symbol||e.caipNetwork?.nativeCurrency.symbol||""}}async signMessage(e){const{provider:r,message:n,address:s}=e;if(!r)throw new Error("UniversalAdapter:signMessage - provider is undefined");let i="";return q.state.activeCaipNetwork?.chainNamespace===fe.CHAIN.SOLANA?i=(await r.request({method:"solana_signMessage",params:{message:mde.encode(new TextEncoder().encode(n)),pubkey:s}},q.state.activeCaipNetwork?.caipNetworkId)).signature:i=await r.request({method:"personal_sign",params:[n,s]},q.state.activeCaipNetwork?.caipNetworkId),{signature:i}}async estimateGas(){return Promise.resolve({gas:BigInt(0)})}async sendTransaction(){return Promise.resolve({hash:""})}walletGetAssets(e){return Promise.resolve({})}async writeContract(){return Promise.resolve({hash:""})}emitFirstAvailableConnection(){}parseUnits(){return 0n}formatUnits(){return"0"}async getCapabilities(){return Promise.resolve({})}async grantPermissions(){return Promise.resolve({})}async revokePermissions(){return Promise.resolve("0x")}async syncConnection(){return Promise.resolve({id:"WALLET_CONNECT",type:"WALLET_CONNECT",chainId:1,provider:this.provider,address:""})}async switchNetwork(e){const{caipNetwork:r}=e,n=this.getWalletConnectConnector();if(r.chainNamespace===fe.CHAIN.EVM)try{await n.provider?.request({method:"wallet_switchEthereumChain",params:[{chainId:Mx(r.id)}]})}catch(s){if(s.code===Zf.ERROR_CODE_UNRECOGNIZED_CHAIN_ID||s.code===Zf.ERROR_INVALID_CHAIN_ID||s.code===Zf.ERROR_CODE_DEFAULT||s?.data?.originalError?.code===Zf.ERROR_CODE_UNRECOGNIZED_CHAIN_ID)try{await n.provider?.request({method:"wallet_addEthereumChain",params:[{chainId:Mx(r.id),rpcUrls:[r?.rpcUrls.chainDefault?.http],chainName:r.name,nativeCurrency:r.nativeCurrency,blockExplorerUrls:[r.blockExplorers?.default.url]}]})}catch{throw new Error("Chain is not supported")}}n.provider.setDefaultChain(r.caipNetworkId)}getWalletConnectProvider(){return this.connectors.find(n=>n.type==="WALLET_CONNECT")?.provider}}const bde=["email","socials","swaps","onramp","activity","reownBranding","multiWallet","emailCapture","payWithExchange","payments","reownAuthentication"],Jf={email:{apiFeatureName:"social_login",localFeatureName:"email",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>{if(!t?.config)return!1;const e=t.config;return!!t.isEnabled&&e.includes("email")},processFallback:t=>t===void 0?mt.DEFAULT_REMOTE_FEATURES.email:!!t},socials:{apiFeatureName:"social_login",localFeatureName:"socials",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>{if(!t?.config)return!1;const e=t.config;return t.isEnabled&&e.length>0?e.filter(r=>r!=="email"):!1},processFallback:t=>t===void 0?mt.DEFAULT_REMOTE_FEATURES.socials:typeof t=="boolean"?t?mt.DEFAULT_REMOTE_FEATURES.socials:!1:t},swaps:{apiFeatureName:"swap",localFeatureName:"swaps",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>{if(!t?.config)return!1;const e=t.config;return t.isEnabled&&e.length>0?e:!1},processFallback:t=>t===void 0?mt.DEFAULT_REMOTE_FEATURES.swaps:typeof t=="boolean"?t?mt.DEFAULT_REMOTE_FEATURES.swaps:!1:t},onramp:{apiFeatureName:"onramp",localFeatureName:"onramp",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>{if(!t?.config)return!1;const e=t.config;return t.isEnabled&&e.length>0?e:!1},processFallback:t=>t===void 0?mt.DEFAULT_REMOTE_FEATURES.onramp:typeof t=="boolean"?t?mt.DEFAULT_REMOTE_FEATURES.onramp:!1:t},activity:{apiFeatureName:"activity",localFeatureName:"history",returnType:!1,isLegacy:!0,isAvailableOnBasic:!1,processApi:t=>!!t.isEnabled,processFallback:t=>t===void 0?mt.DEFAULT_REMOTE_FEATURES.activity:!!t},reownBranding:{apiFeatureName:"reown_branding",localFeatureName:"reownBranding",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>!!t.isEnabled,processFallback:t=>t===void 0?mt.DEFAULT_REMOTE_FEATURES.reownBranding:!!t},emailCapture:{apiFeatureName:"email_capture",localFeatureName:"emailCapture",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>t.isEnabled&&(t.config??[]),processFallback:t=>!1},multiWallet:{apiFeatureName:"multi_wallet",localFeatureName:"multiWallet",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>!!t.isEnabled,processFallback:()=>mt.DEFAULT_REMOTE_FEATURES.multiWallet},payWithExchange:{apiFeatureName:"fund_from_exchange",localFeatureName:"payWithExchange",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>!!t.isEnabled,processFallback:()=>mt.DEFAULT_REMOTE_FEATURES.payWithExchange},payments:{apiFeatureName:"payments",localFeatureName:"payments",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>!!t.isEnabled,processFallback:()=>mt.DEFAULT_REMOTE_FEATURES.payments},reownAuthentication:{apiFeatureName:"reown_authentication",localFeatureName:"reownAuthentication",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>!!t.isEnabled,processFallback:t=>typeof t>"u"?mt.DEFAULT_REMOTE_FEATURES.reownAuthentication:!!t}},vde={localSettingsOverridden:new Set,getApiConfig(t,e){return e?.find(r=>r.id===t)},addWarning(t,e){if(t!==void 0){const r=Jf[e],n=r.isLegacy?`"features.${r.localFeatureName}" (now "${e}")`:`"features.${e}"`;this.localSettingsOverridden.add(n)}},processFeature(t,e,r,n,s){const i=Jf[t],o=e[i.localFeatureName];if(s&&!i.isAvailableOnBasic)return!1;if(n){const a=this.getApiConfig(i.apiFeatureName,r);return a?.config===null?this.processFallbackFeature(t,o):a?.config?(o!==void 0&&this.addWarning(o,t),this.processApiFeature(t,a)):!1}return this.processFallbackFeature(t,o)},processApiFeature(t,e){return Jf[t].processApi(e)},processFallbackFeature(t,e){return Jf[t].processFallback(e)},async fetchRemoteFeatures(t){const e=t.basic??!1,r=t.features||{};this.localSettingsOverridden.clear();let n=null,s=!1;try{n=await Ue.fetchProjectConfig(),s=n!=null}catch(o){console.warn("[Reown Config] Failed to fetch remote project configuration. Using local/default values.",o)}const i=s&&!e?mt.DEFAULT_REMOTE_FEATURES:mt.DEFAULT_REMOTE_FEATURES_DISABLED;try{for(const o of bde){const a=this.processFeature(o,r,n,s,e);Object.assign(i,{[o]:a})}}catch(o){return console.warn("[Reown Config] Failed to process the configuration from Cloud. Using default values.",o),mt.DEFAULT_REMOTE_FEATURES}if(s&&this.localSettingsOverridden.size>0){const o=`Your local configuration for ${Array.from(this.localSettingsOverridden).join(", ")} was ignored because a remote configuration was successfully fetched. Please manage these features via your project dashboard on dashboard.reown.com.`;gs.open({debugMessage:js.ALERT_WARNINGS.LOCAL_CONFIGURATION_IGNORED.debugMessage(o)},"warning")}return i}};class Ede{constructor(e){this.chainNamespaces=[],this.features={},this.remoteFeatures={},this.reportedAlertErrors={},this.getCaipNetwork=(r,n)=>{if(r){const s=q.getCaipNetworks(r)?.find(a=>a.id===n);if(s)return s;const i=q.getNetworkData(r)?.caipNetwork;return i||q.getRequestedCaipNetworks(r).filter(a=>a.chainNamespace===r)?.[0]}return q.state.activeCaipNetwork||this.defaultCaipNetwork},this.getCaipNetworkId=()=>{const r=this.getCaipNetwork();if(r)return r.id},this.getCaipNetworks=r=>q.getCaipNetworks(r),this.getActiveChainNamespace=()=>q.state.activeChain,this.setRequestedCaipNetworks=(r,n)=>{q.setRequestedCaipNetworks(r,n)},this.getApprovedCaipNetworkIds=()=>q.getAllApprovedCaipNetworkIds(),this.getCaipAddress=r=>q.state.activeChain===r||!r?q.state.activeCaipAddress:q.state.chains.get(r)?.accountState?.caipAddress,this.setClientId=r=>{He.setClientId(r)},this.getProvider=r=>Qt.getProvider(r),this.getProviderType=r=>Qt.getProviderId(r),this.getPreferredAccountType=r=>Ys(r),this.setCaipAddress=(r,n,s=!1)=>{q.setAccountProp("caipAddress",r,n,s),q.setAccountProp("address",Ne.getPlainAddress(r),n,s)},this.setBalance=(r,n,s)=>{q.setAccountProp("balance",r,s),q.setAccountProp("balanceSymbol",n,s)},this.setProfileName=(r,n)=>{q.setAccountProp("profileName",r,n)},this.setProfileImage=(r,n)=>{q.setAccountProp("profileImage",r,n)},this.setUser=(r,n)=>{q.setAccountProp("user",r,n)},this.resetAccount=r=>{q.resetAccount(r)},this.setCaipNetwork=r=>{q.setActiveCaipNetwork(r)},this.setCaipNetworkOfNamespace=(r,n)=>{q.setChainNetworkData(n,{caipNetwork:r})},this.setStatus=(r,n)=>{q.setAccountProp("status",r,n),ge.isConnected()?de.setConnectionStatus("connected"):de.setConnectionStatus("disconnected")},this.getAddressByChainNamespace=r=>q.getAccountData(r)?.address,this.setConnectors=r=>{const n=[...ge.state.allConnectors,...r];ge.setConnectors(n)},this.setConnections=(r,n)=>{de.setConnections(r,n),Ee.setConnections(r,n)},this.fetchIdentity=r=>He.fetchIdentity(r),this.getReownName=r=>Ad.getNamesForAddress(r),this.getConnectors=()=>ge.getConnectors(),this.getConnectorImage=r=>jN.getConnectorImage(r),this.getConnections=r=>this.remoteFeatures.multiWallet?ag.getConnectionsData(r).connections:(gs.open(fe.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info"),[]),this.getRecentConnections=r=>this.remoteFeatures.multiWallet?ag.getConnectionsData(r).recentConnections:(gs.open(fe.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info"),[]),this.switchConnection=async r=>{if(!this.remoteFeatures.multiWallet){gs.open(fe.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info");return}await Ee.switchConnection(r)},this.deleteConnection=r=>{if(!this.remoteFeatures.multiWallet){gs.open(fe.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info");return}de.deleteAddressFromConnection(r),Ee.syncStorageConnections()},this.setConnectedWalletInfo=(r,n)=>{const s=Qt.getProviderId(n),i=r?{...r,type:s}:void 0;q.setAccountProp("connectedWalletInfo",i,n)},this.getIsConnectedState=()=>!!q.state.activeCaipAddress,this.addAddressLabel=(r,n,s)=>{const i=q.getAccountData(s)?.addressLabels||{};q.setAccountProp("addressLabels",{...i,[r]:n},s)},this.removeAddressLabel=(r,n)=>{const s=q.getAccountData(n)?.addressLabels||{};q.setAccountProp("addressLabels",{...s,[r]:void 0},n)},this.getAddress=r=>{const n=r||q.state.activeChain;return q.getAccountData(n)?.address},this.resetNetwork=r=>{q.resetNetwork(r)},this.addConnector=r=>{ge.addConnector(r)},this.resetWcConnection=()=>{Ee.resetWcConnection()},this.setAddressExplorerUrl=(r,n)=>{q.setAccountProp("addressExplorerUrl",r,n)},this.setSmartAccountDeployed=(r,n)=>{q.setAccountProp("smartAccountDeployed",r,n)},this.setPreferredAccountType=(r,n)=>{q.setAccountProp("preferredAccountType",r,n)},this.setEIP6963Enabled=r=>{te.setEIP6963Enabled(r)},this.handleUnsafeRPCRequest=()=>{if(this.isOpen()){if(this.isTransactionStackEmpty())return;this.redirect("ApproveTransaction")}else this.open({view:"ApproveTransaction"})},this.options=e,this.version=e.sdkVersion,this.caipNetworks=this.extendCaipNetworks(e),this.chainNamespaces=this.getChainNamespacesSet(e.adapters,this.caipNetworks),this.defaultCaipNetwork=this.extendDefaultCaipNetwork(e),this.chainAdapters=this.createAdapters(e.adapters),this.readyPromise=this.initialize(e)}getChainNamespacesSet(e,r){const n=e?.map(i=>i.namespace).filter(i=>!!i);if(n?.length)return[...new Set(n)];const s=r?.map(i=>i.chainNamespace);return[...new Set(s)]}async initialize(e){if(this.initializeProjectSettings(e),this.initControllers(e),await this.initChainAdapters(),this.sendInitializeEvent(e),te.state.enableReconnect?(await this.syncExistingConnection(),await this.syncAdapterConnections()):await this.unSyncExistingConnection(),!e.basic&&!e.manualWCControl&&(this.remoteFeatures=await vde.fetchRemoteFeatures(e)),await Ue.fetchUsage(),te.setRemoteFeatures(this.remoteFeatures),this.remoteFeatures.onramp&&db.setOnrampProviders(this.remoteFeatures.onramp),(te.state.remoteFeatures?.email||Array.isArray(te.state.remoteFeatures?.socials)&&te.state.remoteFeatures?.socials.length>0)&&await this.checkAllowedOrigins(),te.state.features?.reownAuthentication||te.state.remoteFeatures?.reownAuthentication){const{ReownAuthentication:r}=await ng(async()=>{const{ReownAuthentication:s}=await import("./features-Cjxm1yHk.js");return{ReownAuthentication:s}},[]),n=te.state.siwx;n instanceof r||(n&&console.warn("ReownAuthentication option is enabled, SIWX configuration will be overridden."),te.setSIWX(new r))}}async openSend(e){const r=e.namespace||q.state.activeChain,n=this.getCaipAddress(r),s=this.getCaipNetwork(r)?.id;if(!n)throw new Error("openSend: caipAddress not found");if(s?.toString()!==e.chainId.toString()){const i=q.getCaipNetworkById(e.chainId,r);if(!i)throw new Error(`openSend: caipNetwork with chainId ${e.chainId} not found`);await this.switchNetwork(i,{throwOnFailure:!0})}try{const i=p6.getTokenSymbolByAddress(e.assetAddress);i&&await Ue.fetchTokenImages([i])}catch{}return await lt.open({view:"WalletSend",data:{send:e}}),new Promise((i,o)=>{const a=ot.subscribeKey("hash",u=>{u&&(l(),i({hash:u}))}),c=lt.subscribe(u=>{u.open||(l(),o(new Error("Modal closed")))}),l=this.createCleanupHandler([a,c])})}toModalOptions(){function e(n){return n?.view==="Swap"}function r(n){return n?.view==="WalletSend"}return{isSwap:e,isSend:r}}async checkAllowedOrigins(){try{const e=await Ue.fetchAllowedOrigins();if(!Ne.isClient())return;const r=window.location.origin;Ca.isOriginAllowed(r,e,fe.DEFAULT_ALLOWED_ANCESTORS)||gs.open(js.ALERT_ERRORS.ORIGIN_NOT_ALLOWED,"error")}catch(e){if(!(e instanceof Error))return;switch(e.message){case"RATE_LIMITED":gs.open(js.ALERT_ERRORS.RATE_LIMITED_APP_CONFIGURATION,"error");break;case"SERVER_ERROR":{const r=e.cause instanceof Error?e.cause:e;gs.open({displayMessage:js.ALERT_ERRORS.SERVER_ERROR_APP_CONFIGURATION.displayMessage,debugMessage:js.ALERT_ERRORS.SERVER_ERROR_APP_CONFIGURATION.debugMessage(r.message)},"error");break}}}}createCleanupHandler(e){return()=>{e.forEach(r=>{try{r()}catch{}})}}sendInitializeEvent(e){const{...r}=e;delete r.adapters,delete r.universalProvider,ct.sendEvent({type:"track",event:"INITIALIZE",properties:{...r,networks:e.networks.map(n=>n.id),siweConfig:{options:e.siweConfig?.options||{}}}})}initControllers(e){this.initializeOptionsController(e),this.initializeChainController(e),this.initializeThemeController(e),this.initializeConnectionController(e),this.initializeConnectorController()}initAdapterController(){zN.initialize(this.chainAdapters)}initializeThemeController(e){e.themeMode&&ws.setThemeMode(e.themeMode),e.themeVariables&&ws.setThemeVariables(e.themeVariables)}initializeChainController(e){if(!this.connectionControllerClient)throw new Error("ConnectionControllerClient must be set");q.initialize(e.adapters??[],this.caipNetworks,{connectionControllerClient:this.connectionControllerClient});const r=this.getDefaultNetwork();r&&q.setActiveCaipNetwork(r)}initializeConnectionController(e){Ee.initialize(e.adapters??[]),Ee.setWcBasic(e.basic??!1)}initializeConnectorController(){ge.initialize(this.chainNamespaces)}initializeProjectSettings(e){te.setProjectId(e.projectId),te.setSdkVersion(e.sdkVersion)}initializeOptionsController(e){te.setDebug(e.debug!==!1),te.setEnableWalletGuide(e.enableWalletGuide!==!1),te.setEnableWallets(e.enableWallets!==!1),te.setEIP6963Enabled(e.enableEIP6963!==!1),te.setEnableNetworkSwitch(e.enableNetworkSwitch!==!1),te.setEnableReconnect(e.enableReconnect!==!1),te.setEnableMobileFullScreen(e.enableMobileFullScreen===!0),te.setCoinbasePreference(e.coinbasePreference),te.setEnableAuthLogger(e.enableAuthLogger!==!1),te.setCustomRpcUrls(e.customRpcUrls),te.setEnableEmbedded(e.enableEmbedded),te.setAllWallets(e.allWallets),te.setIncludeWalletIds(e.includeWalletIds),te.setExcludeWalletIds(e.excludeWalletIds),te.setFeaturedWalletIds(e.featuredWalletIds),te.setTokens(e.tokens),te.setTermsConditionsUrl(e.termsConditionsUrl),te.setPrivacyPolicyUrl(e.privacyPolicyUrl),te.setCustomWallets(e.customWallets),te.setFeatures(e.features),te.setAllowUnsupportedChain(e.allowUnsupportedChain),te.setUniversalProviderConfigOverride(e.universalProviderConfigOverride),te.setPreferUniversalLinks(e.experimental_preferUniversalLinks),te.setDefaultAccountTypes(e.defaultAccountTypes);const r=this.getDefaultMetaData();if(!e.metadata&&r&&(e.metadata=r),te.setMetadata(e.metadata),te.setDisableAppend(e.disableAppend),te.setEnableEmbedded(e.enableEmbedded),te.setSIWX(e.siwx),this.features=te.state.features??{},!e.projectId){gs.open(js.ALERT_ERRORS.PROJECT_ID_NOT_CONFIGURED,"error");return}if(e.adapters?.find(s=>s.namespace===fe.CHAIN.EVM)&&e.siweConfig){if(e.siwx)throw new Error("Cannot set both `siweConfig` and `siwx` options");te.setSIWX(e.siweConfig.mapToSIWX())}}getDefaultMetaData(){return Ne.isClient()?{name:document.getElementsByTagName("title")?.[0]?.textContent||"",description:document.querySelector('meta[property="og:description"]')?.content||"",url:window.location.origin,icons:[document.querySelector('link[rel~="icon"]')?.href||""]}:null}setUnsupportedNetwork(e){const r=this.getActiveChainNamespace();if(r){const n=Cl.getUnsupportedNetwork(`${r}:${e}`);q.setActiveCaipNetwork(n)}}getDefaultNetwork(){return Cl.getCaipNetworkFromStorage(this.defaultCaipNetwork)}extendCaipNetwork(e,r){return Cl.extendCaipNetwork(e,{customNetworkImageUrls:r.chainImages,projectId:r.projectId})}extendCaipNetworks(e){return Cl.extendCaipNetworks(e.networks,{customNetworkImageUrls:e.chainImages,customRpcUrls:e.customRpcUrls,projectId:e.projectId})}extendDefaultCaipNetwork(e){const r=e.networks.find(s=>s.id===e.defaultNetwork?.id);return r?Cl.extendCaipNetwork(r,{customNetworkImageUrls:e.chainImages,customRpcUrls:e.customRpcUrls,projectId:e.projectId}):void 0}async disconnectConnector(e,r){try{this.setLoading(!0,e);let n={connections:[]};const s=this.getAdapter(e);return(q.state.chains.get(e)?.accountState?.caipAddress||!te.state.enableReconnect)&&s?.disconnect&&(n=await s.disconnect({id:r})),this.setLoading(!1,e),n}catch(n){throw this.setLoading(!1,e),new Error(`Failed to disconnect chains: ${n.message}`)}}createClients(){this.connectionControllerClient={connectWalletConnect:async()=>{const e=q.state.activeChain,r=this.getAdapter(e),n=this.getCaipNetwork(e)?.id,s=Ee.getConnections(e),i=this.remoteFeatures.multiWallet,o=s.length>0;if(!r)throw new Error("Adapter not found");const a=await r.connectWalletConnect(n);(!o||!i)&&this.close(),this.setClientId(a?.clientId||null),de.setConnectedNamespaces([...q.state.chains.keys()]),await this.syncWalletConnectAccount(),await hi.initializeIfEnabled()},connectExternal:async e=>{const r=await this.onConnectExternal(e);return await this.connectInactiveNamespaces(e,r),r?{address:r.address}:void 0},reconnectExternal:async({id:e,info:r,type:n,provider:s})=>{const i=q.state.activeChain,o=this.getAdapter(i);if(!i)throw new Error("reconnectExternal: namespace not found");if(!o)throw new Error("reconnectExternal: adapter not found");o?.reconnect&&(await o?.reconnect({id:e,info:r,type:n,provider:s,chainId:this.getCaipNetwork()?.id}),de.addConnectedNamespace(i),this.syncConnectedWalletInfo(i))},disconnectConnector:async e=>{await this.disconnectConnector(e.namespace,e.id)},disconnect:async e=>{const{id:r,chainNamespace:n,initialDisconnect:s}=e||{},i=n||q.state.activeChain,o=ge.getConnectorId(i),a=r===fe.CONNECTOR_ID.AUTH||o===fe.CONNECTOR_ID.AUTH,c=r===fe.CONNECTOR_ID.WALLET_CONNECT||o===fe.CONNECTOR_ID.WALLET_CONNECT;try{const l=Array.from(q.state.chains.keys());let u=n?[n]:l;(c||a)&&(u=l);const d=u.map(async y=>{const g=ge.getConnectorId(y),w=r||g,S=await this.disconnectConnector(y,w);S&&(a&&de.deleteConnectedSocialProvider(),S.connections.forEach(A=>{de.addDisconnectedConnectorId(A.connectorId,y)})),s&&this.onDisconnectNamespace({chainNamespace:y,closeModal:!1})}),h=await Promise.allSettled(d);ot.resetSend(),Ee.resetWcConnection(),hi.getSIWX()?.signOutOnDisconnect&&await hi.clearSessions(),ge.setFilterByNamespace(void 0),Ee.syncStorageConnections();const p=h.filter(y=>y.status==="rejected");if(p.length>0)throw new Error(p.map(y=>y.reason.message).join(", "));ct.sendEvent({type:"track",event:"DISCONNECT_SUCCESS",properties:{namespace:n||"all"}})}catch(l){throw new Error(`Failed to disconnect chains: ${l.message}`)}},checkInstalled:e=>e?e.some(r=>!!window.ethereum?.[String(r)]):!!window.ethereum,signMessage:async e=>{const r=q.state.activeChain,n=this.getAdapter(q.state.activeChain);if(!r)throw new Error("signMessage: namespace not found");if(!n)throw new Error("signMessage: adapter not found");const s=this.getAddress(r);if(!s)throw new Error("signMessage: address not found");return(await n?.signMessage({message:e,address:s,provider:Qt.getProvider(r)}))?.signature||""},sendTransaction:async e=>{const r=e.chainNamespace;if(!r)throw new Error("sendTransaction: namespace not found");if(mt.SEND_SUPPORTED_NAMESPACES.includes(r)){const n=this.getAdapter(r);if(!n)throw new Error("sendTransaction: adapter not found");const s=Qt.getProvider(r);return(await n?.sendTransaction({...e,caipNetwork:this.getCaipNetwork(),provider:s}))?.hash||""}return""},estimateGas:async e=>{const r=e.chainNamespace;if(r===fe.CHAIN.EVM){const n=this.getAdapter(r);if(!n)throw new Error("estimateGas: adapter is required but got undefined");const s=Qt.getProvider(r),i=this.getCaipNetwork();if(!i)throw new Error("estimateGas: caipNetwork is required but got undefined");return(await n?.estimateGas({...e,provider:s,caipNetwork:i}))?.gas||0n}return 0n},getEnsAvatar:async()=>{const e=q.state.activeChain;if(!e)throw new Error("getEnsAvatar: namespace is required but got undefined");const r=this.getAddress(e);if(!r)throw new Error("getEnsAvatar: address not found");return await this.syncIdentity({address:r,chainId:Number(this.getCaipNetwork()?.id),chainNamespace:e}),q.getAccountData()?.profileImage||!1},getEnsAddress:async e=>await Ca.resolveReownName(e),writeContract:async e=>{const r=q.state.activeChain,n=this.getAdapter(r);if(!r)throw new Error("writeContract: namespace is required but got undefined");if(!n)throw new Error("writeContract: adapter is required but got undefined");const s=this.getCaipNetwork(),i=this.getCaipAddress(),o=Qt.getProvider(r);if(!s||!i)throw new Error("writeContract: caipNetwork or caipAddress is required but got undefined");return(await n?.writeContract({...e,caipNetwork:s,provider:o,caipAddress:i}))?.hash},parseUnits:(e,r)=>{const n=this.getAdapter(q.state.activeChain);if(!n)throw new Error("parseUnits: adapter is required but got undefined");return n?.parseUnits({value:e,decimals:r})??0n},formatUnits:(e,r)=>{const n=this.getAdapter(q.state.activeChain);if(!n)throw new Error("formatUnits: adapter is required but got undefined");return n?.formatUnits({value:e,decimals:r})??"0"},getCapabilities:async e=>{const r=this.getAdapter(q.state.activeChain);if(!r)throw new Error("getCapabilities: adapter is required but got undefined");return await r?.getCapabilities(e)},grantPermissions:async e=>{const r=this.getAdapter(q.state.activeChain);if(!r)throw new Error("grantPermissions: adapter is required but got undefined");return await r?.grantPermissions(e)},revokePermissions:async e=>{const r=this.getAdapter(q.state.activeChain);if(!r)throw new Error("revokePermissions: adapter is required but got undefined");return r?.revokePermissions?await r.revokePermissions(e):"0x"},walletGetAssets:async e=>{const r=this.getAdapter(q.state.activeChain);if(!r)throw new Error("walletGetAssets: adapter is required but got undefined");return await r?.walletGetAssets(e)??{}},updateBalance:e=>{const r=this.getAddress(e),n=this.getCaipNetwork(e);!n||!r||this.updateNativeBalance(r,n?.id,e)}},Ee.setClient(this.connectionControllerClient)}async onConnectExternal(e){const r=q.state.activeChain,n=e.chain||r,s=this.getAdapter(n);let i=!0;if(e.type===uo.CONNECTOR_TYPE_AUTH&&fe.AUTH_CONNECTOR_SUPPORTED_CHAINS.some(d=>ge.getConnectorId(d)===fe.CONNECTOR_ID.AUTH)&&e.chain!==r&&(i=!1),e.chain&&e.chain!==r&&!e.caipNetwork){const l=this.getCaipNetworks().find(u=>u.chainNamespace===e.chain);l&&i&&this.setCaipNetwork(l)}if(!n)throw new Error("connectExternal: namespace not found");if(!s)throw new Error("connectExternal: adapter not found");const o=this.getCaipNetwork(n),a=e.caipNetwork||o,c=await s.connect({id:e.id,address:e.address,info:e.info,type:e.type,provider:e.provider,socialUri:e.socialUri,chainId:e.caipNetwork?.id||o?.id,rpcUrl:e.caipNetwork?.rpcUrls?.default?.http?.[0]||o?.rpcUrls?.default?.http?.[0]});if(c)return de.addConnectedNamespace(n),this.syncProvider({...c,chainNamespace:n}),this.setStatus("connected",n),this.syncConnectedWalletInfo(n),de.removeDisconnectedConnectorId(e.id,n),{address:c.address,connectedCaipNetwork:a}}async connectInactiveNamespaces(e,r){const n=e.type===uo.CONNECTOR_TYPE_AUTH,s=bh.getOtherAuthNamespaces(r?.connectedCaipNetwork?.chainNamespace),i=q.state.activeCaipNetwork,o=this.getAdapter(i?.chainNamespace);n&&(await Promise.all(s.map(async a=>{try{const c=Qt.getProvider(a),l=this.getCaipNetwork(a);await this.getAdapter(a)?.connect({...e,provider:c,socialUri:void 0,chainId:l?.id,rpcUrl:l?.rpcUrls?.default?.http?.[0]})&&(de.addConnectedNamespace(a),de.removeDisconnectedConnectorId(e.id,a),this.setStatus("connected",a),this.syncConnectedWalletInfo(a))}catch(c){gs.warn(js.ALERT_WARNINGS.INACTIVE_NAMESPACE_NOT_CONNECTED.displayMessage,js.ALERT_WARNINGS.INACTIVE_NAMESPACE_NOT_CONNECTED.debugMessage(a,c instanceof Error?c.message:void 0),js.ALERT_WARNINGS.INACTIVE_NAMESPACE_NOT_CONNECTED.code)}})),i&&await o?.switchNetwork({caipNetwork:i}))}getApprovedCaipNetworksData(){if(Qt.getProviderId(q.state.activeChain)===uo.CONNECTOR_TYPE_WALLET_CONNECT){const r=this.universalProvider?.session?.namespaces;return{supportsAllNetworks:this.universalProvider?.session?.peer?.metadata.name==="MetaMask Wallet",approvedCaipNetworkIds:this.getChainsFromNamespaces(r)}}return{supportsAllNetworks:!0,approvedCaipNetworkIds:[]}}async switchCaipNetwork(e){const r=e.chainNamespace;if(this.getAddressByChainNamespace(e.chainNamespace)){const s=Qt.getProviderId(r);if(e.chainNamespace===q.state.activeChain)await this.getAdapter(r)?.switchNetwork({caipNetwork:e});else if(this.setCaipNetwork(e),s===uo.CONNECTOR_TYPE_WALLET_CONNECT)this.syncWalletConnectAccount();else{const i=this.getAddressByChainNamespace(r);i&&this.syncAccount({address:i,chainId:e.id,chainNamespace:r})}}else this.setCaipNetwork(e)}getChainsFromNamespaces(e={}){return Object.values(e).flatMap(r=>{const n=r.chains||[],s=r.accounts.map(i=>{const{chainId:o,chainNamespace:a}=sn.parseCaipAddress(i);return`${a}:${o}`});return Array.from(new Set([...n,...s]))})}createAdapters(e){return this.createClients(),this.chainNamespaces.reduce((r,n)=>{const s=e?.find(i=>i.namespace===n);return s?(s.construct({namespace:n,projectId:this.options?.projectId,networks:this.caipNetworks?.filter(({chainNamespace:i})=>i===n)}),r[n]=s):r[n]=new wde({namespace:n,networks:this.getCaipNetworks()}),r},{})}async initChainAdapter(e){this.onConnectors(e),this.listenAdapter(e);const r=this.getAdapter(e);if(!r)throw new Error("adapter not found");await r.syncConnectors(),await this.createUniversalProviderForAdapter(e)}async initChainAdapters(){await Promise.all(this.chainNamespaces.map(async e=>{await this.initChainAdapter(e)})),this.initAdapterController()}onConnectors(e){this.getAdapter(e)?.on("connectors",this.setConnectors.bind(this))}listenAdapter(e){const r=this.getAdapter(e);if(!r)return;const n=de.getConnectionStatus();te.state.enableReconnect===!1?this.setStatus("disconnected",e):n==="connected"?this.setStatus("connecting",e):n==="disconnected"?(de.clearAddressCache(),this.setStatus(n,e)):this.setStatus(n,e),r.on("switchNetwork",({address:s,chainId:i})=>{const o=this.getCaipNetworks().find(l=>l.id.toString()===i.toString()||l.caipNetworkId.toString()===i.toString()),a=q.state.activeChain===e,c=q.state.chains.get(e)?.accountState?.address;if(o){const l=a&&s?s:c;l&&this.syncAccount({address:l,chainId:o.id,chainNamespace:e})}else this.setUnsupportedNetwork(i)}),r.on("disconnect",()=>{const s=this.remoteFeatures.multiWallet,i=Array.from(Ee.state.connections.values()).flat();this.onDisconnectNamespace({chainNamespace:e,closeModal:!s||i.length===0})}),r.on("connections",s=>{this.setConnections(s,e)}),r.on("pendingTransactions",()=>{const s=this.getAddress(e),i=q.state.activeCaipNetwork;!s||!i?.id||this.updateNativeBalance(s,i.id,i.chainNamespace)}),r.on("accountChanged",({address:s,chainId:i,connector:o})=>{this.handlePreviousConnectorConnection(o);const a=q.state.activeChain===e;o?.provider&&(this.syncProvider({id:o.id,type:o.type,provider:o?.provider,chainNamespace:e}),this.syncConnectedWalletInfo(e));const c=q.getNetworkData(e)?.caipNetwork?.id,l=i||c;a&&l?this.syncAccount({address:s,chainId:l,chainNamespace:e}):!a&&l?(this.syncAccountInfo(s,l,e),this.syncBalance({address:s,chainId:l,chainNamespace:e})):this.syncAccountInfo(s,i,e),de.addConnectedNamespace(e)})}async handlePreviousConnectorConnection(e){const r=e?.chain,n=e?.id,s=ge.getConnectorId(r),i=te.state.remoteFeatures?.multiWallet,a=r&&n&&s&&s!==n&&!i;try{a&&await Ee.disconnect({id:s,namespace:r})}catch(c){console.warn("Error disconnecting previous connector",c)}}async createUniversalProviderForAdapter(e){await this.getUniversalProvider(),this.universalProvider&&await this.chainAdapters?.[e]?.setUniversalProvider?.(this.universalProvider)}async syncExistingConnection(){await Promise.allSettled(this.chainNamespaces.map(e=>this.syncNamespaceConnection(e)))}async unSyncExistingConnection(){try{await Promise.allSettled(this.chainNamespaces.map(e=>Ee.disconnect({namespace:e,initialDisconnect:!0})))}catch(e){console.error("Error disconnecting existing connections:",e)}}async reconnectWalletConnect(){await this.syncWalletConnectAccount();const e=this.getAddress();this.getCaipAddress()||de.deleteRecentWallet();const r=de.getRecentWallet();ct.sendEvent({type:"track",event:"CONNECT_SUCCESS",address:e,properties:{method:Ne.isMobile()?"mobile":"qrcode",name:r?.name||"Unknown",reconnect:!0,view:qe.state.view,walletRank:r?.order}})}async syncNamespaceConnection(e){try{e===fe.CHAIN.EVM&&Ne.isSafeApp()&&ge.setConnectorId(fe.CONNECTOR_ID.SAFE,e);const r=ge.getConnectorId(e);switch(this.setStatus("connecting",e),r){case fe.CONNECTOR_ID.WALLET_CONNECT:await this.reconnectWalletConnect();break;case fe.CONNECTOR_ID.AUTH:break;default:await this.syncAdapterConnection(e)}}catch(r){console.warn("AppKit couldn't sync existing connection",r),this.setStatus("disconnected",e)}}onDisconnectNamespace(e){const{chainNamespace:r,closeModal:n}=e||{};q.resetAccount(r),q.resetNetwork(r),de.removeConnectedNamespace(r);const s=Array.from(q.state.chains.keys());(r?[r]:s).forEach(o=>de.addDisconnectedConnectorId(ge.getConnectorId(o)||"",o)),ge.removeConnectorId(r),Qt.resetChain(r),this.setUser(null,r),this.setStatus("disconnected",r),this.setConnectedWalletInfo(null,r),n!==!1&&lt.close()}async syncAdapterConnections(){await Promise.allSettled(this.chainNamespaces.map(e=>{const r=this.getAdapter(e),n=this.getCaipAddress(e),s=this.getCaipNetwork(e);return r?.syncConnections({connectToFirstConnector:!n,caipNetwork:s})}))}async syncAdapterConnection(e){const r=this.getAdapter(e),n=this.getCaipNetwork(e),s=ge.getConnectorId(e),o=ge.getConnectors(e).find(a=>a.id===s);try{if(!r||!o)throw new Error(`Adapter or connector not found for namespace ${e}`);if(!n?.id)throw new Error("CaipNetwork not found");const a=await r?.syncConnection({namespace:e,id:o.id,chainId:n.id,rpcUrl:n?.rpcUrls?.default?.http?.[0]});a?(this.syncProvider({...a,chainNamespace:e}),await this.syncAccount({...a,chainNamespace:e}),this.setStatus("connected",e),ct.sendEvent({type:"track",event:"CONNECT_SUCCESS",address:a.address,properties:{method:"browser",name:o.info?.name||o.name||"Unknown",reconnect:!0,view:qe.state.view,walletRank:void 0}})):this.setStatus("disconnected",e)}catch{this.onDisconnectNamespace({chainNamespace:e,closeModal:!1})}}async syncWalletConnectAccount(){const e=Object.keys(this.universalProvider?.session?.namespaces||{}),r=this.chainNamespaces.map(async n=>{const s=this.getAdapter(n);if(!s)return;const i=this.universalProvider?.session?.namespaces?.[n]?.accounts||[],o=q.state.activeCaipNetwork?.id,a=i.find(l=>{const{chainId:u}=sn.parseCaipAddress(l);return u===o?.toString()})||i[0];if(a){const l=sn.validateCaipAddress(a),{chainId:u,address:d}=sn.parseCaipAddress(l);if(Qt.setProviderId(n,uo.CONNECTOR_TYPE_WALLET_CONNECT),this.caipNetworks&&q.state.activeCaipNetwork&&s.namespace!==fe.CHAIN.EVM){const h=s.getWalletConnectProvider({caipNetworks:this.getCaipNetworks(),provider:this.universalProvider,activeCaipNetwork:q.state.activeCaipNetwork});Qt.setProvider(n,h)}else Qt.setProvider(n,this.universalProvider);ge.setConnectorId(fe.CONNECTOR_ID.WALLET_CONNECT,n),de.addConnectedNamespace(n),await this.syncAccount({address:d,chainId:u,chainNamespace:n})}else e.includes(n)&&this.setStatus("disconnected",n);const c=this.getApprovedCaipNetworksData();this.syncConnectedWalletInfo(n),q.setApprovedCaipNetworksData(n,{approvedCaipNetworkIds:c.approvedCaipNetworkIds,supportsAllNetworks:c.supportsAllNetworks})});await Promise.all(r)}syncProvider({type:e,provider:r,id:n,chainNamespace:s}){Qt.setProviderId(s,e),Qt.setProvider(s,r),ge.setConnectorId(n,s)}async syncAccount(e){const r=e.chainNamespace===q.state.activeChain,n=q.getCaipNetworkByNamespace(e.chainNamespace,e.chainId),{address:s,chainId:i,chainNamespace:o}=e,{chainId:a}=de.getActiveNetworkProps(),c=n?.id||a,l=q.state.activeCaipNetwork?.name===fe.UNSUPPORTED_NETWORK_NAME,u=q.getNetworkProp("supportsAllNetworks",o);if(this.setStatus("connected",o),!(l&&!u)&&c){let d=this.getCaipNetworks().find(g=>g.id.toString()===c.toString()),h=this.getCaipNetworks().find(g=>g.chainNamespace===o);if(!u&&!d&&!h){const g=this.getApprovedCaipNetworkIds()||[],w=g.find(A=>sn.parseCaipNetworkId(A)?.chainId===c.toString()),S=g.find(A=>sn.parseCaipNetworkId(A)?.chainNamespace===o);d=this.getCaipNetworks().find(A=>A.caipNetworkId===w),h=this.getCaipNetworks().find(A=>A.caipNetworkId===S||"deprecatedCaipNetworkId"in A&&A.deprecatedCaipNetworkId===S)}const p=d||h;p?.chainNamespace===q.state.activeChain?te.state.enableNetworkSwitch&&!te.state.allowUnsupportedChain&&q.state.activeCaipNetwork?.name===fe.UNSUPPORTED_NETWORK_NAME?q.showUnsupportedChainUI():this.setCaipNetwork(p):r||n&&this.setCaipNetworkOfNamespace(n,o),this.syncConnectedWalletInfo(o);const y=this.getAddress(o);bh.isLowerCaseMatch(s,y)||this.syncAccountInfo(s,p?.id,o),r?await this.syncBalance({address:s,chainId:p?.id,chainNamespace:o}):await this.syncBalance({address:s,chainId:n?.id,chainNamespace:o}),this.syncIdentity({address:s,chainId:i,chainNamespace:o})}}async syncAccountInfo(e,r,n){const s=this.getCaipAddress(n),i=r||s?.split(":")[1];if(!i)return;const o=`${n}:${i}:${e}`;this.setCaipAddress(o,n,!0),await this.syncIdentity({address:e,chainId:i,chainNamespace:n})}async syncReownName(e,r){try{const n=await this.getReownName(e);if(n[0]){const s=n[0];this.setProfileName(s.name,r)}else this.setProfileName(null,r)}catch{this.setProfileName(null,r)}}syncConnectedWalletInfo(e){const r=ge.getConnectorId(e),n=Qt.getProviderId(e);if(n===uo.CONNECTOR_TYPE_ANNOUNCED||n===uo.CONNECTOR_TYPE_INJECTED){if(r){const i=this.getConnectors().find(o=>{const a=o.id===r,c=o.info?.rdns===r,l=o.connectors?.some(u=>u.id===r||u.info?.rdns===r);return a||c||!!l});if(i){const{info:o,name:a,imageUrl:c}=i,l=c||this.getConnectorImage(i);this.setConnectedWalletInfo({name:a,icon:l,...o},e)}}}else if(n===uo.CONNECTOR_TYPE_WALLET_CONNECT){const s=Qt.getProvider(e);s?.session&&this.setConnectedWalletInfo({...s.session.peer.metadata,name:s.session.peer.metadata.name,icon:s.session.peer.metadata.icons?.[0]},e)}else if(r&&(r===fe.CONNECTOR_ID.COINBASE_SDK||r===fe.CONNECTOR_ID.COINBASE)){const s=this.getConnectors().find(c=>c.id===r),i=s?.name||"Coinbase Wallet",o=s?.imageUrl||this.getConnectorImage(s),a=s?.info;this.setConnectedWalletInfo({...a,name:i,icon:o},e)}}async syncBalance(e){!xN.getNetworksByNamespace(this.getCaipNetworks(),e.chainNamespace).find(n=>n.id.toString()===e.chainId?.toString())||!e.chainId||await this.updateNativeBalance(e.address,e.chainId,e.chainNamespace)}async ready(){await this.readyPromise}async updateNativeBalance(e,r,n){const s=this.getAdapter(n),i=q.getCaipNetworkByNamespace(n,r);if(s){const o=await s.getBalance({address:e,chainId:r,caipNetwork:i,tokens:this.options.tokens});return this.setBalance(o.balance,o.symbol,n),o}}async initializeUniversalAdapter(){const e=Due.createLogger((s,...i)=>{s&&this.handleAlertError(s),console.error(...i)}),r={projectId:this.options?.projectId,metadata:{name:this.options?.metadata?this.options?.metadata.name:"",description:this.options?.metadata?this.options?.metadata.description:"",url:this.options?.metadata?this.options?.metadata.url:"",icons:this.options?.metadata?this.options?.metadata.icons:[""]},logger:e};te.setManualWCControl(!!this.options?.manualWCControl),this.universalProvider=this.options.universalProvider??await Jle.init(r);const n=this.universalProvider.disconnect.bind(this.universalProvider);this.universalProvider.disconnect=async()=>{try{return await n()}catch(s){if(s instanceof Error&&s.message.includes("Missing or invalid. Record was recently deleted"))return;throw s}},te.state.enableReconnect===!1&&this.universalProvider.session&&await this.universalProvider.disconnect(),this.listenWalletConnect()}listenWalletConnect(){this.universalProvider&&this.chainNamespaces.forEach(e=>{Ca.listenWcProvider({universalProvider:this.universalProvider,namespace:e,onDisplayUri:r=>{Ee.setUri(r)},onConnect:r=>{const{address:n}=Ne.getAccount(r[0]);Ee.finalizeWcConnection(n)},onDisconnect:()=>{q.state.noAdapters&&this.resetAccount(e),Ee.resetWcConnection()},onChainChanged:r=>{const n=q.state.activeChain,s=n&&ge.state.activeConnectorIds[n]===fe.CONNECTOR_ID.WALLET_CONNECT;if(n===e&&(q.state.noAdapters||s)){const i=this.getCaipNetworks().find(a=>a.id.toString()===r.toString()||a.caipNetworkId.toString()===r.toString()),o=this.getCaipNetwork();if(!i){this.setUnsupportedNetwork(r);return}o?.id.toString()!==i?.id.toString()&&o?.chainNamespace===i?.chainNamespace&&this.setCaipNetwork(i)}},onAccountsChanged:r=>{const n=q.state.activeChain,s=n&&ge.state.activeConnectorIds[n]===fe.CONNECTOR_ID.WALLET_CONNECT;if(n===e&&(q.state.noAdapters||s)){const i=r?.[0];i&&this.syncAccount({address:i.address,chainId:i.chainId,chainNamespace:i.chainNamespace})}}})})}createUniversalProvider(){return!this.universalProviderInitPromise&&Ne.isClient()&&this.options?.projectId&&(this.universalProviderInitPromise=this.initializeUniversalAdapter()),this.universalProviderInitPromise}async getUniversalProvider(){if(!this.universalProvider)try{await this.createUniversalProvider()}catch(e){ct.sendEvent({type:"error",event:"INTERNAL_SDK_ERROR",properties:{errorType:"UniversalProviderInitError",errorMessage:e instanceof Error?e.message:"Unknown",uncaught:!1}}),console.error("AppKit:getUniversalProvider - Cannot create provider",e)}return this.universalProvider}getDisabledCaipNetworks(){const e=q.getAllApprovedCaipNetworkIds(),r=q.getAllRequestedCaipNetworks();return Ne.sortRequestedNetworks(e,r).filter(s=>q.isCaipNetworkDisabled(s))}handleAlertError(e){const r=Object.entries(js.UniversalProviderErrors).find(([,{message:a}])=>e.message.includes(a)),[n,s]=r??[],{message:i,alertErrorKey:o}=s??{};if(n&&i&&!this.reportedAlertErrors[n]){const a=js.ALERT_ERRORS[o];a&&(gs.open(a,"error"),this.reportedAlertErrors[n]=!0)}}getAdapter(e){if(e)return this.chainAdapters?.[e]}createAdapter(e){if(!e)return;const r=e.namespace;if(!r)return;this.createClients();const n=e;n.namespace=r,n.construct({namespace:r,projectId:this.options?.projectId,networks:this.caipNetworks?.filter(({chainNamespace:s})=>s===r)}),this.chainNamespaces.includes(r)||this.chainNamespaces.push(r),this.chainAdapters&&(this.chainAdapters[r]=n)}async open(e){await this.injectModalUi(),e?.uri&&Ee.setUri(e.uri);const{isSwap:r,isSend:n}=this.toModalOptions();return r(e)?lt.open({...e,data:{swap:e.arguments}}):n(e)&&e.arguments?this.openSend(e.arguments):lt.open(e)}async close(){await this.injectModalUi(),lt.close()}setLoading(e,r){lt.setLoading(e,r)}async disconnect(e){await Ee.disconnect({namespace:e})}getSIWX(){return te.state.siwx}getError(){return""}getChainId(){return q.state.activeCaipNetwork?.id}async switchNetwork(e,{throwOnFailure:r=!1}={}){const n=this.getCaipNetworks().find(s=>s.id===e.id);if(!n){gs.open(js.ALERT_ERRORS.SWITCH_NETWORK_NOT_FOUND,"error");return}await q.switchActiveNetwork(n,{throwOnFailure:r})}getWalletProvider(){return q.state.activeChain?Qt.state.providers[q.state.activeChain]:null}getWalletProviderType(){return Qt.getProviderId(q.state.activeChain)}subscribeProviders(e){return Qt.subscribeProviders(e)}getThemeMode(){return ws.state.themeMode}getThemeVariables(){return ws.state.themeVariables}setThemeMode(e){ws.setThemeMode(e),Yb(ws.state.themeMode)}setTermsConditionsUrl(e){te.setTermsConditionsUrl(e)}setPrivacyPolicyUrl(e){te.setPrivacyPolicyUrl(e)}setThemeVariables(e){ws.setThemeVariables(e),pde(ws.state.themeVariables)}subscribeTheme(e){return ws.subscribe(e)}subscribeConnections(e){return this.remoteFeatures.multiWallet?Ee.subscribe(e):(gs.open(fe.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info"),()=>{})}getWalletInfo(e){return e?q.state.chains.get(e)?.accountState?.connectedWalletInfo:q.getAccountData()?.connectedWalletInfo}getAccount(e){const r=e||q.state.activeChain,n=ge.getAuthConnector(r),s=q.getAccountData(r),i=de.getConnectedConnectorId(q.state.activeChain),o=Ee.getConnections(r);if(!r)throw new Error("AppKit:getAccount - namespace is required");const a=o.flatMap(c=>c.accounts.map(({address:l,type:u,publicKey:d})=>Ne.createAccount(r,l,u||"eoa",d)));if(s)return{allAccounts:a,caipAddress:s.caipAddress,address:Ne.getPlainAddress(s.caipAddress),isConnected:!!s.caipAddress,status:s.status,embeddedWalletInfo:n&&i===fe.CONNECTOR_ID.AUTH?{user:s.user?{...s.user,username:de.getConnectedSocialUsername()}:void 0,authProvider:s.socialProvider||"email",accountType:Ys(r),isSmartAccountDeployed:!!s.smartAccountDeployed}:void 0}}subscribeAccount(e,r){const n=()=>{const s=this.getAccount(r);s&&e(s)};r?q.subscribeChainProp("accountState",n,r):q.subscribe(n),ge.subscribe(n)}subscribeNetwork(e){return q.subscribe(({activeCaipNetwork:r})=>{e({caipNetwork:r,chainId:r?.id,caipNetworkId:r?.caipNetworkId})})}subscribeWalletInfo(e,r){return r?q.subscribeChainProp("accountState",n=>e(n?.connectedWalletInfo),r):q.subscribeChainProp("accountState",n=>e(n?.connectedWalletInfo))}subscribeShouldUpdateToAddress(e){q.subscribeChainProp("accountState",r=>e(r?.shouldUpdateToAddress))}subscribeCaipNetworkChange(e){q.subscribeKey("activeCaipNetwork",e)}getState(){return $o.state}getRemoteFeatures(){return te.state.remoteFeatures}subscribeState(e){return $o.subscribe(e)}subscribeRemoteFeatures(e){return te.subscribeKey("remoteFeatures",e)}showErrorMessage(e){Li.showError(e)}showSuccessMessage(e){Li.showSuccess(e)}getEvent(){return{...ct.state}}subscribeEvents(e){return ct.subscribe(e)}replace(e){qe.replace(e)}redirect(e){qe.push(e)}popTransactionStack(e){qe.popTransactionStack(e)}isOpen(){return lt.state.open}isTransactionStackEmpty(){return qe.state.transactionStack.length===0}static getInstance(){return this.instance}updateFeatures(e){te.setFeatures(e)}updateRemoteFeatures(e){te.setRemoteFeatures(e)}updateOptions(e){const n={...te.state||{},...e};te.setOptions(n)}setConnectMethodsOrder(e){te.setConnectMethodsOrder(e)}setWalletFeaturesOrder(e){te.setWalletFeaturesOrder(e)}setCollapseWallets(e){te.setCollapseWallets(e)}setSocialsOrder(e){te.setSocialsOrder(e)}getConnectMethodsOrder(){return dd.getConnectOrderMethod(te.state.features,ge.getConnectors())}addNetwork(e,r){if(this.chainAdapters&&!this.chainAdapters[e])throw new Error(`Adapter for namespace ${e} doesn't exist`);const n=this.extendCaipNetwork(r,this.options);this.getCaipNetworks().find(s=>s.id===n.id)||q.addNetwork(n)}removeNetwork(e,r){if(this.chainAdapters&&!this.chainAdapters[e])throw new Error(`Adapter for namespace ${e} doesn't exist`);this.getCaipNetworks().find(s=>s.id===r)&&q.removeNetwork(e,r)}}let RI=!1;class _de extends Ede{async open(e){ge.isConnected()||await super.open(e)}async close(){if(await super.close(),this.options.manualWCControl){const e=q.getAccountData(this.activeChainNamespace)?.address;Ee.finalizeWcConnection(e)}}async syncIdentity(e){return Promise.resolve()}async syncBalance(e){return Promise.resolve()}async injectModalUi(){if(!RI&&Ne.isClient()){if(await ng(()=>import("./basic-CU7X1560.js"),__vite__mapDeps([0,1])),await ng(()=>import("./w3m-modal-Bh-jYajQ.js"),__vite__mapDeps([2,1])),!document.querySelector("w3m-modal")){const r=document.createElement("w3m-modal");!te.state.disableAppend&&!te.state.enableEmbedded&&document.body.insertAdjacentElement("beforeend",r)}RI=!0}}}const xde="1.8.12";function Sde(t){return new _de({...t,basic:!0,sdkVersion:`html-core-${xde}`})}const Ade=oX({id:1,name:"Ethereum",nativeCurrency:{name:"Ether",symbol:"ETH",decimals:18},blockTime:12e3,rpcUrls:{default:{http:["https://eth.merkle.io"]}},blockExplorers:{default:{name:"Etherscan",url:"https://etherscan.io",apiUrl:"https://api.etherscan.io/api"}},contracts:{ensUniversalResolver:{address:"0xeeeeeeee14d718c2b47d9923deab1335e144eeee",blockCreated:23085558},multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:14353601}}});function bu(t){return{formatters:void 0,fees:void 0,serializers:void 0,...t}}bu({id:"5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",name:"Solana",network:"solana-mainnet",nativeCurrency:{name:"Solana",symbol:"SOL",decimals:9},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},blockExplorers:{default:{name:"Solscan",url:"https://solscan.io"}},testnet:!1,chainNamespace:"solana",caipNetworkId:"solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",deprecatedCaipNetworkId:"solana:4sGjMW1sUnHzSxGspuhpqLDx6wiyjNtZ"});bu({id:"EtWTRABZaYq6iMfeYKouRu166VU2xqa1",name:"Solana Devnet",network:"solana-devnet",nativeCurrency:{name:"Solana",symbol:"SOL",decimals:9},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},blockExplorers:{default:{name:"Solscan",url:"https://solscan.io"}},testnet:!0,chainNamespace:"solana",caipNetworkId:"solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1",deprecatedCaipNetworkId:"solana:8E9rvCKLFQia2Y35HXjjpWzj8weVo44K"});bu({id:"4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z",name:"Solana Testnet",network:"solana-testnet",nativeCurrency:{name:"Solana",symbol:"SOL",decimals:9},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},blockExplorers:{default:{name:"Solscan",url:"https://solscan.io"}},testnet:!0,chainNamespace:"solana",caipNetworkId:"solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z"});bu({id:"000000000019d6689c085ae165831e93",caipNetworkId:"bip122:000000000019d6689c085ae165831e93",chainNamespace:"bip122",name:"Bitcoin",nativeCurrency:{name:"Bitcoin",symbol:"BTC",decimals:8},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}}});bu({id:"000000000933ea01ad0ee984209779ba",caipNetworkId:"bip122:000000000933ea01ad0ee984209779ba",chainNamespace:"bip122",name:"Bitcoin Testnet",nativeCurrency:{name:"Bitcoin",symbol:"BTC",decimals:8},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},testnet:!0});bu({id:"00000008819873e925422c1ff0f99f7c",caipNetworkId:"bip122:00000008819873e925422c1ff0f99f7c",chainNamespace:"bip122",name:"Bitcoin Signet",nativeCurrency:{name:"Bitcoin",symbol:"BTC",decimals:8},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},testnet:!0});const Ide="wallet_connect";class Cde{wcParams;moduleType;productIcon;productId;productName;productUrl;modal;signClient;initiated;constructor(e){if(this.wcParams=e,this.moduleType=Bo.BRIDGE_WALLET,this.productIcon="https://stellar.creit.tech/wallet-icons/walletconnect.png",this.productId=Ide,this.productName="WalletConnect",this.productUrl="https://walletconnect.com/",this.initiated=!1,!e)throw new Error("The WalletConnect modules have required params.");XG.init({projectId:e.projectId,metadata:e.metadata,...e.signClientOptions||{}}).then(r=>{r.on("display_uri",n=>{this.modal.open({uri:n})}),r.on("session_delete",n=>{this.closeSession(n.topic)}),this.signClient=r}),this.modal=Sde({projectId:e.projectId,manualWCControl:!0,enableReconnect:!0,networks:[Ade],featuredWalletIds:["aef3112adf415ec870529e96b4d7b434f13961a079d1ee42c9738217d8adeb91","76a3d548a08cf402f5c7d021f24fd2881d767084b387a5325df88bc3d4b6f21b"],...e.appKitOptions||{}})}async isAvailable(){return!!this.signClient&&!!this.modal}async runChecks(){if(!await this.isAvailable())throw Bt(new Error("WalletConnect modules has not been started yet."))}async getAddress(){if(await this.runChecks(),Pi.value!==Sa.PUBLIC&&Pi.value!==Sa.TESTNET)throw Bt(new Error(`Network ${Pi.value} is not supported by WalletConnect.`));const{uri:e,approval:r}=await this.signClient.connect({requiredNamespaces:{stellar:{methods:[DI.SIGN],chains:this.wcParams.allowedChains||[Hw.PUBLIC],events:[]}}});e&&this.modal.open({uri:e});try{const n=await r(),s=n.namespaces.stellar.accounts.map(i=>i.split(":")[2]);return yo.value=[...yo.value,...s.map(i=>({publicKey:i,topic:n.topic}))],this.modal.close(),{address:s[0]}}catch(n){throw this.modal.close(),n}}async signTransaction(e,r){await this.runChecks();const s=yo.value.find(o=>(r?.address||ur.value)===o.publicKey);if(!s)throw Bt(new Error("No WalletConnect session found or it expired for the selected address."));const{signedXDR:i}=await this.signClient.request({topic:s.topic,chainId:r?.networkPassphrase===Sa.PUBLIC?Hw.PUBLIC:Hw.TESTNET,request:{method:DI.SIGN,params:{xdr:e}}});return{signedTxXdr:i}}async disconnect(){if(!this.signClient)throw new Error("WalletConnect is not running yet");const e=await this.getSessions();for(const r of e)await this.closeSession(r.topic)}async getSessions(){if(!this.signClient)throw new Error("WalletConnect is not running yet");return this.signClient.session.values}async closeSession(e,r){if(!this.signClient)throw new Error("WalletConnect is not running yet");yo.value=yo.value.filter(n=>n.topic!==e),yo.value.length===0&&f1(),await this.signClient.disconnect({topic:e,reason:{message:r||"Session closed",code:-1}})}async signAuthEntry(){throw{code:-3,message:'WalletConnect does not support the "signAuthEntry" function'}}async signMessage(){throw{code:-3,message:'WalletConnect does not support the "signMessage" function'}}async getNetwork(){throw{code:-3,message:'WalletConnect does not support the "getNetwork" function'}}}var Hw=(function(t){return t.PUBLIC="stellar:pubnet",t.TESTNET="stellar:testnet",t})({}),DI=(function(t){return t.SIGN="stellar_signXDR",t})({});Kn.init({theme:V6,modules:[...TP(),new Cde({projectId:"48b7bf0dacf7920c182f112b3cc388a8",metadata:{name:"PortalX LITE",description:"PortalX LITE Wallet Connector",icons:["https://legacygold.github.io/portalx-lite-test/icon.PNG"],url:"https://legacygold.github.io/portalx-lite-test/"}})]});const S6=document.querySelector("#buttonWrapper");Kn.createButton(S6);S6.addEventListener("click",async()=>{try{const{address:t}=await Kn.authModal();console.log("CONNECTED:",t),alert(`Connected wallet:
`+t)}catch(t){console.error("Connection error:",t)}});export{Pf as $,Ue as A,He as B,ge as C,gs as D,ct as E,cv as F,qN as G,bh as H,cn as I,an as J,hi as K,fde as L,lt as M,aY as N,te as O,Bue as P,kpe as Q,qe as R,Li as S,ws as T,w6 as U,Kb as V,dd as W,lu as X,xN as Y,Le as Z,ng as _,Ne as a,kY as a$,De as a0,Zt as a1,Lx as a2,oy as a3,sv as a4,$Y as a5,BY as a6,Mx as a7,MY as a8,Afe as a9,ZY as aA,JY as aB,Bfe as aC,$fe as aD,eX as aE,Lfe as aF,BN as aG,rX as aH,Mfe as aI,zfe as aJ,jfe as aK,qfe as aL,Ffe as aM,ov as aN,vd as aO,kfe as aP,Hfe as aQ,Wfe as aR,QY as aS,tX as aT,LN as aU,qx as aV,uX as aW,kf as aX,$f as aY,jY as aZ,kN as a_,TY as aa,UY as ab,OY as ac,RN as ad,PN as ae,Pfe as af,Jm as ag,Nfe as ah,RY as ai,$c as aj,iv as ak,Dfe as al,og as am,Ufe as an,ru as ao,Zd as ap,DN as aq,av as ar,zY as as,HY as at,WY as au,VY as av,KY as aw,GY as ax,YY as ay,XY as az,Ee as b,PY as b0,jx as b1,hh as b2,dh as b3,uh as b4,sh as b5,ch as b6,Xd as b7,Gd as b8,eh as b9,su as ba,Yd as bb,mc as bc,Kd as bd,nh as be,$s as bf,Jd as bg,Qd as bh,as as bi,ih as bj,nu as bk,th as bl,lh as bm,qY as bn,ah as bo,oh as bp,rh as bq,Tc as br,hX as bs,oX as bt,NY as bu,aX as bv,fe as c,Ope as d,Gs as e,qw as f,jN as g,Rpe as h,_p as i,Bc as j,_o as k,mt as l,Sh as m,Npe as n,q as o,Cl as p,de as q,Ppe as r,Gr as s,ba as t,Xt as u,Ys as v,Js as w,Tpe as x,xo as y,BX as z};
